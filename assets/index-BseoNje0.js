(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))o(d);new MutationObserver(d=>{for(const h of d)if(h.type==="childList")for(const f of h.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&o(f)}).observe(document,{childList:!0,subtree:!0});function n(d){const h={};return d.integrity&&(h.integrity=d.integrity),d.referrerPolicy&&(h.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?h.credentials="include":d.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function o(d){if(d.ep)return;d.ep=!0;const h=n(d);fetch(d.href,h)}})();function dp(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var nu={exports:{}},di={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Em;function Y0(){if(Em)return di;Em=1;var l=Symbol.for("react.transitional.element"),s=Symbol.for("react.fragment");function n(o,d,h){var f=null;if(h!==void 0&&(f=""+h),d.key!==void 0&&(f=""+d.key),"key"in d){h={};for(var b in d)b!=="key"&&(h[b]=d[b])}else h=d;return d=h.ref,{$$typeof:l,type:o,key:f,ref:d!==void 0?d:null,props:h}}return di.Fragment=s,di.jsx=n,di.jsxs=n,di}var Tm;function K0(){return Tm||(Tm=1,nu.exports=Y0()),nu.exports}var r=K0(),iu={exports:{}},$e={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var km;function V0(){if(km)return $e;km=1;var l=Symbol.for("react.transitional.element"),s=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),h=Symbol.for("react.consumer"),f=Symbol.for("react.context"),b=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),N=Symbol.iterator;function j(A){return A===null||typeof A!="object"?null:(A=N&&A[N]||A["@@iterator"],typeof A=="function"?A:null)}var C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},z=Object.assign,M={};function E(A,Q,fe){this.props=A,this.context=Q,this.refs=M,this.updater=fe||C}E.prototype.isReactComponent={},E.prototype.setState=function(A,Q){if(typeof A!="object"&&typeof A!="function"&&A!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,A,Q,"setState")},E.prototype.forceUpdate=function(A){this.updater.enqueueForceUpdate(this,A,"forceUpdate")};function O(){}O.prototype=E.prototype;function _(A,Q,fe){this.props=A,this.context=Q,this.refs=M,this.updater=fe||C}var G=_.prototype=new O;G.constructor=_,z(G,E.prototype),G.isPureReactComponent=!0;var he=Array.isArray;function Z(){}var ie={H:null,A:null,T:null,S:null},ge=Object.prototype.hasOwnProperty;function we(A,Q,fe){var be=fe.ref;return{$$typeof:l,type:A,key:Q,ref:be!==void 0?be:null,props:fe}}function je(A,Q){return we(A.type,Q,A.props)}function Ue(A){return typeof A=="object"&&A!==null&&A.$$typeof===l}function Ce(A){var Q={"=":"=0",":":"=2"};return"$"+A.replace(/[=:]/g,function(fe){return Q[fe]})}var Ge=/\/+/g;function qe(A,Q){return typeof A=="object"&&A!==null&&A.key!=null?Ce(""+A.key):Q.toString(36)}function ye(A){switch(A.status){case"fulfilled":return A.value;case"rejected":throw A.reason;default:switch(typeof A.status=="string"?A.then(Z,Z):(A.status="pending",A.then(function(Q){A.status==="pending"&&(A.status="fulfilled",A.value=Q)},function(Q){A.status==="pending"&&(A.status="rejected",A.reason=Q)})),A.status){case"fulfilled":return A.value;case"rejected":throw A.reason}}throw A}function S(A,Q,fe,be,Ne){var Le=typeof A;(Le==="undefined"||Le==="boolean")&&(A=null);var Xe=!1;if(A===null)Xe=!0;else switch(Le){case"bigint":case"string":case"number":Xe=!0;break;case"object":switch(A.$$typeof){case l:case s:Xe=!0;break;case v:return Xe=A._init,S(Xe(A._payload),Q,fe,be,Ne)}}if(Xe)return Ne=Ne(A),Xe=be===""?"."+qe(A,0):be,he(Ne)?(fe="",Xe!=null&&(fe=Xe.replace(Ge,"$&/")+"/"),S(Ne,Q,fe,"",function(He){return He})):Ne!=null&&(Ue(Ne)&&(Ne=je(Ne,fe+(Ne.key==null||A&&A.key===Ne.key?"":(""+Ne.key).replace(Ge,"$&/")+"/")+Xe)),Q.push(Ne)),1;Xe=0;var zt=be===""?".":be+":";if(he(A))for(var ft=0;ft<A.length;ft++)be=A[ft],Le=zt+qe(be,ft),Xe+=S(be,Q,fe,Le,Ne);else if(ft=j(A),typeof ft=="function")for(A=ft.call(A),ft=0;!(be=A.next()).done;)be=be.value,Le=zt+qe(be,ft++),Xe+=S(be,Q,fe,Le,Ne);else if(Le==="object"){if(typeof A.then=="function")return S(ye(A),Q,fe,be,Ne);throw Q=String(A),Error("Objects are not valid as a React child (found: "+(Q==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":Q)+"). If you meant to render a collection of children, use an array instead.")}return Xe}function V(A,Q,fe){if(A==null)return A;var be=[],Ne=0;return S(A,be,"","",function(Le){return Q.call(fe,Le,Ne++)}),be}function ne(A){if(A._status===-1){var Q=A._result;Q=Q(),Q.then(function(fe){(A._status===0||A._status===-1)&&(A._status=1,A._result=fe)},function(fe){(A._status===0||A._status===-1)&&(A._status=2,A._result=fe)}),A._status===-1&&(A._status=0,A._result=Q)}if(A._status===1)return A._result.default;throw A._result}var pe=typeof reportError=="function"?reportError:function(A){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Q=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof A=="object"&&A!==null&&typeof A.message=="string"?String(A.message):String(A),error:A});if(!window.dispatchEvent(Q))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",A);return}console.error(A)},Te={map:V,forEach:function(A,Q,fe){V(A,function(){Q.apply(this,arguments)},fe)},count:function(A){var Q=0;return V(A,function(){Q++}),Q},toArray:function(A){return V(A,function(Q){return Q})||[]},only:function(A){if(!Ue(A))throw Error("React.Children.only expected to receive a single React element child.");return A}};return $e.Activity=x,$e.Children=Te,$e.Component=E,$e.Fragment=n,$e.Profiler=d,$e.PureComponent=_,$e.StrictMode=o,$e.Suspense=g,$e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=ie,$e.__COMPILER_RUNTIME={__proto__:null,c:function(A){return ie.H.useMemoCache(A)}},$e.cache=function(A){return function(){return A.apply(null,arguments)}},$e.cacheSignal=function(){return null},$e.cloneElement=function(A,Q,fe){if(A==null)throw Error("The argument must be a React element, but you passed "+A+".");var be=z({},A.props),Ne=A.key;if(Q!=null)for(Le in Q.key!==void 0&&(Ne=""+Q.key),Q)!ge.call(Q,Le)||Le==="key"||Le==="__self"||Le==="__source"||Le==="ref"&&Q.ref===void 0||(be[Le]=Q[Le]);var Le=arguments.length-2;if(Le===1)be.children=fe;else if(1<Le){for(var Xe=Array(Le),zt=0;zt<Le;zt++)Xe[zt]=arguments[zt+2];be.children=Xe}return we(A.type,Ne,be)},$e.createContext=function(A){return A={$$typeof:f,_currentValue:A,_currentValue2:A,_threadCount:0,Provider:null,Consumer:null},A.Provider=A,A.Consumer={$$typeof:h,_context:A},A},$e.createElement=function(A,Q,fe){var be,Ne={},Le=null;if(Q!=null)for(be in Q.key!==void 0&&(Le=""+Q.key),Q)ge.call(Q,be)&&be!=="key"&&be!=="__self"&&be!=="__source"&&(Ne[be]=Q[be]);var Xe=arguments.length-2;if(Xe===1)Ne.children=fe;else if(1<Xe){for(var zt=Array(Xe),ft=0;ft<Xe;ft++)zt[ft]=arguments[ft+2];Ne.children=zt}if(A&&A.defaultProps)for(be in Xe=A.defaultProps,Xe)Ne[be]===void 0&&(Ne[be]=Xe[be]);return we(A,Le,Ne)},$e.createRef=function(){return{current:null}},$e.forwardRef=function(A){return{$$typeof:b,render:A}},$e.isValidElement=Ue,$e.lazy=function(A){return{$$typeof:v,_payload:{_status:-1,_result:A},_init:ne}},$e.memo=function(A,Q){return{$$typeof:p,type:A,compare:Q===void 0?null:Q}},$e.startTransition=function(A){var Q=ie.T,fe={};ie.T=fe;try{var be=A(),Ne=ie.S;Ne!==null&&Ne(fe,be),typeof be=="object"&&be!==null&&typeof be.then=="function"&&be.then(Z,pe)}catch(Le){pe(Le)}finally{Q!==null&&fe.types!==null&&(Q.types=fe.types),ie.T=Q}},$e.unstable_useCacheRefresh=function(){return ie.H.useCacheRefresh()},$e.use=function(A){return ie.H.use(A)},$e.useActionState=function(A,Q,fe){return ie.H.useActionState(A,Q,fe)},$e.useCallback=function(A,Q){return ie.H.useCallback(A,Q)},$e.useContext=function(A){return ie.H.useContext(A)},$e.useDebugValue=function(){},$e.useDeferredValue=function(A,Q){return ie.H.useDeferredValue(A,Q)},$e.useEffect=function(A,Q){return ie.H.useEffect(A,Q)},$e.useEffectEvent=function(A){return ie.H.useEffectEvent(A)},$e.useId=function(){return ie.H.useId()},$e.useImperativeHandle=function(A,Q,fe){return ie.H.useImperativeHandle(A,Q,fe)},$e.useInsertionEffect=function(A,Q){return ie.H.useInsertionEffect(A,Q)},$e.useLayoutEffect=function(A,Q){return ie.H.useLayoutEffect(A,Q)},$e.useMemo=function(A,Q){return ie.H.useMemo(A,Q)},$e.useOptimistic=function(A,Q){return ie.H.useOptimistic(A,Q)},$e.useReducer=function(A,Q,fe){return ie.H.useReducer(A,Q,fe)},$e.useRef=function(A){return ie.H.useRef(A)},$e.useState=function(A){return ie.H.useState(A)},$e.useSyncExternalStore=function(A,Q,fe){return ie.H.useSyncExternalStore(A,Q,fe)},$e.useTransition=function(){return ie.H.useTransition()},$e.version="19.2.3",$e}var Am;function Ru(){return Am||(Am=1,iu.exports=V0()),iu.exports}var ee=Ru();const _i=dp(ee);var lu={exports:{}},hi={},ou={exports:{}},cu={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Om;function Q0(){return Om||(Om=1,(function(l){function s(S,V){var ne=S.length;S.push(V);e:for(;0<ne;){var pe=ne-1>>>1,Te=S[pe];if(0<d(Te,V))S[pe]=V,S[ne]=Te,ne=pe;else break e}}function n(S){return S.length===0?null:S[0]}function o(S){if(S.length===0)return null;var V=S[0],ne=S.pop();if(ne!==V){S[0]=ne;e:for(var pe=0,Te=S.length,A=Te>>>1;pe<A;){var Q=2*(pe+1)-1,fe=S[Q],be=Q+1,Ne=S[be];if(0>d(fe,ne))be<Te&&0>d(Ne,fe)?(S[pe]=Ne,S[be]=ne,pe=be):(S[pe]=fe,S[Q]=ne,pe=Q);else if(be<Te&&0>d(Ne,ne))S[pe]=Ne,S[be]=ne,pe=be;else break e}}return V}function d(S,V){var ne=S.sortIndex-V.sortIndex;return ne!==0?ne:S.id-V.id}if(l.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var h=performance;l.unstable_now=function(){return h.now()}}else{var f=Date,b=f.now();l.unstable_now=function(){return f.now()-b}}var g=[],p=[],v=1,x=null,N=3,j=!1,C=!1,z=!1,M=!1,E=typeof setTimeout=="function"?setTimeout:null,O=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;function G(S){for(var V=n(p);V!==null;){if(V.callback===null)o(p);else if(V.startTime<=S)o(p),V.sortIndex=V.expirationTime,s(g,V);else break;V=n(p)}}function he(S){if(z=!1,G(S),!C)if(n(g)!==null)C=!0,Z||(Z=!0,Ce());else{var V=n(p);V!==null&&ye(he,V.startTime-S)}}var Z=!1,ie=-1,ge=5,we=-1;function je(){return M?!0:!(l.unstable_now()-we<ge)}function Ue(){if(M=!1,Z){var S=l.unstable_now();we=S;var V=!0;try{e:{C=!1,z&&(z=!1,O(ie),ie=-1),j=!0;var ne=N;try{t:{for(G(S),x=n(g);x!==null&&!(x.expirationTime>S&&je());){var pe=x.callback;if(typeof pe=="function"){x.callback=null,N=x.priorityLevel;var Te=pe(x.expirationTime<=S);if(S=l.unstable_now(),typeof Te=="function"){x.callback=Te,G(S),V=!0;break t}x===n(g)&&o(g),G(S)}else o(g);x=n(g)}if(x!==null)V=!0;else{var A=n(p);A!==null&&ye(he,A.startTime-S),V=!1}}break e}finally{x=null,N=ne,j=!1}V=void 0}}finally{V?Ce():Z=!1}}}var Ce;if(typeof _=="function")Ce=function(){_(Ue)};else if(typeof MessageChannel<"u"){var Ge=new MessageChannel,qe=Ge.port2;Ge.port1.onmessage=Ue,Ce=function(){qe.postMessage(null)}}else Ce=function(){E(Ue,0)};function ye(S,V){ie=E(function(){S(l.unstable_now())},V)}l.unstable_IdlePriority=5,l.unstable_ImmediatePriority=1,l.unstable_LowPriority=4,l.unstable_NormalPriority=3,l.unstable_Profiling=null,l.unstable_UserBlockingPriority=2,l.unstable_cancelCallback=function(S){S.callback=null},l.unstable_forceFrameRate=function(S){0>S||125<S?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ge=0<S?Math.floor(1e3/S):5},l.unstable_getCurrentPriorityLevel=function(){return N},l.unstable_next=function(S){switch(N){case 1:case 2:case 3:var V=3;break;default:V=N}var ne=N;N=V;try{return S()}finally{N=ne}},l.unstable_requestPaint=function(){M=!0},l.unstable_runWithPriority=function(S,V){switch(S){case 1:case 2:case 3:case 4:case 5:break;default:S=3}var ne=N;N=S;try{return V()}finally{N=ne}},l.unstable_scheduleCallback=function(S,V,ne){var pe=l.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?pe+ne:pe):ne=pe,S){case 1:var Te=-1;break;case 2:Te=250;break;case 5:Te=1073741823;break;case 4:Te=1e4;break;default:Te=5e3}return Te=ne+Te,S={id:v++,callback:V,priorityLevel:S,startTime:ne,expirationTime:Te,sortIndex:-1},ne>pe?(S.sortIndex=ne,s(p,S),n(g)===null&&S===n(p)&&(z?(O(ie),ie=-1):z=!0,ye(he,ne-pe))):(S.sortIndex=Te,s(g,S),C||j||(C=!0,Z||(Z=!0,Ce()))),S},l.unstable_shouldYield=je,l.unstable_wrapCallback=function(S){var V=N;return function(){var ne=N;N=V;try{return S.apply(this,arguments)}finally{N=ne}}}})(cu)),cu}var Cm;function Z0(){return Cm||(Cm=1,ou.exports=Q0()),ou.exports}var uu={exports:{}},ca={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rm;function J0(){if(Rm)return ca;Rm=1;var l=Ru();function s(g){var p="https://react.dev/errors/"+g;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)p+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+g+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var o={d:{f:n,r:function(){throw Error(s(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},d=Symbol.for("react.portal");function h(g,p,v){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:d,key:x==null?null:""+x,children:g,containerInfo:p,implementation:v}}var f=l.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function b(g,p){if(g==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return ca.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=o,ca.createPortal=function(g,p){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(s(299));return h(g,p,null,v)},ca.flushSync=function(g){var p=f.T,v=o.p;try{if(f.T=null,o.p=2,g)return g()}finally{f.T=p,o.p=v,o.d.f()}},ca.preconnect=function(g,p){typeof g=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,o.d.C(g,p))},ca.prefetchDNS=function(g){typeof g=="string"&&o.d.D(g)},ca.preinit=function(g,p){if(typeof g=="string"&&p&&typeof p.as=="string"){var v=p.as,x=b(v,p.crossOrigin),N=typeof p.integrity=="string"?p.integrity:void 0,j=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;v==="style"?o.d.S(g,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:x,integrity:N,fetchPriority:j}):v==="script"&&o.d.X(g,{crossOrigin:x,integrity:N,fetchPriority:j,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},ca.preinitModule=function(g,p){if(typeof g=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var v=b(p.as,p.crossOrigin);o.d.M(g,{crossOrigin:v,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&o.d.M(g)},ca.preload=function(g,p){if(typeof g=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var v=p.as,x=b(v,p.crossOrigin);o.d.L(g,v,{crossOrigin:x,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},ca.preloadModule=function(g,p){if(typeof g=="string")if(p){var v=b(p.as,p.crossOrigin);o.d.m(g,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:v,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else o.d.m(g)},ca.requestFormReset=function(g){o.d.r(g)},ca.unstable_batchedUpdates=function(g,p){return g(p)},ca.useFormState=function(g,p,v){return f.H.useFormState(g,p,v)},ca.useFormStatus=function(){return f.H.useHostTransitionStatus()},ca.version="19.2.3",ca}var zm;function X0(){if(zm)return uu.exports;zm=1;function l(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(l)}catch(s){console.error(s)}}return l(),uu.exports=J0(),uu.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mm;function W0(){if(Mm)return hi;Mm=1;var l=Z0(),s=Ru(),n=X0();function o(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)t+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function d(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function h(e){var t=e,a=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(a=t.return),e=t.return;while(e)}return t.tag===3?a:null}function f(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function b(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function g(e){if(h(e)!==e)throw Error(o(188))}function p(e){var t=e.alternate;if(!t){if(t=h(e),t===null)throw Error(o(188));return t!==e?null:e}for(var a=e,i=t;;){var c=a.return;if(c===null)break;var u=c.alternate;if(u===null){if(i=c.return,i!==null){a=i;continue}break}if(c.child===u.child){for(u=c.child;u;){if(u===a)return g(c),e;if(u===i)return g(c),t;u=u.sibling}throw Error(o(188))}if(a.return!==i.return)a=c,i=u;else{for(var m=!1,y=c.child;y;){if(y===a){m=!0,a=c,i=u;break}if(y===i){m=!0,i=c,a=u;break}y=y.sibling}if(!m){for(y=u.child;y;){if(y===a){m=!0,a=u,i=c;break}if(y===i){m=!0,i=u,a=c;break}y=y.sibling}if(!m)throw Error(o(189))}}if(a.alternate!==i)throw Error(o(190))}if(a.tag!==3)throw Error(o(188));return a.stateNode.current===a?e:t}function v(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=v(e),t!==null)return t;e=e.sibling}return null}var x=Object.assign,N=Symbol.for("react.element"),j=Symbol.for("react.transitional.element"),C=Symbol.for("react.portal"),z=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),O=Symbol.for("react.consumer"),_=Symbol.for("react.context"),G=Symbol.for("react.forward_ref"),he=Symbol.for("react.suspense"),Z=Symbol.for("react.suspense_list"),ie=Symbol.for("react.memo"),ge=Symbol.for("react.lazy"),we=Symbol.for("react.activity"),je=Symbol.for("react.memo_cache_sentinel"),Ue=Symbol.iterator;function Ce(e){return e===null||typeof e!="object"?null:(e=Ue&&e[Ue]||e["@@iterator"],typeof e=="function"?e:null)}var Ge=Symbol.for("react.client.reference");function qe(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===Ge?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case z:return"Fragment";case E:return"Profiler";case M:return"StrictMode";case he:return"Suspense";case Z:return"SuspenseList";case we:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case C:return"Portal";case _:return e.displayName||"Context";case O:return(e._context.displayName||"Context")+".Consumer";case G:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case ie:return t=e.displayName||null,t!==null?t:qe(e.type)||"Memo";case ge:t=e._payload,e=e._init;try{return qe(e(t))}catch{}}return null}var ye=Array.isArray,S=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,V=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ne={pending:!1,data:null,method:null,action:null},pe=[],Te=-1;function A(e){return{current:e}}function Q(e){0>Te||(e.current=pe[Te],pe[Te]=null,Te--)}function fe(e,t){Te++,pe[Te]=e.current,e.current=t}var be=A(null),Ne=A(null),Le=A(null),Xe=A(null);function zt(e,t){switch(fe(Le,t),fe(Ne,e),fe(be,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?Zf(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=Zf(t),e=Jf(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}Q(be),fe(be,e)}function ft(){Q(be),Q(Ne),Q(Le)}function He(e){e.memoizedState!==null&&fe(Xe,e);var t=be.current,a=Jf(t,e.type);t!==a&&(fe(Ne,e),fe(be,a))}function Mt(e){Ne.current===e&&(Q(be),Q(Ne)),Xe.current===e&&(Q(Xe),li._currentValue=ne)}var lt,ce;function re(e){if(lt===void 0)try{throw Error()}catch(a){var t=a.stack.trim().match(/\n( *(at )?)/);lt=t&&t[1]||"",ce=-1<a.stack.indexOf(`
    at`)?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return`
`+lt+e+ce}var Ie=!1;function Ye(e,t){if(!e||Ie)return"";Ie=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(t){var se=function(){throw Error()};if(Object.defineProperty(se.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(se,[])}catch(Y){var P=Y}Reflect.construct(e,[],se)}else{try{se.call()}catch(Y){P=Y}e.call(se.prototype)}}else{try{throw Error()}catch(Y){P=Y}(se=e())&&typeof se.catch=="function"&&se.catch(function(){})}}catch(Y){if(Y&&P&&typeof Y.stack=="string")return[Y.stack,P.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var c=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");c&&c.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var u=i.DetermineComponentFrameRoot(),m=u[0],y=u[1];if(m&&y){var T=m.split(`
`),I=y.split(`
`);for(c=i=0;i<T.length&&!T[i].includes("DetermineComponentFrameRoot");)i++;for(;c<I.length&&!I[c].includes("DetermineComponentFrameRoot");)c++;if(i===T.length||c===I.length)for(i=T.length-1,c=I.length-1;1<=i&&0<=c&&T[i]!==I[c];)c--;for(;1<=i&&0<=c;i--,c--)if(T[i]!==I[c]){if(i!==1||c!==1)do if(i--,c--,0>c||T[i]!==I[c]){var J=`
`+T[i].replace(" at new "," at ");return e.displayName&&J.includes("<anonymous>")&&(J=J.replace("<anonymous>",e.displayName)),J}while(1<=i&&0<=c);break}}}finally{Ie=!1,Error.prepareStackTrace=a}return(a=e?e.displayName||e.name:"")?re(a):""}function ut(e,t){switch(e.tag){case 26:case 27:case 5:return re(e.type);case 16:return re("Lazy");case 13:return e.child!==t&&t!==null?re("Suspense Fallback"):re("Suspense");case 19:return re("SuspenseList");case 0:case 15:return Ye(e.type,!1);case 11:return Ye(e.type.render,!1);case 1:return Ye(e.type,!0);case 31:return re("Activity");default:return""}}function Ht(e){try{var t="",a=null;do t+=ut(e,a),a=e,e=e.return;while(e);return t}catch(i){return`
Error generating stack: `+i.message+`
`+i.stack}}var it=Object.prototype.hasOwnProperty,ha=l.unstable_scheduleCallback,fa=l.unstable_cancelCallback,Dt=l.unstable_shouldYield,ma=l.unstable_requestPaint,Zt=l.unstable_now,Or=l.unstable_getCurrentPriorityLevel,Si=l.unstable_ImmediatePriority,Ei=l.unstable_UserBlockingPriority,pa=l.unstable_NormalPriority,_n=l.unstable_LowPriority,Ti=l.unstable_IdlePriority,w=l.log,k=l.unstable_setDisableYieldValue,D=null,B=null;function U(e){if(typeof w=="function"&&k(e),B&&typeof B.setStrictMode=="function")try{B.setStrictMode(D,e)}catch{}}var te=Math.clz32?Math.clz32:K,le=Math.log,X=Math.LN2;function K(e){return e>>>=0,e===0?32:31-(le(e)/X|0)|0}var F=256,$=262144,q=4194304;function W(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function me(e,t,a){var i=e.pendingLanes;if(i===0)return 0;var c=0,u=e.suspendedLanes,m=e.pingedLanes;e=e.warmLanes;var y=i&134217727;return y!==0?(i=y&~u,i!==0?c=W(i):(m&=y,m!==0?c=W(m):a||(a=y&~e,a!==0&&(c=W(a))))):(y=i&~u,y!==0?c=W(y):m!==0?c=W(m):a||(a=i&~e,a!==0&&(c=W(a)))),c===0?0:t!==0&&t!==c&&(t&u)===0&&(u=c&-c,a=t&-t,u>=a||u===32&&(a&4194048)!==0)?t:c}function ke(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function Re(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Nt(){var e=q;return q<<=1,(q&62914560)===0&&(q=4194304),e}function dt(e){for(var t=[],a=0;31>a;a++)t.push(e);return t}function We(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function St(e,t,a,i,c,u){var m=e.pendingLanes;e.pendingLanes=a,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=a,e.entangledLanes&=a,e.errorRecoveryDisabledLanes&=a,e.shellSuspendCounter=0;var y=e.entanglements,T=e.expirationTimes,I=e.hiddenUpdates;for(a=m&~a;0<a;){var J=31-te(a),se=1<<J;y[J]=0,T[J]=-1;var P=I[J];if(P!==null)for(I[J]=null,J=0;J<P.length;J++){var Y=P[J];Y!==null&&(Y.lane&=-536870913)}a&=~se}i!==0&&Jt(e,i,0),u!==0&&c===0&&e.tag!==0&&(e.suspendedLanes|=u&~(m&~t))}function Jt(e,t,a){e.pendingLanes|=t,e.suspendedLanes&=~t;var i=31-te(t);e.entangledLanes|=t,e.entanglements[i]=e.entanglements[i]|1073741824|a&261930}function la(e,t){var a=e.entangledLanes|=t;for(e=e.entanglements;a;){var i=31-te(a),c=1<<i;c&t|e[i]&t&&(e[i]|=t),a&=~c}}function Se(e,t){var a=t&-t;return a=(a&42)!==0?1:At(a),(a&(e.suspendedLanes|t))!==0?0:a}function At(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function mt(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function Pt(){var e=V.p;return e!==0?e:(e=window.event,e===void 0?32:ym(e.type))}function ve(e,t){var a=V.p;try{return V.p=e,t()}finally{V.p=a}}var Fe=Math.random().toString(36).slice(2),et="__reactFiber$"+Fe,Ke="__reactProps$"+Fe,Qe="__reactContainer$"+Fe,wt="__reactEvents$"+Fe,oa="__reactListeners$"+Fe,nr="__reactHandles$"+Fe,as="__reactResources$"+Fe,cs="__reactMarker$"+Fe;function Va(e){delete e[et],delete e[Ke],delete e[wt],delete e[oa],delete e[nr]}function Et(e){var t=e[et];if(t)return t;for(var a=e.parentNode;a;){if(t=a[Qe]||a[et]){if(a=t.alternate,t.child!==null||a!==null&&a.child!==null)for(e=sm(e);e!==null;){if(a=e[et])return a;e=sm(e)}return t}e=a,a=e.parentNode}return null}function Ct(e){if(e=e[et]||e[Qe]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function Qa(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(o(33))}function _a(e){var t=e[as];return t||(t=e[as]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function bt(e){e[cs]=!0}var ss=new Set,Rs={};function Xt(e,t){us(e,t),us(e+"Capture",t)}function us(e,t){for(Rs[e]=t,e=0;e<t.length;e++)ss.add(t[e])}var Up=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Bu={},Hu={};function Lp(e){return it.call(Hu,e)?!0:it.call(Bu,e)?!1:Up.test(e)?Hu[e]=!0:(Bu[e]=!0,!1)}function ki(e,t,a){if(Lp(t))if(a===null)e.removeAttribute(t);else{switch(typeof a){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var i=t.toLowerCase().slice(0,5);if(i!=="data-"&&i!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+a)}}function Ai(e,t,a){if(a===null)e.removeAttribute(t);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+a)}}function ds(e,t,a,i){if(i===null)e.removeAttribute(a);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(a);return}e.setAttributeNS(t,a,""+i)}}function Ua(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function $u(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Bp(e,t,a){var i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var c=i.get,u=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return c.call(this)},set:function(m){a=""+m,u.call(this,m)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return a},setValue:function(m){a=""+m},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Xl(e){if(!e._valueTracker){var t=$u(e)?"checked":"value";e._valueTracker=Bp(e,t,""+e[t])}}function Iu(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var a=t.getValue(),i="";return e&&(i=$u(e)?e.checked?"true":"false":e.value),e=i,e!==a?(t.setValue(e),!0):!1}function Oi(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var Hp=/[\n"\\]/g;function La(e){return e.replace(Hp,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function Wl(e,t,a,i,c,u,m,y){e.name="",m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"?e.type=m:e.removeAttribute("type"),t!=null?m==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+Ua(t)):e.value!==""+Ua(t)&&(e.value=""+Ua(t)):m!=="submit"&&m!=="reset"||e.removeAttribute("value"),t!=null?Fl(e,m,Ua(t)):a!=null?Fl(e,m,Ua(a)):i!=null&&e.removeAttribute("value"),c==null&&u!=null&&(e.defaultChecked=!!u),c!=null&&(e.checked=c&&typeof c!="function"&&typeof c!="symbol"),y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"?e.name=""+Ua(y):e.removeAttribute("name")}function qu(e,t,a,i,c,u,m,y){if(u!=null&&typeof u!="function"&&typeof u!="symbol"&&typeof u!="boolean"&&(e.type=u),t!=null||a!=null){if(!(u!=="submit"&&u!=="reset"||t!=null)){Xl(e);return}a=a!=null?""+Ua(a):"",t=t!=null?""+Ua(t):a,y||t===e.value||(e.value=t),e.defaultValue=t}i=i??c,i=typeof i!="function"&&typeof i!="symbol"&&!!i,e.checked=y?e.checked:!!i,e.defaultChecked=!!i,m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(e.name=m),Xl(e)}function Fl(e,t,a){t==="number"&&Oi(e.ownerDocument)===e||e.defaultValue===""+a||(e.defaultValue=""+a)}function Cr(e,t,a,i){if(e=e.options,t){t={};for(var c=0;c<a.length;c++)t["$"+a[c]]=!0;for(a=0;a<e.length;a++)c=t.hasOwnProperty("$"+e[a].value),e[a].selected!==c&&(e[a].selected=c),c&&i&&(e[a].defaultSelected=!0)}else{for(a=""+Ua(a),t=null,c=0;c<e.length;c++){if(e[c].value===a){e[c].selected=!0,i&&(e[c].defaultSelected=!0);return}t!==null||e[c].disabled||(t=e[c])}t!==null&&(t.selected=!0)}}function Pu(e,t,a){if(t!=null&&(t=""+Ua(t),t!==e.value&&(e.value=t),a==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=a!=null?""+Ua(a):""}function Gu(e,t,a,i){if(t==null){if(i!=null){if(a!=null)throw Error(o(92));if(ye(i)){if(1<i.length)throw Error(o(93));i=i[0]}a=i}a==null&&(a=""),t=a}a=Ua(t),e.defaultValue=a,i=e.textContent,i===a&&i!==""&&i!==null&&(e.value=i),Xl(e)}function Rr(e,t){if(t){var a=e.firstChild;if(a&&a===e.lastChild&&a.nodeType===3){a.nodeValue=t;return}}e.textContent=t}var $p=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Yu(e,t,a){var i=t.indexOf("--")===0;a==null||typeof a=="boolean"||a===""?i?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":i?e.setProperty(t,a):typeof a!="number"||a===0||$p.has(t)?t==="float"?e.cssFloat=a:e[t]=(""+a).trim():e[t]=a+"px"}function Ku(e,t,a){if(t!=null&&typeof t!="object")throw Error(o(62));if(e=e.style,a!=null){for(var i in a)!a.hasOwnProperty(i)||t!=null&&t.hasOwnProperty(i)||(i.indexOf("--")===0?e.setProperty(i,""):i==="float"?e.cssFloat="":e[i]="");for(var c in t)i=t[c],t.hasOwnProperty(c)&&a[c]!==i&&Yu(e,c,i)}else for(var u in t)t.hasOwnProperty(u)&&Yu(e,u,t[u])}function eo(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ip=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),qp=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ci(e){return qp.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function hs(){}var to=null;function ao(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var zr=null,Mr=null;function Vu(e){var t=Ct(e);if(t&&(e=t.stateNode)){var a=e[Ke]||null;e:switch(e=t.stateNode,t.type){case"input":if(Wl(e,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),t=a.name,a.type==="radio"&&t!=null){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+La(""+t)+'"][type="radio"]'),t=0;t<a.length;t++){var i=a[t];if(i!==e&&i.form===e.form){var c=i[Ke]||null;if(!c)throw Error(o(90));Wl(i,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name)}}for(t=0;t<a.length;t++)i=a[t],i.form===e.form&&Iu(i)}break e;case"textarea":Pu(e,a.value,a.defaultValue);break e;case"select":t=a.value,t!=null&&Cr(e,!!a.multiple,t,!1)}}}var so=!1;function Qu(e,t,a){if(so)return e(t,a);so=!0;try{var i=e(t);return i}finally{if(so=!1,(zr!==null||Mr!==null)&&(xl(),zr&&(t=zr,e=Mr,Mr=zr=null,Vu(t),e)))for(t=0;t<e.length;t++)Vu(e[t])}}function Nn(e,t){var a=e.stateNode;if(a===null)return null;var i=a[Ke]||null;if(i===null)return null;a=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(a&&typeof a!="function")throw Error(o(231,t,typeof a));return a}var fs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ro=!1;if(fs)try{var Sn={};Object.defineProperty(Sn,"passive",{get:function(){ro=!0}}),window.addEventListener("test",Sn,Sn),window.removeEventListener("test",Sn,Sn)}catch{ro=!1}var zs=null,no=null,Ri=null;function Zu(){if(Ri)return Ri;var e,t=no,a=t.length,i,c="value"in zs?zs.value:zs.textContent,u=c.length;for(e=0;e<a&&t[e]===c[e];e++);var m=a-e;for(i=1;i<=m&&t[a-i]===c[u-i];i++);return Ri=c.slice(e,1<i?1-i:void 0)}function zi(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Mi(){return!0}function Ju(){return!1}function ga(e){function t(a,i,c,u,m){this._reactName=a,this._targetInst=c,this.type=i,this.nativeEvent=u,this.target=m,this.currentTarget=null;for(var y in e)e.hasOwnProperty(y)&&(a=e[y],this[y]=a?a(u):u[y]);return this.isDefaultPrevented=(u.defaultPrevented!=null?u.defaultPrevented:u.returnValue===!1)?Mi:Ju,this.isPropagationStopped=Ju,this}return x(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=Mi)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=Mi)},persist:function(){},isPersistent:Mi}),t}var ir={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Di=ga(ir),En=x({},ir,{view:0,detail:0}),Pp=ga(En),io,lo,Tn,Ui=x({},En,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:co,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Tn&&(Tn&&e.type==="mousemove"?(io=e.screenX-Tn.screenX,lo=e.screenY-Tn.screenY):lo=io=0,Tn=e),io)},movementY:function(e){return"movementY"in e?e.movementY:lo}}),Xu=ga(Ui),Gp=x({},Ui,{dataTransfer:0}),Yp=ga(Gp),Kp=x({},En,{relatedTarget:0}),oo=ga(Kp),Vp=x({},ir,{animationName:0,elapsedTime:0,pseudoElement:0}),Qp=ga(Vp),Zp=x({},ir,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Jp=ga(Zp),Xp=x({},ir,{data:0}),Wu=ga(Xp),Wp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Fp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},eg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function tg(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=eg[e])?!!t[e]:!1}function co(){return tg}var ag=x({},En,{key:function(e){if(e.key){var t=Wp[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=zi(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Fp[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:co,charCode:function(e){return e.type==="keypress"?zi(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?zi(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),sg=ga(ag),rg=x({},Ui,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fu=ga(rg),ng=x({},En,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:co}),ig=ga(ng),lg=x({},ir,{propertyName:0,elapsedTime:0,pseudoElement:0}),og=ga(lg),cg=x({},Ui,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),ug=ga(cg),dg=x({},ir,{newState:0,oldState:0}),hg=ga(dg),fg=[9,13,27,32],uo=fs&&"CompositionEvent"in window,kn=null;fs&&"documentMode"in document&&(kn=document.documentMode);var mg=fs&&"TextEvent"in window&&!kn,ed=fs&&(!uo||kn&&8<kn&&11>=kn),td=" ",ad=!1;function sd(e,t){switch(e){case"keyup":return fg.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rd(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Dr=!1;function pg(e,t){switch(e){case"compositionend":return rd(t);case"keypress":return t.which!==32?null:(ad=!0,td);case"textInput":return e=t.data,e===td&&ad?null:e;default:return null}}function gg(e,t){if(Dr)return e==="compositionend"||!uo&&sd(e,t)?(e=Zu(),Ri=no=zs=null,Dr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return ed&&t.locale!=="ko"?null:t.data;default:return null}}var bg={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function nd(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!bg[e.type]:t==="textarea"}function id(e,t,a,i){zr?Mr?Mr.push(i):Mr=[i]:zr=i,t=Sl(t,"onChange"),0<t.length&&(a=new Di("onChange","change",null,a,i),e.push({event:a,listeners:t}))}var An=null,On=null;function xg(e){Pf(e,0)}function Li(e){var t=Qa(e);if(Iu(t))return e}function ld(e,t){if(e==="change")return t}var od=!1;if(fs){var ho;if(fs){var fo="oninput"in document;if(!fo){var cd=document.createElement("div");cd.setAttribute("oninput","return;"),fo=typeof cd.oninput=="function"}ho=fo}else ho=!1;od=ho&&(!document.documentMode||9<document.documentMode)}function ud(){An&&(An.detachEvent("onpropertychange",dd),On=An=null)}function dd(e){if(e.propertyName==="value"&&Li(On)){var t=[];id(t,On,e,ao(e)),Qu(xg,t)}}function yg(e,t,a){e==="focusin"?(ud(),An=t,On=a,An.attachEvent("onpropertychange",dd)):e==="focusout"&&ud()}function vg(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Li(On)}function wg(e,t){if(e==="click")return Li(t)}function jg(e,t){if(e==="input"||e==="change")return Li(t)}function _g(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Na=typeof Object.is=="function"?Object.is:_g;function Cn(e,t){if(Na(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var a=Object.keys(e),i=Object.keys(t);if(a.length!==i.length)return!1;for(i=0;i<a.length;i++){var c=a[i];if(!it.call(t,c)||!Na(e[c],t[c]))return!1}return!0}function hd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function fd(e,t){var a=hd(e);e=0;for(var i;a;){if(a.nodeType===3){if(i=e+a.textContent.length,e<=t&&i>=t)return{node:a,offset:t-e};e=i}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=hd(a)}}function md(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?md(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function pd(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=Oi(e.document);t instanceof e.HTMLIFrameElement;){try{var a=typeof t.contentWindow.location.href=="string"}catch{a=!1}if(a)e=t.contentWindow;else break;t=Oi(e.document)}return t}function mo(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var Ng=fs&&"documentMode"in document&&11>=document.documentMode,Ur=null,po=null,Rn=null,go=!1;function gd(e,t,a){var i=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;go||Ur==null||Ur!==Oi(i)||(i=Ur,"selectionStart"in i&&mo(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Rn&&Cn(Rn,i)||(Rn=i,i=Sl(po,"onSelect"),0<i.length&&(t=new Di("onSelect","select",null,t,a),e.push({event:t,listeners:i}),t.target=Ur)))}function lr(e,t){var a={};return a[e.toLowerCase()]=t.toLowerCase(),a["Webkit"+e]="webkit"+t,a["Moz"+e]="moz"+t,a}var Lr={animationend:lr("Animation","AnimationEnd"),animationiteration:lr("Animation","AnimationIteration"),animationstart:lr("Animation","AnimationStart"),transitionrun:lr("Transition","TransitionRun"),transitionstart:lr("Transition","TransitionStart"),transitioncancel:lr("Transition","TransitionCancel"),transitionend:lr("Transition","TransitionEnd")},bo={},bd={};fs&&(bd=document.createElement("div").style,"AnimationEvent"in window||(delete Lr.animationend.animation,delete Lr.animationiteration.animation,delete Lr.animationstart.animation),"TransitionEvent"in window||delete Lr.transitionend.transition);function or(e){if(bo[e])return bo[e];if(!Lr[e])return e;var t=Lr[e],a;for(a in t)if(t.hasOwnProperty(a)&&a in bd)return bo[e]=t[a];return e}var xd=or("animationend"),yd=or("animationiteration"),vd=or("animationstart"),Sg=or("transitionrun"),Eg=or("transitionstart"),Tg=or("transitioncancel"),wd=or("transitionend"),jd=new Map,xo="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");xo.push("scrollEnd");function Za(e,t){jd.set(e,t),Xt(t,[e])}var Bi=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},Ba=[],Br=0,yo=0;function Hi(){for(var e=Br,t=yo=Br=0;t<e;){var a=Ba[t];Ba[t++]=null;var i=Ba[t];Ba[t++]=null;var c=Ba[t];Ba[t++]=null;var u=Ba[t];if(Ba[t++]=null,i!==null&&c!==null){var m=i.pending;m===null?c.next=c:(c.next=m.next,m.next=c),i.pending=c}u!==0&&_d(a,c,u)}}function $i(e,t,a,i){Ba[Br++]=e,Ba[Br++]=t,Ba[Br++]=a,Ba[Br++]=i,yo|=i,e.lanes|=i,e=e.alternate,e!==null&&(e.lanes|=i)}function vo(e,t,a,i){return $i(e,t,a,i),Ii(e)}function cr(e,t){return $i(e,null,null,t),Ii(e)}function _d(e,t,a){e.lanes|=a;var i=e.alternate;i!==null&&(i.lanes|=a);for(var c=!1,u=e.return;u!==null;)u.childLanes|=a,i=u.alternate,i!==null&&(i.childLanes|=a),u.tag===22&&(e=u.stateNode,e===null||e._visibility&1||(c=!0)),e=u,u=u.return;return e.tag===3?(u=e.stateNode,c&&t!==null&&(c=31-te(a),e=u.hiddenUpdates,i=e[c],i===null?e[c]=[t]:i.push(t),t.lane=a|536870912),u):null}function Ii(e){if(50<ei)throw ei=0,Ac=null,Error(o(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var Hr={};function kg(e,t,a,i){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Sa(e,t,a,i){return new kg(e,t,a,i)}function wo(e){return e=e.prototype,!(!e||!e.isReactComponent)}function ms(e,t){var a=e.alternate;return a===null?(a=Sa(e.tag,t,e.key,e.mode),a.elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=t,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=e.flags&65011712,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,t=e.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a.refCleanup=e.refCleanup,a}function Nd(e,t){e.flags&=65011714;var a=e.alternate;return a===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=a.childLanes,e.lanes=a.lanes,e.child=a.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=a.memoizedProps,e.memoizedState=a.memoizedState,e.updateQueue=a.updateQueue,e.type=a.type,t=a.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function qi(e,t,a,i,c,u){var m=0;if(i=e,typeof e=="function")wo(e)&&(m=1);else if(typeof e=="string")m=z0(e,a,be.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case we:return e=Sa(31,a,t,c),e.elementType=we,e.lanes=u,e;case z:return ur(a.children,c,u,t);case M:m=8,c|=24;break;case E:return e=Sa(12,a,t,c|2),e.elementType=E,e.lanes=u,e;case he:return e=Sa(13,a,t,c),e.elementType=he,e.lanes=u,e;case Z:return e=Sa(19,a,t,c),e.elementType=Z,e.lanes=u,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case _:m=10;break e;case O:m=9;break e;case G:m=11;break e;case ie:m=14;break e;case ge:m=16,i=null;break e}m=29,a=Error(o(130,e===null?"null":typeof e,"")),i=null}return t=Sa(m,a,t,c),t.elementType=e,t.type=i,t.lanes=u,t}function ur(e,t,a,i){return e=Sa(7,e,i,t),e.lanes=a,e}function jo(e,t,a){return e=Sa(6,e,null,t),e.lanes=a,e}function Sd(e){var t=Sa(18,null,null,0);return t.stateNode=e,t}function _o(e,t,a){return t=Sa(4,e.children!==null?e.children:[],e.key,t),t.lanes=a,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Ed=new WeakMap;function Ha(e,t){if(typeof e=="object"&&e!==null){var a=Ed.get(e);return a!==void 0?a:(t={value:e,source:t,stack:Ht(t)},Ed.set(e,t),t)}return{value:e,source:t,stack:Ht(t)}}var $r=[],Ir=0,Pi=null,zn=0,$a=[],Ia=0,Ms=null,rs=1,ns="";function ps(e,t){$r[Ir++]=zn,$r[Ir++]=Pi,Pi=e,zn=t}function Td(e,t,a){$a[Ia++]=rs,$a[Ia++]=ns,$a[Ia++]=Ms,Ms=e;var i=rs;e=ns;var c=32-te(i)-1;i&=~(1<<c),a+=1;var u=32-te(t)+c;if(30<u){var m=c-c%5;u=(i&(1<<m)-1).toString(32),i>>=m,c-=m,rs=1<<32-te(t)+c|a<<c|i,ns=u+e}else rs=1<<u|a<<c|i,ns=e}function No(e){e.return!==null&&(ps(e,1),Td(e,1,0))}function So(e){for(;e===Pi;)Pi=$r[--Ir],$r[Ir]=null,zn=$r[--Ir],$r[Ir]=null;for(;e===Ms;)Ms=$a[--Ia],$a[Ia]=null,ns=$a[--Ia],$a[Ia]=null,rs=$a[--Ia],$a[Ia]=null}function kd(e,t){$a[Ia++]=rs,$a[Ia++]=ns,$a[Ia++]=Ms,rs=t.id,ns=t.overflow,Ms=e}var ta=null,Tt=null,nt=!1,Ds=null,qa=!1,Eo=Error(o(519));function Us(e){var t=Error(o(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Mn(Ha(t,e)),Eo}function Ad(e){var t=e.stateNode,a=e.type,i=e.memoizedProps;switch(t[et]=e,t[Ke]=i,a){case"dialog":at("cancel",t),at("close",t);break;case"iframe":case"object":case"embed":at("load",t);break;case"video":case"audio":for(a=0;a<ai.length;a++)at(ai[a],t);break;case"source":at("error",t);break;case"img":case"image":case"link":at("error",t),at("load",t);break;case"details":at("toggle",t);break;case"input":at("invalid",t),qu(t,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0);break;case"select":at("invalid",t);break;case"textarea":at("invalid",t),Gu(t,i.value,i.defaultValue,i.children)}a=i.children,typeof a!="string"&&typeof a!="number"&&typeof a!="bigint"||t.textContent===""+a||i.suppressHydrationWarning===!0||Vf(t.textContent,a)?(i.popover!=null&&(at("beforetoggle",t),at("toggle",t)),i.onScroll!=null&&at("scroll",t),i.onScrollEnd!=null&&at("scrollend",t),i.onClick!=null&&(t.onclick=hs),t=!0):t=!1,t||Us(e,!0)}function Od(e){for(ta=e.return;ta;)switch(ta.tag){case 5:case 31:case 13:qa=!1;return;case 27:case 3:qa=!0;return;default:ta=ta.return}}function qr(e){if(e!==ta)return!1;if(!nt)return Od(e),nt=!0,!1;var t=e.tag,a;if((a=t!==3&&t!==27)&&((a=t===5)&&(a=e.type,a=!(a!=="form"&&a!=="button")||Gc(e.type,e.memoizedProps)),a=!a),a&&Tt&&Us(e),Od(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(o(317));Tt=am(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(o(317));Tt=am(e)}else t===27?(t=Tt,Js(e.type)?(e=Zc,Zc=null,Tt=e):Tt=t):Tt=ta?Ga(e.stateNode.nextSibling):null;return!0}function dr(){Tt=ta=null,nt=!1}function To(){var e=Ds;return e!==null&&(va===null?va=e:va.push.apply(va,e),Ds=null),e}function Mn(e){Ds===null?Ds=[e]:Ds.push(e)}var ko=A(null),hr=null,gs=null;function Ls(e,t,a){fe(ko,t._currentValue),t._currentValue=a}function bs(e){e._currentValue=ko.current,Q(ko)}function Ao(e,t,a){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===a)break;e=e.return}}function Oo(e,t,a,i){var c=e.child;for(c!==null&&(c.return=e);c!==null;){var u=c.dependencies;if(u!==null){var m=c.child;u=u.firstContext;e:for(;u!==null;){var y=u;u=c;for(var T=0;T<t.length;T++)if(y.context===t[T]){u.lanes|=a,y=u.alternate,y!==null&&(y.lanes|=a),Ao(u.return,a,e),i||(m=null);break e}u=y.next}}else if(c.tag===18){if(m=c.return,m===null)throw Error(o(341));m.lanes|=a,u=m.alternate,u!==null&&(u.lanes|=a),Ao(m,a,e),m=null}else m=c.child;if(m!==null)m.return=c;else for(m=c;m!==null;){if(m===e){m=null;break}if(c=m.sibling,c!==null){c.return=m.return,m=c;break}m=m.return}c=m}}function Pr(e,t,a,i){e=null;for(var c=t,u=!1;c!==null;){if(!u){if((c.flags&524288)!==0)u=!0;else if((c.flags&262144)!==0)break}if(c.tag===10){var m=c.alternate;if(m===null)throw Error(o(387));if(m=m.memoizedProps,m!==null){var y=c.type;Na(c.pendingProps.value,m.value)||(e!==null?e.push(y):e=[y])}}else if(c===Xe.current){if(m=c.alternate,m===null)throw Error(o(387));m.memoizedState.memoizedState!==c.memoizedState.memoizedState&&(e!==null?e.push(li):e=[li])}c=c.return}e!==null&&Oo(t,e,a,i),t.flags|=262144}function Gi(e){for(e=e.firstContext;e!==null;){if(!Na(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function fr(e){hr=e,gs=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function aa(e){return Cd(hr,e)}function Yi(e,t){return hr===null&&fr(e),Cd(e,t)}function Cd(e,t){var a=t._currentValue;if(t={context:t,memoizedValue:a,next:null},gs===null){if(e===null)throw Error(o(308));gs=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else gs=gs.next=t;return a}var Ag=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(a,i){e.push(i)}};this.abort=function(){t.aborted=!0,e.forEach(function(a){return a()})}},Og=l.unstable_scheduleCallback,Cg=l.unstable_NormalPriority,Gt={$$typeof:_,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Co(){return{controller:new Ag,data:new Map,refCount:0}}function Dn(e){e.refCount--,e.refCount===0&&Og(Cg,function(){e.controller.abort()})}var Un=null,Ro=0,Gr=0,Yr=null;function Rg(e,t){if(Un===null){var a=Un=[];Ro=0,Gr=Dc(),Yr={status:"pending",value:void 0,then:function(i){a.push(i)}}}return Ro++,t.then(Rd,Rd),t}function Rd(){if(--Ro===0&&Un!==null){Yr!==null&&(Yr.status="fulfilled");var e=Un;Un=null,Gr=0,Yr=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function zg(e,t){var a=[],i={status:"pending",value:null,reason:null,then:function(c){a.push(c)}};return e.then(function(){i.status="fulfilled",i.value=t;for(var c=0;c<a.length;c++)(0,a[c])(t)},function(c){for(i.status="rejected",i.reason=c,c=0;c<a.length;c++)(0,a[c])(void 0)}),i}var zd=S.S;S.S=function(e,t){bf=Zt(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&Rg(e,t),zd!==null&&zd(e,t)};var mr=A(null);function zo(){var e=mr.current;return e!==null?e:jt.pooledCache}function Ki(e,t){t===null?fe(mr,mr.current):fe(mr,t.pool)}function Md(){var e=zo();return e===null?null:{parent:Gt._currentValue,pool:e}}var Kr=Error(o(460)),Mo=Error(o(474)),Vi=Error(o(542)),Qi={then:function(){}};function Dd(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Ud(e,t,a){switch(a=e[a],a===void 0?e.push(t):a!==t&&(t.then(hs,hs),t=a),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Bd(e),e;default:if(typeof t.status=="string")t.then(hs,hs);else{if(e=jt,e!==null&&100<e.shellSuspendCounter)throw Error(o(482));e=t,e.status="pending",e.then(function(i){if(t.status==="pending"){var c=t;c.status="fulfilled",c.value=i}},function(i){if(t.status==="pending"){var c=t;c.status="rejected",c.reason=i}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Bd(e),e}throw gr=t,Kr}}function pr(e){try{var t=e._init;return t(e._payload)}catch(a){throw a!==null&&typeof a=="object"&&typeof a.then=="function"?(gr=a,Kr):a}}var gr=null;function Ld(){if(gr===null)throw Error(o(459));var e=gr;return gr=null,e}function Bd(e){if(e===Kr||e===Vi)throw Error(o(483))}var Vr=null,Ln=0;function Zi(e){var t=Ln;return Ln+=1,Vr===null&&(Vr=[]),Ud(Vr,e,t)}function Bn(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function Ji(e,t){throw t.$$typeof===N?Error(o(525)):(e=Object.prototype.toString.call(t),Error(o(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function Hd(e){function t(L,R){if(e){var H=L.deletions;H===null?(L.deletions=[R],L.flags|=16):H.push(R)}}function a(L,R){if(!e)return null;for(;R!==null;)t(L,R),R=R.sibling;return null}function i(L){for(var R=new Map;L!==null;)L.key!==null?R.set(L.key,L):R.set(L.index,L),L=L.sibling;return R}function c(L,R){return L=ms(L,R),L.index=0,L.sibling=null,L}function u(L,R,H){return L.index=H,e?(H=L.alternate,H!==null?(H=H.index,H<R?(L.flags|=67108866,R):H):(L.flags|=67108866,R)):(L.flags|=1048576,R)}function m(L){return e&&L.alternate===null&&(L.flags|=67108866),L}function y(L,R,H,ae){return R===null||R.tag!==6?(R=jo(H,L.mode,ae),R.return=L,R):(R=c(R,H),R.return=L,R)}function T(L,R,H,ae){var Oe=H.type;return Oe===z?J(L,R,H.props.children,ae,H.key):R!==null&&(R.elementType===Oe||typeof Oe=="object"&&Oe!==null&&Oe.$$typeof===ge&&pr(Oe)===R.type)?(R=c(R,H.props),Bn(R,H),R.return=L,R):(R=qi(H.type,H.key,H.props,null,L.mode,ae),Bn(R,H),R.return=L,R)}function I(L,R,H,ae){return R===null||R.tag!==4||R.stateNode.containerInfo!==H.containerInfo||R.stateNode.implementation!==H.implementation?(R=_o(H,L.mode,ae),R.return=L,R):(R=c(R,H.children||[]),R.return=L,R)}function J(L,R,H,ae,Oe){return R===null||R.tag!==7?(R=ur(H,L.mode,ae,Oe),R.return=L,R):(R=c(R,H),R.return=L,R)}function se(L,R,H){if(typeof R=="string"&&R!==""||typeof R=="number"||typeof R=="bigint")return R=jo(""+R,L.mode,H),R.return=L,R;if(typeof R=="object"&&R!==null){switch(R.$$typeof){case j:return H=qi(R.type,R.key,R.props,null,L.mode,H),Bn(H,R),H.return=L,H;case C:return R=_o(R,L.mode,H),R.return=L,R;case ge:return R=pr(R),se(L,R,H)}if(ye(R)||Ce(R))return R=ur(R,L.mode,H,null),R.return=L,R;if(typeof R.then=="function")return se(L,Zi(R),H);if(R.$$typeof===_)return se(L,Yi(L,R),H);Ji(L,R)}return null}function P(L,R,H,ae){var Oe=R!==null?R.key:null;if(typeof H=="string"&&H!==""||typeof H=="number"||typeof H=="bigint")return Oe!==null?null:y(L,R,""+H,ae);if(typeof H=="object"&&H!==null){switch(H.$$typeof){case j:return H.key===Oe?T(L,R,H,ae):null;case C:return H.key===Oe?I(L,R,H,ae):null;case ge:return H=pr(H),P(L,R,H,ae)}if(ye(H)||Ce(H))return Oe!==null?null:J(L,R,H,ae,null);if(typeof H.then=="function")return P(L,R,Zi(H),ae);if(H.$$typeof===_)return P(L,R,Yi(L,H),ae);Ji(L,H)}return null}function Y(L,R,H,ae,Oe){if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return L=L.get(H)||null,y(R,L,""+ae,Oe);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case j:return L=L.get(ae.key===null?H:ae.key)||null,T(R,L,ae,Oe);case C:return L=L.get(ae.key===null?H:ae.key)||null,I(R,L,ae,Oe);case ge:return ae=pr(ae),Y(L,R,H,ae,Oe)}if(ye(ae)||Ce(ae))return L=L.get(H)||null,J(R,L,ae,Oe,null);if(typeof ae.then=="function")return Y(L,R,H,Zi(ae),Oe);if(ae.$$typeof===_)return Y(L,R,H,Yi(R,ae),Oe);Ji(R,ae)}return null}function _e(L,R,H,ae){for(var Oe=null,ot=null,Ee=R,Ve=R=0,rt=null;Ee!==null&&Ve<H.length;Ve++){Ee.index>Ve?(rt=Ee,Ee=null):rt=Ee.sibling;var ct=P(L,Ee,H[Ve],ae);if(ct===null){Ee===null&&(Ee=rt);break}e&&Ee&&ct.alternate===null&&t(L,Ee),R=u(ct,R,Ve),ot===null?Oe=ct:ot.sibling=ct,ot=ct,Ee=rt}if(Ve===H.length)return a(L,Ee),nt&&ps(L,Ve),Oe;if(Ee===null){for(;Ve<H.length;Ve++)Ee=se(L,H[Ve],ae),Ee!==null&&(R=u(Ee,R,Ve),ot===null?Oe=Ee:ot.sibling=Ee,ot=Ee);return nt&&ps(L,Ve),Oe}for(Ee=i(Ee);Ve<H.length;Ve++)rt=Y(Ee,L,Ve,H[Ve],ae),rt!==null&&(e&&rt.alternate!==null&&Ee.delete(rt.key===null?Ve:rt.key),R=u(rt,R,Ve),ot===null?Oe=rt:ot.sibling=rt,ot=rt);return e&&Ee.forEach(function(tr){return t(L,tr)}),nt&&ps(L,Ve),Oe}function ze(L,R,H,ae){if(H==null)throw Error(o(151));for(var Oe=null,ot=null,Ee=R,Ve=R=0,rt=null,ct=H.next();Ee!==null&&!ct.done;Ve++,ct=H.next()){Ee.index>Ve?(rt=Ee,Ee=null):rt=Ee.sibling;var tr=P(L,Ee,ct.value,ae);if(tr===null){Ee===null&&(Ee=rt);break}e&&Ee&&tr.alternate===null&&t(L,Ee),R=u(tr,R,Ve),ot===null?Oe=tr:ot.sibling=tr,ot=tr,Ee=rt}if(ct.done)return a(L,Ee),nt&&ps(L,Ve),Oe;if(Ee===null){for(;!ct.done;Ve++,ct=H.next())ct=se(L,ct.value,ae),ct!==null&&(R=u(ct,R,Ve),ot===null?Oe=ct:ot.sibling=ct,ot=ct);return nt&&ps(L,Ve),Oe}for(Ee=i(Ee);!ct.done;Ve++,ct=H.next())ct=Y(Ee,L,Ve,ct.value,ae),ct!==null&&(e&&ct.alternate!==null&&Ee.delete(ct.key===null?Ve:ct.key),R=u(ct,R,Ve),ot===null?Oe=ct:ot.sibling=ct,ot=ct);return e&&Ee.forEach(function(G0){return t(L,G0)}),nt&&ps(L,Ve),Oe}function vt(L,R,H,ae){if(typeof H=="object"&&H!==null&&H.type===z&&H.key===null&&(H=H.props.children),typeof H=="object"&&H!==null){switch(H.$$typeof){case j:e:{for(var Oe=H.key;R!==null;){if(R.key===Oe){if(Oe=H.type,Oe===z){if(R.tag===7){a(L,R.sibling),ae=c(R,H.props.children),ae.return=L,L=ae;break e}}else if(R.elementType===Oe||typeof Oe=="object"&&Oe!==null&&Oe.$$typeof===ge&&pr(Oe)===R.type){a(L,R.sibling),ae=c(R,H.props),Bn(ae,H),ae.return=L,L=ae;break e}a(L,R);break}else t(L,R);R=R.sibling}H.type===z?(ae=ur(H.props.children,L.mode,ae,H.key),ae.return=L,L=ae):(ae=qi(H.type,H.key,H.props,null,L.mode,ae),Bn(ae,H),ae.return=L,L=ae)}return m(L);case C:e:{for(Oe=H.key;R!==null;){if(R.key===Oe)if(R.tag===4&&R.stateNode.containerInfo===H.containerInfo&&R.stateNode.implementation===H.implementation){a(L,R.sibling),ae=c(R,H.children||[]),ae.return=L,L=ae;break e}else{a(L,R);break}else t(L,R);R=R.sibling}ae=_o(H,L.mode,ae),ae.return=L,L=ae}return m(L);case ge:return H=pr(H),vt(L,R,H,ae)}if(ye(H))return _e(L,R,H,ae);if(Ce(H)){if(Oe=Ce(H),typeof Oe!="function")throw Error(o(150));return H=Oe.call(H),ze(L,R,H,ae)}if(typeof H.then=="function")return vt(L,R,Zi(H),ae);if(H.$$typeof===_)return vt(L,R,Yi(L,H),ae);Ji(L,H)}return typeof H=="string"&&H!==""||typeof H=="number"||typeof H=="bigint"?(H=""+H,R!==null&&R.tag===6?(a(L,R.sibling),ae=c(R,H),ae.return=L,L=ae):(a(L,R),ae=jo(H,L.mode,ae),ae.return=L,L=ae),m(L)):a(L,R)}return function(L,R,H,ae){try{Ln=0;var Oe=vt(L,R,H,ae);return Vr=null,Oe}catch(Ee){if(Ee===Kr||Ee===Vi)throw Ee;var ot=Sa(29,Ee,null,L.mode);return ot.lanes=ae,ot.return=L,ot}finally{}}}var br=Hd(!0),$d=Hd(!1),Bs=!1;function Do(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Uo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Hs(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function $s(e,t,a){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,(ht&2)!==0){var c=i.pending;return c===null?t.next=t:(t.next=c.next,c.next=t),i.pending=t,t=Ii(e),_d(e,null,a),t}return $i(e,i,t,a),Ii(e)}function Hn(e,t,a){if(t=t.updateQueue,t!==null&&(t=t.shared,(a&4194048)!==0)){var i=t.lanes;i&=e.pendingLanes,a|=i,t.lanes=a,la(e,a)}}function Lo(e,t){var a=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,a===i)){var c=null,u=null;if(a=a.firstBaseUpdate,a!==null){do{var m={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};u===null?c=u=m:u=u.next=m,a=a.next}while(a!==null);u===null?c=u=t:u=u.next=t}else c=u=t;a={baseState:i.baseState,firstBaseUpdate:c,lastBaseUpdate:u,shared:i.shared,callbacks:i.callbacks},e.updateQueue=a;return}e=a.lastBaseUpdate,e===null?a.firstBaseUpdate=t:e.next=t,a.lastBaseUpdate=t}var Bo=!1;function $n(){if(Bo){var e=Yr;if(e!==null)throw e}}function In(e,t,a,i){Bo=!1;var c=e.updateQueue;Bs=!1;var u=c.firstBaseUpdate,m=c.lastBaseUpdate,y=c.shared.pending;if(y!==null){c.shared.pending=null;var T=y,I=T.next;T.next=null,m===null?u=I:m.next=I,m=T;var J=e.alternate;J!==null&&(J=J.updateQueue,y=J.lastBaseUpdate,y!==m&&(y===null?J.firstBaseUpdate=I:y.next=I,J.lastBaseUpdate=T))}if(u!==null){var se=c.baseState;m=0,J=I=T=null,y=u;do{var P=y.lane&-536870913,Y=P!==y.lane;if(Y?(st&P)===P:(i&P)===P){P!==0&&P===Gr&&(Bo=!0),J!==null&&(J=J.next={lane:0,tag:y.tag,payload:y.payload,callback:null,next:null});e:{var _e=e,ze=y;P=t;var vt=a;switch(ze.tag){case 1:if(_e=ze.payload,typeof _e=="function"){se=_e.call(vt,se,P);break e}se=_e;break e;case 3:_e.flags=_e.flags&-65537|128;case 0:if(_e=ze.payload,P=typeof _e=="function"?_e.call(vt,se,P):_e,P==null)break e;se=x({},se,P);break e;case 2:Bs=!0}}P=y.callback,P!==null&&(e.flags|=64,Y&&(e.flags|=8192),Y=c.callbacks,Y===null?c.callbacks=[P]:Y.push(P))}else Y={lane:P,tag:y.tag,payload:y.payload,callback:y.callback,next:null},J===null?(I=J=Y,T=se):J=J.next=Y,m|=P;if(y=y.next,y===null){if(y=c.shared.pending,y===null)break;Y=y,y=Y.next,Y.next=null,c.lastBaseUpdate=Y,c.shared.pending=null}}while(!0);J===null&&(T=se),c.baseState=T,c.firstBaseUpdate=I,c.lastBaseUpdate=J,u===null&&(c.shared.lanes=0),Ys|=m,e.lanes=m,e.memoizedState=se}}function Id(e,t){if(typeof e!="function")throw Error(o(191,e));e.call(t)}function qd(e,t){var a=e.callbacks;if(a!==null)for(e.callbacks=null,e=0;e<a.length;e++)Id(a[e],t)}var Qr=A(null),Xi=A(0);function Pd(e,t){e=Es,fe(Xi,e),fe(Qr,t),Es=e|t.baseLanes}function Ho(){fe(Xi,Es),fe(Qr,Qr.current)}function $o(){Es=Xi.current,Q(Qr),Q(Xi)}var Ea=A(null),Pa=null;function Is(e){var t=e.alternate;fe($t,$t.current&1),fe(Ea,e),Pa===null&&(t===null||Qr.current!==null||t.memoizedState!==null)&&(Pa=e)}function Io(e){fe($t,$t.current),fe(Ea,e),Pa===null&&(Pa=e)}function Gd(e){e.tag===22?(fe($t,$t.current),fe(Ea,e),Pa===null&&(Pa=e)):qs()}function qs(){fe($t,$t.current),fe(Ea,Ea.current)}function Ta(e){Q(Ea),Pa===e&&(Pa=null),Q($t)}var $t=A(0);function Wi(e){for(var t=e;t!==null;){if(t.tag===13){var a=t.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||Vc(a)||Qc(a)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var xs=0,Pe=null,xt=null,Yt=null,Fi=!1,Zr=!1,xr=!1,el=0,qn=0,Jr=null,Mg=0;function Ut(){throw Error(o(321))}function qo(e,t){if(t===null)return!1;for(var a=0;a<t.length&&a<e.length;a++)if(!Na(e[a],t[a]))return!1;return!0}function Po(e,t,a,i,c,u){return xs=u,Pe=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,S.H=e===null||e.memoizedState===null?Th:rc,xr=!1,u=a(i,c),xr=!1,Zr&&(u=Kd(t,a,i,c)),Yd(e),u}function Yd(e){S.H=Yn;var t=xt!==null&&xt.next!==null;if(xs=0,Yt=xt=Pe=null,Fi=!1,qn=0,Jr=null,t)throw Error(o(300));e===null||Kt||(e=e.dependencies,e!==null&&Gi(e)&&(Kt=!0))}function Kd(e,t,a,i){Pe=e;var c=0;do{if(Zr&&(Jr=null),qn=0,Zr=!1,25<=c)throw Error(o(301));if(c+=1,Yt=xt=null,e.updateQueue!=null){var u=e.updateQueue;u.lastEffect=null,u.events=null,u.stores=null,u.memoCache!=null&&(u.memoCache.index=0)}S.H=kh,u=t(a,i)}while(Zr);return u}function Dg(){var e=S.H,t=e.useState()[0];return t=typeof t.then=="function"?Pn(t):t,e=e.useState()[0],(xt!==null?xt.memoizedState:null)!==e&&(Pe.flags|=1024),t}function Go(){var e=el!==0;return el=0,e}function Yo(e,t,a){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a}function Ko(e){if(Fi){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}Fi=!1}xs=0,Yt=xt=Pe=null,Zr=!1,qn=el=0,Jr=null}function da(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yt===null?Pe.memoizedState=Yt=e:Yt=Yt.next=e,Yt}function It(){if(xt===null){var e=Pe.alternate;e=e!==null?e.memoizedState:null}else e=xt.next;var t=Yt===null?Pe.memoizedState:Yt.next;if(t!==null)Yt=t,xt=e;else{if(e===null)throw Pe.alternate===null?Error(o(467)):Error(o(310));xt=e,e={memoizedState:xt.memoizedState,baseState:xt.baseState,baseQueue:xt.baseQueue,queue:xt.queue,next:null},Yt===null?Pe.memoizedState=Yt=e:Yt=Yt.next=e}return Yt}function tl(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Pn(e){var t=qn;return qn+=1,Jr===null&&(Jr=[]),e=Ud(Jr,e,t),t=Pe,(Yt===null?t.memoizedState:Yt.next)===null&&(t=t.alternate,S.H=t===null||t.memoizedState===null?Th:rc),e}function al(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Pn(e);if(e.$$typeof===_)return aa(e)}throw Error(o(438,String(e)))}function Vo(e){var t=null,a=Pe.updateQueue;if(a!==null&&(t=a.memoCache),t==null){var i=Pe.alternate;i!==null&&(i=i.updateQueue,i!==null&&(i=i.memoCache,i!=null&&(t={data:i.data.map(function(c){return c.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),a===null&&(a=tl(),Pe.updateQueue=a),a.memoCache=t,a=t.data[t.index],a===void 0)for(a=t.data[t.index]=Array(e),i=0;i<e;i++)a[i]=je;return t.index++,a}function ys(e,t){return typeof t=="function"?t(e):t}function sl(e){var t=It();return Qo(t,xt,e)}function Qo(e,t,a){var i=e.queue;if(i===null)throw Error(o(311));i.lastRenderedReducer=a;var c=e.baseQueue,u=i.pending;if(u!==null){if(c!==null){var m=c.next;c.next=u.next,u.next=m}t.baseQueue=c=u,i.pending=null}if(u=e.baseState,c===null)e.memoizedState=u;else{t=c.next;var y=m=null,T=null,I=t,J=!1;do{var se=I.lane&-536870913;if(se!==I.lane?(st&se)===se:(xs&se)===se){var P=I.revertLane;if(P===0)T!==null&&(T=T.next={lane:0,revertLane:0,gesture:null,action:I.action,hasEagerState:I.hasEagerState,eagerState:I.eagerState,next:null}),se===Gr&&(J=!0);else if((xs&P)===P){I=I.next,P===Gr&&(J=!0);continue}else se={lane:0,revertLane:I.revertLane,gesture:null,action:I.action,hasEagerState:I.hasEagerState,eagerState:I.eagerState,next:null},T===null?(y=T=se,m=u):T=T.next=se,Pe.lanes|=P,Ys|=P;se=I.action,xr&&a(u,se),u=I.hasEagerState?I.eagerState:a(u,se)}else P={lane:se,revertLane:I.revertLane,gesture:I.gesture,action:I.action,hasEagerState:I.hasEagerState,eagerState:I.eagerState,next:null},T===null?(y=T=P,m=u):T=T.next=P,Pe.lanes|=se,Ys|=se;I=I.next}while(I!==null&&I!==t);if(T===null?m=u:T.next=y,!Na(u,e.memoizedState)&&(Kt=!0,J&&(a=Yr,a!==null)))throw a;e.memoizedState=u,e.baseState=m,e.baseQueue=T,i.lastRenderedState=u}return c===null&&(i.lanes=0),[e.memoizedState,i.dispatch]}function Zo(e){var t=It(),a=t.queue;if(a===null)throw Error(o(311));a.lastRenderedReducer=e;var i=a.dispatch,c=a.pending,u=t.memoizedState;if(c!==null){a.pending=null;var m=c=c.next;do u=e(u,m.action),m=m.next;while(m!==c);Na(u,t.memoizedState)||(Kt=!0),t.memoizedState=u,t.baseQueue===null&&(t.baseState=u),a.lastRenderedState=u}return[u,i]}function Vd(e,t,a){var i=Pe,c=It(),u=nt;if(u){if(a===void 0)throw Error(o(407));a=a()}else a=t();var m=!Na((xt||c).memoizedState,a);if(m&&(c.memoizedState=a,Kt=!0),c=c.queue,Wo(Jd.bind(null,i,c,e),[e]),c.getSnapshot!==t||m||Yt!==null&&Yt.memoizedState.tag&1){if(i.flags|=2048,Xr(9,{destroy:void 0},Zd.bind(null,i,c,a,t),null),jt===null)throw Error(o(349));u||(xs&127)!==0||Qd(i,t,a)}return a}function Qd(e,t,a){e.flags|=16384,e={getSnapshot:t,value:a},t=Pe.updateQueue,t===null?(t=tl(),Pe.updateQueue=t,t.stores=[e]):(a=t.stores,a===null?t.stores=[e]:a.push(e))}function Zd(e,t,a,i){t.value=a,t.getSnapshot=i,Xd(t)&&Wd(e)}function Jd(e,t,a){return a(function(){Xd(t)&&Wd(e)})}function Xd(e){var t=e.getSnapshot;e=e.value;try{var a=t();return!Na(e,a)}catch{return!0}}function Wd(e){var t=cr(e,2);t!==null&&wa(t,e,2)}function Jo(e){var t=da();if(typeof e=="function"){var a=e;if(e=a(),xr){U(!0);try{a()}finally{U(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ys,lastRenderedState:e},t}function Fd(e,t,a,i){return e.baseState=a,Qo(e,xt,typeof i=="function"?i:ys)}function Ug(e,t,a,i,c){if(il(e))throw Error(o(485));if(e=t.action,e!==null){var u={payload:c,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(m){u.listeners.push(m)}};S.T!==null?a(!0):u.isTransition=!1,i(u),a=t.pending,a===null?(u.next=t.pending=u,eh(t,u)):(u.next=a.next,t.pending=a.next=u)}}function eh(e,t){var a=t.action,i=t.payload,c=e.state;if(t.isTransition){var u=S.T,m={};S.T=m;try{var y=a(c,i),T=S.S;T!==null&&T(m,y),th(e,t,y)}catch(I){Xo(e,t,I)}finally{u!==null&&m.types!==null&&(u.types=m.types),S.T=u}}else try{u=a(c,i),th(e,t,u)}catch(I){Xo(e,t,I)}}function th(e,t,a){a!==null&&typeof a=="object"&&typeof a.then=="function"?a.then(function(i){ah(e,t,i)},function(i){return Xo(e,t,i)}):ah(e,t,a)}function ah(e,t,a){t.status="fulfilled",t.value=a,sh(t),e.state=a,t=e.pending,t!==null&&(a=t.next,a===t?e.pending=null:(a=a.next,t.next=a,eh(e,a)))}function Xo(e,t,a){var i=e.pending;if(e.pending=null,i!==null){i=i.next;do t.status="rejected",t.reason=a,sh(t),t=t.next;while(t!==i)}e.action=null}function sh(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function rh(e,t){return t}function nh(e,t){if(nt){var a=jt.formState;if(a!==null){e:{var i=Pe;if(nt){if(Tt){t:{for(var c=Tt,u=qa;c.nodeType!==8;){if(!u){c=null;break t}if(c=Ga(c.nextSibling),c===null){c=null;break t}}u=c.data,c=u==="F!"||u==="F"?c:null}if(c){Tt=Ga(c.nextSibling),i=c.data==="F!";break e}}Us(i)}i=!1}i&&(t=a[0])}}return a=da(),a.memoizedState=a.baseState=t,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:rh,lastRenderedState:t},a.queue=i,a=Nh.bind(null,Pe,i),i.dispatch=a,i=Jo(!1),u=sc.bind(null,Pe,!1,i.queue),i=da(),c={state:t,dispatch:null,action:e,pending:null},i.queue=c,a=Ug.bind(null,Pe,c,u,a),c.dispatch=a,i.memoizedState=e,[t,a,!1]}function ih(e){var t=It();return lh(t,xt,e)}function lh(e,t,a){if(t=Qo(e,t,rh)[0],e=sl(ys)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var i=Pn(t)}catch(m){throw m===Kr?Vi:m}else i=t;t=It();var c=t.queue,u=c.dispatch;return a!==t.memoizedState&&(Pe.flags|=2048,Xr(9,{destroy:void 0},Lg.bind(null,c,a),null)),[i,u,e]}function Lg(e,t){e.action=t}function oh(e){var t=It(),a=xt;if(a!==null)return lh(t,a,e);It(),t=t.memoizedState,a=It();var i=a.queue.dispatch;return a.memoizedState=e,[t,i,!1]}function Xr(e,t,a,i){return e={tag:e,create:a,deps:i,inst:t,next:null},t=Pe.updateQueue,t===null&&(t=tl(),Pe.updateQueue=t),a=t.lastEffect,a===null?t.lastEffect=e.next=e:(i=a.next,a.next=e,e.next=i,t.lastEffect=e),e}function ch(){return It().memoizedState}function rl(e,t,a,i){var c=da();Pe.flags|=e,c.memoizedState=Xr(1|t,{destroy:void 0},a,i===void 0?null:i)}function nl(e,t,a,i){var c=It();i=i===void 0?null:i;var u=c.memoizedState.inst;xt!==null&&i!==null&&qo(i,xt.memoizedState.deps)?c.memoizedState=Xr(t,u,a,i):(Pe.flags|=e,c.memoizedState=Xr(1|t,u,a,i))}function uh(e,t){rl(8390656,8,e,t)}function Wo(e,t){nl(2048,8,e,t)}function Bg(e){Pe.flags|=4;var t=Pe.updateQueue;if(t===null)t=tl(),Pe.updateQueue=t,t.events=[e];else{var a=t.events;a===null?t.events=[e]:a.push(e)}}function dh(e){var t=It().memoizedState;return Bg({ref:t,nextImpl:e}),function(){if((ht&2)!==0)throw Error(o(440));return t.impl.apply(void 0,arguments)}}function hh(e,t){return nl(4,2,e,t)}function fh(e,t){return nl(4,4,e,t)}function mh(e,t){if(typeof t=="function"){e=e();var a=t(e);return function(){typeof a=="function"?a():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function ph(e,t,a){a=a!=null?a.concat([e]):null,nl(4,4,mh.bind(null,t,e),a)}function Fo(){}function gh(e,t){var a=It();t=t===void 0?null:t;var i=a.memoizedState;return t!==null&&qo(t,i[1])?i[0]:(a.memoizedState=[e,t],e)}function bh(e,t){var a=It();t=t===void 0?null:t;var i=a.memoizedState;if(t!==null&&qo(t,i[1]))return i[0];if(i=e(),xr){U(!0);try{e()}finally{U(!1)}}return a.memoizedState=[i,t],i}function ec(e,t,a){return a===void 0||(xs&1073741824)!==0&&(st&261930)===0?e.memoizedState=t:(e.memoizedState=a,e=yf(),Pe.lanes|=e,Ys|=e,a)}function xh(e,t,a,i){return Na(a,t)?a:Qr.current!==null?(e=ec(e,a,i),Na(e,t)||(Kt=!0),e):(xs&42)===0||(xs&1073741824)!==0&&(st&261930)===0?(Kt=!0,e.memoizedState=a):(e=yf(),Pe.lanes|=e,Ys|=e,t)}function yh(e,t,a,i,c){var u=V.p;V.p=u!==0&&8>u?u:8;var m=S.T,y={};S.T=y,sc(e,!1,t,a);try{var T=c(),I=S.S;if(I!==null&&I(y,T),T!==null&&typeof T=="object"&&typeof T.then=="function"){var J=zg(T,i);Gn(e,t,J,Oa(e))}else Gn(e,t,i,Oa(e))}catch(se){Gn(e,t,{then:function(){},status:"rejected",reason:se},Oa())}finally{V.p=u,m!==null&&y.types!==null&&(m.types=y.types),S.T=m}}function Hg(){}function tc(e,t,a,i){if(e.tag!==5)throw Error(o(476));var c=vh(e).queue;yh(e,c,t,ne,a===null?Hg:function(){return wh(e),a(i)})}function vh(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:ne,baseState:ne,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ys,lastRenderedState:ne},next:null};var a={};return t.next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ys,lastRenderedState:a},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function wh(e){var t=vh(e);t.next===null&&(t=e.alternate.memoizedState),Gn(e,t.next.queue,{},Oa())}function ac(){return aa(li)}function jh(){return It().memoizedState}function _h(){return It().memoizedState}function $g(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var a=Oa();e=Hs(a);var i=$s(t,e,a);i!==null&&(wa(i,t,a),Hn(i,t,a)),t={cache:Co()},e.payload=t;return}t=t.return}}function Ig(e,t,a){var i=Oa();a={lane:i,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null},il(e)?Sh(t,a):(a=vo(e,t,a,i),a!==null&&(wa(a,e,i),Eh(a,t,i)))}function Nh(e,t,a){var i=Oa();Gn(e,t,a,i)}function Gn(e,t,a,i){var c={lane:i,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null};if(il(e))Sh(t,c);else{var u=e.alternate;if(e.lanes===0&&(u===null||u.lanes===0)&&(u=t.lastRenderedReducer,u!==null))try{var m=t.lastRenderedState,y=u(m,a);if(c.hasEagerState=!0,c.eagerState=y,Na(y,m))return $i(e,t,c,0),jt===null&&Hi(),!1}catch{}finally{}if(a=vo(e,t,c,i),a!==null)return wa(a,e,i),Eh(a,t,i),!0}return!1}function sc(e,t,a,i){if(i={lane:2,revertLane:Dc(),gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},il(e)){if(t)throw Error(o(479))}else t=vo(e,a,i,2),t!==null&&wa(t,e,2)}function il(e){var t=e.alternate;return e===Pe||t!==null&&t===Pe}function Sh(e,t){Zr=Fi=!0;var a=e.pending;a===null?t.next=t:(t.next=a.next,a.next=t),e.pending=t}function Eh(e,t,a){if((a&4194048)!==0){var i=t.lanes;i&=e.pendingLanes,a|=i,t.lanes=a,la(e,a)}}var Yn={readContext:aa,use:al,useCallback:Ut,useContext:Ut,useEffect:Ut,useImperativeHandle:Ut,useLayoutEffect:Ut,useInsertionEffect:Ut,useMemo:Ut,useReducer:Ut,useRef:Ut,useState:Ut,useDebugValue:Ut,useDeferredValue:Ut,useTransition:Ut,useSyncExternalStore:Ut,useId:Ut,useHostTransitionStatus:Ut,useFormState:Ut,useActionState:Ut,useOptimistic:Ut,useMemoCache:Ut,useCacheRefresh:Ut};Yn.useEffectEvent=Ut;var Th={readContext:aa,use:al,useCallback:function(e,t){return da().memoizedState=[e,t===void 0?null:t],e},useContext:aa,useEffect:uh,useImperativeHandle:function(e,t,a){a=a!=null?a.concat([e]):null,rl(4194308,4,mh.bind(null,t,e),a)},useLayoutEffect:function(e,t){return rl(4194308,4,e,t)},useInsertionEffect:function(e,t){rl(4,2,e,t)},useMemo:function(e,t){var a=da();t=t===void 0?null:t;var i=e();if(xr){U(!0);try{e()}finally{U(!1)}}return a.memoizedState=[i,t],i},useReducer:function(e,t,a){var i=da();if(a!==void 0){var c=a(t);if(xr){U(!0);try{a(t)}finally{U(!1)}}}else c=t;return i.memoizedState=i.baseState=c,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:c},i.queue=e,e=e.dispatch=Ig.bind(null,Pe,e),[i.memoizedState,e]},useRef:function(e){var t=da();return e={current:e},t.memoizedState=e},useState:function(e){e=Jo(e);var t=e.queue,a=Nh.bind(null,Pe,t);return t.dispatch=a,[e.memoizedState,a]},useDebugValue:Fo,useDeferredValue:function(e,t){var a=da();return ec(a,e,t)},useTransition:function(){var e=Jo(!1);return e=yh.bind(null,Pe,e.queue,!0,!1),da().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,a){var i=Pe,c=da();if(nt){if(a===void 0)throw Error(o(407));a=a()}else{if(a=t(),jt===null)throw Error(o(349));(st&127)!==0||Qd(i,t,a)}c.memoizedState=a;var u={value:a,getSnapshot:t};return c.queue=u,uh(Jd.bind(null,i,u,e),[e]),i.flags|=2048,Xr(9,{destroy:void 0},Zd.bind(null,i,u,a,t),null),a},useId:function(){var e=da(),t=jt.identifierPrefix;if(nt){var a=ns,i=rs;a=(i&~(1<<32-te(i)-1)).toString(32)+a,t="_"+t+"R_"+a,a=el++,0<a&&(t+="H"+a.toString(32)),t+="_"}else a=Mg++,t="_"+t+"r_"+a.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:ac,useFormState:nh,useActionState:nh,useOptimistic:function(e){var t=da();t.memoizedState=t.baseState=e;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=a,t=sc.bind(null,Pe,!0,a),a.dispatch=t,[e,t]},useMemoCache:Vo,useCacheRefresh:function(){return da().memoizedState=$g.bind(null,Pe)},useEffectEvent:function(e){var t=da(),a={impl:e};return t.memoizedState=a,function(){if((ht&2)!==0)throw Error(o(440));return a.impl.apply(void 0,arguments)}}},rc={readContext:aa,use:al,useCallback:gh,useContext:aa,useEffect:Wo,useImperativeHandle:ph,useInsertionEffect:hh,useLayoutEffect:fh,useMemo:bh,useReducer:sl,useRef:ch,useState:function(){return sl(ys)},useDebugValue:Fo,useDeferredValue:function(e,t){var a=It();return xh(a,xt.memoizedState,e,t)},useTransition:function(){var e=sl(ys)[0],t=It().memoizedState;return[typeof e=="boolean"?e:Pn(e),t]},useSyncExternalStore:Vd,useId:jh,useHostTransitionStatus:ac,useFormState:ih,useActionState:ih,useOptimistic:function(e,t){var a=It();return Fd(a,xt,e,t)},useMemoCache:Vo,useCacheRefresh:_h};rc.useEffectEvent=dh;var kh={readContext:aa,use:al,useCallback:gh,useContext:aa,useEffect:Wo,useImperativeHandle:ph,useInsertionEffect:hh,useLayoutEffect:fh,useMemo:bh,useReducer:Zo,useRef:ch,useState:function(){return Zo(ys)},useDebugValue:Fo,useDeferredValue:function(e,t){var a=It();return xt===null?ec(a,e,t):xh(a,xt.memoizedState,e,t)},useTransition:function(){var e=Zo(ys)[0],t=It().memoizedState;return[typeof e=="boolean"?e:Pn(e),t]},useSyncExternalStore:Vd,useId:jh,useHostTransitionStatus:ac,useFormState:oh,useActionState:oh,useOptimistic:function(e,t){var a=It();return xt!==null?Fd(a,xt,e,t):(a.baseState=e,[e,a.queue.dispatch])},useMemoCache:Vo,useCacheRefresh:_h};kh.useEffectEvent=dh;function nc(e,t,a,i){t=e.memoizedState,a=a(i,t),a=a==null?t:x({},t,a),e.memoizedState=a,e.lanes===0&&(e.updateQueue.baseState=a)}var ic={enqueueSetState:function(e,t,a){e=e._reactInternals;var i=Oa(),c=Hs(i);c.payload=t,a!=null&&(c.callback=a),t=$s(e,c,i),t!==null&&(wa(t,e,i),Hn(t,e,i))},enqueueReplaceState:function(e,t,a){e=e._reactInternals;var i=Oa(),c=Hs(i);c.tag=1,c.payload=t,a!=null&&(c.callback=a),t=$s(e,c,i),t!==null&&(wa(t,e,i),Hn(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var a=Oa(),i=Hs(a);i.tag=2,t!=null&&(i.callback=t),t=$s(e,i,a),t!==null&&(wa(t,e,a),Hn(t,e,a))}};function Ah(e,t,a,i,c,u,m){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,u,m):t.prototype&&t.prototype.isPureReactComponent?!Cn(a,i)||!Cn(c,u):!0}function Oh(e,t,a,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(a,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(a,i),t.state!==e&&ic.enqueueReplaceState(t,t.state,null)}function yr(e,t){var a=t;if("ref"in t){a={};for(var i in t)i!=="ref"&&(a[i]=t[i])}if(e=e.defaultProps){a===t&&(a=x({},a));for(var c in e)a[c]===void 0&&(a[c]=e[c])}return a}function Ch(e){Bi(e)}function Rh(e){console.error(e)}function zh(e){Bi(e)}function ll(e,t){try{var a=e.onUncaughtError;a(t.value,{componentStack:t.stack})}catch(i){setTimeout(function(){throw i})}}function Mh(e,t,a){try{var i=e.onCaughtError;i(a.value,{componentStack:a.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(c){setTimeout(function(){throw c})}}function lc(e,t,a){return a=Hs(a),a.tag=3,a.payload={element:null},a.callback=function(){ll(e,t)},a}function Dh(e){return e=Hs(e),e.tag=3,e}function Uh(e,t,a,i){var c=a.type.getDerivedStateFromError;if(typeof c=="function"){var u=i.value;e.payload=function(){return c(u)},e.callback=function(){Mh(t,a,i)}}var m=a.stateNode;m!==null&&typeof m.componentDidCatch=="function"&&(e.callback=function(){Mh(t,a,i),typeof c!="function"&&(Ks===null?Ks=new Set([this]):Ks.add(this));var y=i.stack;this.componentDidCatch(i.value,{componentStack:y!==null?y:""})})}function qg(e,t,a,i,c){if(a.flags|=32768,i!==null&&typeof i=="object"&&typeof i.then=="function"){if(t=a.alternate,t!==null&&Pr(t,a,c,!0),a=Ea.current,a!==null){switch(a.tag){case 31:case 13:return Pa===null?yl():a.alternate===null&&Lt===0&&(Lt=3),a.flags&=-257,a.flags|=65536,a.lanes=c,i===Qi?a.flags|=16384:(t=a.updateQueue,t===null?a.updateQueue=new Set([i]):t.add(i),Rc(e,i,c)),!1;case 22:return a.flags|=65536,i===Qi?a.flags|=16384:(t=a.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([i])},a.updateQueue=t):(a=t.retryQueue,a===null?t.retryQueue=new Set([i]):a.add(i)),Rc(e,i,c)),!1}throw Error(o(435,a.tag))}return Rc(e,i,c),yl(),!1}if(nt)return t=Ea.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=c,i!==Eo&&(e=Error(o(422),{cause:i}),Mn(Ha(e,a)))):(i!==Eo&&(t=Error(o(423),{cause:i}),Mn(Ha(t,a))),e=e.current.alternate,e.flags|=65536,c&=-c,e.lanes|=c,i=Ha(i,a),c=lc(e.stateNode,i,c),Lo(e,c),Lt!==4&&(Lt=2)),!1;var u=Error(o(520),{cause:i});if(u=Ha(u,a),Fn===null?Fn=[u]:Fn.push(u),Lt!==4&&(Lt=2),t===null)return!0;i=Ha(i,a),a=t;do{switch(a.tag){case 3:return a.flags|=65536,e=c&-c,a.lanes|=e,e=lc(a.stateNode,i,e),Lo(a,e),!1;case 1:if(t=a.type,u=a.stateNode,(a.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||u!==null&&typeof u.componentDidCatch=="function"&&(Ks===null||!Ks.has(u))))return a.flags|=65536,c&=-c,a.lanes|=c,c=Dh(c),Uh(c,e,a,i),Lo(a,c),!1}a=a.return}while(a!==null);return!1}var oc=Error(o(461)),Kt=!1;function sa(e,t,a,i){t.child=e===null?$d(t,null,a,i):br(t,e.child,a,i)}function Lh(e,t,a,i,c){a=a.render;var u=t.ref;if("ref"in i){var m={};for(var y in i)y!=="ref"&&(m[y]=i[y])}else m=i;return fr(t),i=Po(e,t,a,m,u,c),y=Go(),e!==null&&!Kt?(Yo(e,t,c),vs(e,t,c)):(nt&&y&&No(t),t.flags|=1,sa(e,t,i,c),t.child)}function Bh(e,t,a,i,c){if(e===null){var u=a.type;return typeof u=="function"&&!wo(u)&&u.defaultProps===void 0&&a.compare===null?(t.tag=15,t.type=u,Hh(e,t,u,i,c)):(e=qi(a.type,null,i,t,t.mode,c),e.ref=t.ref,e.return=t,t.child=e)}if(u=e.child,!gc(e,c)){var m=u.memoizedProps;if(a=a.compare,a=a!==null?a:Cn,a(m,i)&&e.ref===t.ref)return vs(e,t,c)}return t.flags|=1,e=ms(u,i),e.ref=t.ref,e.return=t,t.child=e}function Hh(e,t,a,i,c){if(e!==null){var u=e.memoizedProps;if(Cn(u,i)&&e.ref===t.ref)if(Kt=!1,t.pendingProps=i=u,gc(e,c))(e.flags&131072)!==0&&(Kt=!0);else return t.lanes=e.lanes,vs(e,t,c)}return cc(e,t,a,i,c)}function $h(e,t,a,i){var c=i.children,u=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.mode==="hidden"){if((t.flags&128)!==0){if(u=u!==null?u.baseLanes|a:a,e!==null){for(i=t.child=e.child,c=0;i!==null;)c=c|i.lanes|i.childLanes,i=i.sibling;i=c&~u}else i=0,t.child=null;return Ih(e,t,u,a,i)}if((a&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&Ki(t,u!==null?u.cachePool:null),u!==null?Pd(t,u):Ho(),Gd(t);else return i=t.lanes=536870912,Ih(e,t,u!==null?u.baseLanes|a:a,a,i)}else u!==null?(Ki(t,u.cachePool),Pd(t,u),qs(),t.memoizedState=null):(e!==null&&Ki(t,null),Ho(),qs());return sa(e,t,c,a),t.child}function Kn(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Ih(e,t,a,i,c){var u=zo();return u=u===null?null:{parent:Gt._currentValue,pool:u},t.memoizedState={baseLanes:a,cachePool:u},e!==null&&Ki(t,null),Ho(),Gd(t),e!==null&&Pr(e,t,i,!0),t.childLanes=c,null}function ol(e,t){return t=ul({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function qh(e,t,a){return br(t,e.child,null,a),e=ol(t,t.pendingProps),e.flags|=2,Ta(t),t.memoizedState=null,e}function Pg(e,t,a){var i=t.pendingProps,c=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(nt){if(i.mode==="hidden")return e=ol(t,i),t.lanes=536870912,Kn(null,e);if(Io(t),(e=Tt)?(e=tm(e,qa),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Ms!==null?{id:rs,overflow:ns}:null,retryLane:536870912,hydrationErrors:null},a=Sd(e),a.return=t,t.child=a,ta=t,Tt=null)):e=null,e===null)throw Us(t);return t.lanes=536870912,null}return ol(t,i)}var u=e.memoizedState;if(u!==null){var m=u.dehydrated;if(Io(t),c)if(t.flags&256)t.flags&=-257,t=qh(e,t,a);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(o(558));else if(Kt||Pr(e,t,a,!1),c=(a&e.childLanes)!==0,Kt||c){if(i=jt,i!==null&&(m=Se(i,a),m!==0&&m!==u.retryLane))throw u.retryLane=m,cr(e,m),wa(i,e,m),oc;yl(),t=qh(e,t,a)}else e=u.treeContext,Tt=Ga(m.nextSibling),ta=t,nt=!0,Ds=null,qa=!1,e!==null&&kd(t,e),t=ol(t,i),t.flags|=4096;return t}return e=ms(e.child,{mode:i.mode,children:i.children}),e.ref=t.ref,t.child=e,e.return=t,e}function cl(e,t){var a=t.ref;if(a===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof a!="function"&&typeof a!="object")throw Error(o(284));(e===null||e.ref!==a)&&(t.flags|=4194816)}}function cc(e,t,a,i,c){return fr(t),a=Po(e,t,a,i,void 0,c),i=Go(),e!==null&&!Kt?(Yo(e,t,c),vs(e,t,c)):(nt&&i&&No(t),t.flags|=1,sa(e,t,a,c),t.child)}function Ph(e,t,a,i,c,u){return fr(t),t.updateQueue=null,a=Kd(t,i,a,c),Yd(e),i=Go(),e!==null&&!Kt?(Yo(e,t,u),vs(e,t,u)):(nt&&i&&No(t),t.flags|=1,sa(e,t,a,u),t.child)}function Gh(e,t,a,i,c){if(fr(t),t.stateNode===null){var u=Hr,m=a.contextType;typeof m=="object"&&m!==null&&(u=aa(m)),u=new a(i,u),t.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,u.updater=ic,t.stateNode=u,u._reactInternals=t,u=t.stateNode,u.props=i,u.state=t.memoizedState,u.refs={},Do(t),m=a.contextType,u.context=typeof m=="object"&&m!==null?aa(m):Hr,u.state=t.memoizedState,m=a.getDerivedStateFromProps,typeof m=="function"&&(nc(t,a,m,i),u.state=t.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof u.getSnapshotBeforeUpdate=="function"||typeof u.UNSAFE_componentWillMount!="function"&&typeof u.componentWillMount!="function"||(m=u.state,typeof u.componentWillMount=="function"&&u.componentWillMount(),typeof u.UNSAFE_componentWillMount=="function"&&u.UNSAFE_componentWillMount(),m!==u.state&&ic.enqueueReplaceState(u,u.state,null),In(t,i,u,c),$n(),u.state=t.memoizedState),typeof u.componentDidMount=="function"&&(t.flags|=4194308),i=!0}else if(e===null){u=t.stateNode;var y=t.memoizedProps,T=yr(a,y);u.props=T;var I=u.context,J=a.contextType;m=Hr,typeof J=="object"&&J!==null&&(m=aa(J));var se=a.getDerivedStateFromProps;J=typeof se=="function"||typeof u.getSnapshotBeforeUpdate=="function",y=t.pendingProps!==y,J||typeof u.UNSAFE_componentWillReceiveProps!="function"&&typeof u.componentWillReceiveProps!="function"||(y||I!==m)&&Oh(t,u,i,m),Bs=!1;var P=t.memoizedState;u.state=P,In(t,i,u,c),$n(),I=t.memoizedState,y||P!==I||Bs?(typeof se=="function"&&(nc(t,a,se,i),I=t.memoizedState),(T=Bs||Ah(t,a,T,i,P,I,m))?(J||typeof u.UNSAFE_componentWillMount!="function"&&typeof u.componentWillMount!="function"||(typeof u.componentWillMount=="function"&&u.componentWillMount(),typeof u.UNSAFE_componentWillMount=="function"&&u.UNSAFE_componentWillMount()),typeof u.componentDidMount=="function"&&(t.flags|=4194308)):(typeof u.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=I),u.props=i,u.state=I,u.context=m,i=T):(typeof u.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{u=t.stateNode,Uo(e,t),m=t.memoizedProps,J=yr(a,m),u.props=J,se=t.pendingProps,P=u.context,I=a.contextType,T=Hr,typeof I=="object"&&I!==null&&(T=aa(I)),y=a.getDerivedStateFromProps,(I=typeof y=="function"||typeof u.getSnapshotBeforeUpdate=="function")||typeof u.UNSAFE_componentWillReceiveProps!="function"&&typeof u.componentWillReceiveProps!="function"||(m!==se||P!==T)&&Oh(t,u,i,T),Bs=!1,P=t.memoizedState,u.state=P,In(t,i,u,c),$n();var Y=t.memoizedState;m!==se||P!==Y||Bs||e!==null&&e.dependencies!==null&&Gi(e.dependencies)?(typeof y=="function"&&(nc(t,a,y,i),Y=t.memoizedState),(J=Bs||Ah(t,a,J,i,P,Y,T)||e!==null&&e.dependencies!==null&&Gi(e.dependencies))?(I||typeof u.UNSAFE_componentWillUpdate!="function"&&typeof u.componentWillUpdate!="function"||(typeof u.componentWillUpdate=="function"&&u.componentWillUpdate(i,Y,T),typeof u.UNSAFE_componentWillUpdate=="function"&&u.UNSAFE_componentWillUpdate(i,Y,T)),typeof u.componentDidUpdate=="function"&&(t.flags|=4),typeof u.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof u.componentDidUpdate!="function"||m===e.memoizedProps&&P===e.memoizedState||(t.flags|=4),typeof u.getSnapshotBeforeUpdate!="function"||m===e.memoizedProps&&P===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=Y),u.props=i,u.state=Y,u.context=T,i=J):(typeof u.componentDidUpdate!="function"||m===e.memoizedProps&&P===e.memoizedState||(t.flags|=4),typeof u.getSnapshotBeforeUpdate!="function"||m===e.memoizedProps&&P===e.memoizedState||(t.flags|=1024),i=!1)}return u=i,cl(e,t),i=(t.flags&128)!==0,u||i?(u=t.stateNode,a=i&&typeof a.getDerivedStateFromError!="function"?null:u.render(),t.flags|=1,e!==null&&i?(t.child=br(t,e.child,null,c),t.child=br(t,null,a,c)):sa(e,t,a,c),t.memoizedState=u.state,e=t.child):e=vs(e,t,c),e}function Yh(e,t,a,i){return dr(),t.flags|=256,sa(e,t,a,i),t.child}var uc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function dc(e){return{baseLanes:e,cachePool:Md()}}function hc(e,t,a){return e=e!==null?e.childLanes&~a:0,t&&(e|=Aa),e}function Kh(e,t,a){var i=t.pendingProps,c=!1,u=(t.flags&128)!==0,m;if((m=u)||(m=e!==null&&e.memoizedState===null?!1:($t.current&2)!==0),m&&(c=!0,t.flags&=-129),m=(t.flags&32)!==0,t.flags&=-33,e===null){if(nt){if(c?Is(t):qs(),(e=Tt)?(e=tm(e,qa),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Ms!==null?{id:rs,overflow:ns}:null,retryLane:536870912,hydrationErrors:null},a=Sd(e),a.return=t,t.child=a,ta=t,Tt=null)):e=null,e===null)throw Us(t);return Qc(e)?t.lanes=32:t.lanes=536870912,null}var y=i.children;return i=i.fallback,c?(qs(),c=t.mode,y=ul({mode:"hidden",children:y},c),i=ur(i,c,a,null),y.return=t,i.return=t,y.sibling=i,t.child=y,i=t.child,i.memoizedState=dc(a),i.childLanes=hc(e,m,a),t.memoizedState=uc,Kn(null,i)):(Is(t),fc(t,y))}var T=e.memoizedState;if(T!==null&&(y=T.dehydrated,y!==null)){if(u)t.flags&256?(Is(t),t.flags&=-257,t=mc(e,t,a)):t.memoizedState!==null?(qs(),t.child=e.child,t.flags|=128,t=null):(qs(),y=i.fallback,c=t.mode,i=ul({mode:"visible",children:i.children},c),y=ur(y,c,a,null),y.flags|=2,i.return=t,y.return=t,i.sibling=y,t.child=i,br(t,e.child,null,a),i=t.child,i.memoizedState=dc(a),i.childLanes=hc(e,m,a),t.memoizedState=uc,t=Kn(null,i));else if(Is(t),Qc(y)){if(m=y.nextSibling&&y.nextSibling.dataset,m)var I=m.dgst;m=I,i=Error(o(419)),i.stack="",i.digest=m,Mn({value:i,source:null,stack:null}),t=mc(e,t,a)}else if(Kt||Pr(e,t,a,!1),m=(a&e.childLanes)!==0,Kt||m){if(m=jt,m!==null&&(i=Se(m,a),i!==0&&i!==T.retryLane))throw T.retryLane=i,cr(e,i),wa(m,e,i),oc;Vc(y)||yl(),t=mc(e,t,a)}else Vc(y)?(t.flags|=192,t.child=e.child,t=null):(e=T.treeContext,Tt=Ga(y.nextSibling),ta=t,nt=!0,Ds=null,qa=!1,e!==null&&kd(t,e),t=fc(t,i.children),t.flags|=4096);return t}return c?(qs(),y=i.fallback,c=t.mode,T=e.child,I=T.sibling,i=ms(T,{mode:"hidden",children:i.children}),i.subtreeFlags=T.subtreeFlags&65011712,I!==null?y=ms(I,y):(y=ur(y,c,a,null),y.flags|=2),y.return=t,i.return=t,i.sibling=y,t.child=i,Kn(null,i),i=t.child,y=e.child.memoizedState,y===null?y=dc(a):(c=y.cachePool,c!==null?(T=Gt._currentValue,c=c.parent!==T?{parent:T,pool:T}:c):c=Md(),y={baseLanes:y.baseLanes|a,cachePool:c}),i.memoizedState=y,i.childLanes=hc(e,m,a),t.memoizedState=uc,Kn(e.child,i)):(Is(t),a=e.child,e=a.sibling,a=ms(a,{mode:"visible",children:i.children}),a.return=t,a.sibling=null,e!==null&&(m=t.deletions,m===null?(t.deletions=[e],t.flags|=16):m.push(e)),t.child=a,t.memoizedState=null,a)}function fc(e,t){return t=ul({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function ul(e,t){return e=Sa(22,e,null,t),e.lanes=0,e}function mc(e,t,a){return br(t,e.child,null,a),e=fc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Vh(e,t,a){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),Ao(e.return,t,a)}function pc(e,t,a,i,c,u){var m=e.memoizedState;m===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:a,tailMode:c,treeForkCount:u}:(m.isBackwards=t,m.rendering=null,m.renderingStartTime=0,m.last=i,m.tail=a,m.tailMode=c,m.treeForkCount=u)}function Qh(e,t,a){var i=t.pendingProps,c=i.revealOrder,u=i.tail;i=i.children;var m=$t.current,y=(m&2)!==0;if(y?(m=m&1|2,t.flags|=128):m&=1,fe($t,m),sa(e,t,i,a),i=nt?zn:0,!y&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Vh(e,a,t);else if(e.tag===19)Vh(e,a,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(c){case"forwards":for(a=t.child,c=null;a!==null;)e=a.alternate,e!==null&&Wi(e)===null&&(c=a),a=a.sibling;a=c,a===null?(c=t.child,t.child=null):(c=a.sibling,a.sibling=null),pc(t,!1,c,a,u,i);break;case"backwards":case"unstable_legacy-backwards":for(a=null,c=t.child,t.child=null;c!==null;){if(e=c.alternate,e!==null&&Wi(e)===null){t.child=c;break}e=c.sibling,c.sibling=a,a=c,c=e}pc(t,!0,a,null,u,i);break;case"together":pc(t,!1,null,null,void 0,i);break;default:t.memoizedState=null}return t.child}function vs(e,t,a){if(e!==null&&(t.dependencies=e.dependencies),Ys|=t.lanes,(a&t.childLanes)===0)if(e!==null){if(Pr(e,t,a,!1),(a&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(o(153));if(t.child!==null){for(e=t.child,a=ms(e,e.pendingProps),t.child=a,a.return=t;e.sibling!==null;)e=e.sibling,a=a.sibling=ms(e,e.pendingProps),a.return=t;a.sibling=null}return t.child}function gc(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&Gi(e)))}function Gg(e,t,a){switch(t.tag){case 3:zt(t,t.stateNode.containerInfo),Ls(t,Gt,e.memoizedState.cache),dr();break;case 27:case 5:He(t);break;case 4:zt(t,t.stateNode.containerInfo);break;case 10:Ls(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,Io(t),null;break;case 13:var i=t.memoizedState;if(i!==null)return i.dehydrated!==null?(Is(t),t.flags|=128,null):(a&t.child.childLanes)!==0?Kh(e,t,a):(Is(t),e=vs(e,t,a),e!==null?e.sibling:null);Is(t);break;case 19:var c=(e.flags&128)!==0;if(i=(a&t.childLanes)!==0,i||(Pr(e,t,a,!1),i=(a&t.childLanes)!==0),c){if(i)return Qh(e,t,a);t.flags|=128}if(c=t.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),fe($t,$t.current),i)break;return null;case 22:return t.lanes=0,$h(e,t,a,t.pendingProps);case 24:Ls(t,Gt,e.memoizedState.cache)}return vs(e,t,a)}function Zh(e,t,a){if(e!==null)if(e.memoizedProps!==t.pendingProps)Kt=!0;else{if(!gc(e,a)&&(t.flags&128)===0)return Kt=!1,Gg(e,t,a);Kt=(e.flags&131072)!==0}else Kt=!1,nt&&(t.flags&1048576)!==0&&Td(t,zn,t.index);switch(t.lanes=0,t.tag){case 16:e:{var i=t.pendingProps;if(e=pr(t.elementType),t.type=e,typeof e=="function")wo(e)?(i=yr(e,i),t.tag=1,t=Gh(null,t,e,i,a)):(t.tag=0,t=cc(null,t,e,i,a));else{if(e!=null){var c=e.$$typeof;if(c===G){t.tag=11,t=Lh(null,t,e,i,a);break e}else if(c===ie){t.tag=14,t=Bh(null,t,e,i,a);break e}}throw t=qe(e)||e,Error(o(306,t,""))}}return t;case 0:return cc(e,t,t.type,t.pendingProps,a);case 1:return i=t.type,c=yr(i,t.pendingProps),Gh(e,t,i,c,a);case 3:e:{if(zt(t,t.stateNode.containerInfo),e===null)throw Error(o(387));i=t.pendingProps;var u=t.memoizedState;c=u.element,Uo(e,t),In(t,i,null,a);var m=t.memoizedState;if(i=m.cache,Ls(t,Gt,i),i!==u.cache&&Oo(t,[Gt],a,!0),$n(),i=m.element,u.isDehydrated)if(u={element:i,isDehydrated:!1,cache:m.cache},t.updateQueue.baseState=u,t.memoizedState=u,t.flags&256){t=Yh(e,t,i,a);break e}else if(i!==c){c=Ha(Error(o(424)),t),Mn(c),t=Yh(e,t,i,a);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(Tt=Ga(e.firstChild),ta=t,nt=!0,Ds=null,qa=!0,a=$d(t,null,i,a),t.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling}else{if(dr(),i===c){t=vs(e,t,a);break e}sa(e,t,i,a)}t=t.child}return t;case 26:return cl(e,t),e===null?(a=lm(t.type,null,t.pendingProps,null))?t.memoizedState=a:nt||(a=t.type,e=t.pendingProps,i=El(Le.current).createElement(a),i[et]=t,i[Ke]=e,ra(i,a,e),bt(i),t.stateNode=i):t.memoizedState=lm(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return He(t),e===null&&nt&&(i=t.stateNode=rm(t.type,t.pendingProps,Le.current),ta=t,qa=!0,c=Tt,Js(t.type)?(Zc=c,Tt=Ga(i.firstChild)):Tt=c),sa(e,t,t.pendingProps.children,a),cl(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&nt&&((c=i=Tt)&&(i=v0(i,t.type,t.pendingProps,qa),i!==null?(t.stateNode=i,ta=t,Tt=Ga(i.firstChild),qa=!1,c=!0):c=!1),c||Us(t)),He(t),c=t.type,u=t.pendingProps,m=e!==null?e.memoizedProps:null,i=u.children,Gc(c,u)?i=null:m!==null&&Gc(c,m)&&(t.flags|=32),t.memoizedState!==null&&(c=Po(e,t,Dg,null,null,a),li._currentValue=c),cl(e,t),sa(e,t,i,a),t.child;case 6:return e===null&&nt&&((e=a=Tt)&&(a=w0(a,t.pendingProps,qa),a!==null?(t.stateNode=a,ta=t,Tt=null,e=!0):e=!1),e||Us(t)),null;case 13:return Kh(e,t,a);case 4:return zt(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=br(t,null,i,a):sa(e,t,i,a),t.child;case 11:return Lh(e,t,t.type,t.pendingProps,a);case 7:return sa(e,t,t.pendingProps,a),t.child;case 8:return sa(e,t,t.pendingProps.children,a),t.child;case 12:return sa(e,t,t.pendingProps.children,a),t.child;case 10:return i=t.pendingProps,Ls(t,t.type,i.value),sa(e,t,i.children,a),t.child;case 9:return c=t.type._context,i=t.pendingProps.children,fr(t),c=aa(c),i=i(c),t.flags|=1,sa(e,t,i,a),t.child;case 14:return Bh(e,t,t.type,t.pendingProps,a);case 15:return Hh(e,t,t.type,t.pendingProps,a);case 19:return Qh(e,t,a);case 31:return Pg(e,t,a);case 22:return $h(e,t,a,t.pendingProps);case 24:return fr(t),i=aa(Gt),e===null?(c=zo(),c===null&&(c=jt,u=Co(),c.pooledCache=u,u.refCount++,u!==null&&(c.pooledCacheLanes|=a),c=u),t.memoizedState={parent:i,cache:c},Do(t),Ls(t,Gt,c)):((e.lanes&a)!==0&&(Uo(e,t),In(t,null,null,a),$n()),c=e.memoizedState,u=t.memoizedState,c.parent!==i?(c={parent:i,cache:i},t.memoizedState=c,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=c),Ls(t,Gt,i)):(i=u.cache,Ls(t,Gt,i),i!==c.cache&&Oo(t,[Gt],a,!0))),sa(e,t,t.pendingProps.children,a),t.child;case 29:throw t.pendingProps}throw Error(o(156,t.tag))}function ws(e){e.flags|=4}function bc(e,t,a,i,c){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(c&335544128)===c)if(e.stateNode.complete)e.flags|=8192;else if(_f())e.flags|=8192;else throw gr=Qi,Mo}else e.flags&=-16777217}function Jh(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!hm(t))if(_f())e.flags|=8192;else throw gr=Qi,Mo}function dl(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?Nt():536870912,e.lanes|=t,tn|=t)}function Vn(e,t){if(!nt)switch(e.tailMode){case"hidden":t=e.tail;for(var a=null;t!==null;)t.alternate!==null&&(a=t),t=t.sibling;a===null?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var i=null;a!==null;)a.alternate!==null&&(i=a),a=a.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function kt(e){var t=e.alternate!==null&&e.alternate.child===e.child,a=0,i=0;if(t)for(var c=e.child;c!==null;)a|=c.lanes|c.childLanes,i|=c.subtreeFlags&65011712,i|=c.flags&65011712,c.return=e,c=c.sibling;else for(c=e.child;c!==null;)a|=c.lanes|c.childLanes,i|=c.subtreeFlags,i|=c.flags,c.return=e,c=c.sibling;return e.subtreeFlags|=i,e.childLanes=a,t}function Yg(e,t,a){var i=t.pendingProps;switch(So(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return kt(t),null;case 1:return kt(t),null;case 3:return a=t.stateNode,i=null,e!==null&&(i=e.memoizedState.cache),t.memoizedState.cache!==i&&(t.flags|=2048),bs(Gt),ft(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(qr(t)?ws(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,To())),kt(t),null;case 26:var c=t.type,u=t.memoizedState;return e===null?(ws(t),u!==null?(kt(t),Jh(t,u)):(kt(t),bc(t,c,null,i,a))):u?u!==e.memoizedState?(ws(t),kt(t),Jh(t,u)):(kt(t),t.flags&=-16777217):(e=e.memoizedProps,e!==i&&ws(t),kt(t),bc(t,c,e,i,a)),null;case 27:if(Mt(t),a=Le.current,c=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==i&&ws(t);else{if(!i){if(t.stateNode===null)throw Error(o(166));return kt(t),null}e=be.current,qr(t)?Ad(t):(e=rm(c,i,a),t.stateNode=e,ws(t))}return kt(t),null;case 5:if(Mt(t),c=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==i&&ws(t);else{if(!i){if(t.stateNode===null)throw Error(o(166));return kt(t),null}if(u=be.current,qr(t))Ad(t);else{var m=El(Le.current);switch(u){case 1:u=m.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:u=m.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":u=m.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":u=m.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":u=m.createElement("div"),u.innerHTML="<script><\/script>",u=u.removeChild(u.firstChild);break;case"select":u=typeof i.is=="string"?m.createElement("select",{is:i.is}):m.createElement("select"),i.multiple?u.multiple=!0:i.size&&(u.size=i.size);break;default:u=typeof i.is=="string"?m.createElement(c,{is:i.is}):m.createElement(c)}}u[et]=t,u[Ke]=i;e:for(m=t.child;m!==null;){if(m.tag===5||m.tag===6)u.appendChild(m.stateNode);else if(m.tag!==4&&m.tag!==27&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}t.stateNode=u;e:switch(ra(u,c,i),c){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&ws(t)}}return kt(t),bc(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,a),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==i&&ws(t);else{if(typeof i!="string"&&t.stateNode===null)throw Error(o(166));if(e=Le.current,qr(t)){if(e=t.stateNode,a=t.memoizedProps,i=null,c=ta,c!==null)switch(c.tag){case 27:case 5:i=c.memoizedProps}e[et]=t,e=!!(e.nodeValue===a||i!==null&&i.suppressHydrationWarning===!0||Vf(e.nodeValue,a)),e||Us(t,!0)}else e=El(e).createTextNode(i),e[et]=t,t.stateNode=e}return kt(t),null;case 31:if(a=t.memoizedState,e===null||e.memoizedState!==null){if(i=qr(t),a!==null){if(e===null){if(!i)throw Error(o(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(o(557));e[et]=t}else dr(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;kt(t),e=!1}else a=To(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=a),e=!0;if(!e)return t.flags&256?(Ta(t),t):(Ta(t),null);if((t.flags&128)!==0)throw Error(o(558))}return kt(t),null;case 13:if(i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(c=qr(t),i!==null&&i.dehydrated!==null){if(e===null){if(!c)throw Error(o(318));if(c=t.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(o(317));c[et]=t}else dr(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;kt(t),c=!1}else c=To(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=c),c=!0;if(!c)return t.flags&256?(Ta(t),t):(Ta(t),null)}return Ta(t),(t.flags&128)!==0?(t.lanes=a,t):(a=i!==null,e=e!==null&&e.memoizedState!==null,a&&(i=t.child,c=null,i.alternate!==null&&i.alternate.memoizedState!==null&&i.alternate.memoizedState.cachePool!==null&&(c=i.alternate.memoizedState.cachePool.pool),u=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),u!==c&&(i.flags|=2048)),a!==e&&a&&(t.child.flags|=8192),dl(t,t.updateQueue),kt(t),null);case 4:return ft(),e===null&&Hc(t.stateNode.containerInfo),kt(t),null;case 10:return bs(t.type),kt(t),null;case 19:if(Q($t),i=t.memoizedState,i===null)return kt(t),null;if(c=(t.flags&128)!==0,u=i.rendering,u===null)if(c)Vn(i,!1);else{if(Lt!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(u=Wi(e),u!==null){for(t.flags|=128,Vn(i,!1),e=u.updateQueue,t.updateQueue=e,dl(t,e),t.subtreeFlags=0,e=a,a=t.child;a!==null;)Nd(a,e),a=a.sibling;return fe($t,$t.current&1|2),nt&&ps(t,i.treeForkCount),t.child}e=e.sibling}i.tail!==null&&Zt()>gl&&(t.flags|=128,c=!0,Vn(i,!1),t.lanes=4194304)}else{if(!c)if(e=Wi(u),e!==null){if(t.flags|=128,c=!0,e=e.updateQueue,t.updateQueue=e,dl(t,e),Vn(i,!0),i.tail===null&&i.tailMode==="hidden"&&!u.alternate&&!nt)return kt(t),null}else 2*Zt()-i.renderingStartTime>gl&&a!==536870912&&(t.flags|=128,c=!0,Vn(i,!1),t.lanes=4194304);i.isBackwards?(u.sibling=t.child,t.child=u):(e=i.last,e!==null?e.sibling=u:t.child=u,i.last=u)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Zt(),e.sibling=null,a=$t.current,fe($t,c?a&1|2:a&1),nt&&ps(t,i.treeForkCount),e):(kt(t),null);case 22:case 23:return Ta(t),$o(),i=t.memoizedState!==null,e!==null?e.memoizedState!==null!==i&&(t.flags|=8192):i&&(t.flags|=8192),i?(a&536870912)!==0&&(t.flags&128)===0&&(kt(t),t.subtreeFlags&6&&(t.flags|=8192)):kt(t),a=t.updateQueue,a!==null&&dl(t,a.retryQueue),a=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),i=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(i=t.memoizedState.cachePool.pool),i!==a&&(t.flags|=2048),e!==null&&Q(mr),null;case 24:return a=null,e!==null&&(a=e.memoizedState.cache),t.memoizedState.cache!==a&&(t.flags|=2048),bs(Gt),kt(t),null;case 25:return null;case 30:return null}throw Error(o(156,t.tag))}function Kg(e,t){switch(So(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return bs(Gt),ft(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return Mt(t),null;case 31:if(t.memoizedState!==null){if(Ta(t),t.alternate===null)throw Error(o(340));dr()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(Ta(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(o(340));dr()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Q($t),null;case 4:return ft(),null;case 10:return bs(t.type),null;case 22:case 23:return Ta(t),$o(),e!==null&&Q(mr),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return bs(Gt),null;case 25:return null;default:return null}}function Xh(e,t){switch(So(t),t.tag){case 3:bs(Gt),ft();break;case 26:case 27:case 5:Mt(t);break;case 4:ft();break;case 31:t.memoizedState!==null&&Ta(t);break;case 13:Ta(t);break;case 19:Q($t);break;case 10:bs(t.type);break;case 22:case 23:Ta(t),$o(),e!==null&&Q(mr);break;case 24:bs(Gt)}}function Qn(e,t){try{var a=t.updateQueue,i=a!==null?a.lastEffect:null;if(i!==null){var c=i.next;a=c;do{if((a.tag&e)===e){i=void 0;var u=a.create,m=a.inst;i=u(),m.destroy=i}a=a.next}while(a!==c)}}catch(y){gt(t,t.return,y)}}function Ps(e,t,a){try{var i=t.updateQueue,c=i!==null?i.lastEffect:null;if(c!==null){var u=c.next;i=u;do{if((i.tag&e)===e){var m=i.inst,y=m.destroy;if(y!==void 0){m.destroy=void 0,c=t;var T=a,I=y;try{I()}catch(J){gt(c,T,J)}}}i=i.next}while(i!==u)}}catch(J){gt(t,t.return,J)}}function Wh(e){var t=e.updateQueue;if(t!==null){var a=e.stateNode;try{qd(t,a)}catch(i){gt(e,e.return,i)}}}function Fh(e,t,a){a.props=yr(e.type,e.memoizedProps),a.state=e.memoizedState;try{a.componentWillUnmount()}catch(i){gt(e,t,i)}}function Zn(e,t){try{var a=e.ref;if(a!==null){switch(e.tag){case 26:case 27:case 5:var i=e.stateNode;break;case 30:i=e.stateNode;break;default:i=e.stateNode}typeof a=="function"?e.refCleanup=a(i):a.current=i}}catch(c){gt(e,t,c)}}function is(e,t){var a=e.ref,i=e.refCleanup;if(a!==null)if(typeof i=="function")try{i()}catch(c){gt(e,t,c)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof a=="function")try{a(null)}catch(c){gt(e,t,c)}else a.current=null}function ef(e){var t=e.type,a=e.memoizedProps,i=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":a.autoFocus&&i.focus();break e;case"img":a.src?i.src=a.src:a.srcSet&&(i.srcset=a.srcSet)}}catch(c){gt(e,e.return,c)}}function xc(e,t,a){try{var i=e.stateNode;m0(i,e.type,a,t),i[Ke]=t}catch(c){gt(e,e.return,c)}}function tf(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Js(e.type)||e.tag===4}function yc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||tf(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Js(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function vc(e,t,a){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a).insertBefore(e,t):(t=a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,t.appendChild(e),a=a._reactRootContainer,a!=null||t.onclick!==null||(t.onclick=hs));else if(i!==4&&(i===27&&Js(e.type)&&(a=e.stateNode,t=null),e=e.child,e!==null))for(vc(e,t,a),e=e.sibling;e!==null;)vc(e,t,a),e=e.sibling}function hl(e,t,a){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?a.insertBefore(e,t):a.appendChild(e);else if(i!==4&&(i===27&&Js(e.type)&&(a=e.stateNode),e=e.child,e!==null))for(hl(e,t,a),e=e.sibling;e!==null;)hl(e,t,a),e=e.sibling}function af(e){var t=e.stateNode,a=e.memoizedProps;try{for(var i=e.type,c=t.attributes;c.length;)t.removeAttributeNode(c[0]);ra(t,i,a),t[et]=e,t[Ke]=a}catch(u){gt(e,e.return,u)}}var js=!1,Vt=!1,wc=!1,sf=typeof WeakSet=="function"?WeakSet:Set,ea=null;function Vg(e,t){if(e=e.containerInfo,qc=zl,e=pd(e),mo(e)){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else e:{a=(a=e.ownerDocument)&&a.defaultView||window;var i=a.getSelection&&a.getSelection();if(i&&i.rangeCount!==0){a=i.anchorNode;var c=i.anchorOffset,u=i.focusNode;i=i.focusOffset;try{a.nodeType,u.nodeType}catch{a=null;break e}var m=0,y=-1,T=-1,I=0,J=0,se=e,P=null;t:for(;;){for(var Y;se!==a||c!==0&&se.nodeType!==3||(y=m+c),se!==u||i!==0&&se.nodeType!==3||(T=m+i),se.nodeType===3&&(m+=se.nodeValue.length),(Y=se.firstChild)!==null;)P=se,se=Y;for(;;){if(se===e)break t;if(P===a&&++I===c&&(y=m),P===u&&++J===i&&(T=m),(Y=se.nextSibling)!==null)break;se=P,P=se.parentNode}se=Y}a=y===-1||T===-1?null:{start:y,end:T}}else a=null}a=a||{start:0,end:0}}else a=null;for(Pc={focusedElem:e,selectionRange:a},zl=!1,ea=t;ea!==null;)if(t=ea,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ea=e;else for(;ea!==null;){switch(t=ea,u=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(a=0;a<e.length;a++)c=e[a],c.ref.impl=c.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&u!==null){e=void 0,a=t,c=u.memoizedProps,u=u.memoizedState,i=a.stateNode;try{var _e=yr(a.type,c);e=i.getSnapshotBeforeUpdate(_e,u),i.__reactInternalSnapshotBeforeUpdate=e}catch(ze){gt(a,a.return,ze)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,a=e.nodeType,a===9)Kc(e);else if(a===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Kc(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(o(163))}if(e=t.sibling,e!==null){e.return=t.return,ea=e;break}ea=t.return}}function rf(e,t,a){var i=a.flags;switch(a.tag){case 0:case 11:case 15:Ns(e,a),i&4&&Qn(5,a);break;case 1:if(Ns(e,a),i&4)if(e=a.stateNode,t===null)try{e.componentDidMount()}catch(m){gt(a,a.return,m)}else{var c=yr(a.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(c,t,e.__reactInternalSnapshotBeforeUpdate)}catch(m){gt(a,a.return,m)}}i&64&&Wh(a),i&512&&Zn(a,a.return);break;case 3:if(Ns(e,a),i&64&&(e=a.updateQueue,e!==null)){if(t=null,a.child!==null)switch(a.child.tag){case 27:case 5:t=a.child.stateNode;break;case 1:t=a.child.stateNode}try{qd(e,t)}catch(m){gt(a,a.return,m)}}break;case 27:t===null&&i&4&&af(a);case 26:case 5:Ns(e,a),t===null&&i&4&&ef(a),i&512&&Zn(a,a.return);break;case 12:Ns(e,a);break;case 31:Ns(e,a),i&4&&of(e,a);break;case 13:Ns(e,a),i&4&&cf(e,a),i&64&&(e=a.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(a=a0.bind(null,a),j0(e,a))));break;case 22:if(i=a.memoizedState!==null||js,!i){t=t!==null&&t.memoizedState!==null||Vt,c=js;var u=Vt;js=i,(Vt=t)&&!u?Ss(e,a,(a.subtreeFlags&8772)!==0):Ns(e,a),js=c,Vt=u}break;case 30:break;default:Ns(e,a)}}function nf(e){var t=e.alternate;t!==null&&(e.alternate=null,nf(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&Va(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Ot=null,ba=!1;function _s(e,t,a){for(a=a.child;a!==null;)lf(e,t,a),a=a.sibling}function lf(e,t,a){if(B&&typeof B.onCommitFiberUnmount=="function")try{B.onCommitFiberUnmount(D,a)}catch{}switch(a.tag){case 26:Vt||is(a,t),_s(e,t,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode,a.parentNode.removeChild(a));break;case 27:Vt||is(a,t);var i=Ot,c=ba;Js(a.type)&&(Ot=a.stateNode,ba=!1),_s(e,t,a),ri(a.stateNode),Ot=i,ba=c;break;case 5:Vt||is(a,t);case 6:if(i=Ot,c=ba,Ot=null,_s(e,t,a),Ot=i,ba=c,Ot!==null)if(ba)try{(Ot.nodeType===9?Ot.body:Ot.nodeName==="HTML"?Ot.ownerDocument.body:Ot).removeChild(a.stateNode)}catch(u){gt(a,t,u)}else try{Ot.removeChild(a.stateNode)}catch(u){gt(a,t,u)}break;case 18:Ot!==null&&(ba?(e=Ot,Ff(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,a.stateNode),un(e)):Ff(Ot,a.stateNode));break;case 4:i=Ot,c=ba,Ot=a.stateNode.containerInfo,ba=!0,_s(e,t,a),Ot=i,ba=c;break;case 0:case 11:case 14:case 15:Ps(2,a,t),Vt||Ps(4,a,t),_s(e,t,a);break;case 1:Vt||(is(a,t),i=a.stateNode,typeof i.componentWillUnmount=="function"&&Fh(a,t,i)),_s(e,t,a);break;case 21:_s(e,t,a);break;case 22:Vt=(i=Vt)||a.memoizedState!==null,_s(e,t,a),Vt=i;break;default:_s(e,t,a)}}function of(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{un(e)}catch(a){gt(t,t.return,a)}}}function cf(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{un(e)}catch(a){gt(t,t.return,a)}}function Qg(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new sf),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new sf),t;default:throw Error(o(435,e.tag))}}function fl(e,t){var a=Qg(e);t.forEach(function(i){if(!a.has(i)){a.add(i);var c=s0.bind(null,e,i);i.then(c,c)}})}function xa(e,t){var a=t.deletions;if(a!==null)for(var i=0;i<a.length;i++){var c=a[i],u=e,m=t,y=m;e:for(;y!==null;){switch(y.tag){case 27:if(Js(y.type)){Ot=y.stateNode,ba=!1;break e}break;case 5:Ot=y.stateNode,ba=!1;break e;case 3:case 4:Ot=y.stateNode.containerInfo,ba=!0;break e}y=y.return}if(Ot===null)throw Error(o(160));lf(u,m,c),Ot=null,ba=!1,u=c.alternate,u!==null&&(u.return=null),c.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)uf(t,e),t=t.sibling}var Ja=null;function uf(e,t){var a=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:xa(t,e),ya(e),i&4&&(Ps(3,e,e.return),Qn(3,e),Ps(5,e,e.return));break;case 1:xa(t,e),ya(e),i&512&&(Vt||a===null||is(a,a.return)),i&64&&js&&(e=e.updateQueue,e!==null&&(i=e.callbacks,i!==null&&(a=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=a===null?i:a.concat(i))));break;case 26:var c=Ja;if(xa(t,e),ya(e),i&512&&(Vt||a===null||is(a,a.return)),i&4){var u=a!==null?a.memoizedState:null;if(i=e.memoizedState,a===null)if(i===null)if(e.stateNode===null){e:{i=e.type,a=e.memoizedProps,c=c.ownerDocument||c;t:switch(i){case"title":u=c.getElementsByTagName("title")[0],(!u||u[cs]||u[et]||u.namespaceURI==="http://www.w3.org/2000/svg"||u.hasAttribute("itemprop"))&&(u=c.createElement(i),c.head.insertBefore(u,c.querySelector("head > title"))),ra(u,i,a),u[et]=e,bt(u),i=u;break e;case"link":var m=um("link","href",c).get(i+(a.href||""));if(m){for(var y=0;y<m.length;y++)if(u=m[y],u.getAttribute("href")===(a.href==null||a.href===""?null:a.href)&&u.getAttribute("rel")===(a.rel==null?null:a.rel)&&u.getAttribute("title")===(a.title==null?null:a.title)&&u.getAttribute("crossorigin")===(a.crossOrigin==null?null:a.crossOrigin)){m.splice(y,1);break t}}u=c.createElement(i),ra(u,i,a),c.head.appendChild(u);break;case"meta":if(m=um("meta","content",c).get(i+(a.content||""))){for(y=0;y<m.length;y++)if(u=m[y],u.getAttribute("content")===(a.content==null?null:""+a.content)&&u.getAttribute("name")===(a.name==null?null:a.name)&&u.getAttribute("property")===(a.property==null?null:a.property)&&u.getAttribute("http-equiv")===(a.httpEquiv==null?null:a.httpEquiv)&&u.getAttribute("charset")===(a.charSet==null?null:a.charSet)){m.splice(y,1);break t}}u=c.createElement(i),ra(u,i,a),c.head.appendChild(u);break;default:throw Error(o(468,i))}u[et]=e,bt(u),i=u}e.stateNode=i}else dm(c,e.type,e.stateNode);else e.stateNode=cm(c,i,e.memoizedProps);else u!==i?(u===null?a.stateNode!==null&&(a=a.stateNode,a.parentNode.removeChild(a)):u.count--,i===null?dm(c,e.type,e.stateNode):cm(c,i,e.memoizedProps)):i===null&&e.stateNode!==null&&xc(e,e.memoizedProps,a.memoizedProps)}break;case 27:xa(t,e),ya(e),i&512&&(Vt||a===null||is(a,a.return)),a!==null&&i&4&&xc(e,e.memoizedProps,a.memoizedProps);break;case 5:if(xa(t,e),ya(e),i&512&&(Vt||a===null||is(a,a.return)),e.flags&32){c=e.stateNode;try{Rr(c,"")}catch(_e){gt(e,e.return,_e)}}i&4&&e.stateNode!=null&&(c=e.memoizedProps,xc(e,c,a!==null?a.memoizedProps:c)),i&1024&&(wc=!0);break;case 6:if(xa(t,e),ya(e),i&4){if(e.stateNode===null)throw Error(o(162));i=e.memoizedProps,a=e.stateNode;try{a.nodeValue=i}catch(_e){gt(e,e.return,_e)}}break;case 3:if(Al=null,c=Ja,Ja=Tl(t.containerInfo),xa(t,e),Ja=c,ya(e),i&4&&a!==null&&a.memoizedState.isDehydrated)try{un(t.containerInfo)}catch(_e){gt(e,e.return,_e)}wc&&(wc=!1,df(e));break;case 4:i=Ja,Ja=Tl(e.stateNode.containerInfo),xa(t,e),ya(e),Ja=i;break;case 12:xa(t,e),ya(e);break;case 31:xa(t,e),ya(e),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,fl(e,i)));break;case 13:xa(t,e),ya(e),e.child.flags&8192&&e.memoizedState!==null!=(a!==null&&a.memoizedState!==null)&&(pl=Zt()),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,fl(e,i)));break;case 22:c=e.memoizedState!==null;var T=a!==null&&a.memoizedState!==null,I=js,J=Vt;if(js=I||c,Vt=J||T,xa(t,e),Vt=J,js=I,ya(e),i&8192)e:for(t=e.stateNode,t._visibility=c?t._visibility&-2:t._visibility|1,c&&(a===null||T||js||Vt||vr(e)),a=null,t=e;;){if(t.tag===5||t.tag===26){if(a===null){T=a=t;try{if(u=T.stateNode,c)m=u.style,typeof m.setProperty=="function"?m.setProperty("display","none","important"):m.display="none";else{y=T.stateNode;var se=T.memoizedProps.style,P=se!=null&&se.hasOwnProperty("display")?se.display:null;y.style.display=P==null||typeof P=="boolean"?"":(""+P).trim()}}catch(_e){gt(T,T.return,_e)}}}else if(t.tag===6){if(a===null){T=t;try{T.stateNode.nodeValue=c?"":T.memoizedProps}catch(_e){gt(T,T.return,_e)}}}else if(t.tag===18){if(a===null){T=t;try{var Y=T.stateNode;c?em(Y,!0):em(T.stateNode,!1)}catch(_e){gt(T,T.return,_e)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;a===t&&(a=null),t=t.return}a===t&&(a=null),t.sibling.return=t.return,t=t.sibling}i&4&&(i=e.updateQueue,i!==null&&(a=i.retryQueue,a!==null&&(i.retryQueue=null,fl(e,a))));break;case 19:xa(t,e),ya(e),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,fl(e,i)));break;case 30:break;case 21:break;default:xa(t,e),ya(e)}}function ya(e){var t=e.flags;if(t&2){try{for(var a,i=e.return;i!==null;){if(tf(i)){a=i;break}i=i.return}if(a==null)throw Error(o(160));switch(a.tag){case 27:var c=a.stateNode,u=yc(e);hl(e,u,c);break;case 5:var m=a.stateNode;a.flags&32&&(Rr(m,""),a.flags&=-33);var y=yc(e);hl(e,y,m);break;case 3:case 4:var T=a.stateNode.containerInfo,I=yc(e);vc(e,I,T);break;default:throw Error(o(161))}}catch(J){gt(e,e.return,J)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function df(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;df(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function Ns(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)rf(e,t.alternate,t),t=t.sibling}function vr(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:Ps(4,t,t.return),vr(t);break;case 1:is(t,t.return);var a=t.stateNode;typeof a.componentWillUnmount=="function"&&Fh(t,t.return,a),vr(t);break;case 27:ri(t.stateNode);case 26:case 5:is(t,t.return),vr(t);break;case 22:t.memoizedState===null&&vr(t);break;case 30:vr(t);break;default:vr(t)}e=e.sibling}}function Ss(e,t,a){for(a=a&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var i=t.alternate,c=e,u=t,m=u.flags;switch(u.tag){case 0:case 11:case 15:Ss(c,u,a),Qn(4,u);break;case 1:if(Ss(c,u,a),i=u,c=i.stateNode,typeof c.componentDidMount=="function")try{c.componentDidMount()}catch(I){gt(i,i.return,I)}if(i=u,c=i.updateQueue,c!==null){var y=i.stateNode;try{var T=c.shared.hiddenCallbacks;if(T!==null)for(c.shared.hiddenCallbacks=null,c=0;c<T.length;c++)Id(T[c],y)}catch(I){gt(i,i.return,I)}}a&&m&64&&Wh(u),Zn(u,u.return);break;case 27:af(u);case 26:case 5:Ss(c,u,a),a&&i===null&&m&4&&ef(u),Zn(u,u.return);break;case 12:Ss(c,u,a);break;case 31:Ss(c,u,a),a&&m&4&&of(c,u);break;case 13:Ss(c,u,a),a&&m&4&&cf(c,u);break;case 22:u.memoizedState===null&&Ss(c,u,a),Zn(u,u.return);break;case 30:break;default:Ss(c,u,a)}t=t.sibling}}function jc(e,t){var a=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==a&&(e!=null&&e.refCount++,a!=null&&Dn(a))}function _c(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Dn(e))}function Xa(e,t,a,i){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)hf(e,t,a,i),t=t.sibling}function hf(e,t,a,i){var c=t.flags;switch(t.tag){case 0:case 11:case 15:Xa(e,t,a,i),c&2048&&Qn(9,t);break;case 1:Xa(e,t,a,i);break;case 3:Xa(e,t,a,i),c&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Dn(e)));break;case 12:if(c&2048){Xa(e,t,a,i),e=t.stateNode;try{var u=t.memoizedProps,m=u.id,y=u.onPostCommit;typeof y=="function"&&y(m,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(T){gt(t,t.return,T)}}else Xa(e,t,a,i);break;case 31:Xa(e,t,a,i);break;case 13:Xa(e,t,a,i);break;case 23:break;case 22:u=t.stateNode,m=t.alternate,t.memoizedState!==null?u._visibility&2?Xa(e,t,a,i):Jn(e,t):u._visibility&2?Xa(e,t,a,i):(u._visibility|=2,Wr(e,t,a,i,(t.subtreeFlags&10256)!==0||!1)),c&2048&&jc(m,t);break;case 24:Xa(e,t,a,i),c&2048&&_c(t.alternate,t);break;default:Xa(e,t,a,i)}}function Wr(e,t,a,i,c){for(c=c&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var u=e,m=t,y=a,T=i,I=m.flags;switch(m.tag){case 0:case 11:case 15:Wr(u,m,y,T,c),Qn(8,m);break;case 23:break;case 22:var J=m.stateNode;m.memoizedState!==null?J._visibility&2?Wr(u,m,y,T,c):Jn(u,m):(J._visibility|=2,Wr(u,m,y,T,c)),c&&I&2048&&jc(m.alternate,m);break;case 24:Wr(u,m,y,T,c),c&&I&2048&&_c(m.alternate,m);break;default:Wr(u,m,y,T,c)}t=t.sibling}}function Jn(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var a=e,i=t,c=i.flags;switch(i.tag){case 22:Jn(a,i),c&2048&&jc(i.alternate,i);break;case 24:Jn(a,i),c&2048&&_c(i.alternate,i);break;default:Jn(a,i)}t=t.sibling}}var Xn=8192;function Fr(e,t,a){if(e.subtreeFlags&Xn)for(e=e.child;e!==null;)ff(e,t,a),e=e.sibling}function ff(e,t,a){switch(e.tag){case 26:Fr(e,t,a),e.flags&Xn&&e.memoizedState!==null&&M0(a,Ja,e.memoizedState,e.memoizedProps);break;case 5:Fr(e,t,a);break;case 3:case 4:var i=Ja;Ja=Tl(e.stateNode.containerInfo),Fr(e,t,a),Ja=i;break;case 22:e.memoizedState===null&&(i=e.alternate,i!==null&&i.memoizedState!==null?(i=Xn,Xn=16777216,Fr(e,t,a),Xn=i):Fr(e,t,a));break;default:Fr(e,t,a)}}function mf(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function Wn(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var a=0;a<t.length;a++){var i=t[a];ea=i,gf(i,e)}mf(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)pf(e),e=e.sibling}function pf(e){switch(e.tag){case 0:case 11:case 15:Wn(e),e.flags&2048&&Ps(9,e,e.return);break;case 3:Wn(e);break;case 12:Wn(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,ml(e)):Wn(e);break;default:Wn(e)}}function ml(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var a=0;a<t.length;a++){var i=t[a];ea=i,gf(i,e)}mf(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:Ps(8,t,t.return),ml(t);break;case 22:a=t.stateNode,a._visibility&2&&(a._visibility&=-3,ml(t));break;default:ml(t)}e=e.sibling}}function gf(e,t){for(;ea!==null;){var a=ea;switch(a.tag){case 0:case 11:case 15:Ps(8,a,t);break;case 23:case 22:if(a.memoizedState!==null&&a.memoizedState.cachePool!==null){var i=a.memoizedState.cachePool.pool;i!=null&&i.refCount++}break;case 24:Dn(a.memoizedState.cache)}if(i=a.child,i!==null)i.return=a,ea=i;else e:for(a=e;ea!==null;){i=ea;var c=i.sibling,u=i.return;if(nf(i),i===a){ea=null;break e}if(c!==null){c.return=u,ea=c;break e}ea=u}}}var Zg={getCacheForType:function(e){var t=aa(Gt),a=t.data.get(e);return a===void 0&&(a=e(),t.data.set(e,a)),a},cacheSignal:function(){return aa(Gt).controller.signal}},Jg=typeof WeakMap=="function"?WeakMap:Map,ht=0,jt=null,tt=null,st=0,pt=0,ka=null,Gs=!1,en=!1,Nc=!1,Es=0,Lt=0,Ys=0,wr=0,Sc=0,Aa=0,tn=0,Fn=null,va=null,Ec=!1,pl=0,bf=0,gl=1/0,bl=null,Ks=null,Wt=0,Vs=null,an=null,Ts=0,Tc=0,kc=null,xf=null,ei=0,Ac=null;function Oa(){return(ht&2)!==0&&st!==0?st&-st:S.T!==null?Dc():Pt()}function yf(){if(Aa===0)if((st&536870912)===0||nt){var e=$;$<<=1,($&3932160)===0&&($=262144),Aa=e}else Aa=536870912;return e=Ea.current,e!==null&&(e.flags|=32),Aa}function wa(e,t,a){(e===jt&&(pt===2||pt===9)||e.cancelPendingCommit!==null)&&(sn(e,0),Qs(e,st,Aa,!1)),We(e,a),((ht&2)===0||e!==jt)&&(e===jt&&((ht&2)===0&&(wr|=a),Lt===4&&Qs(e,st,Aa,!1)),ls(e))}function vf(e,t,a){if((ht&6)!==0)throw Error(o(327));var i=!a&&(t&127)===0&&(t&e.expiredLanes)===0||ke(e,t),c=i?Fg(e,t):Cc(e,t,!0),u=i;do{if(c===0){en&&!i&&Qs(e,t,0,!1);break}else{if(a=e.current.alternate,u&&!Xg(a)){c=Cc(e,t,!1),u=!1;continue}if(c===2){if(u=t,e.errorRecoveryDisabledLanes&u)var m=0;else m=e.pendingLanes&-536870913,m=m!==0?m:m&536870912?536870912:0;if(m!==0){t=m;e:{var y=e;c=Fn;var T=y.current.memoizedState.isDehydrated;if(T&&(sn(y,m).flags|=256),m=Cc(y,m,!1),m!==2){if(Nc&&!T){y.errorRecoveryDisabledLanes|=u,wr|=u,c=4;break e}u=va,va=c,u!==null&&(va===null?va=u:va.push.apply(va,u))}c=m}if(u=!1,c!==2)continue}}if(c===1){sn(e,0),Qs(e,t,0,!0);break}e:{switch(i=e,u=c,u){case 0:case 1:throw Error(o(345));case 4:if((t&4194048)!==t)break;case 6:Qs(i,t,Aa,!Gs);break e;case 2:va=null;break;case 3:case 5:break;default:throw Error(o(329))}if((t&62914560)===t&&(c=pl+300-Zt(),10<c)){if(Qs(i,t,Aa,!Gs),me(i,0,!0)!==0)break e;Ts=t,i.timeoutHandle=Xf(wf.bind(null,i,a,va,bl,Ec,t,Aa,wr,tn,Gs,u,"Throttled",-0,0),c);break e}wf(i,a,va,bl,Ec,t,Aa,wr,tn,Gs,u,null,-0,0)}}break}while(!0);ls(e)}function wf(e,t,a,i,c,u,m,y,T,I,J,se,P,Y){if(e.timeoutHandle=-1,se=t.subtreeFlags,se&8192||(se&16785408)===16785408){se={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:hs},ff(t,u,se);var _e=(u&62914560)===u?pl-Zt():(u&4194048)===u?bf-Zt():0;if(_e=D0(se,_e),_e!==null){Ts=u,e.cancelPendingCommit=_e(Af.bind(null,e,t,u,a,i,c,m,y,T,J,se,null,P,Y)),Qs(e,u,m,!I);return}}Af(e,t,u,a,i,c,m,y,T)}function Xg(e){for(var t=e;;){var a=t.tag;if((a===0||a===11||a===15)&&t.flags&16384&&(a=t.updateQueue,a!==null&&(a=a.stores,a!==null)))for(var i=0;i<a.length;i++){var c=a[i],u=c.getSnapshot;c=c.value;try{if(!Na(u(),c))return!1}catch{return!1}}if(a=t.child,t.subtreeFlags&16384&&a!==null)a.return=t,t=a;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Qs(e,t,a,i){t&=~Sc,t&=~wr,e.suspendedLanes|=t,e.pingedLanes&=~t,i&&(e.warmLanes|=t),i=e.expirationTimes;for(var c=t;0<c;){var u=31-te(c),m=1<<u;i[u]=-1,c&=~m}a!==0&&Jt(e,a,t)}function xl(){return(ht&6)===0?(ti(0),!1):!0}function Oc(){if(tt!==null){if(pt===0)var e=tt.return;else e=tt,gs=hr=null,Ko(e),Vr=null,Ln=0,e=tt;for(;e!==null;)Xh(e.alternate,e),e=e.return;tt=null}}function sn(e,t){var a=e.timeoutHandle;a!==-1&&(e.timeoutHandle=-1,b0(a)),a=e.cancelPendingCommit,a!==null&&(e.cancelPendingCommit=null,a()),Ts=0,Oc(),jt=e,tt=a=ms(e.current,null),st=t,pt=0,ka=null,Gs=!1,en=ke(e,t),Nc=!1,tn=Aa=Sc=wr=Ys=Lt=0,va=Fn=null,Ec=!1,(t&8)!==0&&(t|=t&32);var i=e.entangledLanes;if(i!==0)for(e=e.entanglements,i&=t;0<i;){var c=31-te(i),u=1<<c;t|=e[c],i&=~u}return Es=t,Hi(),a}function jf(e,t){Pe=null,S.H=Yn,t===Kr||t===Vi?(t=Ld(),pt=3):t===Mo?(t=Ld(),pt=4):pt=t===oc?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,ka=t,tt===null&&(Lt=1,ll(e,Ha(t,e.current)))}function _f(){var e=Ea.current;return e===null?!0:(st&4194048)===st?Pa===null:(st&62914560)===st||(st&536870912)!==0?e===Pa:!1}function Nf(){var e=S.H;return S.H=Yn,e===null?Yn:e}function Sf(){var e=S.A;return S.A=Zg,e}function yl(){Lt=4,Gs||(st&4194048)!==st&&Ea.current!==null||(en=!0),(Ys&134217727)===0&&(wr&134217727)===0||jt===null||Qs(jt,st,Aa,!1)}function Cc(e,t,a){var i=ht;ht|=2;var c=Nf(),u=Sf();(jt!==e||st!==t)&&(bl=null,sn(e,t)),t=!1;var m=Lt;e:do try{if(pt!==0&&tt!==null){var y=tt,T=ka;switch(pt){case 8:Oc(),m=6;break e;case 3:case 2:case 9:case 6:Ea.current===null&&(t=!0);var I=pt;if(pt=0,ka=null,rn(e,y,T,I),a&&en){m=0;break e}break;default:I=pt,pt=0,ka=null,rn(e,y,T,I)}}Wg(),m=Lt;break}catch(J){jf(e,J)}while(!0);return t&&e.shellSuspendCounter++,gs=hr=null,ht=i,S.H=c,S.A=u,tt===null&&(jt=null,st=0,Hi()),m}function Wg(){for(;tt!==null;)Ef(tt)}function Fg(e,t){var a=ht;ht|=2;var i=Nf(),c=Sf();jt!==e||st!==t?(bl=null,gl=Zt()+500,sn(e,t)):en=ke(e,t);e:do try{if(pt!==0&&tt!==null){t=tt;var u=ka;t:switch(pt){case 1:pt=0,ka=null,rn(e,t,u,1);break;case 2:case 9:if(Dd(u)){pt=0,ka=null,Tf(t);break}t=function(){pt!==2&&pt!==9||jt!==e||(pt=7),ls(e)},u.then(t,t);break e;case 3:pt=7;break e;case 4:pt=5;break e;case 7:Dd(u)?(pt=0,ka=null,Tf(t)):(pt=0,ka=null,rn(e,t,u,7));break;case 5:var m=null;switch(tt.tag){case 26:m=tt.memoizedState;case 5:case 27:var y=tt;if(m?hm(m):y.stateNode.complete){pt=0,ka=null;var T=y.sibling;if(T!==null)tt=T;else{var I=y.return;I!==null?(tt=I,vl(I)):tt=null}break t}}pt=0,ka=null,rn(e,t,u,5);break;case 6:pt=0,ka=null,rn(e,t,u,6);break;case 8:Oc(),Lt=6;break e;default:throw Error(o(462))}}e0();break}catch(J){jf(e,J)}while(!0);return gs=hr=null,S.H=i,S.A=c,ht=a,tt!==null?0:(jt=null,st=0,Hi(),Lt)}function e0(){for(;tt!==null&&!Dt();)Ef(tt)}function Ef(e){var t=Zh(e.alternate,e,Es);e.memoizedProps=e.pendingProps,t===null?vl(e):tt=t}function Tf(e){var t=e,a=t.alternate;switch(t.tag){case 15:case 0:t=Ph(a,t,t.pendingProps,t.type,void 0,st);break;case 11:t=Ph(a,t,t.pendingProps,t.type.render,t.ref,st);break;case 5:Ko(t);default:Xh(a,t),t=tt=Nd(t,Es),t=Zh(a,t,Es)}e.memoizedProps=e.pendingProps,t===null?vl(e):tt=t}function rn(e,t,a,i){gs=hr=null,Ko(t),Vr=null,Ln=0;var c=t.return;try{if(qg(e,c,t,a,st)){Lt=1,ll(e,Ha(a,e.current)),tt=null;return}}catch(u){if(c!==null)throw tt=c,u;Lt=1,ll(e,Ha(a,e.current)),tt=null;return}t.flags&32768?(nt||i===1?e=!0:en||(st&536870912)!==0?e=!1:(Gs=e=!0,(i===2||i===9||i===3||i===6)&&(i=Ea.current,i!==null&&i.tag===13&&(i.flags|=16384))),kf(t,e)):vl(t)}function vl(e){var t=e;do{if((t.flags&32768)!==0){kf(t,Gs);return}e=t.return;var a=Yg(t.alternate,t,Es);if(a!==null){tt=a;return}if(t=t.sibling,t!==null){tt=t;return}tt=t=e}while(t!==null);Lt===0&&(Lt=5)}function kf(e,t){do{var a=Kg(e.alternate,e);if(a!==null){a.flags&=32767,tt=a;return}if(a=e.return,a!==null&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!t&&(e=e.sibling,e!==null)){tt=e;return}tt=e=a}while(e!==null);Lt=6,tt=null}function Af(e,t,a,i,c,u,m,y,T){e.cancelPendingCommit=null;do wl();while(Wt!==0);if((ht&6)!==0)throw Error(o(327));if(t!==null){if(t===e.current)throw Error(o(177));if(u=t.lanes|t.childLanes,u|=yo,St(e,a,u,m,y,T),e===jt&&(tt=jt=null,st=0),an=t,Vs=e,Ts=a,Tc=u,kc=c,xf=i,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,r0(pa,function(){return Mf(),null})):(e.callbackNode=null,e.callbackPriority=0),i=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||i){i=S.T,S.T=null,c=V.p,V.p=2,m=ht,ht|=4;try{Vg(e,t,a)}finally{ht=m,V.p=c,S.T=i}}Wt=1,Of(),Cf(),Rf()}}function Of(){if(Wt===1){Wt=0;var e=Vs,t=an,a=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||a){a=S.T,S.T=null;var i=V.p;V.p=2;var c=ht;ht|=4;try{uf(t,e);var u=Pc,m=pd(e.containerInfo),y=u.focusedElem,T=u.selectionRange;if(m!==y&&y&&y.ownerDocument&&md(y.ownerDocument.documentElement,y)){if(T!==null&&mo(y)){var I=T.start,J=T.end;if(J===void 0&&(J=I),"selectionStart"in y)y.selectionStart=I,y.selectionEnd=Math.min(J,y.value.length);else{var se=y.ownerDocument||document,P=se&&se.defaultView||window;if(P.getSelection){var Y=P.getSelection(),_e=y.textContent.length,ze=Math.min(T.start,_e),vt=T.end===void 0?ze:Math.min(T.end,_e);!Y.extend&&ze>vt&&(m=vt,vt=ze,ze=m);var L=fd(y,ze),R=fd(y,vt);if(L&&R&&(Y.rangeCount!==1||Y.anchorNode!==L.node||Y.anchorOffset!==L.offset||Y.focusNode!==R.node||Y.focusOffset!==R.offset)){var H=se.createRange();H.setStart(L.node,L.offset),Y.removeAllRanges(),ze>vt?(Y.addRange(H),Y.extend(R.node,R.offset)):(H.setEnd(R.node,R.offset),Y.addRange(H))}}}}for(se=[],Y=y;Y=Y.parentNode;)Y.nodeType===1&&se.push({element:Y,left:Y.scrollLeft,top:Y.scrollTop});for(typeof y.focus=="function"&&y.focus(),y=0;y<se.length;y++){var ae=se[y];ae.element.scrollLeft=ae.left,ae.element.scrollTop=ae.top}}zl=!!qc,Pc=qc=null}finally{ht=c,V.p=i,S.T=a}}e.current=t,Wt=2}}function Cf(){if(Wt===2){Wt=0;var e=Vs,t=an,a=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||a){a=S.T,S.T=null;var i=V.p;V.p=2;var c=ht;ht|=4;try{rf(e,t.alternate,t)}finally{ht=c,V.p=i,S.T=a}}Wt=3}}function Rf(){if(Wt===4||Wt===3){Wt=0,ma();var e=Vs,t=an,a=Ts,i=xf;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?Wt=5:(Wt=0,an=Vs=null,zf(e,e.pendingLanes));var c=e.pendingLanes;if(c===0&&(Ks=null),mt(a),t=t.stateNode,B&&typeof B.onCommitFiberRoot=="function")try{B.onCommitFiberRoot(D,t,void 0,(t.current.flags&128)===128)}catch{}if(i!==null){t=S.T,c=V.p,V.p=2,S.T=null;try{for(var u=e.onRecoverableError,m=0;m<i.length;m++){var y=i[m];u(y.value,{componentStack:y.stack})}}finally{S.T=t,V.p=c}}(Ts&3)!==0&&wl(),ls(e),c=e.pendingLanes,(a&261930)!==0&&(c&42)!==0?e===Ac?ei++:(ei=0,Ac=e):ei=0,ti(0)}}function zf(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,Dn(t)))}function wl(){return Of(),Cf(),Rf(),Mf()}function Mf(){if(Wt!==5)return!1;var e=Vs,t=Tc;Tc=0;var a=mt(Ts),i=S.T,c=V.p;try{V.p=32>a?32:a,S.T=null,a=kc,kc=null;var u=Vs,m=Ts;if(Wt=0,an=Vs=null,Ts=0,(ht&6)!==0)throw Error(o(331));var y=ht;if(ht|=4,pf(u.current),hf(u,u.current,m,a),ht=y,ti(0,!1),B&&typeof B.onPostCommitFiberRoot=="function")try{B.onPostCommitFiberRoot(D,u)}catch{}return!0}finally{V.p=c,S.T=i,zf(e,t)}}function Df(e,t,a){t=Ha(a,t),t=lc(e.stateNode,t,2),e=$s(e,t,2),e!==null&&(We(e,2),ls(e))}function gt(e,t,a){if(e.tag===3)Df(e,e,a);else for(;t!==null;){if(t.tag===3){Df(t,e,a);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Ks===null||!Ks.has(i))){e=Ha(a,e),a=Dh(2),i=$s(t,a,2),i!==null&&(Uh(a,i,t,e),We(i,2),ls(i));break}}t=t.return}}function Rc(e,t,a){var i=e.pingCache;if(i===null){i=e.pingCache=new Jg;var c=new Set;i.set(t,c)}else c=i.get(t),c===void 0&&(c=new Set,i.set(t,c));c.has(a)||(Nc=!0,c.add(a),e=t0.bind(null,e,t,a),t.then(e,e))}function t0(e,t,a){var i=e.pingCache;i!==null&&i.delete(t),e.pingedLanes|=e.suspendedLanes&a,e.warmLanes&=~a,jt===e&&(st&a)===a&&(Lt===4||Lt===3&&(st&62914560)===st&&300>Zt()-pl?(ht&2)===0&&sn(e,0):Sc|=a,tn===st&&(tn=0)),ls(e)}function Uf(e,t){t===0&&(t=Nt()),e=cr(e,t),e!==null&&(We(e,t),ls(e))}function a0(e){var t=e.memoizedState,a=0;t!==null&&(a=t.retryLane),Uf(e,a)}function s0(e,t){var a=0;switch(e.tag){case 31:case 13:var i=e.stateNode,c=e.memoizedState;c!==null&&(a=c.retryLane);break;case 19:i=e.stateNode;break;case 22:i=e.stateNode._retryCache;break;default:throw Error(o(314))}i!==null&&i.delete(t),Uf(e,a)}function r0(e,t){return ha(e,t)}var jl=null,nn=null,zc=!1,_l=!1,Mc=!1,Zs=0;function ls(e){e!==nn&&e.next===null&&(nn===null?jl=nn=e:nn=nn.next=e),_l=!0,zc||(zc=!0,i0())}function ti(e,t){if(!Mc&&_l){Mc=!0;do for(var a=!1,i=jl;i!==null;){if(e!==0){var c=i.pendingLanes;if(c===0)var u=0;else{var m=i.suspendedLanes,y=i.pingedLanes;u=(1<<31-te(42|e)+1)-1,u&=c&~(m&~y),u=u&201326741?u&201326741|1:u?u|2:0}u!==0&&(a=!0,$f(i,u))}else u=st,u=me(i,i===jt?u:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),(u&3)===0||ke(i,u)||(a=!0,$f(i,u));i=i.next}while(a);Mc=!1}}function n0(){Lf()}function Lf(){_l=zc=!1;var e=0;Zs!==0&&g0()&&(e=Zs);for(var t=Zt(),a=null,i=jl;i!==null;){var c=i.next,u=Bf(i,t);u===0?(i.next=null,a===null?jl=c:a.next=c,c===null&&(nn=a)):(a=i,(e!==0||(u&3)!==0)&&(_l=!0)),i=c}Wt!==0&&Wt!==5||ti(e),Zs!==0&&(Zs=0)}function Bf(e,t){for(var a=e.suspendedLanes,i=e.pingedLanes,c=e.expirationTimes,u=e.pendingLanes&-62914561;0<u;){var m=31-te(u),y=1<<m,T=c[m];T===-1?((y&a)===0||(y&i)!==0)&&(c[m]=Re(y,t)):T<=t&&(e.expiredLanes|=y),u&=~y}if(t=jt,a=st,a=me(e,e===t?a:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),i=e.callbackNode,a===0||e===t&&(pt===2||pt===9)||e.cancelPendingCommit!==null)return i!==null&&i!==null&&fa(i),e.callbackNode=null,e.callbackPriority=0;if((a&3)===0||ke(e,a)){if(t=a&-a,t===e.callbackPriority)return t;switch(i!==null&&fa(i),mt(a)){case 2:case 8:a=Ei;break;case 32:a=pa;break;case 268435456:a=Ti;break;default:a=pa}return i=Hf.bind(null,e),a=ha(a,i),e.callbackPriority=t,e.callbackNode=a,t}return i!==null&&i!==null&&fa(i),e.callbackPriority=2,e.callbackNode=null,2}function Hf(e,t){if(Wt!==0&&Wt!==5)return e.callbackNode=null,e.callbackPriority=0,null;var a=e.callbackNode;if(wl()&&e.callbackNode!==a)return null;var i=st;return i=me(e,e===jt?i:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),i===0?null:(vf(e,i,t),Bf(e,Zt()),e.callbackNode!=null&&e.callbackNode===a?Hf.bind(null,e):null)}function $f(e,t){if(wl())return null;vf(e,t,!0)}function i0(){x0(function(){(ht&6)!==0?ha(Si,n0):Lf()})}function Dc(){if(Zs===0){var e=Gr;e===0&&(e=F,F<<=1,(F&261888)===0&&(F=256)),Zs=e}return Zs}function If(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Ci(""+e)}function qf(e,t){var a=t.ownerDocument.createElement("input");return a.name=t.name,a.value=t.value,e.id&&a.setAttribute("form",e.id),t.parentNode.insertBefore(a,t),e=new FormData(e),a.parentNode.removeChild(a),e}function l0(e,t,a,i,c){if(t==="submit"&&a&&a.stateNode===c){var u=If((c[Ke]||null).action),m=i.submitter;m&&(t=(t=m[Ke]||null)?If(t.formAction):m.getAttribute("formAction"),t!==null&&(u=t,m=null));var y=new Di("action","action",null,i,c);e.push({event:y,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(Zs!==0){var T=m?qf(c,m):new FormData(c);tc(a,{pending:!0,data:T,method:c.method,action:u},null,T)}}else typeof u=="function"&&(y.preventDefault(),T=m?qf(c,m):new FormData(c),tc(a,{pending:!0,data:T,method:c.method,action:u},u,T))},currentTarget:c}]})}}for(var Uc=0;Uc<xo.length;Uc++){var Lc=xo[Uc],o0=Lc.toLowerCase(),c0=Lc[0].toUpperCase()+Lc.slice(1);Za(o0,"on"+c0)}Za(xd,"onAnimationEnd"),Za(yd,"onAnimationIteration"),Za(vd,"onAnimationStart"),Za("dblclick","onDoubleClick"),Za("focusin","onFocus"),Za("focusout","onBlur"),Za(Sg,"onTransitionRun"),Za(Eg,"onTransitionStart"),Za(Tg,"onTransitionCancel"),Za(wd,"onTransitionEnd"),us("onMouseEnter",["mouseout","mouseover"]),us("onMouseLeave",["mouseout","mouseover"]),us("onPointerEnter",["pointerout","pointerover"]),us("onPointerLeave",["pointerout","pointerover"]),Xt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Xt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Xt("onBeforeInput",["compositionend","keypress","textInput","paste"]),Xt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Xt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Xt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ai="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),u0=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ai));function Pf(e,t){t=(t&4)!==0;for(var a=0;a<e.length;a++){var i=e[a],c=i.event;i=i.listeners;e:{var u=void 0;if(t)for(var m=i.length-1;0<=m;m--){var y=i[m],T=y.instance,I=y.currentTarget;if(y=y.listener,T!==u&&c.isPropagationStopped())break e;u=y,c.currentTarget=I;try{u(c)}catch(J){Bi(J)}c.currentTarget=null,u=T}else for(m=0;m<i.length;m++){if(y=i[m],T=y.instance,I=y.currentTarget,y=y.listener,T!==u&&c.isPropagationStopped())break e;u=y,c.currentTarget=I;try{u(c)}catch(J){Bi(J)}c.currentTarget=null,u=T}}}}function at(e,t){var a=t[wt];a===void 0&&(a=t[wt]=new Set);var i=e+"__bubble";a.has(i)||(Gf(t,e,2,!1),a.add(i))}function Bc(e,t,a){var i=0;t&&(i|=4),Gf(a,e,i,t)}var Nl="_reactListening"+Math.random().toString(36).slice(2);function Hc(e){if(!e[Nl]){e[Nl]=!0,ss.forEach(function(a){a!=="selectionchange"&&(u0.has(a)||Bc(a,!1,e),Bc(a,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Nl]||(t[Nl]=!0,Bc("selectionchange",!1,t))}}function Gf(e,t,a,i){switch(ym(t)){case 2:var c=B0;break;case 8:c=H0;break;default:c=eu}a=c.bind(null,t,a,e),c=void 0,!ro||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(c=!0),i?c!==void 0?e.addEventListener(t,a,{capture:!0,passive:c}):e.addEventListener(t,a,!0):c!==void 0?e.addEventListener(t,a,{passive:c}):e.addEventListener(t,a,!1)}function $c(e,t,a,i,c){var u=i;if((t&1)===0&&(t&2)===0&&i!==null)e:for(;;){if(i===null)return;var m=i.tag;if(m===3||m===4){var y=i.stateNode.containerInfo;if(y===c)break;if(m===4)for(m=i.return;m!==null;){var T=m.tag;if((T===3||T===4)&&m.stateNode.containerInfo===c)return;m=m.return}for(;y!==null;){if(m=Et(y),m===null)return;if(T=m.tag,T===5||T===6||T===26||T===27){i=u=m;continue e}y=y.parentNode}}i=i.return}Qu(function(){var I=u,J=ao(a),se=[];e:{var P=jd.get(e);if(P!==void 0){var Y=Di,_e=e;switch(e){case"keypress":if(zi(a)===0)break e;case"keydown":case"keyup":Y=sg;break;case"focusin":_e="focus",Y=oo;break;case"focusout":_e="blur",Y=oo;break;case"beforeblur":case"afterblur":Y=oo;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Y=Xu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Y=Yp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Y=ig;break;case xd:case yd:case vd:Y=Qp;break;case wd:Y=og;break;case"scroll":case"scrollend":Y=Pp;break;case"wheel":Y=ug;break;case"copy":case"cut":case"paste":Y=Jp;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Y=Fu;break;case"toggle":case"beforetoggle":Y=hg}var ze=(t&4)!==0,vt=!ze&&(e==="scroll"||e==="scrollend"),L=ze?P!==null?P+"Capture":null:P;ze=[];for(var R=I,H;R!==null;){var ae=R;if(H=ae.stateNode,ae=ae.tag,ae!==5&&ae!==26&&ae!==27||H===null||L===null||(ae=Nn(R,L),ae!=null&&ze.push(si(R,ae,H))),vt)break;R=R.return}0<ze.length&&(P=new Y(P,_e,null,a,J),se.push({event:P,listeners:ze}))}}if((t&7)===0){e:{if(P=e==="mouseover"||e==="pointerover",Y=e==="mouseout"||e==="pointerout",P&&a!==to&&(_e=a.relatedTarget||a.fromElement)&&(Et(_e)||_e[Qe]))break e;if((Y||P)&&(P=J.window===J?J:(P=J.ownerDocument)?P.defaultView||P.parentWindow:window,Y?(_e=a.relatedTarget||a.toElement,Y=I,_e=_e?Et(_e):null,_e!==null&&(vt=h(_e),ze=_e.tag,_e!==vt||ze!==5&&ze!==27&&ze!==6)&&(_e=null)):(Y=null,_e=I),Y!==_e)){if(ze=Xu,ae="onMouseLeave",L="onMouseEnter",R="mouse",(e==="pointerout"||e==="pointerover")&&(ze=Fu,ae="onPointerLeave",L="onPointerEnter",R="pointer"),vt=Y==null?P:Qa(Y),H=_e==null?P:Qa(_e),P=new ze(ae,R+"leave",Y,a,J),P.target=vt,P.relatedTarget=H,ae=null,Et(J)===I&&(ze=new ze(L,R+"enter",_e,a,J),ze.target=H,ze.relatedTarget=vt,ae=ze),vt=ae,Y&&_e)t:{for(ze=d0,L=Y,R=_e,H=0,ae=L;ae;ae=ze(ae))H++;ae=0;for(var Oe=R;Oe;Oe=ze(Oe))ae++;for(;0<H-ae;)L=ze(L),H--;for(;0<ae-H;)R=ze(R),ae--;for(;H--;){if(L===R||R!==null&&L===R.alternate){ze=L;break t}L=ze(L),R=ze(R)}ze=null}else ze=null;Y!==null&&Yf(se,P,Y,ze,!1),_e!==null&&vt!==null&&Yf(se,vt,_e,ze,!0)}}e:{if(P=I?Qa(I):window,Y=P.nodeName&&P.nodeName.toLowerCase(),Y==="select"||Y==="input"&&P.type==="file")var ot=ld;else if(nd(P))if(od)ot=jg;else{ot=vg;var Ee=yg}else Y=P.nodeName,!Y||Y.toLowerCase()!=="input"||P.type!=="checkbox"&&P.type!=="radio"?I&&eo(I.elementType)&&(ot=ld):ot=wg;if(ot&&(ot=ot(e,I))){id(se,ot,a,J);break e}Ee&&Ee(e,P,I),e==="focusout"&&I&&P.type==="number"&&I.memoizedProps.value!=null&&Fl(P,"number",P.value)}switch(Ee=I?Qa(I):window,e){case"focusin":(nd(Ee)||Ee.contentEditable==="true")&&(Ur=Ee,po=I,Rn=null);break;case"focusout":Rn=po=Ur=null;break;case"mousedown":go=!0;break;case"contextmenu":case"mouseup":case"dragend":go=!1,gd(se,a,J);break;case"selectionchange":if(Ng)break;case"keydown":case"keyup":gd(se,a,J)}var Ve;if(uo)e:{switch(e){case"compositionstart":var rt="onCompositionStart";break e;case"compositionend":rt="onCompositionEnd";break e;case"compositionupdate":rt="onCompositionUpdate";break e}rt=void 0}else Dr?sd(e,a)&&(rt="onCompositionEnd"):e==="keydown"&&a.keyCode===229&&(rt="onCompositionStart");rt&&(ed&&a.locale!=="ko"&&(Dr||rt!=="onCompositionStart"?rt==="onCompositionEnd"&&Dr&&(Ve=Zu()):(zs=J,no="value"in zs?zs.value:zs.textContent,Dr=!0)),Ee=Sl(I,rt),0<Ee.length&&(rt=new Wu(rt,e,null,a,J),se.push({event:rt,listeners:Ee}),Ve?rt.data=Ve:(Ve=rd(a),Ve!==null&&(rt.data=Ve)))),(Ve=mg?pg(e,a):gg(e,a))&&(rt=Sl(I,"onBeforeInput"),0<rt.length&&(Ee=new Wu("onBeforeInput","beforeinput",null,a,J),se.push({event:Ee,listeners:rt}),Ee.data=Ve)),l0(se,e,I,a,J)}Pf(se,t)})}function si(e,t,a){return{instance:e,listener:t,currentTarget:a}}function Sl(e,t){for(var a=t+"Capture",i=[];e!==null;){var c=e,u=c.stateNode;if(c=c.tag,c!==5&&c!==26&&c!==27||u===null||(c=Nn(e,a),c!=null&&i.unshift(si(e,c,u)),c=Nn(e,t),c!=null&&i.push(si(e,c,u))),e.tag===3)return i;e=e.return}return[]}function d0(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Yf(e,t,a,i,c){for(var u=t._reactName,m=[];a!==null&&a!==i;){var y=a,T=y.alternate,I=y.stateNode;if(y=y.tag,T!==null&&T===i)break;y!==5&&y!==26&&y!==27||I===null||(T=I,c?(I=Nn(a,u),I!=null&&m.unshift(si(a,I,T))):c||(I=Nn(a,u),I!=null&&m.push(si(a,I,T)))),a=a.return}m.length!==0&&e.push({event:t,listeners:m})}var h0=/\r\n?/g,f0=/\u0000|\uFFFD/g;function Kf(e){return(typeof e=="string"?e:""+e).replace(h0,`
`).replace(f0,"")}function Vf(e,t){return t=Kf(t),Kf(e)===t}function yt(e,t,a,i,c,u){switch(a){case"children":typeof i=="string"?t==="body"||t==="textarea"&&i===""||Rr(e,i):(typeof i=="number"||typeof i=="bigint")&&t!=="body"&&Rr(e,""+i);break;case"className":Ai(e,"class",i);break;case"tabIndex":Ai(e,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":Ai(e,a,i);break;case"style":Ku(e,i,u);break;case"data":if(t!=="object"){Ai(e,"data",i);break}case"src":case"href":if(i===""&&(t!=="a"||a!=="href")){e.removeAttribute(a);break}if(i==null||typeof i=="function"||typeof i=="symbol"||typeof i=="boolean"){e.removeAttribute(a);break}i=Ci(""+i),e.setAttribute(a,i);break;case"action":case"formAction":if(typeof i=="function"){e.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof u=="function"&&(a==="formAction"?(t!=="input"&&yt(e,t,"name",c.name,c,null),yt(e,t,"formEncType",c.formEncType,c,null),yt(e,t,"formMethod",c.formMethod,c,null),yt(e,t,"formTarget",c.formTarget,c,null)):(yt(e,t,"encType",c.encType,c,null),yt(e,t,"method",c.method,c,null),yt(e,t,"target",c.target,c,null)));if(i==null||typeof i=="symbol"||typeof i=="boolean"){e.removeAttribute(a);break}i=Ci(""+i),e.setAttribute(a,i);break;case"onClick":i!=null&&(e.onclick=hs);break;case"onScroll":i!=null&&at("scroll",e);break;case"onScrollEnd":i!=null&&at("scrollend",e);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(o(61));if(a=i.__html,a!=null){if(c.children!=null)throw Error(o(60));e.innerHTML=a}}break;case"multiple":e.multiple=i&&typeof i!="function"&&typeof i!="symbol";break;case"muted":e.muted=i&&typeof i!="function"&&typeof i!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(i==null||typeof i=="function"||typeof i=="boolean"||typeof i=="symbol"){e.removeAttribute("xlink:href");break}a=Ci(""+i),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":i!=null&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(a,""+i):e.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(a,""):e.removeAttribute(a);break;case"capture":case"download":i===!0?e.setAttribute(a,""):i!==!1&&i!=null&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(a,i):e.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":i!=null&&typeof i!="function"&&typeof i!="symbol"&&!isNaN(i)&&1<=i?e.setAttribute(a,i):e.removeAttribute(a);break;case"rowSpan":case"start":i==null||typeof i=="function"||typeof i=="symbol"||isNaN(i)?e.removeAttribute(a):e.setAttribute(a,i);break;case"popover":at("beforetoggle",e),at("toggle",e),ki(e,"popover",i);break;case"xlinkActuate":ds(e,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":ds(e,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":ds(e,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":ds(e,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":ds(e,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":ds(e,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":ds(e,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":ds(e,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":ds(e,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":ki(e,"is",i);break;case"innerText":case"textContent":break;default:(!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(a=Ip.get(a)||a,ki(e,a,i))}}function Ic(e,t,a,i,c,u){switch(a){case"style":Ku(e,i,u);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(o(61));if(a=i.__html,a!=null){if(c.children!=null)throw Error(o(60));e.innerHTML=a}}break;case"children":typeof i=="string"?Rr(e,i):(typeof i=="number"||typeof i=="bigint")&&Rr(e,""+i);break;case"onScroll":i!=null&&at("scroll",e);break;case"onScrollEnd":i!=null&&at("scrollend",e);break;case"onClick":i!=null&&(e.onclick=hs);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Rs.hasOwnProperty(a))e:{if(a[0]==="o"&&a[1]==="n"&&(c=a.endsWith("Capture"),t=a.slice(2,c?a.length-7:void 0),u=e[Ke]||null,u=u!=null?u[a]:null,typeof u=="function"&&e.removeEventListener(t,u,c),typeof i=="function")){typeof u!="function"&&u!==null&&(a in e?e[a]=null:e.hasAttribute(a)&&e.removeAttribute(a)),e.addEventListener(t,i,c);break e}a in e?e[a]=i:i===!0?e.setAttribute(a,""):ki(e,a,i)}}}function ra(e,t,a){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":at("error",e),at("load",e);var i=!1,c=!1,u;for(u in a)if(a.hasOwnProperty(u)){var m=a[u];if(m!=null)switch(u){case"src":i=!0;break;case"srcSet":c=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(o(137,t));default:yt(e,t,u,m,a,null)}}c&&yt(e,t,"srcSet",a.srcSet,a,null),i&&yt(e,t,"src",a.src,a,null);return;case"input":at("invalid",e);var y=u=m=c=null,T=null,I=null;for(i in a)if(a.hasOwnProperty(i)){var J=a[i];if(J!=null)switch(i){case"name":c=J;break;case"type":m=J;break;case"checked":T=J;break;case"defaultChecked":I=J;break;case"value":u=J;break;case"defaultValue":y=J;break;case"children":case"dangerouslySetInnerHTML":if(J!=null)throw Error(o(137,t));break;default:yt(e,t,i,J,a,null)}}qu(e,u,y,T,I,m,c,!1);return;case"select":at("invalid",e),i=m=u=null;for(c in a)if(a.hasOwnProperty(c)&&(y=a[c],y!=null))switch(c){case"value":u=y;break;case"defaultValue":m=y;break;case"multiple":i=y;default:yt(e,t,c,y,a,null)}t=u,a=m,e.multiple=!!i,t!=null?Cr(e,!!i,t,!1):a!=null&&Cr(e,!!i,a,!0);return;case"textarea":at("invalid",e),u=c=i=null;for(m in a)if(a.hasOwnProperty(m)&&(y=a[m],y!=null))switch(m){case"value":i=y;break;case"defaultValue":c=y;break;case"children":u=y;break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(o(91));break;default:yt(e,t,m,y,a,null)}Gu(e,i,c,u);return;case"option":for(T in a)if(a.hasOwnProperty(T)&&(i=a[T],i!=null))switch(T){case"selected":e.selected=i&&typeof i!="function"&&typeof i!="symbol";break;default:yt(e,t,T,i,a,null)}return;case"dialog":at("beforetoggle",e),at("toggle",e),at("cancel",e),at("close",e);break;case"iframe":case"object":at("load",e);break;case"video":case"audio":for(i=0;i<ai.length;i++)at(ai[i],e);break;case"image":at("error",e),at("load",e);break;case"details":at("toggle",e);break;case"embed":case"source":case"link":at("error",e),at("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(I in a)if(a.hasOwnProperty(I)&&(i=a[I],i!=null))switch(I){case"children":case"dangerouslySetInnerHTML":throw Error(o(137,t));default:yt(e,t,I,i,a,null)}return;default:if(eo(t)){for(J in a)a.hasOwnProperty(J)&&(i=a[J],i!==void 0&&Ic(e,t,J,i,a,void 0));return}}for(y in a)a.hasOwnProperty(y)&&(i=a[y],i!=null&&yt(e,t,y,i,a,null))}function m0(e,t,a,i){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var c=null,u=null,m=null,y=null,T=null,I=null,J=null;for(Y in a){var se=a[Y];if(a.hasOwnProperty(Y)&&se!=null)switch(Y){case"checked":break;case"value":break;case"defaultValue":T=se;default:i.hasOwnProperty(Y)||yt(e,t,Y,null,i,se)}}for(var P in i){var Y=i[P];if(se=a[P],i.hasOwnProperty(P)&&(Y!=null||se!=null))switch(P){case"type":u=Y;break;case"name":c=Y;break;case"checked":I=Y;break;case"defaultChecked":J=Y;break;case"value":m=Y;break;case"defaultValue":y=Y;break;case"children":case"dangerouslySetInnerHTML":if(Y!=null)throw Error(o(137,t));break;default:Y!==se&&yt(e,t,P,Y,i,se)}}Wl(e,m,y,T,I,J,u,c);return;case"select":Y=m=y=P=null;for(u in a)if(T=a[u],a.hasOwnProperty(u)&&T!=null)switch(u){case"value":break;case"multiple":Y=T;default:i.hasOwnProperty(u)||yt(e,t,u,null,i,T)}for(c in i)if(u=i[c],T=a[c],i.hasOwnProperty(c)&&(u!=null||T!=null))switch(c){case"value":P=u;break;case"defaultValue":y=u;break;case"multiple":m=u;default:u!==T&&yt(e,t,c,u,i,T)}t=y,a=m,i=Y,P!=null?Cr(e,!!a,P,!1):!!i!=!!a&&(t!=null?Cr(e,!!a,t,!0):Cr(e,!!a,a?[]:"",!1));return;case"textarea":Y=P=null;for(y in a)if(c=a[y],a.hasOwnProperty(y)&&c!=null&&!i.hasOwnProperty(y))switch(y){case"value":break;case"children":break;default:yt(e,t,y,null,i,c)}for(m in i)if(c=i[m],u=a[m],i.hasOwnProperty(m)&&(c!=null||u!=null))switch(m){case"value":P=c;break;case"defaultValue":Y=c;break;case"children":break;case"dangerouslySetInnerHTML":if(c!=null)throw Error(o(91));break;default:c!==u&&yt(e,t,m,c,i,u)}Pu(e,P,Y);return;case"option":for(var _e in a)if(P=a[_e],a.hasOwnProperty(_e)&&P!=null&&!i.hasOwnProperty(_e))switch(_e){case"selected":e.selected=!1;break;default:yt(e,t,_e,null,i,P)}for(T in i)if(P=i[T],Y=a[T],i.hasOwnProperty(T)&&P!==Y&&(P!=null||Y!=null))switch(T){case"selected":e.selected=P&&typeof P!="function"&&typeof P!="symbol";break;default:yt(e,t,T,P,i,Y)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ze in a)P=a[ze],a.hasOwnProperty(ze)&&P!=null&&!i.hasOwnProperty(ze)&&yt(e,t,ze,null,i,P);for(I in i)if(P=i[I],Y=a[I],i.hasOwnProperty(I)&&P!==Y&&(P!=null||Y!=null))switch(I){case"children":case"dangerouslySetInnerHTML":if(P!=null)throw Error(o(137,t));break;default:yt(e,t,I,P,i,Y)}return;default:if(eo(t)){for(var vt in a)P=a[vt],a.hasOwnProperty(vt)&&P!==void 0&&!i.hasOwnProperty(vt)&&Ic(e,t,vt,void 0,i,P);for(J in i)P=i[J],Y=a[J],!i.hasOwnProperty(J)||P===Y||P===void 0&&Y===void 0||Ic(e,t,J,P,i,Y);return}}for(var L in a)P=a[L],a.hasOwnProperty(L)&&P!=null&&!i.hasOwnProperty(L)&&yt(e,t,L,null,i,P);for(se in i)P=i[se],Y=a[se],!i.hasOwnProperty(se)||P===Y||P==null&&Y==null||yt(e,t,se,P,i,Y)}function Qf(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function p0(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,a=performance.getEntriesByType("resource"),i=0;i<a.length;i++){var c=a[i],u=c.transferSize,m=c.initiatorType,y=c.duration;if(u&&y&&Qf(m)){for(m=0,y=c.responseEnd,i+=1;i<a.length;i++){var T=a[i],I=T.startTime;if(I>y)break;var J=T.transferSize,se=T.initiatorType;J&&Qf(se)&&(T=T.responseEnd,m+=J*(T<y?1:(y-I)/(T-I)))}if(--i,t+=8*(u+m)/(c.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var qc=null,Pc=null;function El(e){return e.nodeType===9?e:e.ownerDocument}function Zf(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Jf(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function Gc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Yc=null;function g0(){var e=window.event;return e&&e.type==="popstate"?e===Yc?!1:(Yc=e,!0):(Yc=null,!1)}var Xf=typeof setTimeout=="function"?setTimeout:void 0,b0=typeof clearTimeout=="function"?clearTimeout:void 0,Wf=typeof Promise=="function"?Promise:void 0,x0=typeof queueMicrotask=="function"?queueMicrotask:typeof Wf<"u"?function(e){return Wf.resolve(null).then(e).catch(y0)}:Xf;function y0(e){setTimeout(function(){throw e})}function Js(e){return e==="head"}function Ff(e,t){var a=t,i=0;do{var c=a.nextSibling;if(e.removeChild(a),c&&c.nodeType===8)if(a=c.data,a==="/$"||a==="/&"){if(i===0){e.removeChild(c),un(t);return}i--}else if(a==="$"||a==="$?"||a==="$~"||a==="$!"||a==="&")i++;else if(a==="html")ri(e.ownerDocument.documentElement);else if(a==="head"){a=e.ownerDocument.head,ri(a);for(var u=a.firstChild;u;){var m=u.nextSibling,y=u.nodeName;u[cs]||y==="SCRIPT"||y==="STYLE"||y==="LINK"&&u.rel.toLowerCase()==="stylesheet"||a.removeChild(u),u=m}}else a==="body"&&ri(e.ownerDocument.body);a=c}while(a);un(t)}function em(e,t){var a=e;e=0;do{var i=a.nextSibling;if(a.nodeType===1?t?(a._stashedDisplay=a.style.display,a.style.display="none"):(a.style.display=a._stashedDisplay||"",a.getAttribute("style")===""&&a.removeAttribute("style")):a.nodeType===3&&(t?(a._stashedText=a.nodeValue,a.nodeValue=""):a.nodeValue=a._stashedText||""),i&&i.nodeType===8)if(a=i.data,a==="/$"){if(e===0)break;e--}else a!=="$"&&a!=="$?"&&a!=="$~"&&a!=="$!"||e++;a=i}while(a)}function Kc(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var a=t;switch(t=t.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":Kc(a),Va(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(a.rel.toLowerCase()==="stylesheet")continue}e.removeChild(a)}}function v0(e,t,a,i){for(;e.nodeType===1;){var c=a;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!i&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(i){if(!e[cs])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(u=e.getAttribute("rel"),u==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(u!==c.rel||e.getAttribute("href")!==(c.href==null||c.href===""?null:c.href)||e.getAttribute("crossorigin")!==(c.crossOrigin==null?null:c.crossOrigin)||e.getAttribute("title")!==(c.title==null?null:c.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(u=e.getAttribute("src"),(u!==(c.src==null?null:c.src)||e.getAttribute("type")!==(c.type==null?null:c.type)||e.getAttribute("crossorigin")!==(c.crossOrigin==null?null:c.crossOrigin))&&u&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var u=c.name==null?null:""+c.name;if(c.type==="hidden"&&e.getAttribute("name")===u)return e}else return e;if(e=Ga(e.nextSibling),e===null)break}return null}function w0(e,t,a){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!a||(e=Ga(e.nextSibling),e===null))return null;return e}function tm(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=Ga(e.nextSibling),e===null))return null;return e}function Vc(e){return e.data==="$?"||e.data==="$~"}function Qc(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function j0(e,t){var a=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||a.readyState!=="loading")t();else{var i=function(){t(),a.removeEventListener("DOMContentLoaded",i)};a.addEventListener("DOMContentLoaded",i),e._reactRetry=i}}function Ga(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var Zc=null;function am(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var a=e.data;if(a==="/$"||a==="/&"){if(t===0)return Ga(e.nextSibling);t--}else a!=="$"&&a!=="$!"&&a!=="$?"&&a!=="$~"&&a!=="&"||t++}e=e.nextSibling}return null}function sm(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var a=e.data;if(a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"){if(t===0)return e;t--}else a!=="/$"&&a!=="/&"||t++}e=e.previousSibling}return null}function rm(e,t,a){switch(t=El(a),e){case"html":if(e=t.documentElement,!e)throw Error(o(452));return e;case"head":if(e=t.head,!e)throw Error(o(453));return e;case"body":if(e=t.body,!e)throw Error(o(454));return e;default:throw Error(o(451))}}function ri(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Va(e)}var Ya=new Map,nm=new Set;function Tl(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var ks=V.d;V.d={f:_0,r:N0,D:S0,C:E0,L:T0,m:k0,X:O0,S:A0,M:C0};function _0(){var e=ks.f(),t=xl();return e||t}function N0(e){var t=Ct(e);t!==null&&t.tag===5&&t.type==="form"?wh(t):ks.r(e)}var ln=typeof document>"u"?null:document;function im(e,t,a){var i=ln;if(i&&typeof t=="string"&&t){var c=La(t);c='link[rel="'+e+'"][href="'+c+'"]',typeof a=="string"&&(c+='[crossorigin="'+a+'"]'),nm.has(c)||(nm.add(c),e={rel:e,crossOrigin:a,href:t},i.querySelector(c)===null&&(t=i.createElement("link"),ra(t,"link",e),bt(t),i.head.appendChild(t)))}}function S0(e){ks.D(e),im("dns-prefetch",e,null)}function E0(e,t){ks.C(e,t),im("preconnect",e,t)}function T0(e,t,a){ks.L(e,t,a);var i=ln;if(i&&e&&t){var c='link[rel="preload"][as="'+La(t)+'"]';t==="image"&&a&&a.imageSrcSet?(c+='[imagesrcset="'+La(a.imageSrcSet)+'"]',typeof a.imageSizes=="string"&&(c+='[imagesizes="'+La(a.imageSizes)+'"]')):c+='[href="'+La(e)+'"]';var u=c;switch(t){case"style":u=on(e);break;case"script":u=cn(e)}Ya.has(u)||(e=x({rel:"preload",href:t==="image"&&a&&a.imageSrcSet?void 0:e,as:t},a),Ya.set(u,e),i.querySelector(c)!==null||t==="style"&&i.querySelector(ni(u))||t==="script"&&i.querySelector(ii(u))||(t=i.createElement("link"),ra(t,"link",e),bt(t),i.head.appendChild(t)))}}function k0(e,t){ks.m(e,t);var a=ln;if(a&&e){var i=t&&typeof t.as=="string"?t.as:"script",c='link[rel="modulepreload"][as="'+La(i)+'"][href="'+La(e)+'"]',u=c;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":u=cn(e)}if(!Ya.has(u)&&(e=x({rel:"modulepreload",href:e},t),Ya.set(u,e),a.querySelector(c)===null)){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(ii(u)))return}i=a.createElement("link"),ra(i,"link",e),bt(i),a.head.appendChild(i)}}}function A0(e,t,a){ks.S(e,t,a);var i=ln;if(i&&e){var c=_a(i).hoistableStyles,u=on(e);t=t||"default";var m=c.get(u);if(!m){var y={loading:0,preload:null};if(m=i.querySelector(ni(u)))y.loading=5;else{e=x({rel:"stylesheet",href:e,"data-precedence":t},a),(a=Ya.get(u))&&Jc(e,a);var T=m=i.createElement("link");bt(T),ra(T,"link",e),T._p=new Promise(function(I,J){T.onload=I,T.onerror=J}),T.addEventListener("load",function(){y.loading|=1}),T.addEventListener("error",function(){y.loading|=2}),y.loading|=4,kl(m,t,i)}m={type:"stylesheet",instance:m,count:1,state:y},c.set(u,m)}}}function O0(e,t){ks.X(e,t);var a=ln;if(a&&e){var i=_a(a).hoistableScripts,c=cn(e),u=i.get(c);u||(u=a.querySelector(ii(c)),u||(e=x({src:e,async:!0},t),(t=Ya.get(c))&&Xc(e,t),u=a.createElement("script"),bt(u),ra(u,"link",e),a.head.appendChild(u)),u={type:"script",instance:u,count:1,state:null},i.set(c,u))}}function C0(e,t){ks.M(e,t);var a=ln;if(a&&e){var i=_a(a).hoistableScripts,c=cn(e),u=i.get(c);u||(u=a.querySelector(ii(c)),u||(e=x({src:e,async:!0,type:"module"},t),(t=Ya.get(c))&&Xc(e,t),u=a.createElement("script"),bt(u),ra(u,"link",e),a.head.appendChild(u)),u={type:"script",instance:u,count:1,state:null},i.set(c,u))}}function lm(e,t,a,i){var c=(c=Le.current)?Tl(c):null;if(!c)throw Error(o(446));switch(e){case"meta":case"title":return null;case"style":return typeof a.precedence=="string"&&typeof a.href=="string"?(t=on(a.href),a=_a(c).hoistableStyles,i=a.get(t),i||(i={type:"style",instance:null,count:0,state:null},a.set(t,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if(a.rel==="stylesheet"&&typeof a.href=="string"&&typeof a.precedence=="string"){e=on(a.href);var u=_a(c).hoistableStyles,m=u.get(e);if(m||(c=c.ownerDocument||c,m={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,m),(u=c.querySelector(ni(e)))&&!u._p&&(m.instance=u,m.state.loading=5),Ya.has(e)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},Ya.set(e,a),u||R0(c,e,a,m.state))),t&&i===null)throw Error(o(528,""));return m}if(t&&i!==null)throw Error(o(529,""));return null;case"script":return t=a.async,a=a.src,typeof a=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=cn(a),a=_a(c).hoistableScripts,i=a.get(t),i||(i={type:"script",instance:null,count:0,state:null},a.set(t,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(o(444,e))}}function on(e){return'href="'+La(e)+'"'}function ni(e){return'link[rel="stylesheet"]['+e+"]"}function om(e){return x({},e,{"data-precedence":e.precedence,precedence:null})}function R0(e,t,a,i){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?i.loading=1:(t=e.createElement("link"),i.preload=t,t.addEventListener("load",function(){return i.loading|=1}),t.addEventListener("error",function(){return i.loading|=2}),ra(t,"link",a),bt(t),e.head.appendChild(t))}function cn(e){return'[src="'+La(e)+'"]'}function ii(e){return"script[async]"+e}function cm(e,t,a){if(t.count++,t.instance===null)switch(t.type){case"style":var i=e.querySelector('style[data-href~="'+La(a.href)+'"]');if(i)return t.instance=i,bt(i),i;var c=x({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return i=(e.ownerDocument||e).createElement("style"),bt(i),ra(i,"style",c),kl(i,a.precedence,e),t.instance=i;case"stylesheet":c=on(a.href);var u=e.querySelector(ni(c));if(u)return t.state.loading|=4,t.instance=u,bt(u),u;i=om(a),(c=Ya.get(c))&&Jc(i,c),u=(e.ownerDocument||e).createElement("link"),bt(u);var m=u;return m._p=new Promise(function(y,T){m.onload=y,m.onerror=T}),ra(u,"link",i),t.state.loading|=4,kl(u,a.precedence,e),t.instance=u;case"script":return u=cn(a.src),(c=e.querySelector(ii(u)))?(t.instance=c,bt(c),c):(i=a,(c=Ya.get(u))&&(i=x({},a),Xc(i,c)),e=e.ownerDocument||e,c=e.createElement("script"),bt(c),ra(c,"link",i),e.head.appendChild(c),t.instance=c);case"void":return null;default:throw Error(o(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(i=t.instance,t.state.loading|=4,kl(i,a.precedence,e));return t.instance}function kl(e,t,a){for(var i=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),c=i.length?i[i.length-1]:null,u=c,m=0;m<i.length;m++){var y=i[m];if(y.dataset.precedence===t)u=y;else if(u!==c)break}u?u.parentNode.insertBefore(e,u.nextSibling):(t=a.nodeType===9?a.head:a,t.insertBefore(e,t.firstChild))}function Jc(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Xc(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var Al=null;function um(e,t,a){if(Al===null){var i=new Map,c=Al=new Map;c.set(a,i)}else c=Al,i=c.get(a),i||(i=new Map,c.set(a,i));if(i.has(e))return i;for(i.set(e,null),a=a.getElementsByTagName(e),c=0;c<a.length;c++){var u=a[c];if(!(u[cs]||u[et]||e==="link"&&u.getAttribute("rel")==="stylesheet")&&u.namespaceURI!=="http://www.w3.org/2000/svg"){var m=u.getAttribute(t)||"";m=e+m;var y=i.get(m);y?y.push(u):i.set(m,[u])}}return i}function dm(e,t,a){e=e.ownerDocument||e,e.head.insertBefore(a,t==="title"?e.querySelector("head > title"):null)}function z0(e,t,a){if(a===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function hm(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function M0(e,t,a,i){if(a.type==="stylesheet"&&(typeof i.media!="string"||matchMedia(i.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var c=on(i.href),u=t.querySelector(ni(c));if(u){t=u._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=Ol.bind(e),t.then(e,e)),a.state.loading|=4,a.instance=u,bt(u);return}u=t.ownerDocument||t,i=om(i),(c=Ya.get(c))&&Jc(i,c),u=u.createElement("link"),bt(u);var m=u;m._p=new Promise(function(y,T){m.onload=y,m.onerror=T}),ra(u,"link",i),a.instance=u}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(a,t),(t=a.state.preload)&&(a.state.loading&3)===0&&(e.count++,a=Ol.bind(e),t.addEventListener("load",a),t.addEventListener("error",a))}}var Wc=0;function D0(e,t){return e.stylesheets&&e.count===0&&Rl(e,e.stylesheets),0<e.count||0<e.imgCount?function(a){var i=setTimeout(function(){if(e.stylesheets&&Rl(e,e.stylesheets),e.unsuspend){var u=e.unsuspend;e.unsuspend=null,u()}},6e4+t);0<e.imgBytes&&Wc===0&&(Wc=62500*p0());var c=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&Rl(e,e.stylesheets),e.unsuspend)){var u=e.unsuspend;e.unsuspend=null,u()}},(e.imgBytes>Wc?50:800)+t);return e.unsuspend=a,function(){e.unsuspend=null,clearTimeout(i),clearTimeout(c)}}:null}function Ol(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Rl(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Cl=null;function Rl(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Cl=new Map,t.forEach(U0,e),Cl=null,Ol.call(e))}function U0(e,t){if(!(t.state.loading&4)){var a=Cl.get(e);if(a)var i=a.get(null);else{a=new Map,Cl.set(e,a);for(var c=e.querySelectorAll("link[data-precedence],style[data-precedence]"),u=0;u<c.length;u++){var m=c[u];(m.nodeName==="LINK"||m.getAttribute("media")!=="not all")&&(a.set(m.dataset.precedence,m),i=m)}i&&a.set(null,i)}c=t.instance,m=c.getAttribute("data-precedence"),u=a.get(m)||i,u===i&&a.set(null,c),a.set(m,c),this.count++,i=Ol.bind(this),c.addEventListener("load",i),c.addEventListener("error",i),u?u.parentNode.insertBefore(c,u.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(c,e.firstChild)),t.state.loading|=4}}var li={$$typeof:_,Provider:null,Consumer:null,_currentValue:ne,_currentValue2:ne,_threadCount:0};function L0(e,t,a,i,c,u,m,y,T){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=dt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=dt(0),this.hiddenUpdates=dt(null),this.identifierPrefix=i,this.onUncaughtError=c,this.onCaughtError=u,this.onRecoverableError=m,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=T,this.incompleteTransitions=new Map}function fm(e,t,a,i,c,u,m,y,T,I,J,se){return e=new L0(e,t,a,m,T,I,J,se,y),t=1,u===!0&&(t|=24),u=Sa(3,null,null,t),e.current=u,u.stateNode=e,t=Co(),t.refCount++,e.pooledCache=t,t.refCount++,u.memoizedState={element:i,isDehydrated:a,cache:t},Do(u),e}function mm(e){return e?(e=Hr,e):Hr}function pm(e,t,a,i,c,u){c=mm(c),i.context===null?i.context=c:i.pendingContext=c,i=Hs(t),i.payload={element:a},u=u===void 0?null:u,u!==null&&(i.callback=u),a=$s(e,i,t),a!==null&&(wa(a,e,t),Hn(a,e,t))}function gm(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var a=e.retryLane;e.retryLane=a!==0&&a<t?a:t}}function Fc(e,t){gm(e,t),(e=e.alternate)&&gm(e,t)}function bm(e){if(e.tag===13||e.tag===31){var t=cr(e,67108864);t!==null&&wa(t,e,67108864),Fc(e,67108864)}}function xm(e){if(e.tag===13||e.tag===31){var t=Oa();t=At(t);var a=cr(e,t);a!==null&&wa(a,e,t),Fc(e,t)}}var zl=!0;function B0(e,t,a,i){var c=S.T;S.T=null;var u=V.p;try{V.p=2,eu(e,t,a,i)}finally{V.p=u,S.T=c}}function H0(e,t,a,i){var c=S.T;S.T=null;var u=V.p;try{V.p=8,eu(e,t,a,i)}finally{V.p=u,S.T=c}}function eu(e,t,a,i){if(zl){var c=tu(i);if(c===null)$c(e,t,i,Ml,a),vm(e,i);else if(I0(c,e,t,a,i))i.stopPropagation();else if(vm(e,i),t&4&&-1<$0.indexOf(e)){for(;c!==null;){var u=Ct(c);if(u!==null)switch(u.tag){case 3:if(u=u.stateNode,u.current.memoizedState.isDehydrated){var m=W(u.pendingLanes);if(m!==0){var y=u;for(y.pendingLanes|=2,y.entangledLanes|=2;m;){var T=1<<31-te(m);y.entanglements[1]|=T,m&=~T}ls(u),(ht&6)===0&&(gl=Zt()+500,ti(0))}}break;case 31:case 13:y=cr(u,2),y!==null&&wa(y,u,2),xl(),Fc(u,2)}if(u=tu(i),u===null&&$c(e,t,i,Ml,a),u===c)break;c=u}c!==null&&i.stopPropagation()}else $c(e,t,i,null,a)}}function tu(e){return e=ao(e),au(e)}var Ml=null;function au(e){if(Ml=null,e=Et(e),e!==null){var t=h(e);if(t===null)e=null;else{var a=t.tag;if(a===13){if(e=f(t),e!==null)return e;e=null}else if(a===31){if(e=b(t),e!==null)return e;e=null}else if(a===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Ml=e,null}function ym(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Or()){case Si:return 2;case Ei:return 8;case pa:case _n:return 32;case Ti:return 268435456;default:return 32}default:return 32}}var su=!1,Xs=null,Ws=null,Fs=null,oi=new Map,ci=new Map,er=[],$0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function vm(e,t){switch(e){case"focusin":case"focusout":Xs=null;break;case"dragenter":case"dragleave":Ws=null;break;case"mouseover":case"mouseout":Fs=null;break;case"pointerover":case"pointerout":oi.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ci.delete(t.pointerId)}}function ui(e,t,a,i,c,u){return e===null||e.nativeEvent!==u?(e={blockedOn:t,domEventName:a,eventSystemFlags:i,nativeEvent:u,targetContainers:[c]},t!==null&&(t=Ct(t),t!==null&&bm(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,c!==null&&t.indexOf(c)===-1&&t.push(c),e)}function I0(e,t,a,i,c){switch(t){case"focusin":return Xs=ui(Xs,e,t,a,i,c),!0;case"dragenter":return Ws=ui(Ws,e,t,a,i,c),!0;case"mouseover":return Fs=ui(Fs,e,t,a,i,c),!0;case"pointerover":var u=c.pointerId;return oi.set(u,ui(oi.get(u)||null,e,t,a,i,c)),!0;case"gotpointercapture":return u=c.pointerId,ci.set(u,ui(ci.get(u)||null,e,t,a,i,c)),!0}return!1}function wm(e){var t=Et(e.target);if(t!==null){var a=h(t);if(a!==null){if(t=a.tag,t===13){if(t=f(a),t!==null){e.blockedOn=t,ve(e.priority,function(){xm(a)});return}}else if(t===31){if(t=b(a),t!==null){e.blockedOn=t,ve(e.priority,function(){xm(a)});return}}else if(t===3&&a.stateNode.current.memoizedState.isDehydrated){e.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Dl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var a=tu(e.nativeEvent);if(a===null){a=e.nativeEvent;var i=new a.constructor(a.type,a);to=i,a.target.dispatchEvent(i),to=null}else return t=Ct(a),t!==null&&bm(t),e.blockedOn=a,!1;t.shift()}return!0}function jm(e,t,a){Dl(e)&&a.delete(t)}function q0(){su=!1,Xs!==null&&Dl(Xs)&&(Xs=null),Ws!==null&&Dl(Ws)&&(Ws=null),Fs!==null&&Dl(Fs)&&(Fs=null),oi.forEach(jm),ci.forEach(jm)}function Ul(e,t){e.blockedOn===t&&(e.blockedOn=null,su||(su=!0,l.unstable_scheduleCallback(l.unstable_NormalPriority,q0)))}var Ll=null;function _m(e){Ll!==e&&(Ll=e,l.unstable_scheduleCallback(l.unstable_NormalPriority,function(){Ll===e&&(Ll=null);for(var t=0;t<e.length;t+=3){var a=e[t],i=e[t+1],c=e[t+2];if(typeof i!="function"){if(au(i||a)===null)continue;break}var u=Ct(a);u!==null&&(e.splice(t,3),t-=3,tc(u,{pending:!0,data:c,method:a.method,action:i},i,c))}}))}function un(e){function t(T){return Ul(T,e)}Xs!==null&&Ul(Xs,e),Ws!==null&&Ul(Ws,e),Fs!==null&&Ul(Fs,e),oi.forEach(t),ci.forEach(t);for(var a=0;a<er.length;a++){var i=er[a];i.blockedOn===e&&(i.blockedOn=null)}for(;0<er.length&&(a=er[0],a.blockedOn===null);)wm(a),a.blockedOn===null&&er.shift();if(a=(e.ownerDocument||e).$$reactFormReplay,a!=null)for(i=0;i<a.length;i+=3){var c=a[i],u=a[i+1],m=c[Ke]||null;if(typeof u=="function")m||_m(a);else if(m){var y=null;if(u&&u.hasAttribute("formAction")){if(c=u,m=u[Ke]||null)y=m.formAction;else if(au(c)!==null)continue}else y=m.action;typeof y=="function"?a[i+1]=y:(a.splice(i,3),i-=3),_m(a)}}}function Nm(){function e(u){u.canIntercept&&u.info==="react-transition"&&u.intercept({handler:function(){return new Promise(function(m){return c=m})},focusReset:"manual",scroll:"manual"})}function t(){c!==null&&(c(),c=null),i||setTimeout(a,20)}function a(){if(!i&&!navigation.transition){var u=navigation.currentEntry;u&&u.url!=null&&navigation.navigate(u.url,{state:u.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var i=!1,c=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(a,100),function(){i=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),c!==null&&(c(),c=null)}}}function ru(e){this._internalRoot=e}Bl.prototype.render=ru.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(o(409));var a=t.current,i=Oa();pm(a,i,e,t,null,null)},Bl.prototype.unmount=ru.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;pm(e.current,2,null,e,null,null),xl(),t[Qe]=null}};function Bl(e){this._internalRoot=e}Bl.prototype.unstable_scheduleHydration=function(e){if(e){var t=Pt();e={blockedOn:null,target:e,priority:t};for(var a=0;a<er.length&&t!==0&&t<er[a].priority;a++);er.splice(a,0,e),a===0&&wm(e)}};var Sm=s.version;if(Sm!=="19.2.3")throw Error(o(527,Sm,"19.2.3"));V.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(o(188)):(e=Object.keys(e).join(","),Error(o(268,e)));return e=p(t),e=e!==null?v(e):null,e=e===null?null:e.stateNode,e};var P0={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:S,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Hl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Hl.isDisabled&&Hl.supportsFiber)try{D=Hl.inject(P0),B=Hl}catch{}}return hi.createRoot=function(e,t){if(!d(e))throw Error(o(299));var a=!1,i="",c=Ch,u=Rh,m=zh;return t!=null&&(t.unstable_strictMode===!0&&(a=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onUncaughtError!==void 0&&(c=t.onUncaughtError),t.onCaughtError!==void 0&&(u=t.onCaughtError),t.onRecoverableError!==void 0&&(m=t.onRecoverableError)),t=fm(e,1,!1,null,null,a,i,null,c,u,m,Nm),e[Qe]=t.current,Hc(e),new ru(t)},hi.hydrateRoot=function(e,t,a){if(!d(e))throw Error(o(299));var i=!1,c="",u=Ch,m=Rh,y=zh,T=null;return a!=null&&(a.unstable_strictMode===!0&&(i=!0),a.identifierPrefix!==void 0&&(c=a.identifierPrefix),a.onUncaughtError!==void 0&&(u=a.onUncaughtError),a.onCaughtError!==void 0&&(m=a.onCaughtError),a.onRecoverableError!==void 0&&(y=a.onRecoverableError),a.formState!==void 0&&(T=a.formState)),t=fm(e,1,!0,t,a??null,i,c,T,u,m,y,Nm),t.context=mm(null),a=t.current,i=Oa(),i=At(i),c=Hs(i),c.callback=null,$s(a,c,i),a=i,t.current.lanes=a,We(t,a),ls(t),e[Qe]=t.current,Hc(e),new Bl(t)},hi.version="19.2.3",hi}var Dm;function F0(){if(Dm)return lu.exports;Dm=1;function l(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(l)}catch(s){console.error(s)}}return l(),lu.exports=W0(),lu.exports}var eb=F0();const tb=dp(eb);function Ql(l,s){var n={};for(var o in l)Object.prototype.hasOwnProperty.call(l,o)&&s.indexOf(o)<0&&(n[o]=l[o]);if(l!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,o=Object.getOwnPropertySymbols(l);d<o.length;d++)s.indexOf(o[d])<0&&Object.prototype.propertyIsEnumerable.call(l,o[d])&&(n[o[d]]=l[o[d]]);return n}function ab(l,s,n,o){function d(h){return h instanceof n?h:new n(function(f){f(h)})}return new(n||(n=Promise))(function(h,f){function b(v){try{p(o.next(v))}catch(x){f(x)}}function g(v){try{p(o.throw(v))}catch(x){f(x)}}function p(v){v.done?h(v.value):d(v.value).then(b,g)}p((o=o.apply(l,s||[])).next())})}const sb=l=>l?(...s)=>l(...s):(...s)=>fetch(...s);class zu extends Error{constructor(s,n="FunctionsError",o){super(s),this.name=n,this.context=o}}class rb extends zu{constructor(s){super("Failed to send a request to the Edge Function","FunctionsFetchError",s)}}class Um extends zu{constructor(s){super("Relay Error invoking the Edge Function","FunctionsRelayError",s)}}class Lm extends zu{constructor(s){super("Edge Function returned a non-2xx status code","FunctionsHttpError",s)}}var wu;(function(l){l.Any="any",l.ApNortheast1="ap-northeast-1",l.ApNortheast2="ap-northeast-2",l.ApSouth1="ap-south-1",l.ApSoutheast1="ap-southeast-1",l.ApSoutheast2="ap-southeast-2",l.CaCentral1="ca-central-1",l.EuCentral1="eu-central-1",l.EuWest1="eu-west-1",l.EuWest2="eu-west-2",l.EuWest3="eu-west-3",l.SaEast1="sa-east-1",l.UsEast1="us-east-1",l.UsWest1="us-west-1",l.UsWest2="us-west-2"})(wu||(wu={}));class nb{constructor(s,{headers:n={},customFetch:o,region:d=wu.Any}={}){this.url=s,this.headers=n,this.region=d,this.fetch=sb(o)}setAuth(s){this.headers.Authorization=`Bearer ${s}`}invoke(s){return ab(this,arguments,void 0,function*(n,o={}){var d;let h,f;try{const{headers:b,method:g,body:p,signal:v,timeout:x}=o;let N={},{region:j}=o;j||(j=this.region);const C=new URL(`${this.url}/${n}`);j&&j!=="any"&&(N["x-region"]=j,C.searchParams.set("forceFunctionRegion",j));let z;p&&(b&&!Object.prototype.hasOwnProperty.call(b,"Content-Type")||!b)?typeof Blob<"u"&&p instanceof Blob||p instanceof ArrayBuffer?(N["Content-Type"]="application/octet-stream",z=p):typeof p=="string"?(N["Content-Type"]="text/plain",z=p):typeof FormData<"u"&&p instanceof FormData?z=p:(N["Content-Type"]="application/json",z=JSON.stringify(p)):z=p;let M=v;x&&(f=new AbortController,h=setTimeout(()=>f.abort(),x),v?(M=f.signal,v.addEventListener("abort",()=>f.abort())):M=f.signal);const E=yield this.fetch(C.toString(),{method:g||"POST",headers:Object.assign(Object.assign(Object.assign({},N),this.headers),b),body:z,signal:M}).catch(he=>{throw new rb(he)}),O=E.headers.get("x-relay-error");if(O&&O==="true")throw new Um(E);if(!E.ok)throw new Lm(E);let _=((d=E.headers.get("Content-Type"))!==null&&d!==void 0?d:"text/plain").split(";")[0].trim(),G;return _==="application/json"?G=yield E.json():_==="application/octet-stream"||_==="application/pdf"?G=yield E.blob():_==="text/event-stream"?G=E:_==="multipart/form-data"?G=yield E.formData():G=yield E.text(),{data:G,error:null,response:E}}catch(b){return{data:null,error:b,response:b instanceof Lm||b instanceof Um?b.context:void 0}}finally{h&&clearTimeout(h)}})}}var ib=class extends Error{constructor(l){super(l.message),this.name="PostgrestError",this.details=l.details,this.hint=l.hint,this.code=l.code}},lb=class{constructor(l){var s,n;this.shouldThrowOnError=!1,this.method=l.method,this.url=l.url,this.headers=new Headers(l.headers),this.schema=l.schema,this.body=l.body,this.shouldThrowOnError=(s=l.shouldThrowOnError)!==null&&s!==void 0?s:!1,this.signal=l.signal,this.isMaybeSingle=(n=l.isMaybeSingle)!==null&&n!==void 0?n:!1,l.fetch?this.fetch=l.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(l,s){return this.headers=new Headers(this.headers),this.headers.set(l,s),this}then(l,s){var n=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const o=this.fetch;let d=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async h=>{let f=null,b=null,g=null,p=h.status,v=h.statusText;if(h.ok){var x,N;if(n.method!=="HEAD"){var j;const E=await h.text();E===""||(n.headers.get("Accept")==="text/csv"||n.headers.get("Accept")&&(!((j=n.headers.get("Accept"))===null||j===void 0)&&j.includes("application/vnd.pgrst.plan+text"))?b=E:b=JSON.parse(E))}const z=(x=n.headers.get("Prefer"))===null||x===void 0?void 0:x.match(/count=(exact|planned|estimated)/),M=(N=h.headers.get("content-range"))===null||N===void 0?void 0:N.split("/");z&&M&&M.length>1&&(g=parseInt(M[1])),n.isMaybeSingle&&n.method==="GET"&&Array.isArray(b)&&(b.length>1?(f={code:"PGRST116",details:`Results contain ${b.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},b=null,g=null,p=406,v="Not Acceptable"):b.length===1?b=b[0]:b=null)}else{var C;const z=await h.text();try{f=JSON.parse(z),Array.isArray(f)&&h.status===404&&(b=[],f=null,p=200,v="OK")}catch{h.status===404&&z===""?(p=204,v="No Content"):f={message:z}}if(f&&n.isMaybeSingle&&(!(f==null||(C=f.details)===null||C===void 0)&&C.includes("0 rows"))&&(f=null,p=200,v="OK"),f&&n.shouldThrowOnError)throw new ib(f)}return{error:f,data:b,count:g,status:p,statusText:v}});return this.shouldThrowOnError||(d=d.catch(h=>{var f;let b="";const g=h==null?void 0:h.cause;if(g){var p,v,x,N;const C=(p=g==null?void 0:g.message)!==null&&p!==void 0?p:"",z=(v=g==null?void 0:g.code)!==null&&v!==void 0?v:"";b=`${(x=h==null?void 0:h.name)!==null&&x!==void 0?x:"FetchError"}: ${h==null?void 0:h.message}`,b+=`

Caused by: ${(N=g==null?void 0:g.name)!==null&&N!==void 0?N:"Error"}: ${C}`,z&&(b+=` (${z})`),g!=null&&g.stack&&(b+=`
${g.stack}`)}else{var j;b=(j=h==null?void 0:h.stack)!==null&&j!==void 0?j:""}return{error:{message:`${(f=h==null?void 0:h.name)!==null&&f!==void 0?f:"FetchError"}: ${h==null?void 0:h.message}`,details:b,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),d.then(l,s)}returns(){return this}overrideTypes(){return this}},ob=class extends lb{select(l){let s=!1;const n=(l??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(l,{ascending:s=!0,nullsFirst:n,foreignTable:o,referencedTable:d=o}={}){const h=d?`${d}.order`:"order",f=this.url.searchParams.get(h);return this.url.searchParams.set(h,`${f?`${f},`:""}${l}.${s?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(l,{foreignTable:s,referencedTable:n=s}={}){const o=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(o,`${l}`),this}range(l,s,{foreignTable:n,referencedTable:o=n}={}){const d=typeof o>"u"?"offset":`${o}.offset`,h=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(d,`${l}`),this.url.searchParams.set(h,`${s-l+1}`),this}abortSignal(l){return this.signal=l,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:l=!1,verbose:s=!1,settings:n=!1,buffers:o=!1,wal:d=!1,format:h="text"}={}){var f;const b=[l?"analyze":null,s?"verbose":null,n?"settings":null,o?"buffers":null,d?"wal":null].filter(Boolean).join("|"),g=(f=this.headers.get("Accept"))!==null&&f!==void 0?f:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${h}; for="${g}"; options=${b};`),h==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(l){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${l}`),this}};const Bm=new RegExp("[,()]");var xn=class extends ob{eq(l,s){return this.url.searchParams.append(l,`eq.${s}`),this}neq(l,s){return this.url.searchParams.append(l,`neq.${s}`),this}gt(l,s){return this.url.searchParams.append(l,`gt.${s}`),this}gte(l,s){return this.url.searchParams.append(l,`gte.${s}`),this}lt(l,s){return this.url.searchParams.append(l,`lt.${s}`),this}lte(l,s){return this.url.searchParams.append(l,`lte.${s}`),this}like(l,s){return this.url.searchParams.append(l,`like.${s}`),this}likeAllOf(l,s){return this.url.searchParams.append(l,`like(all).{${s.join(",")}}`),this}likeAnyOf(l,s){return this.url.searchParams.append(l,`like(any).{${s.join(",")}}`),this}ilike(l,s){return this.url.searchParams.append(l,`ilike.${s}`),this}ilikeAllOf(l,s){return this.url.searchParams.append(l,`ilike(all).{${s.join(",")}}`),this}ilikeAnyOf(l,s){return this.url.searchParams.append(l,`ilike(any).{${s.join(",")}}`),this}regexMatch(l,s){return this.url.searchParams.append(l,`match.${s}`),this}regexIMatch(l,s){return this.url.searchParams.append(l,`imatch.${s}`),this}is(l,s){return this.url.searchParams.append(l,`is.${s}`),this}isDistinct(l,s){return this.url.searchParams.append(l,`isdistinct.${s}`),this}in(l,s){const n=Array.from(new Set(s)).map(o=>typeof o=="string"&&Bm.test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(l,`in.(${n})`),this}notIn(l,s){const n=Array.from(new Set(s)).map(o=>typeof o=="string"&&Bm.test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(l,`not.in.(${n})`),this}contains(l,s){return typeof s=="string"?this.url.searchParams.append(l,`cs.${s}`):Array.isArray(s)?this.url.searchParams.append(l,`cs.{${s.join(",")}}`):this.url.searchParams.append(l,`cs.${JSON.stringify(s)}`),this}containedBy(l,s){return typeof s=="string"?this.url.searchParams.append(l,`cd.${s}`):Array.isArray(s)?this.url.searchParams.append(l,`cd.{${s.join(",")}}`):this.url.searchParams.append(l,`cd.${JSON.stringify(s)}`),this}rangeGt(l,s){return this.url.searchParams.append(l,`sr.${s}`),this}rangeGte(l,s){return this.url.searchParams.append(l,`nxl.${s}`),this}rangeLt(l,s){return this.url.searchParams.append(l,`sl.${s}`),this}rangeLte(l,s){return this.url.searchParams.append(l,`nxr.${s}`),this}rangeAdjacent(l,s){return this.url.searchParams.append(l,`adj.${s}`),this}overlaps(l,s){return typeof s=="string"?this.url.searchParams.append(l,`ov.${s}`):this.url.searchParams.append(l,`ov.{${s.join(",")}}`),this}textSearch(l,s,{config:n,type:o}={}){let d="";o==="plain"?d="pl":o==="phrase"?d="ph":o==="websearch"&&(d="w");const h=n===void 0?"":`(${n})`;return this.url.searchParams.append(l,`${d}fts${h}.${s}`),this}match(l){return Object.entries(l).forEach(([s,n])=>{this.url.searchParams.append(s,`eq.${n}`)}),this}not(l,s,n){return this.url.searchParams.append(l,`not.${s}.${n}`),this}or(l,{foreignTable:s,referencedTable:n=s}={}){const o=n?`${n}.or`:"or";return this.url.searchParams.append(o,`(${l})`),this}filter(l,s,n){return this.url.searchParams.append(l,`${s}.${n}`),this}},cb=class{constructor(l,{headers:s={},schema:n,fetch:o}){this.url=l,this.headers=new Headers(s),this.schema=n,this.fetch=o}select(l,s){const{head:n=!1,count:o}=s??{},d=n?"HEAD":"GET";let h=!1;const f=(l??"*").split("").map(b=>/\s/.test(b)&&!h?"":(b==='"'&&(h=!h),b)).join("");return this.url.searchParams.set("select",f),o&&this.headers.append("Prefer",`count=${o}`),new xn({method:d,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(l,{count:s,defaultToNull:n=!0}={}){var o;const d="POST";if(s&&this.headers.append("Prefer",`count=${s}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(l)){const h=l.reduce((f,b)=>f.concat(Object.keys(b)),[]);if(h.length>0){const f=[...new Set(h)].map(b=>`"${b}"`);this.url.searchParams.set("columns",f.join(","))}}return new xn({method:d,url:this.url,headers:this.headers,schema:this.schema,body:l,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}upsert(l,{onConflict:s,ignoreDuplicates:n=!1,count:o,defaultToNull:d=!0}={}){var h;const f="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),s!==void 0&&this.url.searchParams.set("on_conflict",s),o&&this.headers.append("Prefer",`count=${o}`),d||this.headers.append("Prefer","missing=default"),Array.isArray(l)){const b=l.reduce((g,p)=>g.concat(Object.keys(p)),[]);if(b.length>0){const g=[...new Set(b)].map(p=>`"${p}"`);this.url.searchParams.set("columns",g.join(","))}}return new xn({method:f,url:this.url,headers:this.headers,schema:this.schema,body:l,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}update(l,{count:s}={}){var n;const o="PATCH";return s&&this.headers.append("Prefer",`count=${s}`),new xn({method:o,url:this.url,headers:this.headers,schema:this.schema,body:l,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:l}={}){var s;const n="DELETE";return l&&this.headers.append("Prefer",`count=${l}`),new xn({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}},ub=class hp{constructor(s,{headers:n={},schema:o,fetch:d}={}){this.url=s,this.headers=new Headers(n),this.schemaName=o,this.fetch=d}from(s){if(!s||typeof s!="string"||s.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new cb(new URL(`${this.url}/${s}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(s){return new hp(this.url,{headers:this.headers,schema:s,fetch:this.fetch})}rpc(s,n={},{head:o=!1,get:d=!1,count:h}={}){var f;let b;const g=new URL(`${this.url}/rpc/${s}`);let p;o||d?(b=o?"HEAD":"GET",Object.entries(n).filter(([x,N])=>N!==void 0).map(([x,N])=>[x,Array.isArray(N)?`{${N.join(",")}}`:`${N}`]).forEach(([x,N])=>{g.searchParams.append(x,N)})):(b="POST",p=n);const v=new Headers(this.headers);return h&&v.set("Prefer",`count=${h}`),new xn({method:b,url:g,headers:v,schema:this.schemaName,body:p,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}};class db{constructor(){}static detectEnvironment(){var s;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((s=navigator.userAgent)===null||s===void 0)&&s.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const o=n.node,d=parseInt(o.replace(/^v/,"").split(".")[0]);return d>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${d} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${d} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const s=this.detectEnvironment();if(s.constructor)return s.constructor;let n=s.error||"WebSocket not supported in this environment.";throw s.workaround&&(n+=`

Suggested solution: ${s.workaround}`),new Error(n)}static createWebSocket(s,n){const o=this.getWebSocketConstructor();return new o(s,n)}static isWebSocketSupported(){try{const s=this.detectEnvironment();return s.type==="native"||s.type==="ws"}catch{return!1}}}const hb="2.89.0",fb=`realtime-js/${hb}`,fp="1.0.0",mb="2.0.0",Hm=fp,ju=1e4,pb=1e3,gb=100;var sr;(function(l){l[l.connecting=0]="connecting",l[l.open=1]="open",l[l.closing=2]="closing",l[l.closed=3]="closed"})(sr||(sr={}));var Ft;(function(l){l.closed="closed",l.errored="errored",l.joined="joined",l.joining="joining",l.leaving="leaving"})(Ft||(Ft={}));var es;(function(l){l.close="phx_close",l.error="phx_error",l.join="phx_join",l.reply="phx_reply",l.leave="phx_leave",l.access_token="access_token"})(es||(es={}));var _u;(function(l){l.websocket="websocket"})(_u||(_u={}));var Sr;(function(l){l.Connecting="connecting",l.Open="open",l.Closing="closing",l.Closed="closed"})(Sr||(Sr={}));class bb{constructor(s){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=s??[]}encode(s,n){if(s.event===this.BROADCAST_EVENT&&!(s.payload instanceof ArrayBuffer)&&typeof s.payload.event=="string")return n(this._binaryEncodeUserBroadcastPush(s));let o=[s.join_ref,s.ref,s.topic,s.event,s.payload];return n(JSON.stringify(o))}_binaryEncodeUserBroadcastPush(s){var n;return this._isArrayBuffer((n=s.payload)===null||n===void 0?void 0:n.payload)?this._encodeBinaryUserBroadcastPush(s):this._encodeJsonUserBroadcastPush(s)}_encodeBinaryUserBroadcastPush(s){var n,o;const d=(o=(n=s.payload)===null||n===void 0?void 0:n.payload)!==null&&o!==void 0?o:new ArrayBuffer(0);return this._encodeUserBroadcastPush(s,this.BINARY_ENCODING,d)}_encodeJsonUserBroadcastPush(s){var n,o;const d=(o=(n=s.payload)===null||n===void 0?void 0:n.payload)!==null&&o!==void 0?o:{},f=new TextEncoder().encode(JSON.stringify(d)).buffer;return this._encodeUserBroadcastPush(s,this.JSON_ENCODING,f)}_encodeUserBroadcastPush(s,n,o){var d,h;const f=s.topic,b=(d=s.ref)!==null&&d!==void 0?d:"",g=(h=s.join_ref)!==null&&h!==void 0?h:"",p=s.payload.event,v=this.allowedMetadataKeys?this._pick(s.payload,this.allowedMetadataKeys):{},x=Object.keys(v).length===0?"":JSON.stringify(v);if(g.length>255)throw new Error(`joinRef length ${g.length} exceeds maximum of 255`);if(b.length>255)throw new Error(`ref length ${b.length} exceeds maximum of 255`);if(f.length>255)throw new Error(`topic length ${f.length} exceeds maximum of 255`);if(p.length>255)throw new Error(`userEvent length ${p.length} exceeds maximum of 255`);if(x.length>255)throw new Error(`metadata length ${x.length} exceeds maximum of 255`);const N=this.USER_BROADCAST_PUSH_META_LENGTH+g.length+b.length+f.length+p.length+x.length,j=new ArrayBuffer(this.HEADER_LENGTH+N);let C=new DataView(j),z=0;C.setUint8(z++,this.KINDS.userBroadcastPush),C.setUint8(z++,g.length),C.setUint8(z++,b.length),C.setUint8(z++,f.length),C.setUint8(z++,p.length),C.setUint8(z++,x.length),C.setUint8(z++,n),Array.from(g,E=>C.setUint8(z++,E.charCodeAt(0))),Array.from(b,E=>C.setUint8(z++,E.charCodeAt(0))),Array.from(f,E=>C.setUint8(z++,E.charCodeAt(0))),Array.from(p,E=>C.setUint8(z++,E.charCodeAt(0))),Array.from(x,E=>C.setUint8(z++,E.charCodeAt(0)));var M=new Uint8Array(j.byteLength+o.byteLength);return M.set(new Uint8Array(j),0),M.set(new Uint8Array(o),j.byteLength),M.buffer}decode(s,n){if(this._isArrayBuffer(s)){let o=this._binaryDecode(s);return n(o)}if(typeof s=="string"){const o=JSON.parse(s),[d,h,f,b,g]=o;return n({join_ref:d,ref:h,topic:f,event:b,payload:g})}return n({})}_binaryDecode(s){const n=new DataView(s),o=n.getUint8(0),d=new TextDecoder;switch(o){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(s,n,d)}}_decodeUserBroadcast(s,n,o){const d=n.getUint8(1),h=n.getUint8(2),f=n.getUint8(3),b=n.getUint8(4);let g=this.HEADER_LENGTH+4;const p=o.decode(s.slice(g,g+d));g=g+d;const v=o.decode(s.slice(g,g+h));g=g+h;const x=o.decode(s.slice(g,g+f));g=g+f;const N=s.slice(g,s.byteLength),j=b===this.JSON_ENCODING?JSON.parse(o.decode(N)):N,C={type:this.BROADCAST_EVENT,event:v,payload:j};return f>0&&(C.meta=JSON.parse(x)),{join_ref:null,ref:null,topic:p,event:this.BROADCAST_EVENT,payload:C}}_isArrayBuffer(s){var n;return s instanceof ArrayBuffer||((n=s==null?void 0:s.constructor)===null||n===void 0?void 0:n.name)==="ArrayBuffer"}_pick(s,n){return!s||typeof s!="object"?{}:Object.fromEntries(Object.entries(s).filter(([o])=>n.includes(o)))}}class mp{constructor(s,n){this.callback=s,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=s,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var _t;(function(l){l.abstime="abstime",l.bool="bool",l.date="date",l.daterange="daterange",l.float4="float4",l.float8="float8",l.int2="int2",l.int4="int4",l.int4range="int4range",l.int8="int8",l.int8range="int8range",l.json="json",l.jsonb="jsonb",l.money="money",l.numeric="numeric",l.oid="oid",l.reltime="reltime",l.text="text",l.time="time",l.timestamp="timestamp",l.timestamptz="timestamptz",l.timetz="timetz",l.tsrange="tsrange",l.tstzrange="tstzrange"})(_t||(_t={}));const $m=(l,s,n={})=>{var o;const d=(o=n.skipTypes)!==null&&o!==void 0?o:[];return s?Object.keys(s).reduce((h,f)=>(h[f]=xb(f,l,s,d),h),{}):{}},xb=(l,s,n,o)=>{const d=s.find(b=>b.name===l),h=d==null?void 0:d.type,f=n[l];return h&&!o.includes(h)?pp(h,f):Nu(f)},pp=(l,s)=>{if(l.charAt(0)==="_"){const n=l.slice(1,l.length);return jb(s,n)}switch(l){case _t.bool:return yb(s);case _t.float4:case _t.float8:case _t.int2:case _t.int4:case _t.int8:case _t.numeric:case _t.oid:return vb(s);case _t.json:case _t.jsonb:return wb(s);case _t.timestamp:return _b(s);case _t.abstime:case _t.date:case _t.daterange:case _t.int4range:case _t.int8range:case _t.money:case _t.reltime:case _t.text:case _t.time:case _t.timestamptz:case _t.timetz:case _t.tsrange:case _t.tstzrange:return Nu(s);default:return Nu(s)}},Nu=l=>l,yb=l=>{switch(l){case"t":return!0;case"f":return!1;default:return l}},vb=l=>{if(typeof l=="string"){const s=parseFloat(l);if(!Number.isNaN(s))return s}return l},wb=l=>{if(typeof l=="string")try{return JSON.parse(l)}catch{return l}return l},jb=(l,s)=>{if(typeof l!="string")return l;const n=l.length-1,o=l[n];if(l[0]==="{"&&o==="}"){let h;const f=l.slice(1,n);try{h=JSON.parse("["+f+"]")}catch{h=f?f.split(","):[]}return h.map(b=>pp(s,b))}return l},_b=l=>typeof l=="string"?l.replace(" ","T"):l,gp=l=>{const s=new URL(l);return s.protocol=s.protocol.replace(/^ws/i,"http"),s.pathname=s.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),s.pathname===""||s.pathname==="/"?s.pathname="/api/broadcast":s.pathname=s.pathname+"/api/broadcast",s.href};class du{constructor(s,n,o={},d=ju){this.channel=s,this.event=n,this.payload=o,this.timeout=d,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(s){this.timeout=s,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(s){this.payload=Object.assign(Object.assign({},this.payload),s)}receive(s,n){var o;return this._hasReceived(s)&&n((o=this.receivedResp)===null||o===void 0?void 0:o.response),this.recHooks.push({status:s,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const s=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},s),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(s,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:s,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:s,response:n}){this.recHooks.filter(o=>o.status===s).forEach(o=>o.callback(n))}_hasReceived(s){return this.receivedResp&&this.receivedResp.status===s}}var Im;(function(l){l.SYNC="sync",l.JOIN="join",l.LEAVE="leave"})(Im||(Im={}));class pi{constructor(s,n){this.channel=s,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const o=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(o.state,{},d=>{const{onJoin:h,onLeave:f,onSync:b}=this.caller;this.joinRef=this.channel._joinRef(),this.state=pi.syncState(this.state,d,h,f),this.pendingDiffs.forEach(g=>{this.state=pi.syncDiff(this.state,g,h,f)}),this.pendingDiffs=[],b()}),this.channel._on(o.diff,{},d=>{const{onJoin:h,onLeave:f,onSync:b}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(d):(this.state=pi.syncDiff(this.state,d,h,f),b())}),this.onJoin((d,h,f)=>{this.channel._trigger("presence",{event:"join",key:d,currentPresences:h,newPresences:f})}),this.onLeave((d,h,f)=>{this.channel._trigger("presence",{event:"leave",key:d,currentPresences:h,leftPresences:f})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(s,n,o,d){const h=this.cloneDeep(s),f=this.transformState(n),b={},g={};return this.map(h,(p,v)=>{f[p]||(g[p]=v)}),this.map(f,(p,v)=>{const x=h[p];if(x){const N=v.map(M=>M.presence_ref),j=x.map(M=>M.presence_ref),C=v.filter(M=>j.indexOf(M.presence_ref)<0),z=x.filter(M=>N.indexOf(M.presence_ref)<0);C.length>0&&(b[p]=C),z.length>0&&(g[p]=z)}else b[p]=v}),this.syncDiff(h,{joins:b,leaves:g},o,d)}static syncDiff(s,n,o,d){const{joins:h,leaves:f}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return o||(o=()=>{}),d||(d=()=>{}),this.map(h,(b,g)=>{var p;const v=(p=s[b])!==null&&p!==void 0?p:[];if(s[b]=this.cloneDeep(g),v.length>0){const x=s[b].map(j=>j.presence_ref),N=v.filter(j=>x.indexOf(j.presence_ref)<0);s[b].unshift(...N)}o(b,v,g)}),this.map(f,(b,g)=>{let p=s[b];if(!p)return;const v=g.map(x=>x.presence_ref);p=p.filter(x=>v.indexOf(x.presence_ref)<0),s[b]=p,d(b,p,g),p.length===0&&delete s[b]}),s}static map(s,n){return Object.getOwnPropertyNames(s).map(o=>n(o,s[o]))}static transformState(s){return s=this.cloneDeep(s),Object.getOwnPropertyNames(s).reduce((n,o)=>{const d=s[o];return"metas"in d?n[o]=d.metas.map(h=>(h.presence_ref=h.phx_ref,delete h.phx_ref,delete h.phx_ref_prev,h)):n[o]=d,n},{})}static cloneDeep(s){return JSON.parse(JSON.stringify(s))}onJoin(s){this.caller.onJoin=s}onLeave(s){this.caller.onLeave=s}onSync(s){this.caller.onSync=s}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var qm;(function(l){l.ALL="*",l.INSERT="INSERT",l.UPDATE="UPDATE",l.DELETE="DELETE"})(qm||(qm={}));var gi;(function(l){l.BROADCAST="broadcast",l.PRESENCE="presence",l.POSTGRES_CHANGES="postgres_changes",l.SYSTEM="system"})(gi||(gi={}));var Os;(function(l){l.SUBSCRIBED="SUBSCRIBED",l.TIMED_OUT="TIMED_OUT",l.CLOSED="CLOSED",l.CHANNEL_ERROR="CHANNEL_ERROR"})(Os||(Os={}));class wn{constructor(s,n={config:{}},o){var d,h;if(this.topic=s,this.params=n,this.socket=o,this.bindings={},this.state=Ft.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=s.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new du(this,es.join,this.params,this.timeout),this.rejoinTimer=new mp(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ft.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(f=>f.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ft.closed,this.socket._remove(this)}),this._onError(f=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,f),this.state=Ft.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ft.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",f=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,f),this.state=Ft.errored,this.rejoinTimer.scheduleTimeout())}),this._on(es.reply,{},(f,b)=>{this._trigger(this._replyEventName(b),f)}),this.presence=new pi(this),this.broadcastEndpointURL=gp(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((h=(d=this.params.config)===null||d===void 0?void 0:d.broadcast)===null||h===void 0)&&h.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(s,n=this.timeout){var o,d,h;if(this.socket.isConnected()||this.socket.connect(),this.state==Ft.closed){const{config:{broadcast:f,presence:b,private:g}}=this.params,p=(d=(o=this.bindings.postgres_changes)===null||o===void 0?void 0:o.map(j=>j.filter))!==null&&d!==void 0?d:[],v=!!this.bindings[gi.PRESENCE]&&this.bindings[gi.PRESENCE].length>0||((h=this.params.config.presence)===null||h===void 0?void 0:h.enabled)===!0,x={},N={broadcast:f,presence:Object.assign(Object.assign({},b),{enabled:v}),postgres_changes:p,private:g};this.socket.accessTokenValue&&(x.access_token=this.socket.accessTokenValue),this._onError(j=>s==null?void 0:s(Os.CHANNEL_ERROR,j)),this._onClose(()=>s==null?void 0:s(Os.CLOSED)),this.updateJoinPayload(Object.assign({config:N},x)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:j})=>{var C;if(this.socket._isManualToken()||this.socket.setAuth(),j===void 0){s==null||s(Os.SUBSCRIBED);return}else{const z=this.bindings.postgres_changes,M=(C=z==null?void 0:z.length)!==null&&C!==void 0?C:0,E=[];for(let O=0;O<M;O++){const _=z[O],{filter:{event:G,schema:he,table:Z,filter:ie}}=_,ge=j&&j[O];if(ge&&ge.event===G&&wn.isFilterValueEqual(ge.schema,he)&&wn.isFilterValueEqual(ge.table,Z)&&wn.isFilterValueEqual(ge.filter,ie))E.push(Object.assign(Object.assign({},_),{id:ge.id}));else{this.unsubscribe(),this.state=Ft.errored,s==null||s(Os.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=E,s&&s(Os.SUBSCRIBED);return}}).receive("error",j=>{this.state=Ft.errored,s==null||s(Os.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(j).join(", ")||"error")))}).receive("timeout",()=>{s==null||s(Os.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(s,n={}){return await this.send({type:"presence",event:"track",payload:s},n.timeout||this.timeout)}async untrack(s={}){return await this.send({type:"presence",event:"untrack"},s)}on(s,n,o){return this.state===Ft.joined&&s===gi.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(s,n,o)}async httpSend(s,n,o={}){var d;if(n==null)return Promise.reject("Payload is required for httpSend()");const h={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(h.Authorization=`Bearer ${this.socket.accessTokenValue}`);const f={method:"POST",headers:h,body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:n,private:this.private}]})},b=await this._fetchWithTimeout(this.broadcastEndpointURL,f,(d=o.timeout)!==null&&d!==void 0?d:this.timeout);if(b.status===202)return{success:!0};let g=b.statusText;try{const p=await b.json();g=p.error||p.message||g}catch{}return Promise.reject(new Error(g))}async send(s,n={}){var o,d;if(!this._canPush()&&s.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:h,payload:f}=s,b={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(b.Authorization=`Bearer ${this.socket.accessTokenValue}`);const g={method:"POST",headers:b,body:JSON.stringify({messages:[{topic:this.subTopic,event:h,payload:f,private:this.private}]})};try{const p=await this._fetchWithTimeout(this.broadcastEndpointURL,g,(o=n.timeout)!==null&&o!==void 0?o:this.timeout);return await((d=p.body)===null||d===void 0?void 0:d.cancel()),p.ok?"ok":"error"}catch(p){return p.name==="AbortError"?"timed out":"error"}}else return new Promise(h=>{var f,b,g;const p=this._push(s.type,s,n.timeout||this.timeout);s.type==="broadcast"&&!(!((g=(b=(f=this.params)===null||f===void 0?void 0:f.config)===null||b===void 0?void 0:b.broadcast)===null||g===void 0)&&g.ack)&&h("ok"),p.receive("ok",()=>h("ok")),p.receive("error",()=>h("error")),p.receive("timeout",()=>h("timed out"))})}updateJoinPayload(s){this.joinPush.updatePayload(s)}unsubscribe(s=this.timeout){this.state=Ft.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(es.close,"leave",this._joinRef())};this.joinPush.destroy();let o=null;return new Promise(d=>{o=new du(this,es.leave,{},s),o.receive("ok",()=>{n(),d("ok")}).receive("timeout",()=>{n(),d("timed out")}).receive("error",()=>{d("error")}),o.send(),this._canPush()||o.trigger("ok",{})}).finally(()=>{o==null||o.destroy()})}teardown(){this.pushBuffer.forEach(s=>s.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Ft.closed,this.bindings={}}async _fetchWithTimeout(s,n,o){const d=new AbortController,h=setTimeout(()=>d.abort(),o),f=await this.socket.fetch(s,Object.assign(Object.assign({},n),{signal:d.signal}));return clearTimeout(h),f}_push(s,n,o=this.timeout){if(!this.joinedOnce)throw`tried to push '${s}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let d=new du(this,s,n,o);return this._canPush()?d.send():this._addToPushBuffer(d),d}_addToPushBuffer(s){if(s.startTimeout(),this.pushBuffer.push(s),this.pushBuffer.length>gb){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(s,n,o){return n}_isMember(s){return this.topic===s}_joinRef(){return this.joinPush.ref}_trigger(s,n,o){var d,h;const f=s.toLocaleLowerCase(),{close:b,error:g,leave:p,join:v}=es;if(o&&[b,g,p,v].indexOf(f)>=0&&o!==this._joinRef())return;let N=this._onMessage(f,n,o);if(n&&!N)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(f)?(d=this.bindings.postgres_changes)===null||d===void 0||d.filter(j=>{var C,z,M;return((C=j.filter)===null||C===void 0?void 0:C.event)==="*"||((M=(z=j.filter)===null||z===void 0?void 0:z.event)===null||M===void 0?void 0:M.toLocaleLowerCase())===f}).map(j=>j.callback(N,o)):(h=this.bindings[f])===null||h===void 0||h.filter(j=>{var C,z,M,E,O,_;if(["broadcast","presence","postgres_changes"].includes(f))if("id"in j){const G=j.id,he=(C=j.filter)===null||C===void 0?void 0:C.event;return G&&((z=n.ids)===null||z===void 0?void 0:z.includes(G))&&(he==="*"||(he==null?void 0:he.toLocaleLowerCase())===((M=n.data)===null||M===void 0?void 0:M.type.toLocaleLowerCase()))}else{const G=(O=(E=j==null?void 0:j.filter)===null||E===void 0?void 0:E.event)===null||O===void 0?void 0:O.toLocaleLowerCase();return G==="*"||G===((_=n==null?void 0:n.event)===null||_===void 0?void 0:_.toLocaleLowerCase())}else return j.type.toLocaleLowerCase()===f}).map(j=>{if(typeof N=="object"&&"ids"in N){const C=N.data,{schema:z,table:M,commit_timestamp:E,type:O,errors:_}=C;N=Object.assign(Object.assign({},{schema:z,table:M,commit_timestamp:E,eventType:O,new:{},old:{},errors:_}),this._getPayloadRecords(C))}j.callback(N,o)})}_isClosed(){return this.state===Ft.closed}_isJoined(){return this.state===Ft.joined}_isJoining(){return this.state===Ft.joining}_isLeaving(){return this.state===Ft.leaving}_replyEventName(s){return`chan_reply_${s}`}_on(s,n,o){const d=s.toLocaleLowerCase(),h={type:d,filter:n,callback:o};return this.bindings[d]?this.bindings[d].push(h):this.bindings[d]=[h],this}_off(s,n){const o=s.toLocaleLowerCase();return this.bindings[o]&&(this.bindings[o]=this.bindings[o].filter(d=>{var h;return!(((h=d.type)===null||h===void 0?void 0:h.toLocaleLowerCase())===o&&wn.isEqual(d.filter,n))})),this}static isEqual(s,n){if(Object.keys(s).length!==Object.keys(n).length)return!1;for(const o in s)if(s[o]!==n[o])return!1;return!0}static isFilterValueEqual(s,n){return(s??void 0)===(n??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(s){this._on(es.close,{},s)}_onError(s){this._on(es.error,{},n=>s(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(s=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ft.joining,this.joinPush.resend(s))}_getPayloadRecords(s){const n={new:{},old:{}};return(s.type==="INSERT"||s.type==="UPDATE")&&(n.new=$m(s.columns,s.record)),(s.type==="UPDATE"||s.type==="DELETE")&&(n.old=$m(s.columns,s.old_record)),n}}const hu=()=>{},$l={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Nb=[1e3,2e3,5e3,1e4],Sb=1e4,Eb=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Tb{constructor(s,n){var o;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=ju,this.transport=null,this.heartbeatIntervalMs=$l.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=hu,this.ref=0,this.reconnectTimer=null,this.vsn=Hm,this.logger=hu,this.conn=null,this.sendBuffer=[],this.serializer=new bb,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=d=>d?(...h)=>d(...h):(...h)=>fetch(...h),!(!((o=n==null?void 0:n.params)===null||o===void 0)&&o.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${s}/${_u.websocket}`,this.httpEndpoint=gp(s),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=db.createWebSocket(this.endpointURL())}catch(s){this._setConnectionState("disconnected");const n=s.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(s,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const o=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(o),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(s?this.conn.close(s,n??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(s){const n=await s.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const s=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),s}log(s,n,o){this.logger(s,n,o)}connectionState(){switch(this.conn&&this.conn.readyState){case sr.connecting:return Sr.Connecting;case sr.open:return Sr.Open;case sr.closing:return Sr.Closing;default:return Sr.Closed}}isConnected(){return this.connectionState()===Sr.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(s,n={config:{}}){const o=`realtime:${s}`,d=this.getChannels().find(h=>h.topic===o);if(d)return d;{const h=new wn(`realtime:${s}`,n,this);return this.channels.push(h),h}}push(s){const{topic:n,event:o,payload:d,ref:h}=s,f=()=>{this.encode(s,b=>{var g;(g=this.conn)===null||g===void 0||g.send(b)})};this.log("push",`${n} ${o} (${h})`,d),this.isConnected()?f():this.sendBuffer.push(f)}async setAuth(s=null){this._authPromise=this._performAuth(s);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var s;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(s=this.conn)===null||s===void 0||s.close(pb,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},$l.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(s){this.heartbeatCallback=s}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(s=>s()),this.sendBuffer=[])}_makeRef(){let s=this.ref+1;return s===this.ref?this.ref=0:this.ref=s,this.ref.toString()}_leaveOpenTopic(s){let n=this.channels.find(o=>o.topic===s&&(o._isJoined()||o._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${s}"`),n.unsubscribe())}_remove(s){this.channels=this.channels.filter(n=>n.topic!==s.topic)}_onConnMessage(s){this.decode(s.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(p){this.log("error","error in heartbeat callback",p)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:o,event:d,payload:h,ref:f}=n,b=f?`(${f})`:"",g=h.status||"";this.log("receive",`${g} ${o} ${d} ${b}`.trim(),h),this.channels.filter(p=>p._isMember(o)).forEach(p=>p._trigger(d,h,f)),this._triggerStateCallbacks("message",n)})}_clearTimer(s){var n;s==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):s==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=s=>this._onConnError(s),this.conn.onmessage=s=>this._onConnMessage(s),this.conn.onclose=s=>this._onConnClose(s),this.conn.readyState===sr.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===sr.open||this.conn.readyState===sr.connecting)try{this.conn.close()}catch(s){this.log("error","Error closing connection",s)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(s=>s.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(n=>{this.log("error","error waiting for auth on connect",n),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const s=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(s),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this._terminateWorker()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(s){var n;this._setConnectionState("disconnected"),this.log("transport","close",s),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",s)}_onConnError(s){this._setConnectionState("disconnected"),this.log("transport",`${s}`),this._triggerChanError(),this._triggerStateCallbacks("error",s)}_triggerChanError(){this.channels.forEach(s=>s._trigger(es.error))}_appendParams(s,n){if(Object.keys(n).length===0)return s;const o=s.match(/\?/)?"&":"?",d=new URLSearchParams(n);return`${s}${o}${d}`}_workerObjectUrl(s){let n;if(s)n=s;else{const o=new Blob([Eb],{type:"application/javascript"});n=URL.createObjectURL(o)}return n}_setConnectionState(s,n=!1){this._connectionState=s,s==="connecting"?this._wasManualDisconnect=!1:s==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(s=null){let n,o=!1;if(s)n=s,o=!0;else if(this.accessToken)try{n=await this.accessToken()}catch(d){this.log("error","Error fetching access token from callback",d),n=this.accessTokenValue}else n=this.accessTokenValue;o?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(d=>{const h={access_token:n,version:fb};n&&d.updateJoinPayload(h),d.joinedOnce&&d._isJoined()&&d._push(es.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(s="general"){this._isManualToken()||this.setAuth().catch(n=>{this.log("error",`Error setting auth in ${s}`,n)})}_triggerStateCallbacks(s,n){try{this.stateChangeCallbacks[s].forEach(o=>{try{o(n)}catch(d){this.log("error",`error in ${s} callback`,d)}})}catch(o){this.log("error",`error triggering ${s} callbacks`,o)}}_setupReconnectionTimer(){this.reconnectTimer=new mp(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},$l.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(s){var n,o,d,h,f,b,g,p,v,x,N,j;switch(this.transport=(n=s==null?void 0:s.transport)!==null&&n!==void 0?n:null,this.timeout=(o=s==null?void 0:s.timeout)!==null&&o!==void 0?o:ju,this.heartbeatIntervalMs=(d=s==null?void 0:s.heartbeatIntervalMs)!==null&&d!==void 0?d:$l.HEARTBEAT_INTERVAL,this.worker=(h=s==null?void 0:s.worker)!==null&&h!==void 0?h:!1,this.accessToken=(f=s==null?void 0:s.accessToken)!==null&&f!==void 0?f:null,this.heartbeatCallback=(b=s==null?void 0:s.heartbeatCallback)!==null&&b!==void 0?b:hu,this.vsn=(g=s==null?void 0:s.vsn)!==null&&g!==void 0?g:Hm,s!=null&&s.params&&(this.params=s.params),s!=null&&s.logger&&(this.logger=s.logger),(s!=null&&s.logLevel||s!=null&&s.log_level)&&(this.logLevel=s.logLevel||s.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(p=s==null?void 0:s.reconnectAfterMs)!==null&&p!==void 0?p:(C=>Nb[C-1]||Sb),this.vsn){case fp:this.encode=(v=s==null?void 0:s.encode)!==null&&v!==void 0?v:((C,z)=>z(JSON.stringify(C))),this.decode=(x=s==null?void 0:s.decode)!==null&&x!==void 0?x:((C,z)=>z(JSON.parse(C)));break;case mb:this.encode=(N=s==null?void 0:s.encode)!==null&&N!==void 0?N:this.serializer.encode.bind(this.serializer),this.decode=(j=s==null?void 0:s.decode)!==null&&j!==void 0?j:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=s==null?void 0:s.workerUrl}}}var bi=class extends Error{constructor(l,s){var n;super(l),this.name="IcebergError",this.status=s.status,this.icebergType=s.icebergType,this.icebergCode=s.icebergCode,this.details=s.details,this.isCommitStateUnknown=s.icebergType==="CommitStateUnknownException"||[500,502,504].includes(s.status)&&((n=s.icebergType)==null?void 0:n.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function kb(l,s,n){const o=new URL(s,l);if(n)for(const[d,h]of Object.entries(n))h!==void 0&&o.searchParams.set(d,h);return o.toString()}async function Ab(l){return!l||l.type==="none"?{}:l.type==="bearer"?{Authorization:`Bearer ${l.token}`}:l.type==="header"?{[l.name]:l.value}:l.type==="custom"?await l.getHeaders():{}}function Ob(l){const s=l.fetchImpl??globalThis.fetch;return{async request({method:n,path:o,query:d,body:h,headers:f}){const b=kb(l.baseUrl,o,d),g=await Ab(l.auth),p=await s(b,{method:n,headers:{...h?{"Content-Type":"application/json"}:{},...g,...f},body:h?JSON.stringify(h):void 0}),v=await p.text(),x=(p.headers.get("content-type")||"").includes("application/json"),N=x&&v?JSON.parse(v):v;if(!p.ok){const j=x?N:void 0,C=j==null?void 0:j.error;throw new bi((C==null?void 0:C.message)??`Request failed with status ${p.status}`,{status:p.status,icebergType:C==null?void 0:C.type,icebergCode:C==null?void 0:C.code,details:j})}return{status:p.status,headers:p.headers,data:N}}}}function Il(l){return l.join("")}var Cb=class{constructor(l,s=""){this.client=l,this.prefix=s}async listNamespaces(l){const s=l?{parent:Il(l.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:s})).data.namespaces.map(o=>({namespace:o}))}async createNamespace(l,s){const n={namespace:l.namespace,properties:s==null?void 0:s.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:n})).data}async dropNamespace(l){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Il(l.namespace)}`})}async loadNamespaceMetadata(l){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Il(l.namespace)}`})).data.properties}}async namespaceExists(l){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Il(l.namespace)}`}),!0}catch(s){if(s instanceof bi&&s.status===404)return!1;throw s}}async createNamespaceIfNotExists(l,s){try{return await this.createNamespace(l,s)}catch(n){if(n instanceof bi&&n.status===409)return;throw n}}};function dn(l){return l.join("")}var Rb=class{constructor(l,s="",n){this.client=l,this.prefix=s,this.accessDelegation=n}async listTables(l){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${dn(l.namespace)}/tables`})).data.identifiers}async createTable(l,s){const n={};return this.accessDelegation&&(n["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${dn(l.namespace)}/tables`,body:s,headers:n})).data.metadata}async updateTable(l,s){const n=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${dn(l.namespace)}/tables/${l.name}`,body:s});return{"metadata-location":n.data["metadata-location"],metadata:n.data.metadata}}async dropTable(l,s){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${dn(l.namespace)}/tables/${l.name}`,query:{purgeRequested:String((s==null?void 0:s.purge)??!1)}})}async loadTable(l){const s={};return this.accessDelegation&&(s["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${dn(l.namespace)}/tables/${l.name}`,headers:s})).data.metadata}async tableExists(l){const s={};this.accessDelegation&&(s["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${dn(l.namespace)}/tables/${l.name}`,headers:s}),!0}catch(n){if(n instanceof bi&&n.status===404)return!1;throw n}}async createTableIfNotExists(l,s){try{return await this.createTable(l,s)}catch(n){if(n instanceof bi&&n.status===409)return await this.loadTable({namespace:l.namespace,name:s.name});throw n}}},zb=class{constructor(l){var o;let s="v1";l.catalogName&&(s+=`/${l.catalogName}`);const n=l.baseUrl.endsWith("/")?l.baseUrl:`${l.baseUrl}/`;this.client=Ob({baseUrl:n,auth:l.auth,fetchImpl:l.fetch}),this.accessDelegation=(o=l.accessDelegation)==null?void 0:o.join(","),this.namespaceOps=new Cb(this.client,s),this.tableOps=new Rb(this.client,s,this.accessDelegation)}async listNamespaces(l){return this.namespaceOps.listNamespaces(l)}async createNamespace(l,s){return this.namespaceOps.createNamespace(l,s)}async dropNamespace(l){await this.namespaceOps.dropNamespace(l)}async loadNamespaceMetadata(l){return this.namespaceOps.loadNamespaceMetadata(l)}async listTables(l){return this.tableOps.listTables(l)}async createTable(l,s){return this.tableOps.createTable(l,s)}async updateTable(l,s){return this.tableOps.updateTable(l,s)}async dropTable(l,s){await this.tableOps.dropTable(l,s)}async loadTable(l){return this.tableOps.loadTable(l)}async namespaceExists(l){return this.namespaceOps.namespaceExists(l)}async tableExists(l){return this.tableOps.tableExists(l)}async createNamespaceIfNotExists(l,s){return this.namespaceOps.createNamespaceIfNotExists(l,s)}async createTableIfNotExists(l,s){return this.tableOps.createTableIfNotExists(l,s)}},Zl=class extends Error{constructor(l){super(l),this.__isStorageError=!0,this.name="StorageError"}};function Rt(l){return typeof l=="object"&&l!==null&&"__isStorageError"in l}var Mb=class extends Zl{constructor(l,s,n){super(l),this.name="StorageApiError",this.status=s,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Su=class extends Zl{constructor(l,s){super(l),this.name="StorageUnknownError",this.originalError=s}};const Mu=l=>l?(...s)=>l(...s):(...s)=>fetch(...s),Db=()=>Response,Eu=l=>{if(Array.isArray(l))return l.map(n=>Eu(n));if(typeof l=="function"||l!==Object(l))return l;const s={};return Object.entries(l).forEach(([n,o])=>{const d=n.replace(/([-_][a-z])/gi,h=>h.toUpperCase().replace(/[-_]/g,""));s[d]=Eu(o)}),s},Ub=l=>{if(typeof l!="object"||l===null)return!1;const s=Object.getPrototypeOf(l);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(Symbol.toStringTag in l)&&!(Symbol.iterator in l)},Lb=l=>!l||typeof l!="string"||l.length===0||l.length>100||l.trim()!==l||l.includes("/")||l.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(l);function xi(l){"@babel/helpers - typeof";return xi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},xi(l)}function Bb(l,s){if(xi(l)!="object"||!l)return l;var n=l[Symbol.toPrimitive];if(n!==void 0){var o=n.call(l,s);if(xi(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(l)}function Hb(l){var s=Bb(l,"string");return xi(s)=="symbol"?s:s+""}function $b(l,s,n){return(s=Hb(s))in l?Object.defineProperty(l,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):l[s]=n,l}function Pm(l,s){var n=Object.keys(l);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(l);s&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(l,d).enumerable})),n.push.apply(n,o)}return n}function De(l){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?Pm(Object(n),!0).forEach(function(o){$b(l,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(n)):Pm(Object(n)).forEach(function(o){Object.defineProperty(l,o,Object.getOwnPropertyDescriptor(n,o))})}return l}const fu=l=>{var s;return l.msg||l.message||l.error_description||(typeof l.error=="string"?l.error:(s=l.error)===null||s===void 0?void 0:s.message)||JSON.stringify(l)},Ib=async(l,s,n)=>{l instanceof await Db()&&!(n!=null&&n.noResolveJson)?l.json().then(o=>{const d=l.status||500,h=(o==null?void 0:o.statusCode)||d+"";s(new Mb(fu(o),d,h))}).catch(o=>{s(new Su(fu(o),o))}):s(new Su(fu(l),l))},qb=(l,s,n,o)=>{const d={method:l,headers:(s==null?void 0:s.headers)||{}};return l==="GET"||!o?d:(Ub(o)?(d.headers=De({"Content-Type":"application/json"},s==null?void 0:s.headers),d.body=JSON.stringify(o)):d.body=o,s!=null&&s.duplex&&(d.duplex=s.duplex),De(De({},d),n))};async function Ni(l,s,n,o,d,h){return new Promise((f,b)=>{l(n,qb(s,o,d,h)).then(g=>{if(!g.ok)throw g;return o!=null&&o.noResolveJson?g:g.json()}).then(g=>f(g)).catch(g=>Ib(g,b,o))})}async function yi(l,s,n,o){return Ni(l,"GET",s,n,o)}async function Fa(l,s,n,o,d){return Ni(l,"POST",s,o,d,n)}async function Tu(l,s,n,o,d){return Ni(l,"PUT",s,o,d,n)}async function Pb(l,s,n,o){return Ni(l,"HEAD",s,De(De({},n),{},{noResolveJson:!0}),o)}async function Du(l,s,n,o,d){return Ni(l,"DELETE",s,o,d,n)}var Gb=class{constructor(l,s){this.downloadFn=l,this.shouldThrowOnError=s}then(l,s){return this.execute().then(l,s)}async execute(){var l=this;try{return{data:(await l.downloadFn()).body,error:null}}catch(s){if(l.shouldThrowOnError)throw s;if(Rt(s))return{data:null,error:s};throw s}}};let bp;bp=Symbol.toStringTag;var Yb=class{constructor(l,s){this.downloadFn=l,this.shouldThrowOnError=s,this[bp]="BlobDownloadBuilder",this.promise=null}asStream(){return new Gb(this.downloadFn,this.shouldThrowOnError)}then(l,s){return this.getPromise().then(l,s)}catch(l){return this.getPromise().catch(l)}finally(l){return this.getPromise().finally(l)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var l=this;try{return{data:await(await l.downloadFn()).blob(),error:null}}catch(s){if(l.shouldThrowOnError)throw s;if(Rt(s))return{data:null,error:s};throw s}}};const Kb={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Gm={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var Vb=class{constructor(l,s={},n,o){this.shouldThrowOnError=!1,this.url=l,this.headers=s,this.bucketId=n,this.fetch=Mu(o)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(l,s,n,o){var d=this;try{let h;const f=De(De({},Gm),o);let b=De(De({},d.headers),l==="POST"&&{"x-upsert":String(f.upsert)});const g=f.metadata;typeof Blob<"u"&&n instanceof Blob?(h=new FormData,h.append("cacheControl",f.cacheControl),g&&h.append("metadata",d.encodeMetadata(g)),h.append("",n)):typeof FormData<"u"&&n instanceof FormData?(h=n,h.has("cacheControl")||h.append("cacheControl",f.cacheControl),g&&!h.has("metadata")&&h.append("metadata",d.encodeMetadata(g))):(h=n,b["cache-control"]=`max-age=${f.cacheControl}`,b["content-type"]=f.contentType,g&&(b["x-metadata"]=d.toBase64(d.encodeMetadata(g))),(typeof ReadableStream<"u"&&h instanceof ReadableStream||h&&typeof h=="object"&&"pipe"in h&&typeof h.pipe=="function")&&!f.duplex&&(f.duplex="half")),o!=null&&o.headers&&(b=De(De({},b),o.headers));const p=d._removeEmptyFolders(s),v=d._getFinalPath(p),x=await(l=="PUT"?Tu:Fa)(d.fetch,`${d.url}/object/${v}`,h,De({headers:b},f!=null&&f.duplex?{duplex:f.duplex}:{}));return{data:{path:p,id:x.Id,fullPath:x.Key},error:null}}catch(h){if(d.shouldThrowOnError)throw h;if(Rt(h))return{data:null,error:h};throw h}}async upload(l,s,n){return this.uploadOrUpdate("POST",l,s,n)}async uploadToSignedUrl(l,s,n,o){var d=this;const h=d._removeEmptyFolders(l),f=d._getFinalPath(h),b=new URL(d.url+`/object/upload/sign/${f}`);b.searchParams.set("token",s);try{let g;const p=De({upsert:Gm.upsert},o),v=De(De({},d.headers),{"x-upsert":String(p.upsert)});return typeof Blob<"u"&&n instanceof Blob?(g=new FormData,g.append("cacheControl",p.cacheControl),g.append("",n)):typeof FormData<"u"&&n instanceof FormData?(g=n,g.append("cacheControl",p.cacheControl)):(g=n,v["cache-control"]=`max-age=${p.cacheControl}`,v["content-type"]=p.contentType),{data:{path:h,fullPath:(await Tu(d.fetch,b.toString(),g,{headers:v})).Key},error:null}}catch(g){if(d.shouldThrowOnError)throw g;if(Rt(g))return{data:null,error:g};throw g}}async createSignedUploadUrl(l,s){var n=this;try{let o=n._getFinalPath(l);const d=De({},n.headers);s!=null&&s.upsert&&(d["x-upsert"]="true");const h=await Fa(n.fetch,`${n.url}/object/upload/sign/${o}`,{},{headers:d}),f=new URL(n.url+h.url),b=f.searchParams.get("token");if(!b)throw new Zl("No token returned by API");return{data:{signedUrl:f.toString(),path:l,token:b},error:null}}catch(o){if(n.shouldThrowOnError)throw o;if(Rt(o))return{data:null,error:o};throw o}}async update(l,s,n){return this.uploadOrUpdate("PUT",l,s,n)}async move(l,s,n){var o=this;try{return{data:await Fa(o.fetch,`${o.url}/object/move`,{bucketId:o.bucketId,sourceKey:l,destinationKey:s,destinationBucket:n==null?void 0:n.destinationBucket},{headers:o.headers}),error:null}}catch(d){if(o.shouldThrowOnError)throw d;if(Rt(d))return{data:null,error:d};throw d}}async copy(l,s,n){var o=this;try{return{data:{path:(await Fa(o.fetch,`${o.url}/object/copy`,{bucketId:o.bucketId,sourceKey:l,destinationKey:s,destinationBucket:n==null?void 0:n.destinationBucket},{headers:o.headers})).Key},error:null}}catch(d){if(o.shouldThrowOnError)throw d;if(Rt(d))return{data:null,error:d};throw d}}async createSignedUrl(l,s,n){var o=this;try{let d=o._getFinalPath(l),h=await Fa(o.fetch,`${o.url}/object/sign/${d}`,De({expiresIn:s},n!=null&&n.transform?{transform:n.transform}:{}),{headers:o.headers});const f=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return h={signedUrl:encodeURI(`${o.url}${h.signedURL}${f}`)},{data:h,error:null}}catch(d){if(o.shouldThrowOnError)throw d;if(Rt(d))return{data:null,error:d};throw d}}async createSignedUrls(l,s,n){var o=this;try{const d=await Fa(o.fetch,`${o.url}/object/sign/${o.bucketId}`,{expiresIn:s,paths:l},{headers:o.headers}),h=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:d.map(f=>De(De({},f),{},{signedUrl:f.signedURL?encodeURI(`${o.url}${f.signedURL}${h}`):null})),error:null}}catch(d){if(o.shouldThrowOnError)throw d;if(Rt(d))return{data:null,error:d};throw d}}download(l,s){const n=typeof(s==null?void 0:s.transform)<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString((s==null?void 0:s.transform)||{}),d=o?`?${o}`:"",h=this._getFinalPath(l),f=()=>yi(this.fetch,`${this.url}/${n}/${h}${d}`,{headers:this.headers,noResolveJson:!0});return new Yb(f,this.shouldThrowOnError)}async info(l){var s=this;const n=s._getFinalPath(l);try{return{data:Eu(await yi(s.fetch,`${s.url}/object/info/${n}`,{headers:s.headers})),error:null}}catch(o){if(s.shouldThrowOnError)throw o;if(Rt(o))return{data:null,error:o};throw o}}async exists(l){var s=this;const n=s._getFinalPath(l);try{return await Pb(s.fetch,`${s.url}/object/${n}`,{headers:s.headers}),{data:!0,error:null}}catch(o){if(s.shouldThrowOnError)throw o;if(Rt(o)&&o instanceof Su){const d=o.originalError;if([400,404].includes(d==null?void 0:d.status))return{data:!1,error:o}}throw o}}getPublicUrl(l,s){const n=this._getFinalPath(l),o=[],d=s!=null&&s.download?`download=${s.download===!0?"":s.download}`:"";d!==""&&o.push(d);const h=typeof(s==null?void 0:s.transform)<"u"?"render/image":"object",f=this.transformOptsToQueryString((s==null?void 0:s.transform)||{});f!==""&&o.push(f);let b=o.join("&");return b!==""&&(b=`?${b}`),{data:{publicUrl:encodeURI(`${this.url}/${h}/public/${n}${b}`)}}}async remove(l){var s=this;try{return{data:await Du(s.fetch,`${s.url}/object/${s.bucketId}`,{prefixes:l},{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Rt(n))return{data:null,error:n};throw n}}async list(l,s,n){var o=this;try{const d=De(De(De({},Kb),s),{},{prefix:l||""});return{data:await Fa(o.fetch,`${o.url}/object/list/${o.bucketId}`,d,{headers:o.headers},n),error:null}}catch(d){if(o.shouldThrowOnError)throw d;if(Rt(d))return{data:null,error:d};throw d}}async listV2(l,s){var n=this;try{const o=De({},l);return{data:await Fa(n.fetch,`${n.url}/object/list-v2/${n.bucketId}`,o,{headers:n.headers},s),error:null}}catch(o){if(n.shouldThrowOnError)throw o;if(Rt(o))return{data:null,error:o};throw o}}encodeMetadata(l){return JSON.stringify(l)}toBase64(l){return typeof Buffer<"u"?Buffer.from(l).toString("base64"):btoa(l)}_getFinalPath(l){return`${this.bucketId}/${l.replace(/^\/+/,"")}`}_removeEmptyFolders(l){return l.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(l){const s=[];return l.width&&s.push(`width=${l.width}`),l.height&&s.push(`height=${l.height}`),l.resize&&s.push(`resize=${l.resize}`),l.format&&s.push(`format=${l.format}`),l.quality&&s.push(`quality=${l.quality}`),s.join("&")}};const xp="2.89.0",yp={"X-Client-Info":`storage-js/${xp}`};var Qb=class{constructor(l,s={},n,o){this.shouldThrowOnError=!1;const d=new URL(l);o!=null&&o.useNewHostname&&/supabase\.(co|in|red)$/.test(d.hostname)&&!d.hostname.includes("storage.supabase.")&&(d.hostname=d.hostname.replace("supabase.","storage.supabase.")),this.url=d.href.replace(/\/$/,""),this.headers=De(De({},yp),s),this.fetch=Mu(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(l){var s=this;try{const n=s.listBucketOptionsToQueryString(l);return{data:await yi(s.fetch,`${s.url}/bucket${n}`,{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Rt(n))return{data:null,error:n};throw n}}async getBucket(l){var s=this;try{return{data:await yi(s.fetch,`${s.url}/bucket/${l}`,{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Rt(n))return{data:null,error:n};throw n}}async createBucket(l,s={public:!1}){var n=this;try{return{data:await Fa(n.fetch,`${n.url}/bucket`,{id:l,name:l,type:s.type,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:n.headers}),error:null}}catch(o){if(n.shouldThrowOnError)throw o;if(Rt(o))return{data:null,error:o};throw o}}async updateBucket(l,s){var n=this;try{return{data:await Tu(n.fetch,`${n.url}/bucket/${l}`,{id:l,name:l,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:n.headers}),error:null}}catch(o){if(n.shouldThrowOnError)throw o;if(Rt(o))return{data:null,error:o};throw o}}async emptyBucket(l){var s=this;try{return{data:await Fa(s.fetch,`${s.url}/bucket/${l}/empty`,{},{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Rt(n))return{data:null,error:n};throw n}}async deleteBucket(l){var s=this;try{return{data:await Du(s.fetch,`${s.url}/bucket/${l}`,{},{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Rt(n))return{data:null,error:n};throw n}}listBucketOptionsToQueryString(l){const s={};return l&&("limit"in l&&(s.limit=String(l.limit)),"offset"in l&&(s.offset=String(l.offset)),l.search&&(s.search=l.search),l.sortColumn&&(s.sortColumn=l.sortColumn),l.sortOrder&&(s.sortOrder=l.sortOrder)),Object.keys(s).length>0?"?"+new URLSearchParams(s).toString():""}},Zb=class{constructor(l,s={},n){this.shouldThrowOnError=!1,this.url=l.replace(/\/$/,""),this.headers=De(De({},yp),s),this.fetch=Mu(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(l){var s=this;try{return{data:await Fa(s.fetch,`${s.url}/bucket`,{name:l},{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Rt(n))return{data:null,error:n};throw n}}async listBuckets(l){var s=this;try{const n=new URLSearchParams;(l==null?void 0:l.limit)!==void 0&&n.set("limit",l.limit.toString()),(l==null?void 0:l.offset)!==void 0&&n.set("offset",l.offset.toString()),l!=null&&l.sortColumn&&n.set("sortColumn",l.sortColumn),l!=null&&l.sortOrder&&n.set("sortOrder",l.sortOrder),l!=null&&l.search&&n.set("search",l.search);const o=n.toString(),d=o?`${s.url}/bucket?${o}`:`${s.url}/bucket`;return{data:await yi(s.fetch,d,{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Rt(n))return{data:null,error:n};throw n}}async deleteBucket(l){var s=this;try{return{data:await Du(s.fetch,`${s.url}/bucket/${l}`,{},{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Rt(n))return{data:null,error:n};throw n}}from(l){var s=this;if(!Lb(l))throw new Zl("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const n=new zb({baseUrl:this.url,catalogName:l,auth:{type:"custom",getHeaders:async()=>s.headers},fetch:this.fetch}),o=this.shouldThrowOnError;return new Proxy(n,{get(d,h){const f=d[h];return typeof f!="function"?f:async(...b)=>{try{return{data:await f.apply(d,b),error:null}}catch(g){if(o)throw g;return{data:null,error:g}}}}})}};const Uu={"X-Client-Info":`storage-js/${xp}`,"Content-Type":"application/json"};var vp=class extends Error{constructor(l){super(l),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Ra(l){return typeof l=="object"&&l!==null&&"__isStorageVectorsError"in l}var mu=class extends vp{constructor(l,s,n){super(l),this.name="StorageVectorsApiError",this.status=s,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Jb=class extends vp{constructor(l,s){super(l),this.name="StorageVectorsUnknownError",this.originalError=s}};const Lu=l=>l?(...s)=>l(...s):(...s)=>fetch(...s),Xb=l=>{if(typeof l!="object"||l===null)return!1;const s=Object.getPrototypeOf(l);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(Symbol.toStringTag in l)&&!(Symbol.iterator in l)},Ym=l=>l.msg||l.message||l.error_description||l.error||JSON.stringify(l),Wb=async(l,s,n)=>{if(l&&typeof l=="object"&&"status"in l&&"ok"in l&&typeof l.status=="number"&&!(n!=null&&n.noResolveJson)){const o=l.status||500,d=l;if(typeof d.json=="function")d.json().then(h=>{const f=(h==null?void 0:h.statusCode)||(h==null?void 0:h.code)||o+"";s(new mu(Ym(h),o,f))}).catch(()=>{const h=o+"";s(new mu(d.statusText||`HTTP ${o} error`,o,h))});else{const h=o+"";s(new mu(d.statusText||`HTTP ${o} error`,o,h))}}else s(new Jb(Ym(l),l))},Fb=(l,s,n,o)=>{const d={method:l,headers:(s==null?void 0:s.headers)||{}};return o?(Xb(o)?(d.headers=De({"Content-Type":"application/json"},s==null?void 0:s.headers),d.body=JSON.stringify(o)):d.body=o,De(De({},d),n)):d};async function ex(l,s,n,o,d,h){return new Promise((f,b)=>{l(n,Fb(s,o,d,h)).then(g=>{if(!g.ok)throw g;if(o!=null&&o.noResolveJson)return g;const p=g.headers.get("content-type");return!p||!p.includes("application/json")?{}:g.json()}).then(g=>f(g)).catch(g=>Wb(g,b,o))})}async function za(l,s,n,o,d){return ex(l,"POST",s,o,d,n)}var tx=class{constructor(l,s={},n){this.shouldThrowOnError=!1,this.url=l.replace(/\/$/,""),this.headers=De(De({},Uu),s),this.fetch=Lu(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(l){var s=this;try{return{data:await za(s.fetch,`${s.url}/CreateIndex`,l,{headers:s.headers})||{},error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Ra(n))return{data:null,error:n};throw n}}async getIndex(l,s){var n=this;try{return{data:await za(n.fetch,`${n.url}/GetIndex`,{vectorBucketName:l,indexName:s},{headers:n.headers}),error:null}}catch(o){if(n.shouldThrowOnError)throw o;if(Ra(o))return{data:null,error:o};throw o}}async listIndexes(l){var s=this;try{return{data:await za(s.fetch,`${s.url}/ListIndexes`,l,{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Ra(n))return{data:null,error:n};throw n}}async deleteIndex(l,s){var n=this;try{return{data:await za(n.fetch,`${n.url}/DeleteIndex`,{vectorBucketName:l,indexName:s},{headers:n.headers})||{},error:null}}catch(o){if(n.shouldThrowOnError)throw o;if(Ra(o))return{data:null,error:o};throw o}}},ax=class{constructor(l,s={},n){this.shouldThrowOnError=!1,this.url=l.replace(/\/$/,""),this.headers=De(De({},Uu),s),this.fetch=Lu(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(l){var s=this;try{if(l.vectors.length<1||l.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await za(s.fetch,`${s.url}/PutVectors`,l,{headers:s.headers})||{},error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Ra(n))return{data:null,error:n};throw n}}async getVectors(l){var s=this;try{return{data:await za(s.fetch,`${s.url}/GetVectors`,l,{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Ra(n))return{data:null,error:n};throw n}}async listVectors(l){var s=this;try{if(l.segmentCount!==void 0){if(l.segmentCount<1||l.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(l.segmentIndex!==void 0&&(l.segmentIndex<0||l.segmentIndex>=l.segmentCount))throw new Error(`segmentIndex must be between 0 and ${l.segmentCount-1}`)}return{data:await za(s.fetch,`${s.url}/ListVectors`,l,{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Ra(n))return{data:null,error:n};throw n}}async queryVectors(l){var s=this;try{return{data:await za(s.fetch,`${s.url}/QueryVectors`,l,{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Ra(n))return{data:null,error:n};throw n}}async deleteVectors(l){var s=this;try{if(l.keys.length<1||l.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await za(s.fetch,`${s.url}/DeleteVectors`,l,{headers:s.headers})||{},error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Ra(n))return{data:null,error:n};throw n}}},sx=class{constructor(l,s={},n){this.shouldThrowOnError=!1,this.url=l.replace(/\/$/,""),this.headers=De(De({},Uu),s),this.fetch=Lu(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(l){var s=this;try{return{data:await za(s.fetch,`${s.url}/CreateVectorBucket`,{vectorBucketName:l},{headers:s.headers})||{},error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Ra(n))return{data:null,error:n};throw n}}async getBucket(l){var s=this;try{return{data:await za(s.fetch,`${s.url}/GetVectorBucket`,{vectorBucketName:l},{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Ra(n))return{data:null,error:n};throw n}}async listBuckets(l={}){var s=this;try{return{data:await za(s.fetch,`${s.url}/ListVectorBuckets`,l,{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Ra(n))return{data:null,error:n};throw n}}async deleteBucket(l){var s=this;try{return{data:await za(s.fetch,`${s.url}/DeleteVectorBucket`,{vectorBucketName:l},{headers:s.headers})||{},error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Ra(n))return{data:null,error:n};throw n}}},rx=class extends sx{constructor(l,s={}){super(l,s.headers||{},s.fetch)}from(l){return new nx(this.url,this.headers,l,this.fetch)}async createBucket(l){var s=()=>super.createBucket,n=this;return s().call(n,l)}async getBucket(l){var s=()=>super.getBucket,n=this;return s().call(n,l)}async listBuckets(l={}){var s=()=>super.listBuckets,n=this;return s().call(n,l)}async deleteBucket(l){var s=()=>super.deleteBucket,n=this;return s().call(n,l)}},nx=class extends tx{constructor(l,s,n,o){super(l,s,o),this.vectorBucketName=n}async createIndex(l){var s=()=>super.createIndex,n=this;return s().call(n,De(De({},l),{},{vectorBucketName:n.vectorBucketName}))}async listIndexes(l={}){var s=()=>super.listIndexes,n=this;return s().call(n,De(De({},l),{},{vectorBucketName:n.vectorBucketName}))}async getIndex(l){var s=()=>super.getIndex,n=this;return s().call(n,n.vectorBucketName,l)}async deleteIndex(l){var s=()=>super.deleteIndex,n=this;return s().call(n,n.vectorBucketName,l)}index(l){return new ix(this.url,this.headers,this.vectorBucketName,l,this.fetch)}},ix=class extends ax{constructor(l,s,n,o,d){super(l,s,d),this.vectorBucketName=n,this.indexName=o}async putVectors(l){var s=()=>super.putVectors,n=this;return s().call(n,De(De({},l),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async getVectors(l){var s=()=>super.getVectors,n=this;return s().call(n,De(De({},l),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async listVectors(l={}){var s=()=>super.listVectors,n=this;return s().call(n,De(De({},l),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async queryVectors(l){var s=()=>super.queryVectors,n=this;return s().call(n,De(De({},l),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async deleteVectors(l){var s=()=>super.deleteVectors,n=this;return s().call(n,De(De({},l),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}},lx=class extends Qb{constructor(l,s={},n,o){super(l,s,n,o)}from(l){return new Vb(this.url,this.headers,l,this.fetch)}get vectors(){return new rx(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Zb(this.url+"/iceberg",this.headers,this.fetch)}};const wp="2.89.0",yn=30*1e3,ku=3,pu=ku*yn,ox="http://localhost:9999",cx="supabase.auth.token",ux={"X-Client-Info":`gotrue-js/${wp}`},Au="X-Supabase-Api-Version",jp={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},dx=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,hx=600*1e3;class vi extends Error{constructor(s,n,o){super(s),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=o}}function Ae(l){return typeof l=="object"&&l!==null&&"__isAuthError"in l}class fx extends vi{constructor(s,n,o){super(s,n,o),this.name="AuthApiError",this.status=n,this.code=o}}function mx(l){return Ae(l)&&l.name==="AuthApiError"}class Er extends vi{constructor(s,n){super(s),this.name="AuthUnknownError",this.originalError=n}}class Cs extends vi{constructor(s,n,o,d){super(s,o,d),this.name=n,this.status=o}}class Ca extends Cs{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function px(l){return Ae(l)&&l.name==="AuthSessionMissingError"}class hn extends Cs{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ql extends Cs{constructor(s){super(s,"AuthInvalidCredentialsError",400,void 0)}}class Pl extends Cs{constructor(s,n=null){super(s,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function gx(l){return Ae(l)&&l.name==="AuthImplicitGrantRedirectError"}class Km extends Cs{constructor(s,n=null){super(s,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class bx extends Cs{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Ou extends Cs{constructor(s,n){super(s,"AuthRetryableFetchError",n,void 0)}}function gu(l){return Ae(l)&&l.name==="AuthRetryableFetchError"}class Vm extends Cs{constructor(s,n,o){super(s,"AuthWeakPasswordError",n,"weak_password"),this.reasons=o}}class Cu extends Cs{constructor(s){super(s,"AuthInvalidJwtError",400,"invalid_jwt")}}const Yl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Qm=` 	
\r=`.split(""),xx=(()=>{const l=new Array(128);for(let s=0;s<l.length;s+=1)l[s]=-1;for(let s=0;s<Qm.length;s+=1)l[Qm[s].charCodeAt(0)]=-2;for(let s=0;s<Yl.length;s+=1)l[Yl[s].charCodeAt(0)]=s;return l})();function Zm(l,s,n){if(l!==null)for(s.queue=s.queue<<8|l,s.queuedBits+=8;s.queuedBits>=6;){const o=s.queue>>s.queuedBits-6&63;n(Yl[o]),s.queuedBits-=6}else if(s.queuedBits>0)for(s.queue=s.queue<<6-s.queuedBits,s.queuedBits=6;s.queuedBits>=6;){const o=s.queue>>s.queuedBits-6&63;n(Yl[o]),s.queuedBits-=6}}function _p(l,s,n){const o=xx[l];if(o>-1)for(s.queue=s.queue<<6|o,s.queuedBits+=6;s.queuedBits>=8;)n(s.queue>>s.queuedBits-8&255),s.queuedBits-=8;else{if(o===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(l)}"`)}}function Jm(l){const s=[],n=f=>{s.push(String.fromCodePoint(f))},o={utf8seq:0,codepoint:0},d={queue:0,queuedBits:0},h=f=>{wx(f,o,n)};for(let f=0;f<l.length;f+=1)_p(l.charCodeAt(f),d,h);return s.join("")}function yx(l,s){if(l<=127){s(l);return}else if(l<=2047){s(192|l>>6),s(128|l&63);return}else if(l<=65535){s(224|l>>12),s(128|l>>6&63),s(128|l&63);return}else if(l<=1114111){s(240|l>>18),s(128|l>>12&63),s(128|l>>6&63),s(128|l&63);return}throw new Error(`Unrecognized Unicode codepoint: ${l.toString(16)}`)}function vx(l,s){for(let n=0;n<l.length;n+=1){let o=l.charCodeAt(n);if(o>55295&&o<=56319){const d=(o-55296)*1024&65535;o=(l.charCodeAt(n+1)-56320&65535|d)+65536,n+=1}yx(o,s)}}function wx(l,s,n){if(s.utf8seq===0){if(l<=127){n(l);return}for(let o=1;o<6;o+=1)if((l>>7-o&1)===0){s.utf8seq=o;break}if(s.utf8seq===2)s.codepoint=l&31;else if(s.utf8seq===3)s.codepoint=l&15;else if(s.utf8seq===4)s.codepoint=l&7;else throw new Error("Invalid UTF-8 sequence");s.utf8seq-=1}else if(s.utf8seq>0){if(l<=127)throw new Error("Invalid UTF-8 sequence");s.codepoint=s.codepoint<<6|l&63,s.utf8seq-=1,s.utf8seq===0&&n(s.codepoint)}}function jn(l){const s=[],n={queue:0,queuedBits:0},o=d=>{s.push(d)};for(let d=0;d<l.length;d+=1)_p(l.charCodeAt(d),n,o);return new Uint8Array(s)}function jx(l){const s=[];return vx(l,n=>s.push(n)),new Uint8Array(s)}function Tr(l){const s=[],n={queue:0,queuedBits:0},o=d=>{s.push(d)};return l.forEach(d=>Zm(d,n,o)),Zm(null,n,o),s.join("")}function _x(l){return Math.round(Date.now()/1e3)+l}function Nx(){return Symbol("auth-callback")}const ia=()=>typeof window<"u"&&typeof document<"u",jr={tested:!1,writable:!1},Np=()=>{if(!ia())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(jr.tested)return jr.writable;const l=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(l,l),globalThis.localStorage.removeItem(l),jr.tested=!0,jr.writable=!0}catch{jr.tested=!0,jr.writable=!1}return jr.writable};function Sx(l){const s={},n=new URL(l);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((d,h)=>{s[h]=d})}catch{}return n.searchParams.forEach((o,d)=>{s[d]=o}),s}const Sp=l=>l?(...s)=>l(...s):(...s)=>fetch(...s),Ex=l=>typeof l=="object"&&l!==null&&"status"in l&&"ok"in l&&"json"in l&&typeof l.json=="function",vn=async(l,s,n)=>{await l.setItem(s,JSON.stringify(n))},_r=async(l,s)=>{const n=await l.getItem(s);if(!n)return null;try{return JSON.parse(n)}catch{return n}},na=async(l,s)=>{await l.removeItem(s)};class Jl{constructor(){this.promise=new Jl.promiseConstructor((s,n)=>{this.resolve=s,this.reject=n})}}Jl.promiseConstructor=Promise;function bu(l){const s=l.split(".");if(s.length!==3)throw new Cu("Invalid JWT structure");for(let o=0;o<s.length;o++)if(!dx.test(s[o]))throw new Cu("JWT not in base64url format");return{header:JSON.parse(Jm(s[0])),payload:JSON.parse(Jm(s[1])),signature:jn(s[2]),raw:{header:s[0],payload:s[1]}}}async function Tx(l){return await new Promise(s=>{setTimeout(()=>s(null),l)})}function kx(l,s){return new Promise((o,d)=>{(async()=>{for(let h=0;h<1/0;h++)try{const f=await l(h);if(!s(h,null,f)){o(f);return}}catch(f){if(!s(h,f)){d(f);return}}})()})}function Ax(l){return("0"+l.toString(16)).substr(-2)}function Ox(){const s=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",o=n.length;let d="";for(let h=0;h<56;h++)d+=n.charAt(Math.floor(Math.random()*o));return d}return crypto.getRandomValues(s),Array.from(s,Ax).join("")}async function Cx(l){const n=new TextEncoder().encode(l),o=await crypto.subtle.digest("SHA-256",n),d=new Uint8Array(o);return Array.from(d).map(h=>String.fromCharCode(h)).join("")}async function Rx(l){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),l;const n=await Cx(l);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function fn(l,s,n=!1){const o=Ox();let d=o;n&&(d+="/PASSWORD_RECOVERY"),await vn(l,`${s}-code-verifier`,d);const h=await Rx(o);return[h,o===h?"plain":"s256"]}const zx=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Mx(l){const s=l.headers.get(Au);if(!s||!s.match(zx))return null;try{return new Date(`${s}T00:00:00.0Z`)}catch{return null}}function Dx(l){if(!l)throw new Error("Missing exp claim");const s=Math.floor(Date.now()/1e3);if(l<=s)throw new Error("JWT has expired")}function Ux(l){switch(l){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Lx=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function mn(l){if(!Lx.test(l))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function xu(){const l={};return new Proxy(l,{get:(s,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const o=n.toString();if(o==="Symbol(Symbol.toPrimitive)"||o==="Symbol(Symbol.toStringTag)"||o==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(s,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(s,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Bx(l,s){return new Proxy(l,{get:(n,o,d)=>{if(o==="__isInsecureUserWarningProxy")return!0;if(typeof o=="symbol"){const h=o.toString();if(h==="Symbol(Symbol.toPrimitive)"||h==="Symbol(Symbol.toStringTag)"||h==="Symbol(util.inspect.custom)"||h==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(n,o,d)}return!s.value&&typeof o=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),s.value=!0),Reflect.get(n,o,d)}})}function Xm(l){return JSON.parse(JSON.stringify(l))}const Nr=l=>l.msg||l.message||l.error_description||l.error||JSON.stringify(l),Hx=[502,503,504];async function Wm(l){var s;if(!Ex(l))throw new Ou(Nr(l),0);if(Hx.includes(l.status))throw new Ou(Nr(l),l.status);let n;try{n=await l.json()}catch(h){throw new Er(Nr(h),h)}let o;const d=Mx(l);if(d&&d.getTime()>=jp["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?o=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(o=n.error_code),o){if(o==="weak_password")throw new Vm(Nr(n),l.status,((s=n.weak_password)===null||s===void 0?void 0:s.reasons)||[]);if(o==="session_not_found")throw new Ca}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((h,f)=>h&&typeof f=="string",!0))throw new Vm(Nr(n),l.status,n.weak_password.reasons);throw new fx(Nr(n),l.status||500,o)}const $x=(l,s,n,o)=>{const d={method:l,headers:(s==null?void 0:s.headers)||{}};return l==="GET"?d:(d.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},s==null?void 0:s.headers),d.body=JSON.stringify(o),Object.assign(Object.assign({},d),n))};async function Me(l,s,n,o){var d;const h=Object.assign({},o==null?void 0:o.headers);h[Au]||(h[Au]=jp["2024-01-01"].name),o!=null&&o.jwt&&(h.Authorization=`Bearer ${o.jwt}`);const f=(d=o==null?void 0:o.query)!==null&&d!==void 0?d:{};o!=null&&o.redirectTo&&(f.redirect_to=o.redirectTo);const b=Object.keys(f).length?"?"+new URLSearchParams(f).toString():"",g=await Ix(l,s,n+b,{headers:h,noResolveJson:o==null?void 0:o.noResolveJson},{},o==null?void 0:o.body);return o!=null&&o.xform?o==null?void 0:o.xform(g):{data:Object.assign({},g),error:null}}async function Ix(l,s,n,o,d,h){const f=$x(s,o,d,h);let b;try{b=await l(n,Object.assign({},f))}catch(g){throw console.error(g),new Ou(Nr(g),0)}if(b.ok||await Wm(b),o!=null&&o.noResolveJson)return b;try{return await b.json()}catch(g){await Wm(g)}}function Wa(l){var s;let n=null;Gx(l)&&(n=Object.assign({},l),l.expires_at||(n.expires_at=_x(l.expires_in)));const o=(s=l.user)!==null&&s!==void 0?s:l;return{data:{session:n,user:o},error:null}}function Fm(l){const s=Wa(l);return!s.error&&l.weak_password&&typeof l.weak_password=="object"&&Array.isArray(l.weak_password.reasons)&&l.weak_password.reasons.length&&l.weak_password.message&&typeof l.weak_password.message=="string"&&l.weak_password.reasons.reduce((n,o)=>n&&typeof o=="string",!0)&&(s.data.weak_password=l.weak_password),s}function rr(l){var s;return{data:{user:(s=l.user)!==null&&s!==void 0?s:l},error:null}}function qx(l){return{data:l,error:null}}function Px(l){const{action_link:s,email_otp:n,hashed_token:o,redirect_to:d,verification_type:h}=l,f=Ql(l,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),b={action_link:s,email_otp:n,hashed_token:o,redirect_to:d,verification_type:h},g=Object.assign({},f);return{data:{properties:b,user:g},error:null}}function ep(l){return l}function Gx(l){return l.access_token&&l.refresh_token&&l.expires_in}const yu=["global","local","others"];class Yx{constructor({url:s="",headers:n={},fetch:o}){this.url=s,this.headers=n,this.fetch=Sp(o),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(s,n=yu[0]){if(yu.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${yu.join(", ")}`);try{return await Me(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:s,noResolveJson:!0}),{data:null,error:null}}catch(o){if(Ae(o))return{data:null,error:o};throw o}}async inviteUserByEmail(s,n={}){try{return await Me(this.fetch,"POST",`${this.url}/invite`,{body:{email:s,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:rr})}catch(o){if(Ae(o))return{data:{user:null},error:o};throw o}}async generateLink(s){try{const{options:n}=s,o=Ql(s,["options"]),d=Object.assign(Object.assign({},o),n);return"newEmail"in o&&(d.new_email=o==null?void 0:o.newEmail,delete d.newEmail),await Me(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:d,headers:this.headers,xform:Px,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(Ae(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(s){try{return await Me(this.fetch,"POST",`${this.url}/admin/users`,{body:s,headers:this.headers,xform:rr})}catch(n){if(Ae(n))return{data:{user:null},error:n};throw n}}async listUsers(s){var n,o,d,h,f,b,g;try{const p={nextPage:null,lastPage:0,total:0},v=await Me(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(o=(n=s==null?void 0:s.page)===null||n===void 0?void 0:n.toString())!==null&&o!==void 0?o:"",per_page:(h=(d=s==null?void 0:s.perPage)===null||d===void 0?void 0:d.toString())!==null&&h!==void 0?h:""},xform:ep});if(v.error)throw v.error;const x=await v.json(),N=(f=v.headers.get("x-total-count"))!==null&&f!==void 0?f:0,j=(g=(b=v.headers.get("link"))===null||b===void 0?void 0:b.split(","))!==null&&g!==void 0?g:[];return j.length>0&&(j.forEach(C=>{const z=parseInt(C.split(";")[0].split("=")[1].substring(0,1)),M=JSON.parse(C.split(";")[1].split("=")[1]);p[`${M}Page`]=z}),p.total=parseInt(N)),{data:Object.assign(Object.assign({},x),p),error:null}}catch(p){if(Ae(p))return{data:{users:[]},error:p};throw p}}async getUserById(s){mn(s);try{return await Me(this.fetch,"GET",`${this.url}/admin/users/${s}`,{headers:this.headers,xform:rr})}catch(n){if(Ae(n))return{data:{user:null},error:n};throw n}}async updateUserById(s,n){mn(s);try{return await Me(this.fetch,"PUT",`${this.url}/admin/users/${s}`,{body:n,headers:this.headers,xform:rr})}catch(o){if(Ae(o))return{data:{user:null},error:o};throw o}}async deleteUser(s,n=!1){mn(s);try{return await Me(this.fetch,"DELETE",`${this.url}/admin/users/${s}`,{headers:this.headers,body:{should_soft_delete:n},xform:rr})}catch(o){if(Ae(o))return{data:{user:null},error:o};throw o}}async _listFactors(s){mn(s.userId);try{const{data:n,error:o}=await Me(this.fetch,"GET",`${this.url}/admin/users/${s.userId}/factors`,{headers:this.headers,xform:d=>({data:{factors:d},error:null})});return{data:n,error:o}}catch(n){if(Ae(n))return{data:null,error:n};throw n}}async _deleteFactor(s){mn(s.userId),mn(s.id);try{return{data:await Me(this.fetch,"DELETE",`${this.url}/admin/users/${s.userId}/factors/${s.id}`,{headers:this.headers}),error:null}}catch(n){if(Ae(n))return{data:null,error:n};throw n}}async _listOAuthClients(s){var n,o,d,h,f,b,g;try{const p={nextPage:null,lastPage:0,total:0},v=await Me(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(o=(n=s==null?void 0:s.page)===null||n===void 0?void 0:n.toString())!==null&&o!==void 0?o:"",per_page:(h=(d=s==null?void 0:s.perPage)===null||d===void 0?void 0:d.toString())!==null&&h!==void 0?h:""},xform:ep});if(v.error)throw v.error;const x=await v.json(),N=(f=v.headers.get("x-total-count"))!==null&&f!==void 0?f:0,j=(g=(b=v.headers.get("link"))===null||b===void 0?void 0:b.split(","))!==null&&g!==void 0?g:[];return j.length>0&&(j.forEach(C=>{const z=parseInt(C.split(";")[0].split("=")[1].substring(0,1)),M=JSON.parse(C.split(";")[1].split("=")[1]);p[`${M}Page`]=z}),p.total=parseInt(N)),{data:Object.assign(Object.assign({},x),p),error:null}}catch(p){if(Ae(p))return{data:{clients:[]},error:p};throw p}}async _createOAuthClient(s){try{return await Me(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:s,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Ae(n))return{data:null,error:n};throw n}}async _getOAuthClient(s){try{return await Me(this.fetch,"GET",`${this.url}/admin/oauth/clients/${s}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Ae(n))return{data:null,error:n};throw n}}async _updateOAuthClient(s,n){try{return await Me(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${s}`,{body:n,headers:this.headers,xform:o=>({data:o,error:null})})}catch(o){if(Ae(o))return{data:null,error:o};throw o}}async _deleteOAuthClient(s){try{return await Me(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${s}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Ae(n))return{data:null,error:n};throw n}}async _regenerateOAuthClientSecret(s){try{return await Me(this.fetch,"POST",`${this.url}/admin/oauth/clients/${s}/regenerate_secret`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Ae(n))return{data:null,error:n};throw n}}}function tp(l={}){return{getItem:s=>l[s]||null,setItem:(s,n)=>{l[s]=n},removeItem:s=>{delete l[s]}}}const pn={debug:!!(globalThis&&Np()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Ep extends Error{constructor(s){super(s),this.isAcquireTimeout=!0}}class Kx extends Ep{}async function Vx(l,s,n){pn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",l,s);const o=new globalThis.AbortController;return s>0&&setTimeout(()=>{o.abort(),pn.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",l)},s),await Promise.resolve().then(()=>globalThis.navigator.locks.request(l,s===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:o.signal},async d=>{if(d){pn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",l,d.name);try{return await n()}finally{pn.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",l,d.name)}}else{if(s===0)throw pn.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",l),new Kx(`Acquiring an exclusive Navigator LockManager lock "${l}" immediately failed`);if(pn.debug)try{const h=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(h,null,"  "))}catch(h){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",h)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}function Qx(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Tp(l){if(!/^0x[a-fA-F0-9]{40}$/.test(l))throw new Error(`@supabase/auth-js: Address "${l}" is invalid.`);return l.toLowerCase()}function Zx(l){return parseInt(l,16)}function Jx(l){const s=new TextEncoder().encode(l);return"0x"+Array.from(s,o=>o.toString(16).padStart(2,"0")).join("")}function Xx(l){var s;const{chainId:n,domain:o,expirationTime:d,issuedAt:h=new Date,nonce:f,notBefore:b,requestId:g,resources:p,scheme:v,uri:x,version:N}=l;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!o)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(f&&f.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${f}`);if(!x)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(N!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${N}`);if(!((s=l.statement)===null||s===void 0)&&s.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${l.statement}`)}const j=Tp(l.address),C=v?`${v}://${o}`:o,z=l.statement?`${l.statement}
`:"",M=`${C} wants you to sign in with your Ethereum account:
${j}

${z}`;let E=`URI: ${x}
Version: ${N}
Chain ID: ${n}${f?`
Nonce: ${f}`:""}
Issued At: ${h.toISOString()}`;if(d&&(E+=`
Expiration Time: ${d.toISOString()}`),b&&(E+=`
Not Before: ${b.toISOString()}`),g&&(E+=`
Request ID: ${g}`),p){let O=`
Resources:`;for(const _ of p){if(!_||typeof _!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${_}`);O+=`
- ${_}`}E+=O}return`${M}
${E}`}class Qt extends Error{constructor({message:s,code:n,cause:o,name:d}){var h;super(s,{cause:o}),this.__isWebAuthnError=!0,this.name=(h=d??(o instanceof Error?o.name:void 0))!==null&&h!==void 0?h:"Unknown Error",this.code=n}}class Kl extends Qt{constructor(s,n){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n,message:s}),this.name="WebAuthnUnknownError",this.originalError=n}}function Wx({error:l,options:s}){var n,o,d;const{publicKey:h}=s;if(!h)throw Error("options was missing required publicKey property");if(l.name==="AbortError"){if(s.signal instanceof AbortSignal)return new Qt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:l})}else if(l.name==="ConstraintError"){if(((n=h.authenticatorSelection)===null||n===void 0?void 0:n.requireResidentKey)===!0)return new Qt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:l});if(s.mediation==="conditional"&&((o=h.authenticatorSelection)===null||o===void 0?void 0:o.userVerification)==="required")return new Qt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:l});if(((d=h.authenticatorSelection)===null||d===void 0?void 0:d.userVerification)==="required")return new Qt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:l})}else{if(l.name==="InvalidStateError")return new Qt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:l});if(l.name==="NotAllowedError")return new Qt({message:l.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:l});if(l.name==="NotSupportedError")return h.pubKeyCredParams.filter(b=>b.type==="public-key").length===0?new Qt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:l}):new Qt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:l});if(l.name==="SecurityError"){const f=window.location.hostname;if(kp(f)){if(h.rp.id!==f)return new Qt({message:`The RP ID "${h.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:l})}else return new Qt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:l})}else if(l.name==="TypeError"){if(h.user.id.byteLength<1||h.user.id.byteLength>64)return new Qt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:l})}else if(l.name==="UnknownError")return new Qt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:l})}return new Qt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:l})}function Fx({error:l,options:s}){const{publicKey:n}=s;if(!n)throw Error("options was missing required publicKey property");if(l.name==="AbortError"){if(s.signal instanceof AbortSignal)return new Qt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:l})}else{if(l.name==="NotAllowedError")return new Qt({message:l.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:l});if(l.name==="SecurityError"){const o=window.location.hostname;if(kp(o)){if(n.rpId!==o)return new Qt({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:l})}else return new Qt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:l})}else if(l.name==="UnknownError")return new Qt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:l})}return new Qt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:l})}class ey{createNewAbortSignal(){if(this.controller){const n=new Error("Cancelling existing WebAuthn API call for new one");n.name="AbortError",this.controller.abort(n)}const s=new AbortController;return this.controller=s,s.signal}cancelCeremony(){if(this.controller){const s=new Error("Manually cancelling existing WebAuthn API call");s.name="AbortError",this.controller.abort(s),this.controller=void 0}}}const ty=new ey;function ay(l){if(!l)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(l);const{challenge:s,user:n,excludeCredentials:o}=l,d=Ql(l,["challenge","user","excludeCredentials"]),h=jn(s).buffer,f=Object.assign(Object.assign({},n),{id:jn(n.id).buffer}),b=Object.assign(Object.assign({},d),{challenge:h,user:f});if(o&&o.length>0){b.excludeCredentials=new Array(o.length);for(let g=0;g<o.length;g++){const p=o[g];b.excludeCredentials[g]=Object.assign(Object.assign({},p),{id:jn(p.id).buffer,type:p.type||"public-key",transports:p.transports})}}return b}function sy(l){if(!l)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(l);const{challenge:s,allowCredentials:n}=l,o=Ql(l,["challenge","allowCredentials"]),d=jn(s).buffer,h=Object.assign(Object.assign({},o),{challenge:d});if(n&&n.length>0){h.allowCredentials=new Array(n.length);for(let f=0;f<n.length;f++){const b=n[f];h.allowCredentials[f]=Object.assign(Object.assign({},b),{id:jn(b.id).buffer,type:b.type||"public-key",transports:b.transports})}}return h}function ry(l){var s;if("toJSON"in l&&typeof l.toJSON=="function")return l.toJSON();const n=l;return{id:l.id,rawId:l.id,response:{attestationObject:Tr(new Uint8Array(l.response.attestationObject)),clientDataJSON:Tr(new Uint8Array(l.response.clientDataJSON))},type:"public-key",clientExtensionResults:l.getClientExtensionResults(),authenticatorAttachment:(s=n.authenticatorAttachment)!==null&&s!==void 0?s:void 0}}function ny(l){var s;if("toJSON"in l&&typeof l.toJSON=="function")return l.toJSON();const n=l,o=l.getClientExtensionResults(),d=l.response;return{id:l.id,rawId:l.id,response:{authenticatorData:Tr(new Uint8Array(d.authenticatorData)),clientDataJSON:Tr(new Uint8Array(d.clientDataJSON)),signature:Tr(new Uint8Array(d.signature)),userHandle:d.userHandle?Tr(new Uint8Array(d.userHandle)):void 0},type:"public-key",clientExtensionResults:o,authenticatorAttachment:(s=n.authenticatorAttachment)!==null&&s!==void 0?s:void 0}}function kp(l){return l==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(l)}function ap(){var l,s;return!!(ia()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((l=navigator==null?void 0:navigator.credentials)===null||l===void 0?void 0:l.create)=="function"&&typeof((s=navigator==null?void 0:navigator.credentials)===null||s===void 0?void 0:s.get)=="function")}async function iy(l){try{const s=await navigator.credentials.create(l);return s?s instanceof PublicKeyCredential?{data:s,error:null}:{data:null,error:new Kl("Browser returned unexpected credential type",s)}:{data:null,error:new Kl("Empty credential response",s)}}catch(s){return{data:null,error:Wx({error:s,options:l})}}}async function ly(l){try{const s=await navigator.credentials.get(l);return s?s instanceof PublicKeyCredential?{data:s,error:null}:{data:null,error:new Kl("Browser returned unexpected credential type",s)}:{data:null,error:new Kl("Empty credential response",s)}}catch(s){return{data:null,error:Fx({error:s,options:l})}}}const oy={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},cy={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Vl(...l){const s=d=>d!==null&&typeof d=="object"&&!Array.isArray(d),n=d=>d instanceof ArrayBuffer||ArrayBuffer.isView(d),o={};for(const d of l)if(d)for(const h in d){const f=d[h];if(f!==void 0)if(Array.isArray(f))o[h]=f;else if(n(f))o[h]=f;else if(s(f)){const b=o[h];s(b)?o[h]=Vl(b,f):o[h]=Vl(f)}else o[h]=f}return o}function uy(l,s){return Vl(oy,l,s||{})}function dy(l,s){return Vl(cy,l,s||{})}class hy{constructor(s){this.client=s,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(s){return this.client.mfa.enroll(Object.assign(Object.assign({},s),{factorType:"webauthn"}))}async _challenge({factorId:s,webauthn:n,friendlyName:o,signal:d},h){try{const{data:f,error:b}=await this.client.mfa.challenge({factorId:s,webauthn:n});if(!f)return{data:null,error:b};const g=d??ty.createNewAbortSignal();if(f.webauthn.type==="create"){const{user:p}=f.webauthn.credential_options.publicKey;p.name||(p.name=`${p.id}:${o}`),p.displayName||(p.displayName=p.name)}switch(f.webauthn.type){case"create":{const p=uy(f.webauthn.credential_options.publicKey,h==null?void 0:h.create),{data:v,error:x}=await iy({publicKey:p,signal:g});return v?{data:{factorId:s,challengeId:f.id,webauthn:{type:f.webauthn.type,credential_response:v}},error:null}:{data:null,error:x}}case"request":{const p=dy(f.webauthn.credential_options.publicKey,h==null?void 0:h.request),{data:v,error:x}=await ly(Object.assign(Object.assign({},f.webauthn.credential_options),{publicKey:p,signal:g}));return v?{data:{factorId:s,challengeId:f.id,webauthn:{type:f.webauthn.type,credential_response:v}},error:null}:{data:null,error:x}}}}catch(f){return Ae(f)?{data:null,error:f}:{data:null,error:new Er("Unexpected error in challenge",f)}}}async _verify({challengeId:s,factorId:n,webauthn:o}){return this.client.mfa.verify({factorId:n,challengeId:s,webauthn:o})}async _authenticate({factorId:s,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:o=typeof window<"u"?[window.location.origin]:void 0,signal:d}={}},h){if(!n)return{data:null,error:new vi("rpId is required for WebAuthn authentication")};try{if(!ap())return{data:null,error:new Er("Browser does not support WebAuthn",null)};const{data:f,error:b}=await this.challenge({factorId:s,webauthn:{rpId:n,rpOrigins:o},signal:d},{request:h});if(!f)return{data:null,error:b};const{webauthn:g}=f;return this._verify({factorId:s,challengeId:f.challengeId,webauthn:{type:g.type,rpId:n,rpOrigins:o,credential_response:g.credential_response}})}catch(f){return Ae(f)?{data:null,error:f}:{data:null,error:new Er("Unexpected error in authenticate",f)}}}async _register({friendlyName:s,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:o=typeof window<"u"?[window.location.origin]:void 0,signal:d}={}},h){if(!n)return{data:null,error:new vi("rpId is required for WebAuthn registration")};try{if(!ap())return{data:null,error:new Er("Browser does not support WebAuthn",null)};const{data:f,error:b}=await this._enroll({friendlyName:s});if(!f)return await this.client.mfa.listFactors().then(v=>{var x;return(x=v.data)===null||x===void 0?void 0:x.all.find(N=>N.factor_type==="webauthn"&&N.friendly_name===s&&N.status!=="unverified")}).then(v=>v?this.client.mfa.unenroll({factorId:v==null?void 0:v.id}):void 0),{data:null,error:b};const{data:g,error:p}=await this._challenge({factorId:f.id,friendlyName:f.friendly_name,webauthn:{rpId:n,rpOrigins:o},signal:d},{create:h});return g?this._verify({factorId:f.id,challengeId:g.challengeId,webauthn:{rpId:n,rpOrigins:o,type:g.webauthn.type,credential_response:g.webauthn.credential_response}}):{data:null,error:p}}catch(f){return Ae(f)?{data:null,error:f}:{data:null,error:new Er("Unexpected error in register",f)}}}}Qx();const fy={url:ox,storageKey:cx,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:ux,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function sp(l,s,n){return await n()}const gn={};class wi{get jwks(){var s,n;return(n=(s=gn[this.storageKey])===null||s===void 0?void 0:s.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(s){gn[this.storageKey]=Object.assign(Object.assign({},gn[this.storageKey]),{jwks:s})}get jwks_cached_at(){var s,n;return(n=(s=gn[this.storageKey])===null||s===void 0?void 0:s.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(s){gn[this.storageKey]=Object.assign(Object.assign({},gn[this.storageKey]),{cachedAt:s})}constructor(s){var n,o,d;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const h=Object.assign(Object.assign({},fy),s);if(this.storageKey=h.storageKey,this.instanceID=(n=wi.nextInstanceID[this.storageKey])!==null&&n!==void 0?n:0,wi.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!h.debug,typeof h.debug=="function"&&(this.logger=h.debug),this.instanceID>0&&ia()){const f=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(f),this.logDebugMessages&&console.trace(f)}if(this.persistSession=h.persistSession,this.autoRefreshToken=h.autoRefreshToken,this.admin=new Yx({url:h.url,headers:h.headers,fetch:h.fetch}),this.url=h.url,this.headers=h.headers,this.fetch=Sp(h.fetch),this.lock=h.lock||sp,this.detectSessionInUrl=h.detectSessionInUrl,this.flowType=h.flowType,this.hasCustomAuthorizationHeader=h.hasCustomAuthorizationHeader,this.throwOnError=h.throwOnError,h.lock?this.lock=h.lock:this.persistSession&&ia()&&(!((o=globalThis==null?void 0:globalThis.navigator)===null||o===void 0)&&o.locks)?this.lock=Vx:this.lock=sp,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new hy(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(h.storage?this.storage=h.storage:Np()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=tp(this.memoryStorage)),h.userStorage&&(this.userStorage=h.userStorage)):(this.memoryStorage={},this.storage=tp(this.memoryStorage)),ia()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(f){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",f)}(d=this.broadcastChannel)===null||d===void 0||d.addEventListener("message",async f=>{this._debug("received broadcast notification from other tab or client",f),await this._notifyAllSubscribers(f.data.event,f.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(s){if(this.throwOnError&&s&&s.error)throw s.error;return s}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${wp}) ${new Date().toISOString()}`}_debug(...s){return this.logDebugMessages&&this.logger(this._logPrefix(),...s),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var s;try{let n={},o="none";if(ia()&&(n=Sx(window.location.href),this._isImplicitGrantCallback(n)?o="implicit":await this._isPKCECallback(n)&&(o="pkce")),ia()&&this.detectSessionInUrl&&o!=="none"){const{data:d,error:h}=await this._getSessionFromURL(n,o);if(h){if(this._debug("#_initialize()","error detecting session from URL",h),gx(h)){const g=(s=h.details)===null||s===void 0?void 0:s.code;if(g==="identity_already_exists"||g==="identity_not_found"||g==="single_identity_not_deletable")return{error:h}}return await this._removeSession(),{error:h}}const{session:f,redirectType:b}=d;return this._debug("#_initialize()","detected session in URL",f,"redirect type",b),await this._saveSession(f),setTimeout(async()=>{b==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",f):await this._notifyAllSubscribers("SIGNED_IN",f)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return Ae(n)?this._returnResult({error:n}):this._returnResult({error:new Er("Unexpected error during initialization",n)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(s){var n,o,d;try{const h=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(o=(n=s==null?void 0:s.options)===null||n===void 0?void 0:n.data)!==null&&o!==void 0?o:{},gotrue_meta_security:{captcha_token:(d=s==null?void 0:s.options)===null||d===void 0?void 0:d.captchaToken}},xform:Wa}),{data:f,error:b}=h;if(b||!f)return this._returnResult({data:{user:null,session:null},error:b});const g=f.session,p=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",g)),this._returnResult({data:{user:p,session:g},error:null})}catch(h){if(Ae(h))return this._returnResult({data:{user:null,session:null},error:h});throw h}}async signUp(s){var n,o,d;try{let h;if("email"in s){const{email:v,password:x,options:N}=s;let j=null,C=null;this.flowType==="pkce"&&([j,C]=await fn(this.storage,this.storageKey)),h=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:N==null?void 0:N.emailRedirectTo,body:{email:v,password:x,data:(n=N==null?void 0:N.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:N==null?void 0:N.captchaToken},code_challenge:j,code_challenge_method:C},xform:Wa})}else if("phone"in s){const{phone:v,password:x,options:N}=s;h=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:v,password:x,data:(o=N==null?void 0:N.data)!==null&&o!==void 0?o:{},channel:(d=N==null?void 0:N.channel)!==null&&d!==void 0?d:"sms",gotrue_meta_security:{captcha_token:N==null?void 0:N.captchaToken}},xform:Wa})}else throw new ql("You must provide either an email or phone number and a password");const{data:f,error:b}=h;if(b||!f)return await na(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:b});const g=f.session,p=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",g)),this._returnResult({data:{user:p,session:g},error:null})}catch(h){if(await na(this.storage,`${this.storageKey}-code-verifier`),Ae(h))return this._returnResult({data:{user:null,session:null},error:h});throw h}}async signInWithPassword(s){try{let n;if("email"in s){const{email:h,password:f,options:b}=s;n=await Me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:h,password:f,gotrue_meta_security:{captcha_token:b==null?void 0:b.captchaToken}},xform:Fm})}else if("phone"in s){const{phone:h,password:f,options:b}=s;n=await Me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:h,password:f,gotrue_meta_security:{captcha_token:b==null?void 0:b.captchaToken}},xform:Fm})}else throw new ql("You must provide either an email or phone number and a password");const{data:o,error:d}=n;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!o||!o.session||!o.user){const h=new hn;return this._returnResult({data:{user:null,session:null},error:h})}return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),this._returnResult({data:Object.assign({user:o.user,session:o.session},o.weak_password?{weakPassword:o.weak_password}:null),error:d})}catch(n){if(Ae(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOAuth(s){var n,o,d,h;return await this._handleProviderSignIn(s.provider,{redirectTo:(n=s.options)===null||n===void 0?void 0:n.redirectTo,scopes:(o=s.options)===null||o===void 0?void 0:o.scopes,queryParams:(d=s.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:(h=s.options)===null||h===void 0?void 0:h.skipBrowserRedirect})}async exchangeCodeForSession(s){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(s))}async signInWithWeb3(s){const{chain:n}=s;switch(n){case"ethereum":return await this.signInWithEthereum(s);case"solana":return await this.signInWithSolana(s);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(s){var n,o,d,h,f,b,g,p,v,x,N;let j,C;if("message"in s)j=s.message,C=s.signature;else{const{chain:z,wallet:M,statement:E,options:O}=s;let _;if(ia())if(typeof M=="object")_=M;else{const we=window;if("ethereum"in we&&typeof we.ethereum=="object"&&"request"in we.ethereum&&typeof we.ethereum.request=="function")_=we.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof M!="object"||!(O!=null&&O.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=M}const G=new URL((n=O==null?void 0:O.url)!==null&&n!==void 0?n:window.location.href),he=await _.request({method:"eth_requestAccounts"}).then(we=>we).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!he||he.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const Z=Tp(he[0]);let ie=(o=O==null?void 0:O.signInWithEthereum)===null||o===void 0?void 0:o.chainId;if(!ie){const we=await _.request({method:"eth_chainId"});ie=Zx(we)}const ge={domain:G.host,address:Z,statement:E,uri:G.href,version:"1",chainId:ie,nonce:(d=O==null?void 0:O.signInWithEthereum)===null||d===void 0?void 0:d.nonce,issuedAt:(f=(h=O==null?void 0:O.signInWithEthereum)===null||h===void 0?void 0:h.issuedAt)!==null&&f!==void 0?f:new Date,expirationTime:(b=O==null?void 0:O.signInWithEthereum)===null||b===void 0?void 0:b.expirationTime,notBefore:(g=O==null?void 0:O.signInWithEthereum)===null||g===void 0?void 0:g.notBefore,requestId:(p=O==null?void 0:O.signInWithEthereum)===null||p===void 0?void 0:p.requestId,resources:(v=O==null?void 0:O.signInWithEthereum)===null||v===void 0?void 0:v.resources};j=Xx(ge),C=await _.request({method:"personal_sign",params:[Jx(j),Z]})}try{const{data:z,error:M}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:j,signature:C},!((x=s.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(N=s.options)===null||N===void 0?void 0:N.captchaToken}}:null),xform:Wa});if(M)throw M;if(!z||!z.session||!z.user){const E=new hn;return this._returnResult({data:{user:null,session:null},error:E})}return z.session&&(await this._saveSession(z.session),await this._notifyAllSubscribers("SIGNED_IN",z.session)),this._returnResult({data:Object.assign({},z),error:M})}catch(z){if(Ae(z))return this._returnResult({data:{user:null,session:null},error:z});throw z}}async signInWithSolana(s){var n,o,d,h,f,b,g,p,v,x,N,j;let C,z;if("message"in s)C=s.message,z=s.signature;else{const{chain:M,wallet:E,statement:O,options:_}=s;let G;if(ia())if(typeof E=="object")G=E;else{const Z=window;if("solana"in Z&&typeof Z.solana=="object"&&("signIn"in Z.solana&&typeof Z.solana.signIn=="function"||"signMessage"in Z.solana&&typeof Z.solana.signMessage=="function"))G=Z.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof E!="object"||!(_!=null&&_.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");G=E}const he=new URL((n=_==null?void 0:_.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in G&&G.signIn){const Z=await G.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},_==null?void 0:_.signInWithSolana),{version:"1",domain:he.host,uri:he.href}),O?{statement:O}:null));let ie;if(Array.isArray(Z)&&Z[0]&&typeof Z[0]=="object")ie=Z[0];else if(Z&&typeof Z=="object"&&"signedMessage"in Z&&"signature"in Z)ie=Z;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in ie&&"signature"in ie&&(typeof ie.signedMessage=="string"||ie.signedMessage instanceof Uint8Array)&&ie.signature instanceof Uint8Array)C=typeof ie.signedMessage=="string"?ie.signedMessage:new TextDecoder().decode(ie.signedMessage),z=ie.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in G)||typeof G.signMessage!="function"||!("publicKey"in G)||typeof G!="object"||!G.publicKey||!("toBase58"in G.publicKey)||typeof G.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");C=[`${he.host} wants you to sign in with your Solana account:`,G.publicKey.toBase58(),...O?["",O,""]:[""],"Version: 1",`URI: ${he.href}`,`Issued At: ${(d=(o=_==null?void 0:_.signInWithSolana)===null||o===void 0?void 0:o.issuedAt)!==null&&d!==void 0?d:new Date().toISOString()}`,...!((h=_==null?void 0:_.signInWithSolana)===null||h===void 0)&&h.notBefore?[`Not Before: ${_.signInWithSolana.notBefore}`]:[],...!((f=_==null?void 0:_.signInWithSolana)===null||f===void 0)&&f.expirationTime?[`Expiration Time: ${_.signInWithSolana.expirationTime}`]:[],...!((b=_==null?void 0:_.signInWithSolana)===null||b===void 0)&&b.chainId?[`Chain ID: ${_.signInWithSolana.chainId}`]:[],...!((g=_==null?void 0:_.signInWithSolana)===null||g===void 0)&&g.nonce?[`Nonce: ${_.signInWithSolana.nonce}`]:[],...!((p=_==null?void 0:_.signInWithSolana)===null||p===void 0)&&p.requestId?[`Request ID: ${_.signInWithSolana.requestId}`]:[],...!((x=(v=_==null?void 0:_.signInWithSolana)===null||v===void 0?void 0:v.resources)===null||x===void 0)&&x.length?["Resources",..._.signInWithSolana.resources.map(ie=>`- ${ie}`)]:[]].join(`
`);const Z=await G.signMessage(new TextEncoder().encode(C),"utf8");if(!Z||!(Z instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");z=Z}}try{const{data:M,error:E}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:C,signature:Tr(z)},!((N=s.options)===null||N===void 0)&&N.captchaToken?{gotrue_meta_security:{captcha_token:(j=s.options)===null||j===void 0?void 0:j.captchaToken}}:null),xform:Wa});if(E)throw E;if(!M||!M.session||!M.user){const O=new hn;return this._returnResult({data:{user:null,session:null},error:O})}return M.session&&(await this._saveSession(M.session),await this._notifyAllSubscribers("SIGNED_IN",M.session)),this._returnResult({data:Object.assign({},M),error:E})}catch(M){if(Ae(M))return this._returnResult({data:{user:null,session:null},error:M});throw M}}async _exchangeCodeForSession(s){const n=await _r(this.storage,`${this.storageKey}-code-verifier`),[o,d]=(n??"").split("/");try{if(!o&&this.flowType==="pkce")throw new bx;const{data:h,error:f}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:s,code_verifier:o},xform:Wa});if(await na(this.storage,`${this.storageKey}-code-verifier`),f)throw f;if(!h||!h.session||!h.user){const b=new hn;return this._returnResult({data:{user:null,session:null,redirectType:null},error:b})}return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),this._returnResult({data:Object.assign(Object.assign({},h),{redirectType:d??null}),error:f})}catch(h){if(await na(this.storage,`${this.storageKey}-code-verifier`),Ae(h))return this._returnResult({data:{user:null,session:null,redirectType:null},error:h});throw h}}async signInWithIdToken(s){try{const{options:n,provider:o,token:d,access_token:h,nonce:f}=s,b=await Me(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:o,id_token:d,access_token:h,nonce:f,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:Wa}),{data:g,error:p}=b;if(p)return this._returnResult({data:{user:null,session:null},error:p});if(!g||!g.session||!g.user){const v=new hn;return this._returnResult({data:{user:null,session:null},error:v})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:g,error:p})}catch(n){if(Ae(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOtp(s){var n,o,d,h,f;try{if("email"in s){const{email:b,options:g}=s;let p=null,v=null;this.flowType==="pkce"&&([p,v]=await fn(this.storage,this.storageKey));const{error:x}=await Me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:b,data:(n=g==null?void 0:g.data)!==null&&n!==void 0?n:{},create_user:(o=g==null?void 0:g.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},code_challenge:p,code_challenge_method:v},redirectTo:g==null?void 0:g.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:x})}if("phone"in s){const{phone:b,options:g}=s,{data:p,error:v}=await Me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:b,data:(d=g==null?void 0:g.data)!==null&&d!==void 0?d:{},create_user:(h=g==null?void 0:g.shouldCreateUser)!==null&&h!==void 0?h:!0,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},channel:(f=g==null?void 0:g.channel)!==null&&f!==void 0?f:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:p==null?void 0:p.message_id},error:v})}throw new ql("You must provide either an email or phone number.")}catch(b){if(await na(this.storage,`${this.storageKey}-code-verifier`),Ae(b))return this._returnResult({data:{user:null,session:null},error:b});throw b}}async verifyOtp(s){var n,o;try{let d,h;"options"in s&&(d=(n=s.options)===null||n===void 0?void 0:n.redirectTo,h=(o=s.options)===null||o===void 0?void 0:o.captchaToken);const{data:f,error:b}=await Me(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},s),{gotrue_meta_security:{captcha_token:h}}),redirectTo:d,xform:Wa});if(b)throw b;if(!f)throw new Error("An error occurred on token verification.");const g=f.session,p=f.user;return g!=null&&g.access_token&&(await this._saveSession(g),await this._notifyAllSubscribers(s.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",g)),this._returnResult({data:{user:p,session:g},error:null})}catch(d){if(Ae(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async signInWithSSO(s){var n,o,d,h,f;try{let b=null,g=null;this.flowType==="pkce"&&([b,g]=await fn(this.storage,this.storageKey));const p=await Me(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in s?{provider_id:s.providerId}:null),"domain"in s?{domain:s.domain}:null),{redirect_to:(o=(n=s.options)===null||n===void 0?void 0:n.redirectTo)!==null&&o!==void 0?o:void 0}),!((d=s==null?void 0:s.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:s.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:b,code_challenge_method:g}),headers:this.headers,xform:qx});return!((h=p.data)===null||h===void 0)&&h.url&&ia()&&!(!((f=s.options)===null||f===void 0)&&f.skipBrowserRedirect)&&window.location.assign(p.data.url),this._returnResult(p)}catch(b){if(await na(this.storage,`${this.storageKey}-code-verifier`),Ae(b))return this._returnResult({data:null,error:b});throw b}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async s=>{const{data:{session:n},error:o}=s;if(o)throw o;if(!n)throw new Ca;const{error:d}=await Me(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return this._returnResult({data:{user:null,session:null},error:d})})}catch(s){if(Ae(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async resend(s){try{const n=`${this.url}/resend`;if("email"in s){const{email:o,type:d,options:h}=s,{error:f}=await Me(this.fetch,"POST",n,{headers:this.headers,body:{email:o,type:d,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},redirectTo:h==null?void 0:h.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}else if("phone"in s){const{phone:o,type:d,options:h}=s,{data:f,error:b}=await Me(this.fetch,"POST",n,{headers:this.headers,body:{phone:o,type:d,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:f==null?void 0:f.message_id},error:b})}throw new ql("You must provide either an email or phone number and a type")}catch(n){if(Ae(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(s,n){this._debug("#_acquireLock","begin",s);try{if(this.lockAcquired){const o=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),d=(async()=>(await o,await n()))();return this.pendingInLock.push((async()=>{try{await d}catch{}})()),d}return await this.lock(`lock:${this.storageKey}`,s,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const o=n();for(this.pendingInLock.push((async()=>{try{await o}catch{}})()),await o;this.pendingInLock.length;){const d=[...this.pendingInLock];await Promise.all(d),this.pendingInLock.splice(0,d.length)}return await o}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(s){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await s(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let s=null;const n=await _r(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?s=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!s)return{data:{session:null},error:null};const o=s.expires_at?s.expires_at*1e3-Date.now()<pu:!1;if(this._debug("#__loadSession()",`session has${o?"":" not"} expired`,"expires_at",s.expires_at),!o){if(this.userStorage){const f=await _r(this.userStorage,this.storageKey+"-user");f!=null&&f.user?s.user=f.user:s.user=xu()}if(this.storage.isServer&&s.user&&!s.user.__isUserNotAvailableProxy){const f={value:this.suppressGetSessionWarning};s.user=Bx(s.user,f),f.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:s},error:null}}const{data:d,error:h}=await this._callRefreshToken(s.refresh_token);return h?this._returnResult({data:{session:null},error:h}):this._returnResult({data:{session:d},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(s){if(s)return await this._getUser(s);await this.initializePromise;const n=await this._acquireLock(-1,async()=>await this._getUser());return n.data.user&&(this.suppressGetSessionWarning=!0),n}async _getUser(s){try{return s?await Me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:s,xform:rr}):await this._useSession(async n=>{var o,d,h;const{data:f,error:b}=n;if(b)throw b;return!(!((o=f.session)===null||o===void 0)&&o.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ca}:await Me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(h=(d=f.session)===null||d===void 0?void 0:d.access_token)!==null&&h!==void 0?h:void 0,xform:rr})})}catch(n){if(Ae(n))return px(n)&&(await this._removeSession(),await na(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:n});throw n}}async updateUser(s,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(s,n))}async _updateUser(s,n={}){try{return await this._useSession(async o=>{const{data:d,error:h}=o;if(h)throw h;if(!d.session)throw new Ca;const f=d.session;let b=null,g=null;this.flowType==="pkce"&&s.email!=null&&([b,g]=await fn(this.storage,this.storageKey));const{data:p,error:v}=await Me(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},s),{code_challenge:b,code_challenge_method:g}),jwt:f.access_token,xform:rr});if(v)throw v;return f.user=p.user,await this._saveSession(f),await this._notifyAllSubscribers("USER_UPDATED",f),this._returnResult({data:{user:f.user},error:null})})}catch(o){if(await na(this.storage,`${this.storageKey}-code-verifier`),Ae(o))return this._returnResult({data:{user:null},error:o});throw o}}async setSession(s){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(s))}async _setSession(s){try{if(!s.access_token||!s.refresh_token)throw new Ca;const n=Date.now()/1e3;let o=n,d=!0,h=null;const{payload:f}=bu(s.access_token);if(f.exp&&(o=f.exp,d=o<=n),d){const{data:b,error:g}=await this._callRefreshToken(s.refresh_token);if(g)return this._returnResult({data:{user:null,session:null},error:g});if(!b)return{data:{user:null,session:null},error:null};h=b}else{const{data:b,error:g}=await this._getUser(s.access_token);if(g)throw g;h={access_token:s.access_token,refresh_token:s.refresh_token,user:b.user,token_type:"bearer",expires_in:o-n,expires_at:o},await this._saveSession(h),await this._notifyAllSubscribers("SIGNED_IN",h)}return this._returnResult({data:{user:h.user,session:h},error:null})}catch(n){if(Ae(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}}async refreshSession(s){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(s))}async _refreshSession(s){try{return await this._useSession(async n=>{var o;if(!s){const{data:f,error:b}=n;if(b)throw b;s=(o=f.session)!==null&&o!==void 0?o:void 0}if(!(s!=null&&s.refresh_token))throw new Ca;const{data:d,error:h}=await this._callRefreshToken(s.refresh_token);return h?this._returnResult({data:{user:null,session:null},error:h}):d?this._returnResult({data:{user:d.user,session:d},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(n){if(Ae(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async _getSessionFromURL(s,n){try{if(!ia())throw new Pl("No browser detected.");if(s.error||s.error_description||s.error_code)throw new Pl(s.error_description||"Error in URL with unspecified error_description",{error:s.error||"unspecified_error",code:s.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new Km("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Pl("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!s.code)throw new Km("No code detected.");const{data:O,error:_}=await this._exchangeCodeForSession(s.code);if(_)throw _;const G=new URL(window.location.href);return G.searchParams.delete("code"),window.history.replaceState(window.history.state,"",G.toString()),{data:{session:O.session,redirectType:null},error:null}}const{provider_token:o,provider_refresh_token:d,access_token:h,refresh_token:f,expires_in:b,expires_at:g,token_type:p}=s;if(!h||!b||!f||!p)throw new Pl("No session defined in URL");const v=Math.round(Date.now()/1e3),x=parseInt(b);let N=v+x;g&&(N=parseInt(g));const j=N-v;j*1e3<=yn&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${j}s, should have been closer to ${x}s`);const C=N-x;v-C>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",C,N,v):v-C<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",C,N,v);const{data:z,error:M}=await this._getUser(h);if(M)throw M;const E={provider_token:o,provider_refresh_token:d,access_token:h,expires_in:x,expires_at:N,refresh_token:f,token_type:p,user:z.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:E,redirectType:s.type},error:null})}catch(o){if(Ae(o))return this._returnResult({data:{session:null,redirectType:null},error:o});throw o}}_isImplicitGrantCallback(s){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),s):!!(s.access_token||s.error_description)}async _isPKCECallback(s){const n=await _r(this.storage,`${this.storageKey}-code-verifier`);return!!(s.code&&n)}async signOut(s={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(s))}async _signOut({scope:s}={scope:"global"}){return await this._useSession(async n=>{var o;const{data:d,error:h}=n;if(h)return this._returnResult({error:h});const f=(o=d.session)===null||o===void 0?void 0:o.access_token;if(f){const{error:b}=await this.admin.signOut(f,s);if(b&&!(mx(b)&&(b.status===404||b.status===401||b.status===403)))return this._returnResult({error:b})}return s!=="others"&&(await this._removeSession(),await na(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(s){const n=Nx(),o={id:n,callback:s,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,o),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:o}}}async _emitInitialSession(s){return await this._useSession(async n=>{var o,d;try{const{data:{session:h},error:f}=n;if(f)throw f;await((o=this.stateChangeEmitters.get(s))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",h)),this._debug("INITIAL_SESSION","callback id",s,"session",h)}catch(h){await((d=this.stateChangeEmitters.get(s))===null||d===void 0?void 0:d.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",s,"error",h),console.error(h)}})}async resetPasswordForEmail(s,n={}){let o=null,d=null;this.flowType==="pkce"&&([o,d]=await fn(this.storage,this.storageKey,!0));try{return await Me(this.fetch,"POST",`${this.url}/recover`,{body:{email:s,code_challenge:o,code_challenge_method:d,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(h){if(await na(this.storage,`${this.storageKey}-code-verifier`),Ae(h))return this._returnResult({data:null,error:h});throw h}}async getUserIdentities(){var s;try{const{data:n,error:o}=await this.getUser();if(o)throw o;return this._returnResult({data:{identities:(s=n.user.identities)!==null&&s!==void 0?s:[]},error:null})}catch(n){if(Ae(n))return this._returnResult({data:null,error:n});throw n}}async linkIdentity(s){return"token"in s?this.linkIdentityIdToken(s):this.linkIdentityOAuth(s)}async linkIdentityOAuth(s){var n;try{const{data:o,error:d}=await this._useSession(async h=>{var f,b,g,p,v;const{data:x,error:N}=h;if(N)throw N;const j=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,s.provider,{redirectTo:(f=s.options)===null||f===void 0?void 0:f.redirectTo,scopes:(b=s.options)===null||b===void 0?void 0:b.scopes,queryParams:(g=s.options)===null||g===void 0?void 0:g.queryParams,skipBrowserRedirect:!0});return await Me(this.fetch,"GET",j,{headers:this.headers,jwt:(v=(p=x.session)===null||p===void 0?void 0:p.access_token)!==null&&v!==void 0?v:void 0})});if(d)throw d;return ia()&&!(!((n=s.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(o==null?void 0:o.url),this._returnResult({data:{provider:s.provider,url:o==null?void 0:o.url},error:null})}catch(o){if(Ae(o))return this._returnResult({data:{provider:s.provider,url:null},error:o});throw o}}async linkIdentityIdToken(s){return await this._useSession(async n=>{var o;try{const{error:d,data:{session:h}}=n;if(d)throw d;const{options:f,provider:b,token:g,access_token:p,nonce:v}=s,x=await Me(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(o=h==null?void 0:h.access_token)!==null&&o!==void 0?o:void 0,body:{provider:b,id_token:g,access_token:p,nonce:v,link_identity:!0,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Wa}),{data:N,error:j}=x;return j?this._returnResult({data:{user:null,session:null},error:j}):!N||!N.session||!N.user?this._returnResult({data:{user:null,session:null},error:new hn}):(N.session&&(await this._saveSession(N.session),await this._notifyAllSubscribers("USER_UPDATED",N.session)),this._returnResult({data:N,error:j}))}catch(d){if(await na(this.storage,`${this.storageKey}-code-verifier`),Ae(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}})}async unlinkIdentity(s){try{return await this._useSession(async n=>{var o,d;const{data:h,error:f}=n;if(f)throw f;return await Me(this.fetch,"DELETE",`${this.url}/user/identities/${s.identity_id}`,{headers:this.headers,jwt:(d=(o=h.session)===null||o===void 0?void 0:o.access_token)!==null&&d!==void 0?d:void 0})})}catch(n){if(Ae(n))return this._returnResult({data:null,error:n});throw n}}async _refreshAccessToken(s){const n=`#_refreshAccessToken(${s.substring(0,5)}...)`;this._debug(n,"begin");try{const o=Date.now();return await kx(async d=>(d>0&&await Tx(200*Math.pow(2,d-1)),this._debug(n,"refreshing attempt",d),await Me(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:s},headers:this.headers,xform:Wa})),(d,h)=>{const f=200*Math.pow(2,d);return h&&gu(h)&&Date.now()+f-o<yn})}catch(o){if(this._debug(n,"error",o),Ae(o))return this._returnResult({data:{session:null,user:null},error:o});throw o}finally{this._debug(n,"end")}}_isValidSession(s){return typeof s=="object"&&s!==null&&"access_token"in s&&"refresh_token"in s&&"expires_at"in s}async _handleProviderSignIn(s,n){const o=await this._getUrlForProvider(`${this.url}/authorize`,s,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",s,"options",n,"url",o),ia()&&!n.skipBrowserRedirect&&window.location.assign(o),{data:{provider:s,url:o},error:null}}async _recoverAndRefresh(){var s,n;const o="#_recoverAndRefresh()";this._debug(o,"begin");try{const d=await _r(this.storage,this.storageKey);if(d&&this.userStorage){let f=await _r(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!f&&(f={user:d.user},await vn(this.userStorage,this.storageKey+"-user",f)),d.user=(s=f==null?void 0:f.user)!==null&&s!==void 0?s:xu()}else if(d&&!d.user&&!d.user){const f=await _r(this.storage,this.storageKey+"-user");f&&(f!=null&&f.user)?(d.user=f.user,await na(this.storage,this.storageKey+"-user"),await vn(this.storage,this.storageKey,d)):d.user=xu()}if(this._debug(o,"session from storage",d),!this._isValidSession(d)){this._debug(o,"session is not valid"),d!==null&&await this._removeSession();return}const h=((n=d.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<pu;if(this._debug(o,`session has${h?"":" not"} expired with margin of ${pu}s`),h){if(this.autoRefreshToken&&d.refresh_token){const{error:f}=await this._callRefreshToken(d.refresh_token);f&&(console.error(f),gu(f)||(this._debug(o,"refresh failed with a non-retryable error, removing the session",f),await this._removeSession()))}}else if(d.user&&d.user.__isUserNotAvailableProxy===!0)try{const{data:f,error:b}=await this._getUser(d.access_token);!b&&(f!=null&&f.user)?(d.user=f.user,await this._saveSession(d),await this._notifyAllSubscribers("SIGNED_IN",d)):this._debug(o,"could not get user data, skipping SIGNED_IN notification")}catch(f){console.error("Error getting user data:",f),this._debug(o,"error getting user data, skipping SIGNED_IN notification",f)}else await this._notifyAllSubscribers("SIGNED_IN",d)}catch(d){this._debug(o,"error",d),console.error(d);return}finally{this._debug(o,"end")}}async _callRefreshToken(s){var n,o;if(!s)throw new Ca;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const d=`#_callRefreshToken(${s.substring(0,5)}...)`;this._debug(d,"begin");try{this.refreshingDeferred=new Jl;const{data:h,error:f}=await this._refreshAccessToken(s);if(f)throw f;if(!h.session)throw new Ca;await this._saveSession(h.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",h.session);const b={data:h.session,error:null};return this.refreshingDeferred.resolve(b),b}catch(h){if(this._debug(d,"error",h),Ae(h)){const f={data:null,error:h};return gu(h)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(f),f}throw(o=this.refreshingDeferred)===null||o===void 0||o.reject(h),h}finally{this.refreshingDeferred=null,this._debug(d,"end")}}async _notifyAllSubscribers(s,n,o=!0){const d=`#_notifyAllSubscribers(${s})`;this._debug(d,"begin",n,`broadcast = ${o}`);try{this.broadcastChannel&&o&&this.broadcastChannel.postMessage({event:s,session:n});const h=[],f=Array.from(this.stateChangeEmitters.values()).map(async b=>{try{await b.callback(s,n)}catch(g){h.push(g)}});if(await Promise.all(f),h.length>0){for(let b=0;b<h.length;b+=1)console.error(h[b]);throw h[0]}}finally{this._debug(d,"end")}}async _saveSession(s){this._debug("#_saveSession()",s),this.suppressGetSessionWarning=!0,await na(this.storage,`${this.storageKey}-code-verifier`);const n=Object.assign({},s),o=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!o&&n.user&&await vn(this.userStorage,this.storageKey+"-user",{user:n.user});const d=Object.assign({},n);delete d.user;const h=Xm(d);await vn(this.storage,this.storageKey,h)}else{const d=Xm(n);await vn(this.storage,this.storageKey,d)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await na(this.storage,this.storageKey),await na(this.storage,this.storageKey+"-code-verifier"),await na(this.storage,this.storageKey+"-user"),this.userStorage&&await na(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const s=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{s&&ia()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",s)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const s=setInterval(()=>this._autoRefreshTokenTick(),yn);this.autoRefreshTicker=s,s&&typeof s=="object"&&typeof s.unref=="function"?s.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(s),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const s=this.autoRefreshTicker;this.autoRefreshTicker=null,s&&clearInterval(s)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const s=Date.now();try{return await this._useSession(async n=>{const{data:{session:o}}=n;if(!o||!o.refresh_token||!o.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const d=Math.floor((o.expires_at*1e3-s)/yn);this._debug("#_autoRefreshTokenTick()",`access token expires in ${d} ticks, a tick lasts ${yn}ms, refresh threshold is ${ku} ticks`),d<=ku&&await this._callRefreshToken(o.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(s){if(s.isAcquireTimeout||s instanceof Ep)this._debug("auto refresh token tick lock not available");else throw s}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ia()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(s){console.error("_handleVisibilityChange",s)}}async _onVisibilityChanged(s){const n=`#_onVisibilityChanged(${s})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),s||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(s,n,o){const d=[`provider=${encodeURIComponent(n)}`];if(o!=null&&o.redirectTo&&d.push(`redirect_to=${encodeURIComponent(o.redirectTo)}`),o!=null&&o.scopes&&d.push(`scopes=${encodeURIComponent(o.scopes)}`),this.flowType==="pkce"){const[h,f]=await fn(this.storage,this.storageKey),b=new URLSearchParams({code_challenge:`${encodeURIComponent(h)}`,code_challenge_method:`${encodeURIComponent(f)}`});d.push(b.toString())}if(o!=null&&o.queryParams){const h=new URLSearchParams(o.queryParams);d.push(h.toString())}return o!=null&&o.skipBrowserRedirect&&d.push(`skip_http_redirect=${o.skipBrowserRedirect}`),`${s}?${d.join("&")}`}async _unenroll(s){try{return await this._useSession(async n=>{var o;const{data:d,error:h}=n;return h?this._returnResult({data:null,error:h}):await Me(this.fetch,"DELETE",`${this.url}/factors/${s.factorId}`,{headers:this.headers,jwt:(o=d==null?void 0:d.session)===null||o===void 0?void 0:o.access_token})})}catch(n){if(Ae(n))return this._returnResult({data:null,error:n});throw n}}async _enroll(s){try{return await this._useSession(async n=>{var o,d;const{data:h,error:f}=n;if(f)return this._returnResult({data:null,error:f});const b=Object.assign({friendly_name:s.friendlyName,factor_type:s.factorType},s.factorType==="phone"?{phone:s.phone}:s.factorType==="totp"?{issuer:s.issuer}:{}),{data:g,error:p}=await Me(this.fetch,"POST",`${this.url}/factors`,{body:b,headers:this.headers,jwt:(o=h==null?void 0:h.session)===null||o===void 0?void 0:o.access_token});return p?this._returnResult({data:null,error:p}):(s.factorType==="totp"&&g.type==="totp"&&(!((d=g==null?void 0:g.totp)===null||d===void 0)&&d.qr_code)&&(g.totp.qr_code=`data:image/svg+xml;utf-8,${g.totp.qr_code}`),this._returnResult({data:g,error:null}))})}catch(n){if(Ae(n))return this._returnResult({data:null,error:n});throw n}}async _verify(s){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var o;const{data:d,error:h}=n;if(h)return this._returnResult({data:null,error:h});const f=Object.assign({challenge_id:s.challengeId},"webauthn"in s?{webauthn:Object.assign(Object.assign({},s.webauthn),{credential_response:s.webauthn.type==="create"?ry(s.webauthn.credential_response):ny(s.webauthn.credential_response)})}:{code:s.code}),{data:b,error:g}=await Me(this.fetch,"POST",`${this.url}/factors/${s.factorId}/verify`,{body:f,headers:this.headers,jwt:(o=d==null?void 0:d.session)===null||o===void 0?void 0:o.access_token});return g?this._returnResult({data:null,error:g}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+b.expires_in},b)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",b),this._returnResult({data:b,error:g}))})}catch(n){if(Ae(n))return this._returnResult({data:null,error:n});throw n}})}async _challenge(s){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var o;const{data:d,error:h}=n;if(h)return this._returnResult({data:null,error:h});const f=await Me(this.fetch,"POST",`${this.url}/factors/${s.factorId}/challenge`,{body:s,headers:this.headers,jwt:(o=d==null?void 0:d.session)===null||o===void 0?void 0:o.access_token});if(f.error)return f;const{data:b}=f;if(b.type!=="webauthn")return{data:b,error:null};switch(b.webauthn.type){case"create":return{data:Object.assign(Object.assign({},b),{webauthn:Object.assign(Object.assign({},b.webauthn),{credential_options:Object.assign(Object.assign({},b.webauthn.credential_options),{publicKey:ay(b.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},b),{webauthn:Object.assign(Object.assign({},b.webauthn),{credential_options:Object.assign(Object.assign({},b.webauthn.credential_options),{publicKey:sy(b.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(n){if(Ae(n))return this._returnResult({data:null,error:n});throw n}})}async _challengeAndVerify(s){const{data:n,error:o}=await this._challenge({factorId:s.factorId});return o?this._returnResult({data:null,error:o}):await this._verify({factorId:s.factorId,challengeId:n.id,code:s.code})}async _listFactors(){var s;const{data:{user:n},error:o}=await this.getUser();if(o)return{data:null,error:o};const d={all:[],phone:[],totp:[],webauthn:[]};for(const h of(s=n==null?void 0:n.factors)!==null&&s!==void 0?s:[])d.all.push(h),h.status==="verified"&&d[h.factor_type].push(h);return{data:d,error:null}}async _getAuthenticatorAssuranceLevel(){var s,n;const{data:{session:o},error:d}=await this.getSession();if(d)return this._returnResult({data:null,error:d});if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:h}=bu(o.access_token);let f=null;h.aal&&(f=h.aal);let b=f;((n=(s=o.user.factors)===null||s===void 0?void 0:s.filter(v=>v.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(b="aal2");const p=h.amr||[];return{data:{currentLevel:f,nextLevel:b,currentAuthenticationMethods:p},error:null}}async _getAuthorizationDetails(s){try{return await this._useSession(async n=>{const{data:{session:o},error:d}=n;return d?this._returnResult({data:null,error:d}):o?await Me(this.fetch,"GET",`${this.url}/oauth/authorizations/${s}`,{headers:this.headers,jwt:o.access_token,xform:h=>({data:h,error:null})}):this._returnResult({data:null,error:new Ca})})}catch(n){if(Ae(n))return this._returnResult({data:null,error:n});throw n}}async _approveAuthorization(s,n){try{return await this._useSession(async o=>{const{data:{session:d},error:h}=o;if(h)return this._returnResult({data:null,error:h});if(!d)return this._returnResult({data:null,error:new Ca});const f=await Me(this.fetch,"POST",`${this.url}/oauth/authorizations/${s}/consent`,{headers:this.headers,jwt:d.access_token,body:{action:"approve"},xform:b=>({data:b,error:null})});return f.data&&f.data.redirect_url&&ia()&&!(n!=null&&n.skipBrowserRedirect)&&window.location.assign(f.data.redirect_url),f})}catch(o){if(Ae(o))return this._returnResult({data:null,error:o});throw o}}async _denyAuthorization(s,n){try{return await this._useSession(async o=>{const{data:{session:d},error:h}=o;if(h)return this._returnResult({data:null,error:h});if(!d)return this._returnResult({data:null,error:new Ca});const f=await Me(this.fetch,"POST",`${this.url}/oauth/authorizations/${s}/consent`,{headers:this.headers,jwt:d.access_token,body:{action:"deny"},xform:b=>({data:b,error:null})});return f.data&&f.data.redirect_url&&ia()&&!(n!=null&&n.skipBrowserRedirect)&&window.location.assign(f.data.redirect_url),f})}catch(o){if(Ae(o))return this._returnResult({data:null,error:o});throw o}}async _listOAuthGrants(){try{return await this._useSession(async s=>{const{data:{session:n},error:o}=s;return o?this._returnResult({data:null,error:o}):n?await Me(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,xform:d=>({data:d,error:null})}):this._returnResult({data:null,error:new Ca})})}catch(s){if(Ae(s))return this._returnResult({data:null,error:s});throw s}}async _revokeOAuthGrant(s){try{return await this._useSession(async n=>{const{data:{session:o},error:d}=n;return d?this._returnResult({data:null,error:d}):o?(await Me(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:o.access_token,query:{client_id:s.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Ca})})}catch(n){if(Ae(n))return this._returnResult({data:null,error:n});throw n}}async fetchJwk(s,n={keys:[]}){let o=n.keys.find(b=>b.kid===s);if(o)return o;const d=Date.now();if(o=this.jwks.keys.find(b=>b.kid===s),o&&this.jwks_cached_at+hx>d)return o;const{data:h,error:f}=await Me(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(f)throw f;return!h.keys||h.keys.length===0||(this.jwks=h,this.jwks_cached_at=d,o=h.keys.find(b=>b.kid===s),!o)?null:o}async getClaims(s,n={}){try{let o=s;if(!o){const{data:j,error:C}=await this.getSession();if(C||!j.session)return this._returnResult({data:null,error:C});o=j.session.access_token}const{header:d,payload:h,signature:f,raw:{header:b,payload:g}}=bu(o);n!=null&&n.allowExpired||Dx(h.exp);const p=!d.alg||d.alg.startsWith("HS")||!d.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(d.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!p){const{error:j}=await this.getUser(o);if(j)throw j;return{data:{claims:h,header:d,signature:f},error:null}}const v=Ux(d.alg),x=await crypto.subtle.importKey("jwk",p,v,!0,["verify"]);if(!await crypto.subtle.verify(v,x,f,jx(`${b}.${g}`)))throw new Cu("Invalid JWT signature");return{data:{claims:h,header:d,signature:f},error:null}}catch(o){if(Ae(o))return this._returnResult({data:null,error:o});throw o}}}wi.nextInstanceID={};const my=wi,py="2.89.0";let mi="";typeof Deno<"u"?mi="deno":typeof document<"u"?mi="web":typeof navigator<"u"&&navigator.product==="ReactNative"?mi="react-native":mi="node";const gy={"X-Client-Info":`supabase-js-${mi}/${py}`},by={headers:gy},xy={schema:"public"},yy={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},vy={};function ji(l){"@babel/helpers - typeof";return ji=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},ji(l)}function wy(l,s){if(ji(l)!="object"||!l)return l;var n=l[Symbol.toPrimitive];if(n!==void 0){var o=n.call(l,s);if(ji(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(l)}function jy(l){var s=wy(l,"string");return ji(s)=="symbol"?s:s+""}function _y(l,s,n){return(s=jy(s))in l?Object.defineProperty(l,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):l[s]=n,l}function rp(l,s){var n=Object.keys(l);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(l);s&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(l,d).enumerable})),n.push.apply(n,o)}return n}function Bt(l){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?rp(Object(n),!0).forEach(function(o){_y(l,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(n)):rp(Object(n)).forEach(function(o){Object.defineProperty(l,o,Object.getOwnPropertyDescriptor(n,o))})}return l}const Ny=l=>l?(...s)=>l(...s):(...s)=>fetch(...s),Sy=()=>Headers,Ey=(l,s,n)=>{const o=Ny(n),d=Sy();return async(h,f)=>{var b;const g=(b=await s())!==null&&b!==void 0?b:l;let p=new d(f==null?void 0:f.headers);return p.has("apikey")||p.set("apikey",l),p.has("Authorization")||p.set("Authorization",`Bearer ${g}`),o(h,Bt(Bt({},f),{},{headers:p}))}};function Ty(l){return l.endsWith("/")?l:l+"/"}function ky(l,s){var n,o;const{db:d,auth:h,realtime:f,global:b}=l,{db:g,auth:p,realtime:v,global:x}=s,N={db:Bt(Bt({},g),d),auth:Bt(Bt({},p),h),realtime:Bt(Bt({},v),f),storage:{},global:Bt(Bt(Bt({},x),b),{},{headers:Bt(Bt({},(n=x==null?void 0:x.headers)!==null&&n!==void 0?n:{}),(o=b==null?void 0:b.headers)!==null&&o!==void 0?o:{})}),accessToken:async()=>""};return l.accessToken?N.accessToken=l.accessToken:delete N.accessToken,N}function Ay(l){const s=l==null?void 0:l.trim();if(!s)throw new Error("supabaseUrl is required.");if(!s.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Ty(s))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var Oy=class extends my{constructor(l){super(l)}},Cy=class{constructor(l,s,n){var o,d;this.supabaseUrl=l,this.supabaseKey=s;const h=Ay(l);if(!s)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",h),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",h),this.storageUrl=new URL("storage/v1",h),this.functionsUrl=new URL("functions/v1",h);const f=`sb-${h.hostname.split(".")[0]}-auth-token`,b={db:xy,realtime:vy,auth:Bt(Bt({},yy),{},{storageKey:f}),global:by},g=ky(n??{},b);if(this.storageKey=(o=g.auth.storageKey)!==null&&o!==void 0?o:"",this.headers=(d=g.global.headers)!==null&&d!==void 0?d:{},g.accessToken)this.accessToken=g.accessToken,this.auth=new Proxy({},{get:(v,x)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(x)} is not possible`)}});else{var p;this.auth=this._initSupabaseAuthClient((p=g.auth)!==null&&p!==void 0?p:{},this.headers,g.global.fetch)}this.fetch=Ey(s,this._getAccessToken.bind(this),g.global.fetch),this.realtime=this._initRealtimeClient(Bt({headers:this.headers,accessToken:this._getAccessToken.bind(this)},g.realtime)),this.accessToken&&this.accessToken().then(v=>this.realtime.setAuth(v)).catch(v=>console.warn("Failed to set initial Realtime auth token:",v)),this.rest=new ub(new URL("rest/v1",h).href,{headers:this.headers,schema:g.db.schema,fetch:this.fetch}),this.storage=new lx(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),g.accessToken||this._listenForAuthEvents()}get functions(){return new nb(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(l){return this.rest.from(l)}schema(l){return this.rest.schema(l)}rpc(l,s={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(l,s,n)}channel(l,s={config:{}}){return this.realtime.channel(l,s)}getChannels(){return this.realtime.getChannels()}removeChannel(l){return this.realtime.removeChannel(l)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var l=this,s,n;if(l.accessToken)return await l.accessToken();const{data:o}=await l.auth.getSession();return(s=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:l.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:l,persistSession:s,detectSessionInUrl:n,storage:o,userStorage:d,storageKey:h,flowType:f,lock:b,debug:g,throwOnError:p},v,x){const N={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Oy({url:this.authUrl.href,headers:Bt(Bt({},N),v),storageKey:h,autoRefreshToken:l,persistSession:s,detectSessionInUrl:n,storage:o,userStorage:d,flowType:f,lock:b,debug:g,throwOnError:p,fetch:x,hasCustomAuthorizationHeader:Object.keys(this.headers).some(j=>j.toLowerCase()==="authorization")})}_initRealtimeClient(l){return new Tb(this.realtimeUrl.href,Bt(Bt({},l),{},{params:Bt(Bt({},{apikey:this.supabaseKey}),l==null?void 0:l.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((l,s)=>{this._handleTokenChanged(l,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(l,s,n){(l==="TOKEN_REFRESHED"||l==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):l==="SIGNED_OUT"&&(this.realtime.setAuth(),s=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const Ry=(l,s,n)=>new Cy(l,s,n);function zy(){if(typeof window<"u"||typeof process>"u")return!1;const l=process.version;if(l==null)return!1;const s=l.match(/^v(\d+)\./);return s?parseInt(s[1],10)<=18:!1}zy()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const My="https://roouxunjcwzrqwyusari.supabase.co",Dy="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJvb3V4dW5qY3d6cnF3eXVzYXJpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcwMTQxMzEsImV4cCI6MjA4MjU5MDEzMX0.wDnCr8Qhmwz-asqdY2gcC84KRqjpJIKxi5rlfL4H_Uo",de=Ry(My,Dy),Uy=async()=>"Notification"in window?Notification.permission==="granted"?!0:Notification.permission!=="denied"?await Notification.requestPermission()==="granted":!1:(console.log("This browser does not support desktop notification"),!1),np=(l,s,n)=>{if(Notification.permission==="granted")try{navigator.vibrate&&navigator.vibrate([200,100,200]);const o={body:s,icon:n||"/kosmo/icons/icon-192x192.png",vibrate:[200,100,200],tag:"kosmo-alert"};new Notification(l,o)}catch(o){console.error("Notification error:",o)}};var oe=(l=>(l.METAL_MINE="metalMine",l.CRYSTAL_MINE="crystalMine",l.DEUTERIUM_SYNTH="deuteriumSynth",l.SOLAR_PLANT="solarPlant",l.FUSION_REACTOR="fusionReactor",l.ROBOT_FACTORY="robotFactory",l.SHIPYARD="shipyard",l.RESEARCH_LAB="researchLab",l.METAL_STORAGE="metalStorage",l.CRYSTAL_STORAGE="crystalStorage",l.DEUTERIUM_TANK="deuteriumTank",l))(oe||{}),xe=(l=>(l.ENERGY_TECH="energyTech",l.LASER_TECH="laserTech",l.ION_TECH="ionTech",l.HYPERSPACE_TECH="hyperspaceTech",l.PLASMA_TECH="plasmaTech",l.COMBUSTION_DRIVE="combustionDrive",l.IMPULSE_DRIVE="impulseDrive",l.HYPERSPACE_DRIVE="hyperspaceDrive",l.ESPIONAGE_TECH="espionageTech",l.COMPUTER_TECH="computerTech",l.ASTROPHYSICS="astrophysics",l.WEAPON_TECH="weaponTech",l.SHIELDING_TECH="shieldingTech",l.ARMOUR_TECH="armourTech",l))(xe||{}),ue=(l=>(l.LIGHT_FIGHTER="lightFighter",l.HEAVY_FIGHTER="heavyFighter",l.CRUISER="cruiser",l.BATTLESHIP="battleship",l.DESTROYER="destroyer",l.DEATH_STAR="deathStar",l.SMALL_CARGO="smallCargo",l.MEDIUM_CARGO="mediumCargo",l.HUGE_CARGO="hugeCargo",l.COLONY_SHIP="colonyShip",l.ESPIONAGE_PROBE="espionageProbe",l.PIONEER="pioneer",l.RECYCLER="recycler",l))(ue||{}),qt=(l=>(l.ROCKET_LAUNCHER="rocketLauncher",l.LIGHT_LASER="lightLaser",l.HEAVY_LASER="heavyLaser",l.GAUSS_CANNON="gaussCannon",l.ION_CANNON="ionCannon",l.PLASMA_TURRET="plasmaTurret",l.SMALL_SHIELD="smallShield",l.LARGE_SHIELD="largeShield",l))(qt||{}),Ze=(l=>(l.EXPEDITION="expedition",l.ATTACK="attack",l.TRANSPORT="transport",l.SPY="spy",l.COLONIZE="colonize",l.RECYCLE="recycle",l))(Ze||{});const Ma=l=>{if(l<0)return"00:00";const s=Math.floor(l/3600),n=Math.floor(l%3600/60),o=Math.floor(l%60);return s>0?`${s}:${n.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`:`${n.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`},ip=l=>l>=1e12?(l/1e12).toFixed(2)+"T":l>=1e9?(l/1e9).toFixed(2)+"B":l>=1e6?(l/1e6).toFixed(2)+"M":l>=1e3?(l/1e3).toFixed(1)+"k":l.toLocaleString(),Be={avatar:"/kosmo/avatars/avatar_default.png",planet:"https://lh3.googleusercontent.com/aida-public/AB6AXuBSLdQjiDuWVTAfBaEU-HCuYBah9ZQiEwQ-pDEofrc4cE_VxNy9QrAshJikmgoDRsSiufik3xpY-aK01ZyAD-oMT7oiGEoiGMpFWgFdZ7P3A8bg6_W71He4ede4ePe-0BNBFOYzd9apqH_IBj5ZXTOU7lbf7qfnmAK01iO7b2ckjVagWx4YlZdAbeOGA1_vJMuSCRVCtupT_RNvx19THDplwxx3PvEcIgc4g0ljwPyZlPI8DaYq7UaMbOiwXHxzgV-oCUQBi8YwaGc",metalMine:"/kosmo/budowle/kopalniametalu.png",crystalMine:"/kosmo/budowle/kopalnia krysztalu.png",deuteriumSynth:"/kosmo/budowle/synterzator deuter.png",solarPlant:"/kosmo/budowle/elektrownia sloneczna.png",fusionReactor:"/kosmo/budowle/Reaktor Fuzyjny.png",robotFactory:"/kosmo/budowle/Fabryka Robotw.png",shipyard:"/kosmo/budowle/stocznia.png",researchLab:"/kosmo/budowle/Laboratorium Badawcz.png",metalStorage:"/kosmo/budowle/Magazyn MetaluKrysztau.png",crystalStorage:"/kosmo/budowle/Magazyn MetaluKrysztau.png",deuteriumTank:"/kosmo/budowle/zbiornik deuter.png",techEnergy:"https://lh3.googleusercontent.com/aida-public/AB6AXuAUsk_veHUVdI7Xyyen3wE1Sor8I2WXguf2jjbakOFbdtRfW9EJruiDvsIgX5IEW3yt01vrIYq_I5G3cqefGk7O7w9BvvVsHpHioXTKjEfTwaHGv1fWwoc4_coc6yXGitNBGAa3URR7KjlKaomN_pmSPD9Jalb9rxdmt1NRlt2b98OZQVQqii0zOOVaBBsICIos_bTfcnyMBW_tecAFg3TP9zzNghDVuvahMe87fSHyj_9wuv1y3NXeDTDGk2w8iBPZsl8B6D58Jhg",techLaser:"https://lh3.googleusercontent.com/aida-public/AB6AXuCttLEph3WsOd3HRlZC0zxgyo5HtGQLhoc_Nr46u_bMbqY6nTEQYuIV_gyR_hpfVBS-J_jj5GGZynbPPZti1oj5iZ3eOY_YBYNi3q8nw6c4ebgmqCgJnaJhFtJwFfpNu4nYT65VMgmQkWQU-ek95Y5Ue6RnI9LCcYQpDhod0Y_eUiJYtnqiu9_aD-u_ukPsujkP5hgKqFchbR8vhUje3E-LrA80lMR4QTQEfNKXUDobsJRFGe11_CQSYumUsrXBnYunhGfRGvl2epw",techIon:"https://lh3.googleusercontent.com/aida-public/AB6AXuAUsk_veHUVdI7Xyyen3wE1Sor8I2WXguf2jjbakOFbdtRfW9EJruiDvsIgX5IEW3yt01vrIYq_I5G3cqefGk7O7w9BvvVsHpHioXTKjEfTwaHGv1fWwoc4_coc6yXGitNBGAa3URR7KjlKaomN_pmSPD9Jalb9rxdmt1NRlt2b98OZQVQqii0zOOVaBBsICIos_bTfcnyMBW_tecAFg3TP9zzNghDVuvahMe87fSHyj_9wuv1y3NXeDTDGk2w8iBPZsl8B6D58Jhg",techHyper:"https://lh3.googleusercontent.com/aida-public/AB6AXuC_5G35L8rN6N_8x173o5o3z6c0K8P5w2Z4s7Y8l9X0M2b5Q3v6R4t8J9L1K5N7P4Q2M6v8L3z9J0x5N2k8R7w9M4P1L6O3v8K5N7Q2M6v8L3z9J0x5N2k8R7w9M4P1L6O3v8K5N7Q2",techCombustion:"https://lh3.googleusercontent.com/aida-public/AB6AXuDbgGTOOmYRO8Cx2O9AikzppzN9zC4-i7_FrPEcct-2C21HpEJmdGGu5Za7crC8JzzPSg7_h9whOWZrcV1uaeGNi-PRI2xgDrhQfv1_Lby8fBTWyDZhQ06O3AM6n76j_-cHlHjJLahmP4ygvJ-iwGSSXwntVJtmV76vprhB_mPDHFsOxjwoWadVZ5tBOQifnLzeGQYMb6Q00oYkbFwAD8554XNTDT0nmK16jTdF17V-MgWnK8RmGNBFkySydK0sEWwjYVjCScUCM6I",techImpulse:"https://lh3.googleusercontent.com/aida-public/AB6AXuCd2dUTqjUsAcUPQOTk2ukYe3jO6XM4-sDHF10X83-XP8vidQdYFHgCjpeNNuxHLjWuIETBVc4-tF48QBg635FXHK3OHl3XJtyBIkYhbuNKjm1gi-w5E5JBsKMfFkYYudLiRVf917sQBCIkRdhPmSnjKNUpHDiqn1OUmKVHK1oFpUAXDHKoc7NOKDMZCKLxm4p1GZhpnvu-GP9sZFnbzedCWMEBtk7KlYd6EiN0uuYs9gi5y-_MDWTKKT4NE1bSe52hWWJuZidIru8",techHyperDrive:"https://lh3.googleusercontent.com/aida-public/AB6AXuDbgGTOOmYRO8Cx2O9AikzppzN9zC4-i7_FrPEcct-2C21HpEJmdGGu5Za7crC8JzzPSg7_h9whOWZrcV1uaeGNi-PRI2xgDrhQfv1_Lby8fBTWyDZhQ06O3AM6n76j_-cHlHjJLahmP4ygvJ-iwGSSXwntVJtmV76vprhB_mPDHFsOxjwoWadVZ5tBOQifnLzeGQYMb6Q00oYkbFwAD8554XNTDT0nmK16jTdF17V-MgWnK8RmGNBFkySydK0sEWwjYVjCScUCM6I",techPlasma:"https://lh3.googleusercontent.com/aida-public/AB6AXuA5zJhoBmc9B_7K3kdzmS0jRGQ4TxTF1sKrsA0-Zxnv4gQMVzgicY3JzPKK5mAwCC1iuh4xUjsQTCiOr1frnHwM2FNQ59ZbM8gyFwJvf5kgN1Np1dDGsQP7vua8fW77DzSNOmAX7frp_E13Rt22KjtAxy61zJl5Drp2C1v4LUF1HPLKJqcHTdEO6D_s3q5ujXDXOR8tV0yHYqfY4Gjc1egtpZyY1hbpRfwcedU-Fd728-EDyp_LSAz12VFwRRaLGqsOpgXayb0dFUU",techEspionage:"https://lh3.googleusercontent.com/aida-public/AB6AXuAuzcKCcqW_Uwb_MHjDE4UnIS9iufqeQRG-ox9HOxWuvVuHaPFUOrPzlXsVC7PfwZ7MI1K-xoYXSIRYGuCSJskYUnvKDvMxqvSe3Gia4Hb2MB3OLyt_tMwvU9qvxgjTrPmM6wQypgXYMFoiUUJMXWeDDfXxHDYHBm1mxGIFog5PovvrH7Zb2U4gFbh_HAslZUcihLWiSiQi2WAG8mGqDZzKh4eaLLLitm105RayEmmJXCGVObylA3o_oKyx4bVz44Os-zM8jsZ59ng",techComputer:"https://lh3.googleusercontent.com/aida-public/AB6AXuCWhn2HXSCm5RHKMuQUw21Hw6EWLXbJVTX6WMPGH0zSgbJ5FrOtwFl3GoA7TburBE1sfekcUVJknBOryC06NelUAT8HKLx_GxRk7p7zy_6yTCsUIteUJ1P-m68zJ-LqyQZ_hz53P1KnKtNVNIoJZvor1YyzW2ZN49ItxXjuLoIAl6Run1afN28jy6tc9scmfRtvAzO2Ixv0SIek4-r4SWglDDGR-aZYAweEP3K9zyWk8ez2EY6n6s7_UCU10S04j1dHEXCQ6GDjpDc",techAstro:"https://lh3.googleusercontent.com/aida-public/AB6AXuBSOTflDav4MFvu_Yvg-9qCDKqpS6BwAJDvSFmXbaK1M4mBatMw8wpRPT_bROfe2lelYtoxtN-ew041hcpd7KHjnZTbZ7Ov1q8gvcDdQ-zV7WCHlysly8ohvQJqhXRh1J3QUSfnu95xoFJX3O50BjiNefxhrFKws1eSBVnIPiB0iOWl_S8NDWo5mwLU-rA0pT6VOakhtRCgKUZrJmDumK6NIAyB0H60AK5EdDlixy4qsNd1SagA7z0AUEAqWHF43uun44RCqVq1hOY",techWeapon:"https://lh3.googleusercontent.com/aida-public/AB6AXuCd2dUTqjUsAcUPQOTk2ukYe3jO6XM4-sDHF10X83-XP8vidQdYFHgCjpeNNuxHLjWuIETBVc4-tF48QBg635FXHK3OHl3XJtyBIkYhbuNKjm1gi-w5E5JBsKMfFkYYudLiRVf917sQBCIkRdhPmSnjKNUpHDiqn1OUmKVHK1oFpUAXDHKoc7NOKDMZCKLxm4p1GZhpnvu-GP9sZFnbzedCWMEBtk7KlYd6EiN0uuYs9gi5y-_MDWTKKT4NE1bSe52hWWJuZidIru8",techShield:"https://lh3.googleusercontent.com/aida-public/AB6AXuAUSEKlHxUvCzxVOgj1Y6MtxX1VhQuac5X-CQBCwdETPQW0ynuAd-uEVEWMCGnx7FyX7vOxy4epq_CKJImgHYAUcz04j5B4DL1cjdUqVefFWq4dFoTwzLUivuBxpd4Q1i7dnsLEZAlkOwXPiYSMTau5dTr7XWhZMcXfDAG4bloSSPGJYItXueBQ_uivo-IdPPh5ad4npHg32fLsQj__8JNmEc7rzx0kjjz3wz_upv0MPt66tV9BzNqd29cwpdNqoUhnRVHjteACKYU",techArmour:"https://lh3.googleusercontent.com/aida-public/AB6AXuDKFYodx8aYkS3L0_aZKv8NQVKCFFLEp_aIojke7fVSBUGfftz5yRPvF1fuXX4vvvHwtId36V6DzP398lKo5i9fDlbC3dgYH7qP5VhLyKyyn_n9D4fSyvnoiPHulQLtl5Do1YYRpVvhVcfGOS4IyPuY7dVya1qor3vSjhE-KsxkO9Nr0rKccvd0lp1OQYWa4fOwAJKWnx24KLrcu70jfMTpcUW-Fb5dXiBJkD9UFjV4B07Jr5EhFLNsjASa8zQIzRaxg3XKdJnmvFs",lightFighter:"/kosmo/ships/light_fighter.png",heavyFighter:"/kosmo/ships/heavy_fighter.png",cruiser:"/kosmo/ships/cruiser.png",battleship:"/kosmo/ships/battleship.png",destroyer:"/kosmo/ships/destroyer.png",deathStar:"/kosmo/ships/death_star.png",smallCargo:"/kosmo/ships/small_cargo.png",mediumCargo:"/kosmo/ships/medium_cargo.png",hugeCargo:"/kosmo/ships/huge_cargo.png",colonyShip:"/kosmo/ships/colony_ship.png",espionageProbe:"/kosmo/ships/espionage_probe.png",recycler:"/kosmo/ships/recycler.png",pioneer:"/kosmo/ships/pioneer.png"},kr={terran:"https://lh3.googleusercontent.com/aida-public/AB6AXuBSLdQjiDuWVTAfBaEU-HCuYBah9ZQiEwQ-pDEofrc4cE_VxNy9QrAshJikmgoDRsSiufik3xpY-aK01ZyAD-oMT7oiGEoiGMpFWgFdZ7P3A8bg6_W71He4ede4ePe-0BNBFOYzd9apqH_IBj5ZXTOU7lbf7qfnmAK01iO7b2ckjVagWx4YlZdAbeOGA1_vJMuSCRVCtupT_RNvx19THDplwxx3PvEcIgc4g0ljwPyZlPI8DaYq7UaMbOiwXHxzgV-oCUQBi8YwaGc",desert:"https://lh3.googleusercontent.com/aida-public/AB6AXuBSLdQjiDuWVTAfBaEU-HCuYBah9ZQiEwQ-pDEofrc4cE_VxNy9QrAshJikmgoDRsSiufik3xpY-aK01ZyAD-oMT7oiGEoiGMpFWgFdZ7P3A8bg6_W71He4ede4ePe-0BNBFOYzd9apqH_IBj5ZXTOU7lbf7qfnmAK01iO7b2ckjVagWx4YlZdAbeOGA1_vJMuSCRVCtupT_RNvx19THDplwxx3PvEcIgc4g0ljwPyZlPI8DaYq7UaMbOiwXHxzgV-oCUQBi8YwaGc",ice:"https://lh3.googleusercontent.com/aida-public/AB6AXuBSLdQjiDuWVTAfBaEU-HCuYBah9ZQiEwQ-pDEofrc4cE_VxNy9QrAshJikmgoDRsSiufik3xpY-aK01ZyAD-oMT7oiGEoiGMpFWgFdZ7P3A8bg6_W71He4ede4ePe-0BNBFOYzd9apqH_IBj5ZXTOU7lbf7qfnmAK01iO7b2ckjVagWx4YlZdAbeOGA1_vJMuSCRVCtupT_RNvx19THDplwxx3PvEcIgc4g0ljwPyZlPI8DaYq7UaMbOiwXHxzgV-oCUQBi8YwaGc",default:Be.planet},Je={[ue.LIGHT_FIGHTER]:{id:ue.LIGHT_FIGHTER,name:"Myliwiec Przechwytujcy",description:"Szybki i zwrotny myliwiec przechwytujcy, podstawa kadej floty.",baseCost:{metal:1e3,crystal:300,deuterium:0},image:Be.lightFighter,buildTime:5,attack:80,defense:10,capacity:50,requirements:[{type:"building",id:oe.SHIPYARD,level:1},{type:"research",id:xe.COMBUSTION_DRIVE,level:1}],bonuses:{[ue.DEATH_STAR]:2,[ue.ESPIONAGE_PROBE]:.5}},[ue.HEAVY_FIGHTER]:{id:ue.HEAVY_FIGHTER,name:"Myliwiec Szturmowy",description:"Ciej opancerzona wersja myliwca z silniejszym uzbrojeniem.",baseCost:{metal:2e3,crystal:1500,deuterium:0},image:Be.heavyFighter,buildTime:10,attack:150,defense:25,capacity:100,requirements:[{type:"building",id:oe.SHIPYARD,level:3},{type:"research",id:xe.IMPULSE_DRIVE,level:2}],bonuses:{[ue.LIGHT_FIGHTER]:.5,[ue.SMALL_CARGO]:.5}},[ue.CRUISER]:{id:ue.CRUISER,name:"Kanonierka",description:"Szybki okrt bojowy skuteczny przeciwko lekkim myliwcom.",baseCost:{metal:6e3,crystal:2500,deuterium:500},image:Be.cruiser,buildTime:30,attack:400,defense:50,capacity:800,requirements:[{type:"building",id:oe.SHIPYARD,level:5},{type:"research",id:xe.ION_TECH,level:2},{type:"research",id:xe.IMPULSE_DRIVE,level:4}],bonuses:{[ue.LIGHT_FIGHTER]:1,[ue.HEAVY_FIGHTER]:.5,[ue.ESPIONAGE_PROBE]:1}},[ue.BATTLESHIP]:{id:ue.BATTLESHIP,name:"Niszczyciel Klasy A",description:"Potna jednostka bojowa o ogromnej sile ognia.",baseCost:{metal:15e3,crystal:5e3,deuterium:0},image:Be.battleship,buildTime:60,attack:1e3,defense:200,capacity:1500,requirements:[{type:"building",id:oe.SHIPYARD,level:7},{type:"research",id:xe.HYPERSPACE_DRIVE,level:4}],bonuses:{[ue.CRUISER]:.5,[ue.HEAVY_FIGHTER]:.3,[ue.SMALL_CARGO]:.5,[ue.MEDIUM_CARGO]:.5,[ue.HUGE_CARGO]:.5}},[ue.DESTROYER]:{id:ue.DESTROYER,name:"Drednot",description:"Krl pola bitwy. Niszczy lekkie statki w mgnieniu oka.",baseCost:{metal:2e4,crystal:17e3,deuterium:5e3},image:Be.destroyer,buildTime:90,attack:2e3,defense:500,capacity:2e3,requirements:[{type:"building",id:oe.SHIPYARD,level:9},{type:"research",id:xe.HYPERSPACE_DRIVE,level:6},{type:"research",id:xe.HYPERSPACE_TECH,level:5}],bonuses:{[ue.BATTLESHIP]:.5,[ue.CRUISER]:.5,[ue.LIGHT_FIGHTER]:.5,[qt.LIGHT_LASER]:1,[qt.ROCKET_LAUNCHER]:1}},[ue.DEATH_STAR]:{id:ue.DEATH_STAR,name:"Leviathan",description:"Mobilna stacja bojowa klasy Leviathan. Zdolna niszczy cae ksiyce.",baseCost:{metal:5e6,crystal:4e6,deuterium:1e6},image:Be.deathStar,buildTime:1e3,attack:2e5,defense:1e5,capacity:1e6,requirements:[{type:"building",id:oe.SHIPYARD,level:12},{type:"research",id:xe.HYPERSPACE_DRIVE,level:7},{type:"research",id:xe.ASTROPHYSICS,level:5}],bonuses:{[ue.DESTROYER]:1,[ue.BATTLESHIP]:1,[ue.HUGE_CARGO]:1,[ue.ESPIONAGE_PROBE]:10,[qt.GAUSS_CANNON]:1,[qt.ION_CANNON]:1,[qt.PLASMA_TURRET]:1,[qt.LARGE_SHIELD]:1,[qt.SMALL_SHIELD]:1,[qt.HEAVY_LASER]:1,[qt.LIGHT_LASER]:1,[qt.ROCKET_LAUNCHER]:1}},[ue.SMALL_CARGO]:{id:ue.SMALL_CARGO,name:"May Transporter",description:"Podstawowa jednostka do transportu surowcw na inne planety.",baseCost:{metal:500,crystal:500,deuterium:0},image:Be.smallCargo,buildTime:5,attack:5,defense:10,capacity:5e3,requirements:[{type:"building",id:oe.SHIPYARD,level:2},{type:"research",id:xe.COMBUSTION_DRIVE,level:2}]},[ue.MEDIUM_CARGO]:{id:ue.MEDIUM_CARGO,name:"redni Transporter",description:"Zbalansowany statek transportowy o wikszej pojemnoci.",baseCost:{metal:1500,crystal:1500,deuterium:0},image:Be.mediumCargo,buildTime:10,attack:10,defense:25,capacity:12e3,requirements:[{type:"building",id:oe.SHIPYARD,level:4},{type:"research",id:xe.COMBUSTION_DRIVE,level:4}]},[ue.HUGE_CARGO]:{id:ue.HUGE_CARGO,name:"Ogromny Transporter",description:"Kolos transportowy zdolny przewie zasoby caej kolonii.",baseCost:{metal:7e3,crystal:7e3,deuterium:500},image:Be.hugeCargo,buildTime:25,attack:25,defense:100,capacity:5e4,requirements:[{type:"building",id:oe.SHIPYARD,level:8},{type:"research",id:xe.IMPULSE_DRIVE,level:6}]},[ue.COLONY_SHIP]:{id:ue.COLONY_SHIP,name:"Statek Kolonizacyjny",description:"Umoliwia zasiedlanie nowych planet w niezbadanych ukadach.",baseCost:{metal:3e3,crystal:6e3,deuterium:3e3},image:Be.colonyShip,buildTime:150,attack:50,defense:100,capacity:7500,requirements:[{type:"building",id:oe.SHIPYARD,level:4},{type:"research",id:xe.IMPULSE_DRIVE,level:3}]},[ue.RECYCLER]:{id:ue.RECYCLER,name:"Statek Odzysku",description:"Specjalistyczna jednostka do zbierania szcztkw z pl bitew.",baseCost:{metal:3e4,crystal:15e3,deuterium:5e3},image:Be.recycler,buildTime:60,attack:10,defense:30,capacity:2e4,requirements:[{type:"building",id:oe.SHIPYARD,level:4},{type:"research",id:xe.COMBUSTION_DRIVE,level:6},{type:"research",id:xe.SHIELDING_TECH,level:2}]},[ue.ESPIONAGE_PROBE]:{id:ue.ESPIONAGE_PROBE,name:"Dron Zwiadowczy",description:"May dron do zdobywania informacji o innych planetach.",baseCost:{metal:0,crystal:1e3,deuterium:0},image:Be.espionageProbe,buildTime:2,attack:0,defense:0,capacity:5,requirements:[{type:"building",id:oe.SHIPYARD,level:3},{type:"research",id:xe.COMBUSTION_DRIVE,level:3}]},[ue.PIONEER]:{id:ue.PIONEER,name:"Pionier",description:"Zaawansowany statek ekspedycyjny. Zwiksza szans na sukces i chroni flot przed zagroeniami.",baseCost:{metal:3e3,crystal:1500,deuterium:500},image:Be.pioneer,buildTime:45,attack:200,defense:200,capacity:2e3,requirements:[{type:"building",id:oe.SHIPYARD,level:6},{type:"research",id:xe.ESPIONAGE_TECH,level:4},{type:"research",id:xe.IMPULSE_DRIVE,level:4}]}},ts={[oe.METAL_MINE]:{id:oe.METAL_MINE,name:"Wiertnia Tytanu",description:"Pozyskuje rud tytanu z gbi planety.",baseCost:{metal:60,crystal:15,deuterium:0},baseProduction:{metal:30,crystal:0,deuterium:0,energy:-20},image:Be.metalMine,buildTimeBase:10},[oe.CRYSTAL_MINE]:{id:oe.CRYSTAL_MINE,name:"Ekstraktor Krzemu",description:"Wydobywa krzem niezbdny do elektroniki.",baseCost:{metal:48,crystal:24,deuterium:0},baseProduction:{metal:0,crystal:20,deuterium:0,energy:-15},image:Be.crystalMine,buildTimeBase:15},[oe.DEUTERIUM_SYNTH]:{id:oe.DEUTERIUM_SYNTH,name:"Syntezator Plazmy",description:"Generuje stabiln plazm.",baseCost:{metal:225,crystal:75,deuterium:0},baseProduction:{metal:0,crystal:0,deuterium:10,energy:-30},image:Be.deuteriumSynth,buildTimeBase:20},[oe.SOLAR_PLANT]:{id:oe.SOLAR_PLANT,name:"Elektrownia Soneczna",description:"Wytwarza energi z promieniowania gwiazdy.",baseCost:{metal:75,crystal:30,deuterium:0},baseProduction:{metal:0,crystal:0,deuterium:0,energy:30},image:Be.solarPlant,buildTimeBase:12},[oe.FUSION_REACTOR]:{id:oe.FUSION_REACTOR,name:"Reaktor Plazmowy",description:"Wydajna elektrownia zuywajca plazm.",baseCost:{metal:900,crystal:360,deuterium:180},baseProduction:{metal:0,crystal:0,deuterium:-5,energy:60},image:Be.fusionReactor,buildTimeBase:40,requirements:[{type:"research",id:xe.ENERGY_TECH,level:3}]},[oe.METAL_STORAGE]:{id:oe.METAL_STORAGE,name:"Magazyn Tytanu",description:"Zwiksza limit przechowywania tytanu.",baseCost:{metal:1e3,crystal:0,deuterium:0},image:Be.metalStorage,buildTimeBase:25},[oe.CRYSTAL_STORAGE]:{id:oe.CRYSTAL_STORAGE,name:"Magazyn Krzemu",description:"Zwiksza limit przechowywania krzemu.",baseCost:{metal:1e3,crystal:500,deuterium:0},image:Be.crystalStorage,buildTimeBase:25},[oe.DEUTERIUM_TANK]:{id:oe.DEUTERIUM_TANK,name:"Zbiornik Plazmy",description:"Zwiksza limit przechowywania plazmy.",baseCost:{metal:1e3,crystal:1e3,deuterium:0},image:Be.deuteriumTank,buildTimeBase:25},[oe.ROBOT_FACTORY]:{id:oe.ROBOT_FACTORY,name:"Fabryka Robotw",description:"Skraca czas budowy budynkw.",baseCost:{metal:400,crystal:120,deuterium:200},image:Be.robotFactory,buildTimeBase:30},[oe.SHIPYARD]:{id:oe.SHIPYARD,name:"Stocznia",description:"Umoliwia budow statkw.",baseCost:{metal:800,crystal:400,deuterium:200},image:Be.shipyard,buildTimeBase:50,requirements:[{type:"building",id:oe.ROBOT_FACTORY,level:2}]},[oe.RESEARCH_LAB]:{id:oe.RESEARCH_LAB,name:"Laboratorium Badawcze",description:"Niezbdne do odkrywania technologii.",baseCost:{metal:200,crystal:400,deuterium:200},image:Be.researchLab,buildTimeBase:60}},Ar={[xe.ENERGY_TECH]:{id:xe.ENERGY_TECH,name:"Technologia Energetyczna",description:"Kluczowa do odblokowania zaawansowanych elektrowni i broni.",baseCost:{metal:0,crystal:800,deuterium:400},image:Be.techEnergy,buildTimeBase:40,requirements:[{type:"building",id:oe.RESEARCH_LAB,level:1}],maxLevel:20},[xe.LASER_TECH]:{id:xe.LASER_TECH,name:"Technologia Laserowa",description:"Podstawa dla systemw uzbrojenia.",baseCost:{metal:200,crystal:100,deuterium:0},image:Be.techLaser,buildTimeBase:20,requirements:[{type:"building",id:oe.RESEARCH_LAB,level:1},{type:"research",id:xe.ENERGY_TECH,level:2}],maxLevel:20},[xe.ION_TECH]:{id:xe.ION_TECH,name:"Technologia Jonowa",description:"Wymagana dla kanonierek i broni jonowej.",baseCost:{metal:1e3,crystal:300,deuterium:100},image:Be.techIon,buildTimeBase:60,requirements:[{type:"building",id:oe.RESEARCH_LAB,level:4},{type:"research",id:xe.LASER_TECH,level:5}],maxLevel:20},[xe.HYPERSPACE_TECH]:{id:xe.HYPERSPACE_TECH,name:"Technologia Nadprzestrzenna",description:"Wymagana dla drednotw i zaawansowanych napdw.",baseCost:{metal:0,crystal:4e3,deuterium:2e3},image:Be.techHyper,buildTimeBase:120,requirements:[{type:"building",id:oe.RESEARCH_LAB,level:7},{type:"research",id:xe.ENERGY_TECH,level:5}],maxLevel:20},[xe.COMBUSTION_DRIVE]:{id:xe.COMBUSTION_DRIVE,name:"Napd Rakietowy",description:"Podstawowy napd dla lekkich statkw.",baseCost:{metal:400,crystal:0,deuterium:600},image:Be.techCombustion,buildTimeBase:30,requirements:[{type:"building",id:oe.RESEARCH_LAB,level:1},{type:"research",id:xe.ENERGY_TECH,level:1}],maxLevel:20},[xe.IMPULSE_DRIVE]:{id:xe.IMPULSE_DRIVE,name:"Napd Jonowy",description:"Dla ciszych myliwcw i okrtw.",baseCost:{metal:2e3,crystal:4e3,deuterium:600},image:Be.techImpulse,buildTimeBase:80,requirements:[{type:"building",id:oe.RESEARCH_LAB,level:2},{type:"research",id:xe.ENERGY_TECH,level:1}],maxLevel:20},[xe.HYPERSPACE_DRIVE]:{id:xe.HYPERSPACE_DRIVE,name:"Napd Warp",description:"Umoliwia podre midzygalaktyczne drednotw.",baseCost:{metal:1e4,crystal:2e4,deuterium:6e3},image:Be.techHyperDrive,buildTimeBase:200,requirements:[{type:"research",id:xe.HYPERSPACE_TECH,level:3}],maxLevel:20},[xe.PLASMA_TECH]:{id:xe.PLASMA_TECH,name:"Technologia Plazmowa",description:"",baseCost:{metal:2e3,crystal:4e3,deuterium:1e3},image:Be.techPlasma,buildTimeBase:100,maxLevel:20},[xe.ESPIONAGE_TECH]:{id:xe.ESPIONAGE_TECH,name:"Sensoryka",description:"",baseCost:{metal:200,crystal:1e3,deuterium:200},image:Be.techEspionage,buildTimeBase:40,maxLevel:20},[xe.COMPUTER_TECH]:{id:xe.COMPUTER_TECH,name:"Technologia Komputerowa",description:"",baseCost:{metal:0,crystal:400,deuterium:600},image:Be.techComputer,buildTimeBase:50,maxLevel:25},[xe.ASTROPHYSICS]:{id:xe.ASTROPHYSICS,name:"Eksploracja Kosmosu",description:"",baseCost:{metal:4e3,crystal:8e3,deuterium:4e3},image:Be.techAstro,buildTimeBase:100,maxLevel:30},[xe.WEAPON_TECH]:{id:xe.WEAPON_TECH,name:"Technologia Bojowa",description:"",baseCost:{metal:800,crystal:200,deuterium:0},image:Be.techWeapon,buildTimeBase:60,maxLevel:50},[xe.SHIELDING_TECH]:{id:xe.SHIELDING_TECH,name:"Technologia Ochronna",description:"",baseCost:{metal:200,crystal:600,deuterium:0},image:Be.techShield,buildTimeBase:60,maxLevel:50},[xe.ARMOUR_TECH]:{id:xe.ARMOUR_TECH,name:"Opancerzenie",description:"",baseCost:{metal:1e3,crystal:0,deuterium:0},image:Be.techArmour,buildTimeBase:60,maxLevel:50}},Ka={rocketLauncher:{id:"rocketLauncher",name:"Bateria Rakietowa",desc:"Podstawowa obrona planetarna. Skuteczna przeciwko lekkim celom.",attack:40,defense:10,cost:{metal:500,crystal:0,deuterium:0},buildTime:20,icon:"rocket_launch",bonuses:{[ue.ESPIONAGE_PROBE]:2}},lightLaser:{id:"lightLaser",name:"Lekkie Dziako Laserowe",desc:"Szybkostrzelna wieyczka laserowa. Idealna do zwalczania myliwcw. Skuteczna przeciwko myliwcom przechwytujcym.",attack:50,defense:12,cost:{metal:400,crystal:100,deuterium:0},buildTime:30,icon:"electric_bolt",bonuses:{[ue.LIGHT_FIGHTER]:1.5,[ue.ESPIONAGE_PROBE]:2}},heavyLaser:{id:"heavyLaser",name:"Cikie Dziako Laserowe",desc:"Potny laser zdolny przebi pancerz rednich okrtw.",attack:125,defense:50,cost:{metal:1500,crystal:500,deuterium:0},buildTime:60,icon:"bolt",bonuses:{[ue.HEAVY_FIGHTER]:1.5,[ue.CRUISER]:1}},gaussCannon:{id:"gaussCannon",name:"Dziao Kinetyczne",desc:"Elektromagnetyczne dziao wystrzeliwujce pociski z ogromn prdkoci.",attack:550,defense:100,cost:{metal:5e3,crystal:3500,deuterium:500},buildTime:150,icon:"target",bonuses:{[ue.CRUISER]:2,[ue.BATTLESHIP]:1,[qt.SMALL_SHIELD]:2}},ionCannon:{id:"ionCannon",name:"Emitery EMP",desc:"Zaawansowana technologia jonowa dezaktywujca systemy wroga.",attack:75,defense:250,cost:{metal:1200,crystal:700,deuterium:250},buildTime:120,icon:"storm",bonuses:{[ue.BATTLESHIP]:1.5,[ue.DESTROYER]:.5,[qt.LARGE_SHIELD]:2}},plasmaTurret:{id:"plasmaTurret",name:"Wieyczka Plazmowa",desc:"Najpotniejsza bro obronna. Zdolna zniszczy drednoty jednym strzaem.",attack:1500,defense:150,cost:{metal:12e3,crystal:12e3,deuterium:7500},buildTime:300,icon:"whatshot",bonuses:{[ue.DESTROYER]:1.5,[ue.DEATH_STAR]:.1,[ue.BATTLESHIP]:1.5}},smallShield:{id:"smallShield",name:"Maa Osona Tarczowa",desc:"Kopua energetyczna chronica cz planety przed atakami.",attack:1,defense:500,cost:{metal:2500,crystal:2500,deuterium:0},buildTime:60,icon:"shield",bonuses:{}},largeShield:{id:"largeShield",name:"Dua Osona Tarczowa",desc:"Masywna tarcza energetyczna obejmujca ca planet.",attack:1,defense:2500,cost:{metal:12e3,crystal:12e3,deuterium:0},buildTime:300,icon:"security",bonuses:{}}},Ly=l=>{var p;const s=(l.ships[ue.PIONEER]||0)>0;(l.ships[ue.ESPIONAGE_PROBE]||0)>0;let n=0,o=0;Object.entries(l.ships).forEach(([v,x])=>{const N=Je[v];N&&(n+=N.capacity*x,o+=N.attack*x+N.defense*x)});const d=Math.random(),h=s?.98:.85,f=Date.now(),b={id:`exp-${f}-${Math.random().toString(36).substr(2,9)}`,timestamp:f};if(d>h){const v=["Sensory nie wykryy adnych anomalii w sektorze.","Pusta przestrze. Zaoga spdzia czas na kalibracji systemw.","Wyprawa dotara do koordynatw, ale znaleziono jedynie kosmiczny py.","Sektor wydaje si opuszczony od tysicleci.","Brak znaczcych odkry. Morale zaogi stabilne."];return{log:{...b,title:"Pusta Przestrze",message:v[Math.floor(Math.random()*v.length)],outcome:"neutral"},rewards:{}}}const g=Math.random();if(g<.4){let v=Math.floor(Math.random()*5e4)+12e3,x=Math.floor(Math.random()*3e4)+6e3,N=Math.floor(Math.random()*1e4)+2e3;const j=Math.random();let C={},z="";j<.5?(N=0,z="Odkryto pole asteroid bogate w mineray."):j<.8?(v=0,z="Znaleziono obok gazowy zawierajcy deuter."):z="Trafiono na opuszczony magazyn piratw!";const M=v+x+N;if(M>n){const E=n/M;v=Math.floor(v*E),x=Math.floor(x*E),N=Math.floor(N*E),z+=` (adownie pene: ${n})`}return v>0&&(C.metal=v),x>0&&(C.crystal=x),N>0&&(C.deuterium=N),z+=" Pozyskano:",v>0&&(z+=` Metal: ${v}`),x>0&&(z+=` Kryszta: ${x}`),N>0&&(z+=` Deuter: ${N}.`),{log:{...b,title:"Pozyskano Zasoby",message:z,outcome:"success",rewards:C},rewards:C}}else if(g<.75){const v=Math.random();let x,N=1;v<.6?(x=[ue.LIGHT_FIGHTER,ue.HEAVY_FIGHTER,ue.SMALL_CARGO,ue.ESPIONAGE_PROBE],N=8):v<.9?(x=[ue.MEDIUM_CARGO,ue.PIONEER,ue.CRUISER],N=4):(x=[ue.BATTLESHIP,ue.DESTROYER,ue.HUGE_CARGO],N=2);const j=x[Math.floor(Math.random()*x.length)],C=Math.floor(Math.random()*N)+1,z=((p=Je[j])==null?void 0:p.name)||j;return{log:{...b,title:"Odnaleziono Statki",message:`Flota napotkaa dryfujce wraki, ktre udao si przywrci do dziaania. Doczono do floty: ${C}x ${z}.`,outcome:"success"},rewards:{ships:{[j]:C}}}}else if(g<.9){const v=Math.floor(Math.random()*1e4)+2e3;return{log:{...b,title:"Antyczny Artefakt",message:`Znaleziono dziwny artefakt obcych. Po jego analizie uzyskano technologi wart ${v} Metalu.`,outcome:"success",rewards:{metal:v}},rewards:{metal:v}}}else{const v=Math.floor(Math.random()*150)+50;return{log:{...b,title:"Czarna Materia (Rzadkie!)",message:`Eksperymentalne skanery wykryy anomali czasoprzestrzenn. Skondensowano a ${v} jednostek Czarnej Materii!`,outcome:"success"},rewards:{darkMatter:v}}}},bn=l=>JSON.parse(JSON.stringify(l||{})),lp=(l,s,n,o,d,h,f=!1,b={})=>{const g=bn(l),p=bn(s||{}),v=bn(n||{}),x=1+(b[xe.WEAPON_TECH]||0)*.1,N=1+(b[xe.SHIELDING_TECH]||0)*.05+(b[xe.ARMOUR_TECH]||0)*.05,j=1+(d[xe.WEAPON_TECH]||0)*.1,C=1+(d[xe.SHIELDING_TECH]||0)*.05+(d[xe.ARMOUR_TECH]||0)*.05;let z=bn(l),M=bn(s||{}),E=bn(n||{});const O=6,_=[];for(let ne=1;ne<=O;ne++){let pe=0,Te=0;if(Object.values(M).forEach(He=>Te+=He),Object.values(E).forEach(He=>Te+=He),Te===0)break;Object.entries(z).forEach(([He,Mt])=>{const lt=Je[He],ce=Mt;if(ce<=0)return;let re=lt.attack*ce*x;lt.bonuses&&Object.entries(lt.bonuses).forEach(([Ie,Ye])=>{let ut=(M[Ie]||0)+(E[Ie]||0);if(ut>0){const Ht=Math.min(1,ut/ce),it=lt.attack*ce*x*Ye*Ht;re+=it}}),pe+=re});let A=0,Q=0;if(Object.values(z).forEach(He=>Q+=He),Q===0)break;Object.entries(M).forEach(([He,Mt])=>{const lt=Je[He],ce=Mt;if(ce<=0)return;let re=lt.attack*ce*j;lt.bonuses&&Object.entries(lt.bonuses).forEach(([Ie,Ye])=>{let ut=z[Ie]||0;if(ut>0){const Ht=Math.min(1,ut/ce),it=lt.attack*ce*j*Ye*Ht;re+=it}}),A+=re}),Object.entries(E).forEach(([He,Mt])=>{const lt=Ka[He],ce=Mt;if(ce<=0)return;let re=lt.attack*ce*j;A+=re});const fe=(He,Mt,lt)=>Object.entries(He).reduce((ce,[re,Ie])=>{const Ye=Mt&&Ka[re]||Je[re];if(!Ye)return ce;const ut=Ye.baseCost||Ye.cost||{metal:0,crystal:0},Ht=(ut.metal+ut.crystal)/10,it=Ye.defense*lt;return ce+(Ht+it)*Ie},0),be=fe(l,!1,N),Ne=fe(M,!0,C);_.push(`Runda ${ne}: Agresor atakuje si ${Math.floor(pe)}. Obroca atakuje si ${Math.floor(A)}.`);const Le=Math.min(1,A/be);be>0&&A>0&&Object.keys(z).forEach(He=>{const Mt=z[He],lt=Math.floor(Mt*Le);z[He]-=lt,z[He]<0&&(z[He]=0)});const Xe=Math.min(1,pe/Ne);Ne>0&&pe>0&&(Object.keys(M).forEach(He=>{const Mt=M[He],lt=Math.floor(Mt*Xe);M[He]-=lt,M[He]<0&&(M[He]=0)}),Object.keys(E).forEach(He=>{const Mt=E[He],lt=Math.floor(Mt*Xe);E[He]-=lt,E[He]<0&&(E[He]=0)}));let zt=0;Object.values(z).forEach(He=>zt+=He);let ft=0;if(Object.values(M).forEach(He=>ft+=He),Object.values(E).forEach(He=>ft+=He),zt<=0||ft<=0)break}const G=Object.values(z).reduce((ne,pe)=>ne+pe,0),he=Object.values(M).reduce((ne,pe)=>ne+pe,0)+Object.values(E).reduce((ne,pe)=>ne+pe,0),Z=G>0&&he<=0,ie={};let ge=0;Object.keys(g).forEach(ne=>{const pe=g[ne]-(z[ne]||0);ie[ne]=pe,ge+=pe});const we={};Object.keys(p).forEach(ne=>{we[ne]=p[ne]-(M[ne]||0)});const je={},Ue={};Object.keys(v).forEach(ne=>{const pe=v[ne]-(E[ne]||0),Te=Math.floor(pe*.7),A=pe-Te;je[ne]=A,Ue[ne]=(E[ne]||0)+Te});let Ce={metal:0,crystal:0,deuterium:0};Z&&(Ce.metal=Math.floor((h.metal||0)*.5),Ce.crystal=Math.floor((h.crystal||0)*.5),Ce.deuterium=Math.floor((h.deuterium||0)*.5));const Ge={};Z&&o&&Object.entries(o).forEach(([ne,pe])=>{pe>0&&Math.random()<.1&&(Ge[ne]=1)});const qe={rounds:6,initialAttackerShips:g,initialDefenderShips:p,initialDefenderDefenses:v,finalAttackerShips:z,finalDefenderShips:M,finalDefenderDefenses:Ue,attackerLosses:ie,defenderLosses:we,defenderDefensesLost:je,loot:Ce,bonuses:{attacker:{weapon:x,shield:N,armour:1},defender:{weapon:j,shield:C,armour:1}},logMessages:_,result:Z?"attacker_win":"defender_win"};let ye=0,S=0;const V=(ne,pe)=>{if(Je[ne]){const Te=Je[ne].baseCost;ye+=Te.metal*pe*.3,S+=Te.crystal*pe*.3}};return Object.entries(ie).forEach(([ne,pe])=>V(ne,pe)),Object.entries(we).forEach(([ne,pe])=>V(ne,pe)),{report:qe,survivingAttackerShips:z,survivingDefenderShips:M,survivingDefenderDefenses:Ue,damagedBuildings:Ge,loot:Ce,attackerWon:Z,totalAttackerLost:ge,debris:{metal:Math.floor(ye),crystal:Math.floor(S)}}},By=1e3,ar=100,As="cosmos_conquest_save_v1",ja={avatarUrl:"/kosmo/avatars/avatar_default.png",planetType:"terran",planetName:"Nowa Kolonia",nickname:"Player",resources:{metal:500,crystal:300,deuterium:100,darkMatter:0,energy:0,maxEnergy:0,storage:{metal:1e4,crystal:1e4,deuterium:1e4}},productionSettings:{[oe.METAL_MINE]:100,[oe.CRYSTAL_MINE]:100,[oe.DEUTERIUM_SYNTH]:100,[oe.SOLAR_PLANT]:100,[oe.FUSION_REACTOR]:100},productionRates:{metal:0,crystal:0,deuterium:0},buildings:{[oe.METAL_MINE]:1,[oe.CRYSTAL_MINE]:0,[oe.DEUTERIUM_SYNTH]:0,[oe.SOLAR_PLANT]:1,[oe.FUSION_REACTOR]:0,[oe.ROBOT_FACTORY]:0,[oe.SHIPYARD]:0,[oe.RESEARCH_LAB]:0,[oe.METAL_STORAGE]:0,[oe.CRYSTAL_STORAGE]:0,[oe.DEUTERIUM_TANK]:0},research:{[xe.ENERGY_TECH]:0,[xe.LASER_TECH]:0,[xe.ION_TECH]:0,[xe.HYPERSPACE_TECH]:0,[xe.PLASMA_TECH]:0,[xe.COMBUSTION_DRIVE]:0,[xe.IMPULSE_DRIVE]:0,[xe.HYPERSPACE_DRIVE]:0,[xe.ESPIONAGE_TECH]:0,[xe.COMPUTER_TECH]:0,[xe.ASTROPHYSICS]:0,[xe.WEAPON_TECH]:0,[xe.SHIELDING_TECH]:0,[xe.ARMOUR_TECH]:0},ships:{[ue.LIGHT_FIGHTER]:0,[ue.HEAVY_FIGHTER]:0,[ue.CRUISER]:0,[ue.BATTLESHIP]:0,[ue.DESTROYER]:0,[ue.DEATH_STAR]:0,[ue.SMALL_CARGO]:0,[ue.MEDIUM_CARGO]:0,[ue.HUGE_CARGO]:0,[ue.COLONY_SHIP]:0,[ue.ESPIONAGE_PROBE]:0,[ue.PIONEER]:1,[ue.RECYCLER]:0},defenses:{[qt.ROCKET_LAUNCHER]:0,[qt.LIGHT_LASER]:0,[qt.HEAVY_LASER]:0,[qt.GAUSS_CANNON]:0,[qt.ION_CANNON]:0,[qt.PLASMA_TURRET]:0,[qt.SMALL_SHIELD]:0,[qt.LARGE_SHIELD]:0},constructionQueue:[],shipyardQueue:[],activeMissions:[],incomingMissions:[],missionLogs:[],lastTick:Date.now(),xp:0,level:1,version:1},os=(l,s,n,o,d)=>{const h=x=>(x.metal||0)+(x.crystal||0)+(x.deuterium||0)*2;let f=0;Object.entries(s||{}).forEach(([x,N])=>{const j=ts[x];if(!j)return;let C=0,z=0,M=0;for(let E=1;E<=N;E++){const O=Math.pow(1.5,E-1);C+=Math.floor(j.baseCost.metal*O),z+=Math.floor(j.baseCost.crystal*O),M+=Math.floor(j.baseCost.deuterium*O)}f+=h({metal:C,crystal:z,deuterium:M})});let b=0;Object.entries(o||{}).forEach(([x,N])=>{const j=Ar[x];if(!j)return;let C=0,z=0,M=0;for(let E=1;E<=N;E++){const O=Math.pow(1.5,E-1);C+=Math.floor(j.baseCost.metal*O),z+=Math.floor(j.baseCost.crystal*O),M+=Math.floor(j.baseCost.deuterium*O)}b+=h({metal:C,crystal:z,deuterium:M})});let g=0;Object.entries(n||{}).forEach(([x,N])=>{const j=Je[x];j&&(g+=h(j.baseCost)*N)});let p=0;Object.entries(d||{}).forEach(([x,N])=>{const j=Ka[x];j&&(p+=h(j.cost)*N)});const v=f+b+g+p;return Math.floor(v/1e3)},Ap=ee.createContext(void 0),Hy=({children:l,session:s})=>{const[n,o]=ee.useState({...ja,userId:s==null?void 0:s.user.id}),[d,h]=ee.useState(!1),[f,b]=ee.useState(!1),[g,p]=ee.useState(navigator.onLine);ee.useEffect(()=>{Uy()},[]);const v=ee.useRef(new Set);ee.useEffect(()=>{const w=()=>{console.log(" Status: ONLINE"),p(!0),b(!1)},k=()=>{console.log(" Status: OFFLINE"),p(!1)};return window.addEventListener("online",w),window.addEventListener("offline",k),()=>{window.removeEventListener("online",w),window.removeEventListener("offline",k)}},[]);const[x,N]=ee.useState([]),[j,C]=ee.useState(null),[z,M]=ee.useState("Gwna"),[E,O]=ee.useState(null),[_,G]=ee.useState(null),he=ee.useRef(n),Z=ee.useRef(j),ie=ee.useRef(_);ee.useEffect(()=>{he.current=n,Z.current=j,ie.current=_},[n,j,_]),ee.useEffect(()=>{},[]);const ge=ee.useRef(null),we=ee.useRef(new Set),je=async w=>{var X,K,F,$;if(f)return console.warn(" [SAVE] Paused due to auth error"),!1;const k=he.current,D=Z.current,B=D&&D!=="main"&&D!==null;console.log(""),console.log(` [SAVE START] Reason: ${w}`),console.log(` [SAVE] Target: ${B?`Colony (${D})`:"Main Planet"}`),console.log(" [SAVE] Current State:"),console.log("   Resources:",JSON.stringify(k.resources)),console.log("   Buildings:",JSON.stringify(k.buildings)),console.log("   Research:",JSON.stringify(k.research)),console.log("   Ships:",JSON.stringify(k.ships)),console.log("   Defenses:",JSON.stringify(k.defenses)),console.log("   ConstructionQueue:",((X=k.constructionQueue)==null?void 0:X.length)||0,"items"),console.log("   ShipyardQueue:",((K=k.shipyardQueue)==null?void 0:K.length)||0,"items"),console.log("   GalaxyCoords:",JSON.stringify(k.galaxyCoords)),console.log("   Nickname:",k.nickname),console.log("   PlanetName:",k.planetName),localStorage.setItem(As,JSON.stringify(k));let U={},te=null,le=null;if(B){te={buildings:k.buildings,ships:k.ships,defenses:k.defenses,resources:k.resources,construction_queue:k.constructionQueue,shipyard_queue:k.shipyardQueue},le=D;const{data:q}=await de.from("profiles").select("resources, debris").eq("id",s.user.id).single(),me={...(q==null?void 0:q.resources)||{},darkMatter:n.resources.darkMatter};U={research:k.research,production_settings:{...k.productionSettings,avatarUrl:k.avatarUrl,planetType:k.planetType,nickname:k.nickname},nickname:k.nickname,active_missions:k.activeMissions,resources:me,last_updated:Date.now(),level:k.level,xp:k.xp,points:(()=>{let ke=0;return ke+=os(null,k.buildings,k.ships,k.research,k.defenses),ke})()},ge.current={...k}}else U={planet_name:k.planetName,nickname:k.nickname,resources:k.resources,buildings:k.buildings,research:k.research,ships:k.ships,defenses:k.defenses,construction_queue:k.constructionQueue,shipyard_queue:k.shipyardQueue,production_settings:{...k.productionSettings,avatarUrl:k.avatarUrl,planetType:k.planetType,nickname:k.nickname},active_missions:k.activeMissions,mission_logs:k.missionLogs,galaxy_coords:k.galaxyCoords,points:(()=>{let q=0;return q+=os(null,k.buildings,k.ships,k.research,k.defenses),x.forEach(W=>{W.id!==j&&(q+=os(null,W.buildings,W.ships,{},W.defenses))}),q})(),last_updated:Date.now(),level:k.level,xp:k.xp};try{console.log(` [SAVE] Calling RPC save_game_atomic (Ver: ${k.version||1})`);const{data:q,error:W}=await de.rpc("save_game_atomic",{p_user_id:s.user.id,p_profile_data:U,p_planet_id:le,p_planet_data:te,p_expected_version:k.version||1});if(W){if(console.error(" [SAVE RPC ERROR]",W),W.message&&W.message.includes("VERSION_MISMATCH"))return console.warn(" Version mismatch, reloading..."),window.location.reload(),!1;throw W}if(q&&q.success){const me=q.new_version;return console.log(` [SAVE SUCCESS] Version bumped to ${me}`),o(ke=>({...ke,version:me})),he.current.version=me,ge.current=JSON.parse(JSON.stringify(k)),!0}}catch(q){return console.error(" [SAVE EXCEPTION]",q),((F=q==null?void 0:q.message)!=null&&F.includes("Failed to fetch")||($=q==null?void 0:q.message)!=null&&$.includes("NetworkError"))&&p(!1),(q.code==="401"||q.code==="403")&&b(!0),!1}return!1},Ue=(w,k)=>{const D=ge.current;if(!D){console.log(" [VALIDATE] No previous state to compare");return}console.log(" [VALIDATE] Comparing loaded state vs last saved...");const B=[],U=(te,le,X,K=[])=>{if(!X||!le){if(te==="research"){console.log(" [VALIDATE] Skipping research (global, not per-planet)");return}X!==le&&B.push(` [DESYNC] ${te}: one is null/undefined`);return}const F=new Set([...Object.keys(X),...Object.keys(le)]),$=[];F.forEach(q=>{if(K.includes(q))return;const W=X[q],me=le[q];if(typeof W=="object"&&W!==null){const ke=JSON.stringify(W),Re=JSON.stringify(me);ke!==Re&&$.push(`  ${q}: SAVED=${ke.substring(0,50)} LOADED=${Re==null?void 0:Re.substring(0,50)}`)}else if(typeof W=="number"&&typeof me=="number"){const ke=Math.max(1,Math.abs(W)*.01);Math.abs(W-me)>ke&&$.push(`  ${q}: SAVED=${W}  LOADED=${me}`)}else W!==me&&$.push(`  ${q}: SAVED=${W}  LOADED=${me}`)}),$.length>0&&(B.push(` [DESYNC] ${te} has ${$.length} differences:`),$.forEach(q=>console.warn(q)))};U("buildings",w.buildings,D.buildings),U("research",w.research,D.research),U("ships",w.ships,D.ships),U("defenses",w.defenses,D.defenses),U("resources",w.resources,D.resources,["energy","maxEnergy"]),JSON.stringify(w.constructionQueue)!==JSON.stringify(D.constructionQueue)&&B.push(` [DESYNC] constructionQueue:
SAVED=${JSON.stringify(D.constructionQueue)}
LOADED=${JSON.stringify(w.constructionQueue)}`),JSON.stringify(w.shipyardQueue)!==JSON.stringify(D.shipyardQueue)&&B.push(` [DESYNC] shipyardQueue:
SAVED=${JSON.stringify(D.shipyardQueue)}
LOADED=${JSON.stringify(w.shipyardQueue)}`),B.length>0?(console.warn(""),console.warn(" [VALIDATION FAILED] Data desync detected:"),B.forEach(te=>console.warn(te)),console.warn("")):console.log(" [VALIDATE] State matches - no desync detected from",k)},Ce=async w=>{const{data:k,error:D}=await de.from("profiles").select("id, galaxy_coords").not("galaxy_coords","is",null);if(D)return console.error("Error finding target user:",D),null;const B=k==null?void 0:k.find(U=>{var te,le,X;return((te=U.galaxy_coords)==null?void 0:te.galaxy)===w.galaxy&&((le=U.galaxy_coords)==null?void 0:le.system)===w.system&&((X=U.galaxy_coords)==null?void 0:X.position)===w.position});return(B==null?void 0:B.id)||null},Ge=async()=>{if(!(s!=null&&s.user)||f)return;const{data:w,error:k}=await de.from("missions").select("*").or(`owner_id.eq.${s.user.id}, target_user_id.eq.${s.user.id}`);if(w&&!k){const D=w.map(K=>({id:K.id,ownerId:K.owner_id,targetUserId:K.target_user_id,type:K.mission_type,ships:K.ships,targetCoords:K.target_coords,originCoords:K.origin_coords,startTime:K.start_time,arrivalTime:K.arrival_time,returnTime:K.return_time,eventProcessed:K.status!=="flying",status:K.status,resources:K.resources,result:K.result})),U=Date.now()-1e4,te=D.filter(K=>K.status==="flying"&&K.arrivalTime<U&&!we.current.has(K.id));te.length>0&&(console.log(" [SILENT RESCUE] Zombies detected:",te.length),te.forEach(K=>{we.current.add(K.id),de.from("missions").update({status:"completed",result:{id:`${K.id}-rescue`,timestamp:Date.now(),outcome:"neutral",title:"Zaginiona Flota",message:"Misja zakoczona awaryjnie (Silent Rescue)."}}).eq("id",K.id).then(({error:F})=>{F?console.error("Silent Rescue DB Error:",F):console.log(" [SILENT RESCUE] DB Updated for",K.id)})}));const le=D.filter(K=>K.ownerId===s.user.id&&K.status!=="completed"&&!we.current.has(K.id));let X=D.filter(K=>K.targetUserId===s.user.id&&K.ownerId!==s.user.id&&K.status==="flying"&&K.arrivalTime>U&&!we.current.has(K.id));if(X.length>0){const K=X.map($=>$.ownerId).filter($=>!!$),F=Array.from(new Set(K));if(F.length>0){console.log(" Resolving Incoming Attackers:",F);const{data:$,error:q}=await de.from("profiles").select("id, nickname").in("id",F);if(q&&console.error(" Error fetching incoming attackers:",q),$){const W=new Map($.map(me=>[me.id,me.nickname]));X=X.map(me=>{var ke;return{...me,attackerName:me.ownerId&&W.get(me.ownerId)||`Obcy [${((ke=me.ownerId)==null?void 0:ke.slice(0,4))||"???"}]`}})}}X.forEach($=>{if(!v.current.has($.id)){v.current.add($.id);const q=$.originCoords?`[${$.originCoords.galaxy}:${$.originCoords.system}:${$.originCoords.position}]`:"[?:?:?]";np(" WYKRYTO ZAGROENIE!",`Gracz ${$.attackerName||"Nieznany"} ${q} zblia si do Twojej planety!`,"/kosmo/icons/warning.png")}}),console.log("Incoming Attacks Detected:",X)}o(K=>({...K,activeMissions:le,incomingMissions:X}))}else k&&(console.error("Error fetching missions:",k),(k.code==="401"||k.code==="403"||k.message.includes("JWT"))&&(console.error(" CRITICAL: Pausing Sync due to Auth Error. Please run SQL RLS script."),b(!0)))},qe=async()=>{var D,B,U,te,le,X;if(!(s!=null&&s.user))return;const{data:w,error:k}=await de.from("profiles").select("*").eq("id",s.user.id).single();if(w&&!k){const K=w.last_updated||Date.now(),F=Date.now(),$=Math.max(0,(F-K)/1e3);let q={...w.resources};if($>1){console.log(` Calculating offline production for ${$.toFixed(0)} seconds...`);const me={...ja.buildings,...w.buildings},ke={...ja.productionSettings,...w.production_settings},Re=me[oe.METAL_MINE]||0,Nt=me[oe.CRYSTAL_MINE]||0,dt=me[oe.DEUTERIUM_SYNTH]||0,We=me[oe.SOLAR_PLANT]||0,St=me[oe.FUSION_REACTOR]||0,Jt=20*We*Math.pow(1.1,We),la=30*St*Math.pow(1.05+.01*(me[xe.ENERGY_TECH]||0),St),Se=Math.floor(Jt+la),At=10*Re*Math.pow(1.1,Re),mt=10*Nt*Math.pow(1.1,Nt),Pt=20*dt*Math.pow(1.1,dt),ve=Math.ceil(At+mt+Pt),Fe=Se>=ve?1:Se/(ve||1),et=30*Re*Math.pow(1.1,Re)*Fe*(ke[oe.METAL_MINE]??100)/100,Ke=20*Nt*Math.pow(1.1,Nt)*Fe*(ke[oe.CRYSTAL_MINE]??100)/100,Qe=10*dt*Math.pow(1.1,dt)*1*Fe*(ke[oe.DEUTERIUM_SYNTH]??100)/100;let wt=0,oa=0;Object.entries(w.ships||{}).forEach(([as,cs])=>{const Va=Je[as];Va&&(oa+=(Va.baseCost.metal+Va.baseCost.crystal)*cs)}),wt=oa/1e3*ar/3600;const nr=Qe-wt;q.storage||(q.storage=JSON.parse(JSON.stringify(ja.resources.storage))),q.metal=Math.max(0,Math.min(q.storage.metal,q.metal+et*$)),q.crystal=Math.max(0,Math.min(q.storage.crystal,q.crystal+Ke*$)),q.deuterium=Math.max(0,Math.min(q.storage.deuterium,q.deuterium+nr*$))}M(w.planet_name||"Gwna"),console.log(""),console.log(" [LOAD] Profile loaded from Supabase"),console.log(" [LOAD] Raw DB Data:"),console.log("   Resources:",JSON.stringify(w.resources)),console.log("   Buildings:",JSON.stringify(w.buildings)),console.log("   Research:",JSON.stringify(w.research)),console.log("   Ships:",JSON.stringify(w.ships)),console.log("   Defenses:",JSON.stringify(w.defenses)),console.log("   ConstructionQueue:",((D=w.construction_queue)==null?void 0:D.length)||0,"items"),console.log("   ShipyardQueue:",((B=w.shipyard_queue)==null?void 0:B.length)||0,"items"),console.log("   GalaxyCoords:",JSON.stringify(w.galaxy_coords)),console.log("   Nickname:",w.nickname),console.log("   PlanetName:",w.planet_name),console.log("");const W={planetName:w.planet_name||"Nowa Kolonia",nickname:w.nickname||((U=w.production_settings)==null?void 0:U.nickname)||"Player",resources:{...ja.resources,...q},buildings:{...ja.buildings,...w.buildings},research:{...ja.research,...w.research},ships:{...ja.ships,...w.ships},defenses:{...ja.defenses,...w.defenses},constructionQueue:w.construction_queue||[],shipyardQueue:w.shipyard_queue||[],productionSettings:{...ja.productionSettings,...w.production_settings},avatarUrl:((te=w.production_settings)==null?void 0:te.avatarUrl)||ja.avatarUrl,planetType:((le=w.production_settings)==null?void 0:le.planetType)||"terran",missionLogs:w.mission_logs||[],galaxyCoords:w.galaxy_coords,version:w.version||1,debris:w.debris||{metal:0,crystal:0}};w.galaxy_coords&&O(w.galaxy_coords),Ue(W,"refreshProfile (Main Planet)"),o(me=>({...me,...W,lastTick:Date.now()})),$>1&&de.from("profiles").update({resources:q}).eq("id",s.user.id).then(({error:me})=>{me&&console.error("Failed to save offline production:",me)})}else{if(k){if(console.error("Profile Load Error:",k),k.code==="401"||k.code==="403"){console.error(" RLS Policy Missing"),b(!0);return}if(k.code!=="PGRST116"){alert("Bd poczenia z baz danych (Profile Load). Nie nadpisuj danych.");return}}const K=localStorage.getItem(As);if(K)try{const F=JSON.parse(K);F.userId&&F.userId===s.user.id?((X=F.production_settings)!=null&&X.nickname&&(F.nickname=F.production_settings.nickname),o($=>({...$,...F,userId:s.user.id,lastTick:Date.now()}))):(console.warn("Cleared mismatching local storage data"),localStorage.removeItem(As),o($=>({...ja,userId:s.user.id})))}catch{localStorage.removeItem(As)}}h(!0)};ee.useEffect(()=>{qe(),Ge(),ce();const w=setInterval(()=>{var k;document.visibilityState==="visible"&&!f&&(Ge(),de.from("profiles").select("mission_logs, nickname").eq("id",(k=s==null?void 0:s.user)==null?void 0:k.id).single().then(({data:D})=>{D&&o(B=>({...B,missionLogs:D.mission_logs||B.missionLogs,nickname:D.nickname||B.nickname}))}))},6e4);return()=>clearInterval(w)},[s]),ee.useEffect(()=>{if(!d||!(s!=null&&s.user)||f)return;const w=async()=>{await je("Auto-Save (60s interval)")},k=setInterval(w,6e4),D=B=>{const U=he.current;localStorage.setItem(As,JSON.stringify(U)),localStorage.setItem(As+"_backup",JSON.stringify({...U,_savedAt:Date.now(),_savedBy:"beforeunload"})),console.log(" [BEFOREUNLOAD] Saved to localStorage"),w()};return window.addEventListener("beforeunload",D),()=>{clearInterval(k),window.removeEventListener("beforeunload",D),w()}},[d,s]);const ye=async w=>{var te,le,X,K,F,$,q,W,me,ke,Re,Nt,dt;if(w.eventProcessed)return;const{data:k,error:D}=await de.from("missions").update({status:"processing"}).eq("id",w.id).eq("status","flying").select("id");if(D||!k||k.length===0){console.log(" Mission already being processed by another session:",w.id);return}let B=0;const U=5;for(;B<U;){let We={},St={},Jt={...w.ships};try{if(console.log(`Przetwarzanie Przylotu (Prba ${B+1}):`,w.id,w.type),w.type===Ze.COLONIZE){const{data:Se}=await de.from("planets").select("id").contains("galaxy_coords",w.targetCoords),{data:At}=await de.from("profiles").select("id").contains("galaxy_coords",w.targetCoords);if(Se&&Se.length>0||At&&At.length>0)We={id:`${w.id}-fail`,timestamp:Date.now(),title:"Kolonizacja Nieudana",message:`Pozycja [${w.targetCoords.galaxy}:${w.targetCoords.system}:${w.targetCoords.position}] zajta.`,outcome:"failure"};else{const{error:mt}=await de.from("planets").insert({owner_id:w.ownerId,planet_name:`Kolonia ${x.length+1}`,planet_type:"terran",galaxy_coords:w.targetCoords,resources:{metal:500+(((te=w.resources)==null?void 0:te.metal)||0),crystal:300+(((le=w.resources)==null?void 0:le.crystal)||0),deuterium:100+(((X=w.resources)==null?void 0:X.deuterium)||0),darkMatter:0,energy:0,maxEnergy:0,storage:{metal:1e4,crystal:1e4,deuterium:1e4}},buildings:{},ships:{},defenses:{},is_main:!1});mt?We={id:`${w.id}-error`,timestamp:Date.now(),title:"Bd Kolonizacji",message:mt.message,outcome:"failure"}:(We={id:`${w.id}-success`,timestamp:Date.now(),title:"Kolonizacja Zakoczona",message:"Nowa kolonia zaoona.",outcome:"success"},Jt={},ce())}B=U+1}else if(w.type===Ze.EXPEDITION){const Se=Ly(w);We=Se.log,Se.rewards&&(St=Se.rewards),B=U+1}else if(w.type===Ze.RECYCLE){const{data:Se}=await de.from("planets").select("*").contains("galaxy_coords",w.targetCoords),{data:At}=await de.from("profiles").select("*").contains("galaxy_coords",w.targetCoords);let mt=Se&&Se[0]||At&&At[0],Pt=!!(Se&&Se[0]);if(!mt)We={id:`${w.id}-fail`,timestamp:Date.now(),title:"Recykling Nieudany",message:"Brak pola zniszcze na tych koordynatach.",outcome:"failure"};else{const ve=mt.debris||{metal:0,crystal:0};if((ve.metal||0)+(ve.crystal||0)<=0)We={id:`${w.id}-empty`,timestamp:Date.now(),title:"Raport Recyklingu",message:"Pole zniszcze jest puste.",outcome:"neutral"};else{let Qe=(w.ships[ue.RECYCLER]||0)*2e4;const wt=Math.min(ve.metal||0,Qe);Qe-=wt;const oa=Math.min(ve.crystal||0,Qe),nr={metal:-wt,crystal:-oa},{error:as}=await de.rpc("apply_mission_outcome",{p_mission_id:w.id,p_target_id:mt.id,p_is_planet:Pt,p_log_entry:null,p_resources_diff:null,p_debris_diff:nr,p_ships_new:null,p_defenses_new:null,p_buildings_new:null});as?(console.error("Recycle RPC Error:",as),We={id:`${w.id}-err`,timestamp:Date.now(),title:"Bd Recyklingu",message:as.message,outcome:"failure"}):(await de.from("fleets").update({resources:{metal:wt,crystal:oa,deuterium:0}}).eq("id",w.id),We={id:`${w.id}-success`,timestamp:Date.now(),title:"Recykling Zakoczony",message:`Odzyskano: M:${wt} K:${oa}.`,outcome:"success",rewards:{metal:wt,crystal:oa}})}}B=U+1}else if(w.type===Ze.ATTACK||w.type===Ze.SPY||w.type===Ze.TRANSPORT)if(w.targetUserId){let Se=null,At=!1,mt=w.targetUserId;const{data:Pt,error:ve}=await de.from("planets").select("*").eq("galaxy",w.targetCoords.galaxy).eq("system",w.targetCoords.system).eq("position",w.targetCoords.position).single();if(Pt)Se=Pt,At=!0,mt=Pt.id;else{const{data:Et,error:Ct}=await de.from("profiles").select("*").eq("id",w.targetUserId).single();if(Ct)throw new Error("Target fetch error");Se=Et,At=!1,mt=Et.id}let Fe={},et=[...Se.mission_logs||[]],Ke=w.attackerName||"Nieznany";if(w.ownerId===s.user.id)Ke=he.current.nickname||"Ty";else if(!w.attackerName||w.attackerName==="Nieznany"){console.log(` Fetching attacker name for ID: ${w.ownerId}`);const{data:Et,error:Ct}=await de.from("profiles").select("nickname, research").eq("id",w.ownerId).single();Ct&&console.error(" Error fetching attacker profile:",Ct),Et&&Et.nickname?(Ke=Et.nickname,console.log(` Attacker identified: ${Ke}`)):console.warn(` Attacker profile not found or no nickname for ID: ${w.ownerId}`)}let Qe=null;if(w.type===Ze.ATTACK){let Et={};w.ownerId===s.user.id&&(Et=he.current.research);const Ct=lp(w.ships,Se.ships,Se.defenses||{},Se.buildings,Se.research,Se.resources,!1,Et);Qe=Ct;const Qa=`[${w.originCoords.galaxy}:${w.originCoords.system}:${w.originCoords.position}]`,_a=`[${w.targetCoords.galaxy}:${w.targetCoords.system}:${w.targetCoords.position}]`;We={id:`${w.id}-result`,timestamp:Date.now(),title:Qe.attackerWon?"Zwycistwo!":"Poraka",message:`Atak na ${Se.nickname||"Gracza"} ${_a} zakoczony. Wynik: ${Qe.attackerWon?"Wygrana":"Przegrana"}. Zrabowano: M:${Math.floor(Qe.loot.metal)} C:${Math.floor(Qe.loot.crystal)}.`,outcome:Qe.attackerWon?"success":"failure",rewards:Qe.loot,report:Qe.report},St=Qe.loot,Jt=Qe.survivingAttackerShips,Qe.report.result==="attacker_win"&&pa(50,"PvP Victory"),Fe.ships=Ct.survivingDefenderShips,Fe.defenses=Ct.survivingDefenderDefenses;const bt={...Se.buildings};Object.entries(Ct.damagedBuildings||{}).forEach(([Xt,us])=>{bt[Xt]&&(bt[Xt]=Math.max(0,bt[Xt]-us))}),Fe.buildings=bt,Fe.resources={...Se.resources,metal:Math.max(0,Se.resources.metal-(St.metal||0)),crystal:Math.max(0,Se.resources.crystal-(St.crystal||0)),deuterium:Math.max(0,Se.resources.deuterium-(St.deuterium||0))};const ss=Se.debris||{metal:0,crystal:0},Rs=Ct.debris||{metal:0,crystal:0};Fe.debris={metal:(ss.metal||0)+(Rs.metal||0),crystal:(ss.crystal||0)+(Rs.crystal||0)},et.unshift({id:`${w.id}-def-log`,timestamp:Date.now(),title:"ZOSTAE ZAATAKOWANY!",message:`Gracz ${Ke} ${Qa} zaatakowa Twoj planet ${_a}. Wynik: ${Ct.attackerWon?"PRZEGRANA":"OBRONA"}.`,outcome:"danger",report:Ct.report})}else if(w.type===Ze.TRANSPORT)Fe.resources={...Se.resources||{},metal:(((K=Se.resources)==null?void 0:K.metal)||0)+(((F=w.resources)==null?void 0:F.metal)||0),crystal:((($=Se.resources)==null?void 0:$.crystal)||0)+(((q=w.resources)==null?void 0:q.crystal)||0),deuterium:(((W=Se.resources)==null?void 0:W.deuterium)||0)+(((me=w.resources)==null?void 0:me.deuterium)||0)},et.unshift({id:Date.now().toString(),timestamp:Date.now(),title:"Dostawa Surowcw",message:`Otrzymano surowce od ${Ke}.`,outcome:"success"}),We={id:Date.now().toString(),timestamp:Date.now(),outcome:"success",title:"Transport",message:"Surowce dostarczone."};else if(w.type===Ze.SPY){let Et={};if(w.ownerId===s.user.id)Et=he.current.research;else{const{data:Xt,error:us}=await de.from("profiles").select("nickname, research").eq("id",w.ownerId).single();Et=(Xt==null?void 0:Xt.research)||{},(!Ke||Ke==="Nieznany")&&(Xt!=null&&Xt.nickname)&&(Ke=Xt.nickname,console.log(` Spy Attacker identified (Fallback): ${Ke}`))}const Ct=(Et==null?void 0:Et.espionageTech)||0,Qa=((ke=Se.research)==null?void 0:ke.espionageTech)||0,_a=Ct-Qa,bt={targetName:Se.nickname||"Nieznany Cel",attackerSpyLevel:Ct,defenderSpyLevel:Qa,resources:Se.resources};let ss=[`Surowce: M:${Math.floor(Se.resources.metal)} K:${Math.floor(Se.resources.crystal)} D:${Math.floor(Se.resources.deuterium)}`];_a>=2&&(bt.ships=Se.ships,ss.push(`Flota: ${Object.keys(Se.ships||{}).length} typw.`)),_a>=3&&(bt.defenses=Se.defenses,ss.push(`Obrona: ${Object.keys(Se.defenses||{}).length} typw.`)),_a>=5&&(bt.buildings=Se.buildings,ss.push(`Budynki: ${Object.keys(Se.buildings||{}).length} typw.`));const Rs=w.originCoords?`[${w.originCoords.galaxy}:${w.originCoords.system}:${w.originCoords.position}]`:"[?:?:?]";np(" WYKRYTO SKANOWANIE",`Gracz ${Ke} ${Rs} przeskanowa Twoj planet.`,"/kosmo/icons/spy.png"),et.unshift({id:`${w.id}-def-log`,timestamp:Date.now(),title:"Wykryto Skanowanie!",message:`Gracz ${Ke} ${Rs} przeskanowa Twoj planet.`,outcome:"danger"}),We={id:`${w.id}-result`,timestamp:Date.now(),title:"Raport Szpiegowski",message:`Skanowanie zakoczone. Poziomy: Ty:${Ct} vs Cel:${Qa}. 
${ss.join(`
`)}`,outcome:"success",report:bt}}const wt={};w.type===Ze.ATTACK?(wt.metal=-(St.metal||0),wt.crystal=-(St.crystal||0),wt.deuterium=-(St.deuterium||0)):w.type===Ze.TRANSPORT&&(wt.metal=((Re=w.resources)==null?void 0:Re.metal)||0,wt.crystal=((Nt=w.resources)==null?void 0:Nt.crystal)||0,wt.deuterium=((dt=w.resources)==null?void 0:dt.deuterium)||0);const oa={};if(w.type===Ze.ATTACK){const Et=(Qe==null?void 0:Qe.debris)||{metal:0,crystal:0};oa.metal=Et.metal,oa.crystal=Et.crystal}const nr=w.type===Ze.ATTACK?Qe==null?void 0:Qe.survivingDefenderShips:void 0,as=w.type===Ze.ATTACK?Qe==null?void 0:Qe.survivingDefenderDefenses:void 0,cs=w.type===Ze.ATTACK?Fe.buildings:void 0,{error:Va}=await de.rpc("apply_mission_outcome",{p_mission_id:w.id,p_target_id:mt,p_is_planet:At,p_log_entry:et[0],p_resources_diff:wt,p_debris_diff:oa,p_ships_new:nr,p_defenses_new:as,p_buildings_new:cs});Va&&(console.error("Mission Outcome RPC Error:",Va),Va.message.includes("UNAUTHORIZED")&&console.error("Critical Auth Error in Mission RPC")),B=U+1}else{if(w.type===Ze.ATTACK){const Se=lp(w.ships,{},{},{},{},{metal:5e3,crystal:3e3,deuterium:500},!0);We={id:`${w.id}-pve`,timestamp:Date.now(),title:"Bitwa z Piratami",message:`Wynik: ${Se.attackerWon?"Wygrana":"Przegrana"}.`,outcome:"success",rewards:Se.loot,report:Se.report},St=Se.loot,Jt=Se.survivingAttackerShips,pa(30,"Pirate Combat")}else We={id:Date.now().toString(),timestamp:Date.now(),outcome:"neutral",title:"Raport",message:"Cel nie istnieje (Pustka)."},w.type===Ze.TRANSPORT&&(St=w.resources||{});B=U+1}const la=(w.returnTime-w.startTime)/2;await de.from("missions").update({status:"returning",resources:St,ships:Jt,result:We,return_time:Date.now()+la}).eq("id",w.id),Ge()}catch(la){console.error("Critical Mission Arrival Error:",la),await de.from("missions").update({status:"returning",return_time:Date.now()+6e4,result:{id:Date.now().toString(),title:"Bd Systemowy",message:"Awaryjny powrt.",outcome:"neutral"}}).eq("id",w.id),B=U+1}}},S=async w=>{var B,U,te,le,X;let k=0;const D=5;for(;k<D;)try{console.log(`Processing Return (Attempt ${k+1}):`,w.id);const{data:K}=await de.from("missions").select("*").eq("id",w.id).single(),{data:F,error:$}=await de.from("profiles").select("*").eq("id",s.user.id).single();if($||!F)throw new Error("Profile fetch error");const q=K?{...w,resources:K.resources,result:K.result,ships:K.ships||w.ships,type:K.mission_type}:w,W=`${q.id}-return`;if((B=F.mission_logs)==null?void 0:B.some(ve=>ve.id===W)){console.warn(" Powrt misji ju przetworzony (Dubel). Pomijam."),await de.from("missions").update({status:"completed"}).eq("id",q.id),Ge();return}const ke={...F.ships};q.ships&&Object.entries(q.ships).forEach(([ve,Fe])=>{ke[ve]=(Number(ke[ve])||0)+(Number(Fe)||0)});const Re={...ja.resources,...F.resources||{}};q.resources&&(Re.metal=(Number(Re.metal)||0)+(Number(q.resources.metal)||0),Re.crystal=(Number(Re.crystal)||0)+(Number(q.resources.crystal)||0),Re.deuterium=(Number(Re.deuterium)||0)+(Number(q.resources.deuterium)||0),Re.darkMatter=(Number(Re.darkMatter)||0)+(Number(q.resources.darkMatter)||0),q.resources.ships&&Object.entries(q.resources.ships).forEach(([ve,Fe])=>{ke[ve]=(Number(ke[ve])||0)+(Number(Fe)||0)}));const Nt=((U=q.result)==null?void 0:U.title)||"Powrt Floty (Anulowana)";let dt="";Object.entries(q.ships||{}).forEach(([ve,Fe])=>{Fe>0&&(dt+=`${Je[ve].name}: ${Fe}, `)}),dt&&(dt=dt.slice(0,-2));const We=q.resources,St=We&&(We.metal||We.crystal||We.deuterium)?`Surowce: M:${Math.floor(We.metal||0)} K:${Math.floor(We.crystal||0)} D:${Math.floor(We.deuterium||0)}`:"",Jt=((te=q.result)==null?void 0:te.message)||`Flota wrcia z anulowanej misji ${q.type}. 
Flota: ${dt}. 
${St}`,la=((le=q.result)==null?void 0:le.outcome)||"neutral",Se=(X=q.result)==null?void 0:X.report,At=[{id:W,timestamp:Date.now(),title:Nt,message:Jt,outcome:la,rewards:q.resources,report:Se},...F.mission_logs||[]].slice(0,50),{data:mt,error:Pt}=await de.rpc("save_game_atomic",{p_user_id:s.user.id,p_profile_data:{ships:ke,resources:Re,mission_logs:At,points:os(Re,n.buildings,ke,n.research,n.defenses),last_updated:Date.now()},p_expected_version:F.version||1});if(Pt)if(Pt.message.includes("VERSION_MISMATCH")){console.warn(` Konflikt Wersji (Zmiana w tle). Ponawiam ${k+1}/${D}...`),k++,await new Promise(ve=>setTimeout(ve,Math.random()*500+200));continue}else throw Pt;console.log(" Powrt Misji Zapisany (Atomowo)."),ge.current={...ge.current,ships:ke,resources:Re,missionLogs:At,version:mt.new_version},o(ve=>({...ve,ships:ke,resources:Re,missionLogs:At,version:mt.new_version})),await de.from("missions").update({status:"completed"}).eq("id",q.id),Ge();return}catch(K){console.error("Critical Error in processMissionReturn:",K),alert(`BD MISJI: ${K.message||K} `);return}console.error(" Max Retries Exceeded for Mission Return"),alert("Nie udao si zapisa powrotu misji (Bd poczenia/Wersji). Sprbuj odwiey stron.")};ee.useEffect(()=>{if(!(s!=null&&s.user))return;Ge();const w=de.channel("missions-changes").on("postgres_changes",{event:"*",schema:"public",table:"missions",filter:`source_user=eq.${s.user.id}`},()=>Ge()).on("postgres_changes",{event:"*",schema:"public",table:"missions",filter:`target_user=eq.${s.user.id}`},()=>{console.log(" Incoming mission detected via Realtime"),Ge()}).subscribe(D=>{D==="SUBSCRIBED"&&console.log(" Connected to Missions stream (Filtered)")}),k=de.channel("profile-changes").on("postgres_changes",{event:"UPDATE",schema:"public",table:"profiles",filter:`id=eq.${s.user.id}`},D=>{const B=D.new;B&&(console.log(" Profile update received via Realtime"),o(U=>({...U,missionLogs:B.mission_logs||U.missionLogs,nickname:B.nickname||U.nickname})))}).subscribe(D=>{D==="SUBSCRIBED"&&console.log(" Connected to Profile stream")});return()=>{de.removeChannel(w),de.removeChannel(k)}},[s]),ee.useEffect(()=>{if(!d||!(s!=null&&s.user))return;let w=0;const k=async()=>{const B=Date.now(),U=[...he.current.activeMissions||[],...he.current.incomingMissions||[]];w++,w>=30&&(w=0,Ge());const te=B-60*1e3,le=U.filter($=>$.status==="flying"&&$.arrivalTime<te),X=new Set;for(const $ of le){console.warn(` AGGRESSIVE RESCUE: Force-completing stuck mission ${$.id}`),X.add($.id),we.current.add($.id),o(W=>({...W,activeMissions:W.activeMissions.filter(me=>me.id!==$.id),incomingMissions:W.incomingMissions.filter(me=>me.id!==$.id)}));const{error:q}=await de.from("missions").update({status:"completed",result:{id:B.toString(),timestamp:B,title:"Misja Anulowana (System)",message:"Misja utkna i zostaa automatycznie zakoczona przez system.",outcome:"neutral"}}).eq("id",$.id);if(q?console.error(" AGGRESSIVE RESCUE DB ERROR:",q):console.log(" AGGRESSIVE RESCUE: Success"),$.ownerId===s.user.id){const{data:W}=await de.from("profiles").select("ships").eq("id",s.user.id).single();if(W&&$.ships){const me={...W.ships};Object.entries($.ships).forEach(([ke,Re])=>{me[ke]=(Number(me[ke])||0)+(Number(Re)||0)}),await de.from("profiles").update({ships:me}).eq("id",s.user.id)}}}const K=U.filter($=>!X.has($.id)&&$.status==="flying"&&B>=$.arrivalTime&&!$.eventProcessed&&($.ownerId===s.user.id||$.targetUserId===s.user.id&&B>$.arrivalTime+1e4));for(const $ of K)o(q=>({...q,activeMissions:q.activeMissions.map(W=>W.id===$.id?{...W,eventProcessed:!0}:W)})),await ye($);const F=U.filter($=>$.status==="returning"&&B>=$.returnTime&&$.ownerId===s.user.id);for(const $ of F)o(q=>({...q,activeMissions:q.activeMissions.filter(W=>W.id!==$.id)})),await S($);X.size>0&&Ge()};Ge();const D=setInterval(k,1e3);return()=>clearInterval(D)},[d,s]);const V=(w,k,D)=>{const B=w==="building"?ts[k]:Ar[k],U=Math.pow(1.5,D);return{metal:Math.floor(B.baseCost.metal*U),crystal:Math.floor(B.baseCost.crystal*U),deuterium:Math.floor(B.baseCost.deuterium*U)}},ne=w=>{if(!w)return!0;for(const k of w)if(k.type==="building"){if(n.buildings[k.id]<k.level)return!1}else if(k.type==="research"&&n.research[k.id]<k.level)return!1;return!0},pe=w=>{let k=0;return Object.entries(w).forEach(([B,U])=>{const te=Je[B];if(te){const le=te.baseCost.metal+te.baseCost.crystal;k+=le*U}}),k/1e3*ar/3600},Te=w=>{const k=w.productionSettings,D=oa=>(k[oa]!==void 0?k[oa]:100)/100,B=w.buildings[oe.METAL_MINE],U=D(oe.METAL_MINE),te=Math.floor(30*B*Math.pow(1.1,B))*ar*U,le=Math.floor(20*B*Math.pow(1.1,B))*U,X=w.buildings[oe.CRYSTAL_MINE],K=D(oe.CRYSTAL_MINE),F=Math.floor(20*X*Math.pow(1.1,X))*ar*K,$=Math.floor(20*X*Math.pow(1.1,X))*K,q=w.buildings[oe.DEUTERIUM_SYNTH],W=D(oe.DEUTERIUM_SYNTH),me=Math.floor(10*q*Math.pow(1.1,q))*ar*W,ke=Math.floor(40*q*Math.pow(1.1,q))*W,Re=w.buildings[oe.SOLAR_PLANT],Nt=D(oe.SOLAR_PLANT),dt=w.buildings[oe.FUSION_REACTOR],We=D(oe.FUSION_REACTOR),St=w.research[xe.ENERGY_TECH]||0;let Jt=Math.floor(20*Re*Math.pow(1.1,Re))*Nt;Jt+=Math.floor(30*dt*Math.pow(1.05+.01*St,dt))*We;const la=Math.floor(10*dt*Math.pow(1.1,dt))*We,Se=le+$+ke,At=Jt-Se,mt=At>=0?1:Math.max(0,Jt/(Se||1)),Pt=w.buildings[oe.METAL_STORAGE],ve=w.buildings[oe.CRYSTAL_STORAGE],Fe=w.buildings[oe.DEUTERIUM_TANK],et=1e4+5e3*Math.floor(Math.pow(2.5,Pt)),Ke=1e4+5e3*Math.floor(Math.pow(2.5,ve)),Qe=1e4+5e3*Math.floor(Math.pow(2.5,Fe)),wt=pe(w.ships);return{metal:te*mt/3600,crystal:F*mt/3600,deuterium:(me-la)*mt/3600-wt,energy:At,maxEnergy:Jt,storage:{metal:et,crystal:Ke,deuterium:Qe},upkeep:wt}},A=(w,k)=>{const D=Math.floor(w/1e3)+1;return k!=null&&k.reachedLevel16?Math.max(16,D):D},Q=async(w,k)=>{if(n.resources.darkMatter<w)return"no_funds";if(k.metal&&n.resources.metal+k.metal>n.resources.storage.metal||k.crystal&&n.resources.crystal+k.crystal>n.resources.storage.crystal||k.deuterium&&n.resources.deuterium+k.deuterium>n.resources.storage.deuterium)return"storage_full";const D={...n.resources,darkMatter:n.resources.darkMatter-w,metal:Math.min(n.resources.storage.metal,n.resources.metal+(k.metal||0)),crystal:Math.min(n.resources.storage.crystal,n.resources.crystal+(k.crystal||0)),deuterium:Math.min(n.resources.storage.deuterium,n.resources.deuterium+(k.deuterium||0))};o(U=>({...U,resources:D}));const{error:B}=await de.from("profiles").update({resources:D}).eq("id",s.user.id);return B?(console.error("buyPremium DB save failed:",B),o(U=>({...U,resources:n.resources})),"no_funds"):(ge.current={...ge.current,resources:D},ge.current={...ge.current,resources:D},"success")},fe=async(w,k)=>{const B=Date.now(),U=crypto.randomUUID(),te={id:U,ownerId:s==null?void 0:s.user.id,type:Ze.EXPEDITION,ships:w,targetCoords:k,originCoords:n.galaxyCoords||{galaxy:1,system:1,position:1},startTime:B,arrivalTime:B+1e4/2,returnTime:B+1e4,eventProcessed:!1,status:"flying"};o(K=>{const F={...K.ships};return Object.entries(w).forEach(([$,q])=>{F[$]-=q}),{...K,ships:F,activeMissions:[...K.activeMissions,te]}});const{error:le}=await de.from("missions").insert({id:U,owner_id:s.user.id,mission_type:Ze.EXPEDITION,ships:w,target_coords:k,origin_coords:n.galaxyCoords||{galaxy:1,system:1,position:1},start_time:B,arrival_time:B+1e4/2,return_time:B+1e4,status:"flying"});if(le){console.error("Failed to start expedition:",le),alert("Bd wysyania ekspedycji. Sprbuj ponownie."),o(K=>{const F={...K.ships};return Object.entries(w).forEach(([$,q])=>{F[$]=(F[$]||0)+q}),{...K,ships:F,activeMissions:K.activeMissions.filter($=>$.id!==U)}});return}const X={...n.ships};Object.entries(w).forEach(([K,F])=>{X[K]=(X[K]||0)-F}),await de.from("profiles").update({ships:X,points:os(n.resources,n.buildings,X,n.research,n.defenses)}).eq("id",s.user.id)},be=async(w,k)=>{const B=Date.now(),U=crypto.randomUUID(),te=await Ce(k);if(console.log(" ATTACK: Target at coords",k,"resolved to userId:",te),te){const{data:$,error:q}=await de.from("profiles").select("points").eq("id",te).single();if(!q&&$){const W=Math.floor(Math.pow($.points||0,.3333333333333333));if(W<7){alert(`Ten gracz znajduje si pod ochron pocztkujcych(Poziom ${W} < 7).Atak niemoliwy.`);return}}}const le={...n.ships};Object.entries(w).forEach(([$,q])=>{le[$]=(le[$]||0)-q});const{error:X}=await de.from("profiles").update({ships:le,points:os(n.resources,n.buildings,le,n.research,n.defenses)}).eq("id",s.user.id);if(X){console.error(" ATTACK PROFILE UPDATE ERROR:",X),alert("Bd odejmowania statkw.");return}const K={id:U,ownerId:s==null?void 0:s.user.id,type:Ze.ATTACK,ships:w,targetCoords:k,targetUserId:te,originCoords:n.galaxyCoords||{galaxy:1,system:1,position:1},startTime:B,arrivalTime:B+3e4,returnTime:B+3e4*2,eventProcessed:!1,status:"flying"};o($=>({...$,ships:le,activeMissions:[...$.activeMissions,K]}));const{error:F}=await de.from("missions").insert({id:U,owner_id:s.user.id,target_user_id:te,mission_type:Ze.ATTACK,ships:w,target_coords:k,origin_coords:n.galaxyCoords||{galaxy:1,system:1,position:1},start_time:B,arrival_time:B+3e4,return_time:B+3e4*2,status:"flying"});F?console.error(" ATTACK INSERT ERROR:",F):console.log(" ATTACK INSERTED")},Ne=async(w,k)=>{if((n.ships[ue.ESPIONAGE_PROBE]||0)<w)return!1;const D=Date.now(),B=30*1e3,U=crypto.randomUUID(),te=await Ce(k),le={...n.ships};le[ue.ESPIONAGE_PROBE]=(le[ue.ESPIONAGE_PROBE]||0)-w;const{error:X}=await de.from("profiles").update({ships:le,points:os(n.resources,n.buildings,le,n.research,n.defenses)}).eq("id",s.user.id);if(X)return console.error(" SPY PROFILE UPDATE ERROR:",X),alert("Bd odejmowania sond."),!1;const K={id:U,ownerId:s==null?void 0:s.user.id,type:Ze.SPY,ships:{[ue.ESPIONAGE_PROBE]:w},targetCoords:k,targetUserId:te,originCoords:n.galaxyCoords||{galaxy:1,system:1,position:1},startTime:D,arrivalTime:D+B/2,returnTime:D+B,eventProcessed:!1,status:"flying"};o($=>({...$,ships:le,activeMissions:[...$.activeMissions,K]}));const{error:F}=await de.from("missions").insert({id:U,owner_id:s.user.id,target_user_id:te,mission_type:Ze.SPY,ships:{[ue.ESPIONAGE_PROBE]:w},target_coords:k,origin_coords:n.galaxyCoords||{galaxy:1,system:1,position:1},start_time:D,arrival_time:D+B/2,return_time:D+B,status:"flying"});return F&&console.error("Failed to send spy probe:",F),!0},Le=async(w,k,D)=>{const U=Date.now(),te=crypto.randomUUID(),le=await Ce(D),X={...n.ships};Object.entries(w).forEach(([W,me])=>{X[W]=(X[W]||0)-me});const K={...n.resources,metal:n.resources.metal-(k.metal||0),crystal:n.resources.crystal-(k.crystal||0),deuterium:n.resources.deuterium-(k.deuterium||0)},{error:F}=await de.from("profiles").update({ships:X,resources:K,points:os(K,n.buildings,X,n.research,n.defenses)}).eq("id",s.user.id);if(F){console.error("Error deducting resources:",F),alert("Bd odejmowania surowcw.");return}const $={id:te,ownerId:s==null?void 0:s.user.id,type:Ze.TRANSPORT,ships:w,resources:k,targetCoords:D,targetUserId:le,originCoords:n.galaxyCoords||{galaxy:1,system:1,position:1},startTime:U,arrivalTime:U+3e5/2,returnTime:U+3e5,eventProcessed:!1,status:"flying"};o(W=>({...W,ships:X,resources:K,activeMissions:[...W.activeMissions,$]}));const{error:q}=await de.from("missions").insert({id:te,owner_id:s.user.id,target_user_id:le,mission_type:Ze.TRANSPORT,ships:w,resources:k,target_coords:D,origin_coords:n.galaxyCoords||{galaxy:1,system:1,position:1},start_time:U,arrival_time:U+3e5/2,return_time:U+3e5,status:"flying"});q&&console.error("Error creating mission:",q)},Xe=async w=>{const k=n.activeMissions.find(le=>le.id===w);if(!k||k.status!=="flying")return;const D=Date.now(),B=D-k.startTime,U=D+B;o(le=>({...le,activeMissions:le.activeMissions.map(X=>X.id===w?{...X,status:"returning",returnTime:U,arrivalTime:D}:X)}));const{error:te}=await de.from("missions").update({status:"returning",return_time:U,arrival_time:D}).eq("id",w);if(k.type==="attack"&&k.targetUserId){const{data:le}=await de.from("profiles").select("mission_logs").eq("id",k.targetUserId).single();if(le){const K=[{id:Date.now().toString(),timestamp:Date.now(),title:"Atak Anulowany",message:`Gracz ${he.current.nickname||"Nieznany"} [${k.originCoords.galaxy}: ${k.originCoords.system}: ${k.originCoords.position}] zawrci flot tu przed atakiem.
Skad floty: ${Object.entries(k.ships).map(([F,$])=>{var q;return`${((q=Je[F])==null?void 0:q.name)||F}: ${$}`}).join(", ")}.`,outcome:"info"},...le.mission_logs||[]].slice(0,50);await de.from("profiles").update({mission_logs:K}).eq("id",k.targetUserId)}}te&&(console.error("Failed to cancel mission:",te),alert("Bd anulowania misji."),o(le=>({...le,activeMissions:le.activeMissions.map(X=>X.id===w?{...X,status:"flying",returnTime:k.returnTime,arrivalTime:k.arrivalTime}:X)})))},zt=async w=>{const k=n.buildings[w],D=V("building",w,k);if(n.resources.metal<D.metal||n.resources.crystal<D.crystal||n.resources.deuterium<D.deuterium){console.log("Not enough resources");return}const B=n.constructionQueue.filter(ke=>ke.type==="building");if(B.length>=5){console.log("Queue full");return}const U=D.metal+D.crystal;let te=U/2500*3600*1e3;te=te/(n.buildings[oe.ROBOT_FACTORY]+1),te=te/ar;const le=Math.max(1e3,te),X=B.sort((ke,Re)=>Re.endTime-ke.endTime)[0],K=X?X.endTime:Date.now(),F=K+le,$={id:Date.now().toString(),type:"building",itemId:w,targetLevel:k+1,startTime:K,endTime:F},q={...n.resources,metal:n.resources.metal-D.metal,crystal:n.resources.crystal-D.crystal,deuterium:n.resources.deuterium-D.deuterium},W=[...n.constructionQueue,$];o(ke=>({...ke,resources:{...ke.resources,...q},constructionQueue:[...ke.constructionQueue,$]})),pa(Math.floor(U/100),"Building Construction");const{error:me}=await de.from("profiles").update({resources:q,construction_queue:W}).eq("id",s.user.id);me&&(console.error("Building upgrade failed:",me),o(ke=>{const Re=ke.constructionQueue.filter(Nt=>Nt.id!==$.id);return{...ke,resources:{...ke.resources,metal:ke.resources.metal+D.metal,crystal:ke.resources.crystal+D.crystal,deuterium:ke.resources.deuterium+D.deuterium},constructionQueue:Re}}))},ft=async w=>{const k=n.constructionQueue.findIndex($=>$.id===w);if(k===-1)return;const D=n.constructionQueue[k];if(D.type!=="building"&&D.type!=="research"){console.error("Cannot cancel item of type:",D.type);return}const B=(D.targetLevel||1)-1,U=V(D.type,D.itemId,B),te=Math.floor(U.metal||0),le=Math.floor(U.crystal||0),X=Math.floor(U.deuterium||0),K={...n.resources,metal:(n.resources.metal||0)+te,crystal:(n.resources.crystal||0)+le,deuterium:(n.resources.deuterium||0)+X},F=[...n.constructionQueue];F.splice(k,1);for(let $=k;$<F.length;$++){const q=$>0?F[$-1]:null,W=q?q.endTime:Date.now(),me=F[$].endTime-F[$].startTime;F[$]={...F[$],startTime:W,endTime:W+me}}if(o($=>({...$,resources:K,constructionQueue:F})),D.type==="building"){const $=te+le;pa(-Math.floor($/100),"Construction Cancelled")}try{const{error:$}=await de.from("profiles").update({resources:K,construction_queue:F}).eq("id",s.user.id);if($)throw $}catch($){console.error("Cancel constr sync failed:",$),o(q=>({...q,resources:n.resources,constructionQueue:n.constructionQueue}))}},He=async w=>{const k=n.research[w],D=V("research",w,k);if(n.resources.metal<D.metal||n.resources.crystal<D.crystal||n.resources.deuterium<D.deuterium||n.constructionQueue.some(q=>q.type==="research"))return;const B=Ar[w];if(B.maxLevel&&k>=B.maxLevel)return;const U=n.buildings[oe.RESEARCH_LAB];if(U===0)return;let le=(D.metal+D.crystal)/1e3*3600*1e3;le=le/(U+1),le=le/ar;const X=Math.max(1e3,le),K=Date.now(),F={id:K.toString(),type:"research",itemId:w,targetLevel:k+1,startTime:K,endTime:K+X};o(q=>({...q,resources:{...q.resources,metal:q.resources.metal-D.metal,crystal:q.resources.crystal-D.crystal,deuterium:q.resources.deuterium-D.deuterium},constructionQueue:[...q.constructionQueue,F]}));const{error:$}=await de.from("profiles").update({resources:{...n.resources,metal:n.resources.metal-D.metal,crystal:n.resources.crystal-D.crystal,deuterium:n.resources.deuterium-D.deuterium},construction_queue:[...n.constructionQueue,F]}).eq("id",s.user.id);$&&(console.error("upgradeResearch DB save failed:",$),o(q=>({...q,resources:{...q.resources,metal:q.resources.metal+D.metal,crystal:q.resources.crystal+D.crystal,deuterium:q.resources.deuterium+D.deuterium},constructionQueue:q.constructionQueue.filter(W=>W.id!==F.id)})))},Mt=async(w,k)=>{const D=Math.max(1,Math.floor(k)),B=Je[w],U={metal:B.baseCost.metal*D,crystal:B.baseCost.crystal*D,deuterium:B.baseCost.deuterium*D};if(n.resources.metal<U.metal||n.resources.crystal<U.crystal||n.resources.deuterium<U.deuterium)return;const te=n.buildings[oe.SHIPYARD];if(te===0)return;const le=B.buildTime*1e3/(te+1),X=Date.now();let K=X;n.shipyardQueue.length>0&&(K=n.shipyardQueue[n.shipyardQueue.length-1].endTime);const F={id:X.toString()+Math.random(),type:"ship",itemId:w,quantity:D,startTime:K,endTime:K+le*D},$=[...n.shipyardQueue,F];o(W=>({...W,resources:{...W.resources,metal:W.resources.metal-U.metal,crystal:W.resources.crystal-U.crystal,deuterium:W.resources.deuterium-U.deuterium},shipyardQueue:$})),pa(Math.floor((U.metal+U.crystal)/200),"Fleet Production");const{error:q}=await de.from("profiles").update({resources:{...n.resources,metal:n.resources.metal-U.metal,crystal:n.resources.crystal-U.crystal,deuterium:n.resources.deuterium-U.deuterium},shipyard_queue:$}).eq("id",s.user.id);q&&(console.error("buildShip DB save failed:",q),o(W=>({...W,resources:{...W.resources,metal:W.resources.metal+U.metal,crystal:W.resources.crystal+U.crystal,deuterium:W.resources.deuterium+U.deuterium},shipyardQueue:W.shipyardQueue.filter(me=>me.id!==F.id)})))},lt=async(w,k)=>{const D=Math.max(1,Math.floor(k)),B=Ka[w];if(!B)return;const U={metal:B.cost.metal*D,crystal:B.cost.crystal*D,deuterium:B.cost.deuterium*D};if(n.resources.metal<U.metal||n.resources.crystal<U.crystal||n.resources.deuterium<U.deuterium)return;const te=n.buildings[oe.SHIPYARD];if(te===0)return;const le=B.buildTime*1e3/(te+1),X=Date.now();let K=X;n.shipyardQueue.length>0&&(K=n.shipyardQueue[n.shipyardQueue.length-1].endTime);const F={id:`def - ${X} -${Math.random()} `,type:"defense",itemId:w,quantity:D,startTime:K,endTime:K+le*D},$=[...n.shipyardQueue,F];o(W=>({...W,resources:{...W.resources,metal:W.resources.metal-U.metal,crystal:W.resources.crystal-U.crystal,deuterium:W.resources.deuterium-U.deuterium},shipyardQueue:$})),pa(Math.floor((U.metal+U.crystal)/200),"Defense Production");const{error:q}=await de.from("profiles").update({resources:{...n.resources,metal:n.resources.metal-U.metal,crystal:n.resources.crystal-U.crystal,deuterium:n.resources.deuterium-U.deuterium},shipyard_queue:$}).eq("id",s.user.id);q&&(console.error("buildDefense DB save failed:",q),o(W=>({...W,resources:{...W.resources,metal:W.resources.metal+U.metal,crystal:W.resources.crystal+U.crystal,deuterium:W.resources.deuterium+U.deuterium},shipyardQueue:W.shipyardQueue.filter(me=>me.id!==F.id)})))},ce=async()=>{var D;if(!((D=s==null?void 0:s.user)!=null&&D.id))return;const{data:w,error:k}=await de.from("planets").select("*").eq("owner_id",s.user.id);w&&!k&&N(w)},re=async(w,k)=>{if((n.ships[ue.COLONY_SHIP]||0)<1)return alert("Potrzebujesz Statku Kolonizacyjnego!"),!1;if(x.length>=8)return alert("Osigne limit 8 planet!"),!1;const{data:D}=await de.from("planets").select("id").contains("galaxy_coords",w),{data:B}=await de.from("profiles").select("id").contains("galaxy_coords",w);if(D&&D.length>0||B&&B.length>0)return alert("Ta pozycja jest ju zajta!"),!1;const U={metal:Math.min(k.metal,15e3),crystal:Math.min(k.crystal,15e3),deuterium:Math.min(k.deuterium,15e3)};if(n.resources.metal<U.metal||n.resources.crystal<U.crystal||n.resources.deuterium<U.deuterium)return alert("Brak wystarczajcych zasobw!"),!1;const te={...n.ships,[ue.COLONY_SHIP]:(n.ships[ue.COLONY_SHIP]||0)-1},le={...n.resources,metal:n.resources.metal-U.metal,crystal:n.resources.crystal-U.crystal,deuterium:n.resources.deuterium-U.deuterium},X=Date.now(),K=60*1e3,F=n.galaxyCoords||{galaxy:1,system:1,position:1};let $=K;if(F.galaxy!==w.galaxy)$=3600*1e3;else if(F.system!==w.system){const Re=Math.abs(F.system-w.system);$=K+Re*30*1e3}else{const Re=Math.abs(F.position-w.position);$=K+Re*10*1e3}const q=crypto.randomUUID(),W={id:q,ownerId:s==null?void 0:s.user.id,type:Ze.COLONIZE,ships:{[ue.COLONY_SHIP]:1},targetCoords:w,targetUserId:s.user.id,originCoords:F,startTime:X,arrivalTime:X+$,eventProcessed:!1,status:"flying",resources:U},{error:me}=await de.from("profiles").update({ships:te,resources:le}).eq("id",s.user.id);if(me)return console.error(" COLONIZE PROFILE UPDATE ERROR:",me),alert("Bd odejmowania surowcw."),!1;o(Re=>({...Re,ships:te,resources:le,activeMissions:[...Re.activeMissions,W]}));const{error:ke}=await de.from("missions").insert({id:q,owner_id:s.user.id,target_user_id:s.user.id,mission_type:Ze.COLONIZE,ships:{[ue.COLONY_SHIP]:1},target_coords:w,origin_coords:F,start_time:X,arrival_time:X+$,status:"flying",resources:U});return ke?(console.error(" COLONIZE MISSION ERROR:",ke),alert("Bd tworzenia misji. Surowce zostay odjte."),!1):(pa(500,"New Colony"),ge.current={...ge.current,ships:te,resources:le},console.log(" Colonization mission sent!",W),alert(`Misja kolonizacyjna rozpoczta! Czas lotu: ${($/1e3).toFixed(0)}s`),!0)},Ie=async(w,k,D,B,U,te,le)=>{const X={buildings:k,ships:D,defenses:B,resources:U,construction_queue:te,shipyard_queue:le};console.log(""),console.log(` [COLONY SAVE] Planet: ${w}`),console.log(" [COLONY SAVE] Payload:"),console.log("   Buildings:",JSON.stringify(k)),console.log("   Ships:",JSON.stringify(D)),console.log("   Defenses:",JSON.stringify(B)),console.log("   Resources:",JSON.stringify(U)),console.log("   Queue:",(te==null?void 0:te.length)||0,"items"),console.log("   Shipyard:",(le==null?void 0:le.length)||0,"items");const{error:K,data:F}=await de.from("planets").update(X).eq("id",w).select();return K?(console.error(" [COLONY SAVE ERROR]:",K.message),console.warn(""),!1):(console.log(" [COLONY SAVE SUCCESS] Rows affected:",(F==null?void 0:F.length)||0),F&&F[0]&&console.log("   DB Response Buildings:",JSON.stringify(F[0].buildings)),console.log(""),!0)},Ye=async w=>{var D,B,U,te,le;console.log(" Switching to planet:",w);const k=he.current;if(j&&j!=="main"){if(console.log(" Saving current colony before switch:",j),!await Ie(j,k.buildings,k.ships,k.defenses,k.resources,k.constructionQueue,k.shipyardQueue)){alert("Bd zapisu stanu kolonii! Przeczanie przerwane, aby zapobiec utracie danych.");return}}else(!j||j==="main")&&(console.log(" Saving main planet before switch"),await de.from("profiles").update({buildings:k.buildings,resources:k.resources,ships:k.ships,defenses:k.defenses,construction_queue:k.constructionQueue,shipyard_queue:k.shipyardQueue}).eq("id",s.user.id));if(w==="main")C("main"),_?(o(_),ge.current=JSON.parse(JSON.stringify(_)),G(null),console.log(" Restored main planet from cache (ref updated)")):(await qe(),console.log(" Reloaded main planet from DB (no cache)"));else{console.log(" Fetching colony data from DB:",w);const{data:X,error:K}=await de.from("planets").select("*").eq("id",w).single();if(X&&!K){(!j||j==="main")&&(G(k),console.log(" Cached main planet data")),C(w);const F=X.resources||{},$={metal:F.metal??500,crystal:F.crystal??300,deuterium:F.deuterium??100,darkMatter:F.darkMatter??0,energy:0,maxEnergy:0,storage:{metal:((D=F.storage)==null?void 0:D.metal)??1e4,crystal:((B=F.storage)==null?void 0:B.crystal)??1e4,deuterium:((U=F.storage)==null?void 0:U.deuterium)??1e4}},q=X.buildings||{},W={};Object.keys(ja.buildings).forEach(me=>{W[me]=q[me]??0}),console.log(""),console.log(" [LOAD] Colony loaded from Supabase:",w),console.log("   Resources:",JSON.stringify($)),console.log("   Buildings:",JSON.stringify(W)),console.log("   Ships:",JSON.stringify(X.ships)),console.log("   Defenses:",JSON.stringify(X.defenses)),console.log("   ConstructionQueue:",((te=X.construction_queue)==null?void 0:te.length)||0,"items"),console.log("   ShipyardQueue:",((le=X.shipyard_queue)==null?void 0:le.length)||0,"items"),console.log(""),ge.current={...n,resources:$,buildings:W,ships:X.ships||{},defenses:X.defenses||{},constructionQueue:X.construction_queue||[],shipyardQueue:X.shipyard_queue||[]},o(me=>({...me,planetName:X.planet_name||`Kolonia ${x.indexOf(X)+1}`,planetType:X.planet_type||"terran",resources:$,buildings:W,ships:X.ships||{},defenses:X.defenses||{},constructionQueue:X.construction_queue||[],shipyardQueue:X.shipyard_queue||[],galaxyCoords:X.galaxy_coords,debris:X.debris||{metal:0,crystal:0}})),console.log(" Switched to colony (Fresh DB Load):",X.planet_name)}else console.error("Failed to load colony:",K),alert("Bd wczytywania kolonii.")}},ut=(w,k)=>{o(D=>({...D,productionSettings:{...D.productionSettings,[w]:k}}))},Ht=async(w,k)=>{if(!w.trim())return;const D=w.trim(),B=k||Z.current,U=B==="main";if(console.log(` Renaming ${B} to ${D}`),B===Z.current&&o(te=>({...te,planetName:D})),U&&M(D),U){const{error:te}=await de.from("profiles").update({planet_name:D}).eq("id",s.user.id);te?console.error(" Main rename error:",te):(console.log(" Main renamed"),await ce())}else{const{error:te}=await de.from("planets").update({planet_name:D}).eq("id",B);te?console.error(" Colony rename error:",te):(console.log(" Colony renamed"),await ce())}},it=async w=>{w.trim()&&(o(k=>({...k,nickname:w.trim(),productionSettings:{...k.productionSettings,nickname:w.trim()}})),await de.from("profiles").update({nickname:w.trim(),production_settings:{...n.productionSettings,nickname:w.trim()}}).eq("id",s.user.id),console.log(" User renamed to:",w))},ha=()=>{localStorage.removeItem(As),window.location.reload()},fa=async()=>{o(w=>({...w,missionLogs:[]})),await de.from("profiles").update({mission_logs:[]}).eq("id",s.user.id)},Dt=async()=>{try{await je("Logout")}catch(w){console.error("Logout save failed:",w)}localStorage.removeItem(As),localStorage.removeItem(As+"_backup"),await de.auth.signOut(),window.location.reload()},ma=async(w,k)=>{if(!w||w==="main")return alert("Nie moesz porzuci Gwnej Planety!"),!1;if(k!=="DELETE")return!1;console.log(" Abandoning colony:",w);const{error:D}=await de.from("planets").delete().eq("id",w);return D?(console.error("Failed to abandon colony:",D),alert(`Bd: ${D.message}`),!1):(j===w&&(C("main"),_&&(o(_),G(null))),ce(),alert("Kolonia zostaa porzucona."),!0)},Zt=async()=>{if(s!=null&&s.user&&confirm("Czy na pewno chcesz usun konto? Tej operacji nie mona cofn. Twoje imperium zostanie zniszczone."))try{await de.from("missions").delete().eq("owner_id",s.user.id),await de.from("profiles").delete().eq("id",s.user.id),await Dt()}catch(w){console.error("Error deleting account:",w),alert("Bd podczas usuwania konta. Sprbuj ponownie.")}},Or=async w=>{o(D=>({...D,avatarUrl:w}));const k=n.productionSettings||{};await de.from("profiles").update({production_settings:{...k,avatarUrl:w}}).eq("id",s.user.id)},Si=async w=>{o(D=>({...D,planetType:w}));const k=n.productionSettings||{};await de.from("profiles").update({production_settings:{...k,planetType:w}}).eq("id",s.user.id)},Ei=async(w,k)=>{try{const{data:D,error:B}=await de.from("profiles").select("id, planet_name, galaxy_coords, points, production_settings, buildings, nickname, level, debris").contains("galaxy_coords",{galaxy:w,system:k});if(B)throw B;const{data:U,error:te}=await de.from("planets").select("id, owner_id, planet_name, planet_type, galaxy_coords, buildings, ships, defenses, debris").contains("galaxy_coords",{galaxy:w,system:k});if(te)throw te;let le=D||[];if(U&&U.length>0){const X=[...new Set(U.map(W=>W.owner_id))],{data:K,error:F}=await de.from("profiles").select("id, nickname, points, production_settings, level").in("id",X);F&&console.error("Error fetching colony owners:",F);const $=new Map((K==null?void 0:K.map(W=>[W.id,W]))||[]),q=U.map(W=>{const me=$.get(W.owner_id);return{id:W.owner_id,colony_id:W.id,planet_name:W.planet_name,galaxy_coords:W.galaxy_coords,points:(me==null?void 0:me.points)||0,level:(me==null?void 0:me.level)||1,production_settings:{...(me==null?void 0:me.production_settings)||{},planetType:W.planet_type},buildings:W.buildings,nickname:((me==null?void 0:me.nickname)||"Unknown")+" (Kolonia)",isColony:!0,debris:W.debris}});le=[...le,...q]}return le}catch(D){return console.error("Error fetching system users:",D),[]}};ee.useEffect(()=>{if(!d)return;const k=setInterval(()=>{const D=Date.now(),B=he.current,U=Te(B),te=(D-B.lastTick)/1e3;if(te<=0)return;const le=U.metal*te,X=U.crystal*te,K=U.deuterium*te;let F={...B.buildings},$={...B.research},q=[...B.constructionQueue],W=0;const me=q.filter(ve=>D>=ve.endTime),ke=q.filter(ve=>D<ve.endTime);me.length>0&&(me.forEach(ve=>{if(ve.type==="building")F[ve.itemId]=ve.targetLevel||1;else if(ve.type==="research"){const Fe=ve.targetLevel||1;$[ve.itemId]=Fe,W+=Math.pow(Fe,2)*10}}),q=ke);let Re={...B.ships},Nt={...B.defenses},dt=[...B.shipyardQueue];for(;dt.length>0&&D>=dt[0].endTime;){const ve=dt.shift();ve&&(ve.type==="defense"?Nt[ve.itemId]=(Nt[ve.itemId]||0)+(ve.quantity||0):Re[ve.itemId]=(Re[ve.itemId]||0)+(ve.quantity||0))}const We=(B.xp||0)+W,St=Math.floor(Math.sqrt(We/500))+1,Jt=B.level||1;let la=0;if(St>Jt)for(let ve=Jt+1;ve<=St;ve++)la+=10+ve*2;const Se=os(B.resources,F,Re,$,Nt),At=Math.floor(Se/1e3)+1;let mt={...B.productionSettings},Pt=!1;if(At>=16&&!mt.reachedLevel16&&(mt.reachedLevel16=!0,Pt=!0),me.length>0||B.shipyardQueue.length!==dt.length||Pt||D-B.lastTick>3e4){const ve=Z.current,Fe=me.length>0?"Queue Completed":D-B.lastTick>3e4?"Tick 30s":"Settings Changed";if(console.log(` [TICK SAVE] Reason: ${Fe}, Target: ${ve||"main"}`),!ve||ve==="main"){const et={buildings:F,research:$,ships:Re,defenses:Nt,resources:{...B.resources,metal:Math.min(U.storage.metal,(B.resources.metal||0)+le),crystal:Math.min(U.storage.crystal,(B.resources.crystal||0)+X),deuterium:Math.min(U.storage.deuterium,(B.resources.deuterium||0)+K),darkMatter:(B.resources.darkMatter||0)+la},xp:We,level:St,shipyard_queue:dt,construction_queue:q,production_settings:mt,last_updated:Date.now()};console.log(" [TICK SAVE] Payload:",JSON.stringify(et).substring(0,200)+"..."),de.from("profiles").update(et).eq("id",s.user.id).then(({error:Ke})=>{Ke?console.error(" [TICK SAVE ERROR] Main:",Ke):console.log(" [TICK SAVE] Main Success")})}else{console.log(` [TICK SAVE] Colony ${ve} - Buildings:`,JSON.stringify(F));const et={...B.resources,metal:Math.min(U.storage.metal,(B.resources.metal||0)+le),crystal:Math.min(U.storage.crystal,(B.resources.crystal||0)+X),deuterium:Math.min(U.storage.deuterium,(B.resources.deuterium||0)+K)};Ie(ve,F,Re,Nt,et,q,dt),de.from("profiles").update({production_settings:mt,research:$,points:os(et,F,Re,$,Nt),xp:We,level:St,last_updated:Date.now()}).eq("id",s.user.id).then(Ke=>{Ke.error&&console.error("Colony profile sync error:",Ke.error)})}ge.current={...B,buildings:F,research:$,ships:Re,defenses:Nt,resources:{...B.resources,metal:Math.max(0,Math.min(U.storage.metal,(B.resources.metal||0)+le)),crystal:Math.max(0,Math.min(U.storage.crystal,(B.resources.crystal||0)+X)),deuterium:Math.max(0,Math.min(U.storage.deuterium,(B.resources.deuterium||0)+K)),darkMatter:(B.resources.darkMatter||0)+la},constructionQueue:q,shipyardQueue:dt}}o(ve=>{const Fe=(ve.xp||0)+W,et=Math.floor(Math.sqrt(Fe/500))+1,Ke=ve.level||1;let Qe=0;if(et>Ke){for(let wt=Ke+1;wt<=et;wt++)Qe+=10+wt*2;Qe>0&&console.log(` Level Up! ${Ke} -> ${et}. Reward: ${Qe} DM`)}return{...ve,productionSettings:Pt?mt:ve.productionSettings,resources:{...ve.resources,metal:Math.max(0,Math.min(U.storage.metal,(ve.resources.metal||0)+le)),crystal:Math.max(0,Math.min(U.storage.crystal,(ve.resources.crystal||0)+X)),deuterium:Math.max(0,Math.min(U.storage.deuterium,(ve.resources.deuterium||0)+K)),energy:U.energy,maxEnergy:U.maxEnergy,storage:U.storage,darkMatter:(ve.resources.darkMatter||0)+Qe},buildings:F,research:$,ships:Re,defenses:Nt,constructionQueue:q,shipyardQueue:dt,productionRates:{metal:U.metal,crystal:U.crystal,deuterium:U.deuterium},xp:Fe,level:et,lastTick:D}})},By);return()=>clearInterval(k)},[d]);const pa=(w,k)=>{w<=0||(o(D=>{const B=D.xp||0,U=D.level||1,te=B+w,le=Math.floor(Math.sqrt(te/500))+1;if(le>U){const X=10+le*2;return{...D,xp:te,level:le,resources:{...D.resources,darkMatter:(D.resources.darkMatter||0)+X}}}return{...D,xp:te,level:le}}),k&&console.log(` [XP] +${w} (${k})`))},_n=ee.useRef(!1);ee.useEffect(()=>{if(!d||_n.current)return;let w=0;const k=U=>{let te=0;return Object.entries(U).forEach(([le,X])=>{const K=ts[le];if(!K)return;let F=0;for(let $=1;$<=X;$++){const q=Math.pow(1.5,$-1);F+=Math.floor(K.baseCost.metal*q)+Math.floor(K.baseCost.crystal*q)}te+=Math.floor(F/100)}),te},D=U=>{let te=0;return Object.entries(U).forEach(([le,X])=>{const K=Je[le];if(!K)return;const F=K.baseCost.metal+K.baseCost.crystal;te+=Math.floor(F*X/200)}),te};w+=k(n.buildings),w+=D(n.ships),x.forEach(U=>{U.buildings&&(w+=k(U.buildings)),U.ships&&(w+=D(U.ships))}),Object.entries(n.research).forEach(([U,te])=>{let le=0;for(let X=1;X<=te;X++)le+=Math.pow(X,2)*10;w+=le});const B=n.xp||0;if(w>B+10){const U=w-B;console.log(` Retroactive XP Fix: Player has ${B}, Assets worth ${w}. Adding ${U}.`),_n.current=!0,pa(U,"Retroactive Catch-Up")}else _n.current=!0},[d,x.length]);const Ti={...n,addXP:pa,upgradeBuilding:zt,upgradeResearch:He,buildShip:Mt,buildDefense:lt,sendExpedition:fe,sendAttack:be,sendSpyProbe:Ne,sendTransport:Le,cancelMission:Xe,cancelConstruction:ft,buyPremium:Q,getCost:V,checkRequirements:ne,renamePlanet:Ht,updateProductionSetting:ut,resetGame:ha,isOnline:g,clearLogs:fa,logout:Dt,deleteAccount:Zt,abandonColony:ma,updateAvatar:Or,updatePlanetType:Si,getPlayersInSystem:Ei,renameUser:it,getLevel:A,session:s,planets:x,currentPlanetId:j,mainPlanetName:z,mainPlanetCoords:E,sendColonize:re,switchPlanet:Ye,fetchPlanets:ce};return r.jsx(Ap.Provider,{value:Ti,children:l})},ua=()=>{const l=ee.useContext(Ap);if(l===void 0)throw new Error("useGame must be used within a GameProvider");return l},$y=({activeView:l,onNavigate:s})=>{var g,p,v;const n=ua();n!=null&&n.resetGame;const o=(n==null?void 0:n.avatarUrl)||"/kosmo/avatars/avatar_default.png",d=(n==null?void 0:n.nickname)||(n!=null&&n.userId?`Kmdr. ${n.userId.split("-")[0]}`:"Kmdr. DareG"),h=[{id:"overview",label:"Podgld",icon:"dashboard"},{id:"buildings",label:"Budynki",icon:"domain"},{id:"shipyard",label:"Stocznia",icon:"rocket_launch"},{id:"research",label:"Badania",icon:"science"},{id:"galaxy",label:"Galaktyka",icon:"public"},{id:"fleet",label:"Flota",icon:"flight_takeoff"},{id:"shop",label:"Sklep",icon:"shopping_cart"},{id:"defense",label:"Obrona",icon:"shield"},{id:"clans",label:"Klany",icon:"groups"},{id:"ranking",label:"Ranking",icon:"leaderboard"},{id:"settings",label:"Opcje",icon:"settings"}],f=["admin@kosmo.pl","dareg@kosmo.pl","admin@kosmo.com"],b=(v=(p=(g=n.session)==null?void 0:g.user)==null?void 0:p.email)==null?void 0:v.toLowerCase();return b&&f.includes(b)&&h.push({id:"admin",label:"ADMIN",icon:"shield_person"}),r.jsxs("aside",{className:"w-64 flex-shrink-0 flex flex-col bg-[#111422] border-r border-white/5 z-20 hidden lg:flex h-full",children:[r.jsx("div",{className:"p-6 border-b border-white/5",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 flex-shrink-0 aspect-square bg-center bg-no-repeat bg-cover rounded-full border-2 border-primary",style:{backgroundImage:`url("${o}")`}}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("h1",{className:"text-white text-base font-bold tracking-tight uppercase",children:"Centrum Dowodzenia"}),r.jsx("p",{className:"text-[#929bc9] text-xs font-normal",children:d})]})]})}),n.planets&&n.planets.length>0&&r.jsxs("div",{className:"mx-4 mt-4 p-3 bg-[#1a1f35] border border-white/10 rounded-lg",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"text-xs text-[#929bc9] uppercase font-bold",children:"Twoje Planety"}),r.jsxs("span",{className:"text-xs text-primary",children:[n.planets.length+1,"/9"]})]}),r.jsx("button",{onClick:()=>n.switchPlanet("main"),className:`w-full text-left px-3 py-2 rounded mb-1 text-sm transition-colors ${!n.currentPlanetId||n.currentPlanetId==="main"?"bg-primary/20 text-white border border-primary/50":"bg-white/5 text-[#929bc9] hover:bg-white/10 border border-transparent"}`,children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"home"}),r.jsx("span",{className:"truncate",children:n.mainPlanetName||n.planetName}),n.galaxyCoords&&r.jsxs("span",{className:"text-xs text-gray-500 ml-auto",children:["[",n.galaxyCoords.galaxy,":",n.galaxyCoords.system,":",n.galaxyCoords.position,"]"]})]})}),n.planets.map(x=>{var N,j,C;return r.jsx("button",{onClick:()=>n.switchPlanet(x.id),className:`w-full text-left px-3 py-2 rounded mb-1 text-sm transition-colors ${n.currentPlanetId===x.id?"bg-primary/20 text-white border border-primary/50":"bg-white/5 text-[#929bc9] hover:bg-white/10 border border-transparent"}`,children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"public"}),r.jsx("span",{className:"truncate",children:x.planet_name}),r.jsxs("span",{className:"text-xs text-gray-500 ml-auto",children:["[",(N=x.galaxy_coords)==null?void 0:N.galaxy,":",(j=x.galaxy_coords)==null?void 0:j.system,":",(C=x.galaxy_coords)==null?void 0:C.position,"]"]})]})},x.id)})]}),n.incomingMissions&&n.incomingMissions.length>0&&r.jsxs("div",{className:"mx-4 mt-4 p-3 bg-red-900/50 border border-red-500 rounded-lg animate-pulse flex items-center gap-3 shadow-[0_0_15px_rgba(239,68,68,0.5)]",children:[r.jsx("span",{className:"material-symbols-outlined text-red-500 animate-bounce",children:"warning"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-red-400 text-xs font-bold uppercase tracking-wider",children:"Uwaga!"}),r.jsx("div",{className:"text-white text-xs font-medium",children:"Nadciga Wrg!"})]})]}),r.jsx("nav",{className:"flex-1 overflow-y-auto px-4 py-4 space-y-2",children:h.map(x=>{const N=l===x.id,j=x.id==="shop";return r.jsxs("button",{onClick:()=>s(x.id),className:`w-full flex items-center gap-3 px-3 py-3 rounded-lg transition-all group ${N?"bg-primary/20 text-white border border-primary/50 shadow-[0_0_15px_rgba(19,55,236,0.3)]":"text-[#929bc9] hover:bg-white/5 hover:text-white"} ${j?"text-yellow-400 hover:text-yellow-300":""}`,children:[r.jsx("span",{className:`material-symbols-outlined ${N?"text-primary":j?"text-yellow-500":"group-hover:text-primary transition-colors"}`,children:x.icon}),r.jsx("span",{className:"text-sm font-medium",children:x.label})]},x.id)})}),r.jsxs("div",{className:"p-4 border-t border-white/10",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx("div",{className:`w-2 h-2 rounded-full ${n.isOnline?"bg-green-500 animate-pulse":"bg-red-500"} `}),r.jsx("span",{className:`text-xs font-bold uppercase tracking-wider ${n.isOnline?"text-[#929bc9]":"text-red-500"}`,children:n.isOnline?"Status: Online":"Status: Offline"})]}),r.jsx("div",{className:"text-white text-sm font-medium mb-1",children:d}),r.jsx("div",{className:"text-[#555a7a] text-xs font-mono",children:"v1.2.8"})]})]})},fi=({name:l,value:s,icon:n,production:o,subValue:d,colorClass:h,bgClass:f})=>r.jsxs("div",{className:`flex items-center gap-2 md:gap-3 min-w-[90px] md:min-w-[150px] px-2 py-1 md:px-3 md:py-2 rounded-xl border border-white/5 ${f} backdrop-blur-md flex-shrink-0 shadow-sm transition-colors`,children:[r.jsx("div",{className:`size-6 md:size-10 rounded-full flex items-center justify-center shadow-lg ${h}`,children:r.jsx("span",{className:"material-symbols-outlined text-white text-xs md:text-lg",children:n})}),r.jsxs("div",{className:"flex flex-col justify-center",children:[r.jsx("span",{className:"text-[9px] md:text-[10px] text-[#929bc9] font-bold uppercase tracking-wider mb-0.5",children:l}),r.jsxs("div",{className:"flex flex-col md:flex-row md:items-baseline md:gap-2",children:[r.jsx("span",{className:`text-xs md:text-lg font-bold font-mono leading-none ${(s??0)<0?"text-red-500 animate-pulse":"text-white"}`,children:Math.floor(s??0).toLocaleString()}),o!==void 0&&r.jsxs("div",{className:"flex items-center gap-0.5 mt-0.5 md:mt-0",children:[r.jsx("span",{className:"material-symbols-outlined text-[10px] text-[#0bda65]",children:"trending_up"}),r.jsxs("span",{className:"text-[#0bda65] text-[10px] font-medium font-mono leading-none whitespace-nowrap",children:[Math.floor((o??0)*3600).toLocaleString(),"/h"]})]}),d!==void 0&&r.jsxs("span",{className:"text-[#929bc9] text-[10px] font-medium leading-none whitespace-nowrap mt-0.5 md:mt-0",children:["/ ",(d??0).toLocaleString()]})]})]})]}),Iy=()=>{const{resources:l,productionRates:s,logout:n,planets:o,currentPlanetId:d,switchPlanet:h,planetName:f,mainPlanetName:b,galaxyCoords:g}=ua(),[p,v]=_i.useState(!1);return r.jsx("header",{className:"bg-[#111422]/90 backdrop-blur-md border-b border-white/5 p-3 flex-shrink-0 relative z-50",children:r.jsxs("div",{className:"flex flex-wrap gap-3 justify-between items-center w-full",children:[o&&o.length>0&&r.jsxs("div",{className:"relative lg:hidden",children:[r.jsx("button",{onClick:()=>v(!p),className:"flex items-center justify-center p-2 bg-[#1c2136] border border-white/10 rounded-lg hover:border-primary/50 transition-colors",children:r.jsx("span",{className:"material-symbols-outlined text-primary text-xl",children:"public"})}),p&&r.jsxs("div",{className:"absolute top-full left-0 mt-1 bg-[#1c2136] border border-white/10 rounded-lg shadow-xl z-50 min-w-[200px]",children:[r.jsxs("button",{onClick:()=>{h("main"),v(!1)},className:`w-full text-left px-4 py-3 text-sm hover:bg-white/5 transition-colors flex items-center gap-3 border-b border-white/5 ${!d||d==="main"?"text-primary bg-primary/10":"text-white"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-lg",children:"home"}),b||"Gwna"]}),o.map((x,N)=>r.jsxs("button",{onClick:()=>{h(x.id),v(!1)},className:`w-full text-left px-4 py-3 text-sm hover:bg-white/5 transition-colors flex items-center gap-3 border-b border-white/5 last:border-0 ${d===x.id?"text-primary bg-primary/10":"text-white"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-lg",children:"public"}),x.planet_name||`Kolonia ${N+1}`]},x.id))]})]}),r.jsxs("div",{className:"flex gap-2 md:gap-3 flex-1 overflow-x-auto pb-2 items-center",children:[r.jsx(fi,{name:"Tytan",value:l.metal,production:s==null?void 0:s.metal,icon:"handyman",colorClass:"bg-gradient-to-br from-gray-500 to-gray-700",bgClass:"bg-[#1c2136]"}),r.jsx(fi,{name:"Krzem",value:l.crystal,production:s==null?void 0:s.crystal,icon:"diamond",colorClass:"bg-gradient-to-br from-blue-400 to-blue-600",bgClass:"bg-[#1c2136]"}),r.jsx(fi,{name:"Plazma",value:l.deuterium,production:s==null?void 0:s.deuterium,icon:"propane",colorClass:"bg-gradient-to-br from-teal-400 to-teal-600",bgClass:"bg-[#1c2136]"}),r.jsx(fi,{name:"Energia",value:l.energy,subValue:l.maxEnergy,icon:"bolt",colorClass:"bg-gradient-to-br from-yellow-400 to-orange-500",bgClass:"bg-[#1c2136]"}),r.jsx(fi,{name:"Nanity",value:l.darkMatter||0,icon:"all_inclusive",colorClass:"bg-gradient-to-br from-purple-500 to-indigo-600",bgClass:"bg-[#1c2136] border-purple-500/20 shadow-purple-900/20"})]}),r.jsx("div",{className:"hidden lg:block",children:r.jsx("button",{onClick:n,className:"bg-center bg-no-repeat bg-cover rounded-full size-10 border-2 border-primary cursor-pointer hover:scale-105 transition-transform shadow-lg shadow-primary/20 flex items-center justify-center group bg-[#111422]",title:"Wyloguj",children:r.jsx("span",{className:"material-symbols-outlined text-white group-hover:text-red-400 transition-colors",children:"logout"})})})]})})},op=100,Op="kosmo_error_logs";let Da=[],Gl=[],qy=null;const Py=()=>`${Date.now()}-${Math.random().toString(36).slice(2,9)}`,Gy=()=>{try{const l=localStorage.getItem(Op);l&&(Da=JSON.parse(l))}catch{Da=[]}return Da},Cp=()=>{try{Da.length>op&&(Da=Da.slice(-op)),localStorage.setItem(Op,JSON.stringify(Da))}catch{}},Rp=()=>{Gl.forEach(l=>l([...Da]))},Yy=async l=>{try{await de.from("error_logs").insert({user_id:qy,error_type:l.type,message:l.message,context:l.context,stack:l.stack,user_agent:navigator.userAgent,url:window.location.href})}catch(s){console.warn("Failed to send error to Supabase:",s)}},zp=(l,s,n,o)=>{const d={id:Py(),timestamp:Date.now(),type:l,message:s,context:n,stack:o};return Da.push(d),Cp(),Rp(),d},vu=(l,s,n)=>{console.error(` [ERROR] ${l}`,s,n);const o=zp("error",l,s,n==null?void 0:n.stack);return Yy(o),o},Ky=()=>{Da=[],Cp(),Rp()},Vy=()=>[...Da],Qy=()=>Da.filter(l=>l.type==="error").length,Mp=l=>(Gl.push(l),()=>{Gl=Gl.filter(s=>s!==l)}),Zy=()=>{window.onerror=(s,n,o,d,h)=>(vu(String(s),`${n}:${o}:${d}`,h),!1),window.onunhandledrejection=s=>{var o;const n=((o=s.reason)==null?void 0:o.message)||String(s.reason);vu(n,"UnhandledPromiseRejection",s.reason instanceof Error?s.reason:void 0)},window.addEventListener("error",s=>{if(s.target&&s.target instanceof HTMLElement){const n=s.target,o=n.src||n.href||"unknown",d=n.tagName.toLowerCase();vu(`Failed to load resource: <${d} src="${o}">`,"ResourceLoader")}},!0);const l=console.error;console.error=(...s)=>{l.apply(console,s);const n=s.map(o=>typeof o=="object"?o.message||JSON.stringify(o):String(o)).join(" ");n.includes(" [ERROR]")||zp("error",n,"Console")}};Gy();console.log(" Error Logger initialized");const Jy=async()=>{try{const l=Da.map(s=>`[${new Date(s.timestamp).toLocaleTimeString()}] ${s.type.toUpperCase()}: ${s.message}${s.context?` (${s.context})`:""}`).join(`
`);return await navigator.clipboard.writeText(l),!0}catch{return!1}},Xy=({visible:l,onClose:s})=>{const[n,o]=ee.useState([]),[d,h]=ee.useState("all"),[f,b]=ee.useState(null),[g,p]=ee.useState(!1),[v,x]=ee.useState(!1);ee.useEffect(()=>(o(Vy()),Mp(o)),[]);const N=d==="all"?n:n.filter(M=>M.type===d),j=async()=>{await Jy()&&(p(!0),setTimeout(()=>p(!1),2e3))},C=()=>{Ky()},z=M=>new Date(M).toLocaleTimeString("pl-PL");return l?r.jsxs("div",{style:{position:"fixed",bottom:0,left:0,right:0,height:v?"40px":"50vh",maxHeight:v?"40px":"400px",background:"linear-gradient(180deg, #1a1a2e 0%, #16213e 100%)",borderTop:"2px solid #e94560",zIndex:9999,display:"flex",flexDirection:"column",fontFamily:"monospace",fontSize:"12px",transition:"height 0.2s, max-height 0.2s"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 12px",background:"rgba(0,0,0,0.3)",borderBottom:v?"none":"1px solid rgba(255,255,255,0.1)",cursor:"pointer"},onClick:()=>x(!v),children:[r.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[r.jsx("span",{style:{color:"#e94560",fontWeight:"bold"},children:" Debug Console"}),r.jsxs("span",{style:{color:"#666",fontSize:"10px"},children:["(",n.length," wpisw)"]}),v&&n.filter(M=>M.type==="error").length>0&&r.jsxs("span",{style:{color:"#ff4444",fontSize:"10px"},children:[" ",n.filter(M=>M.type==="error").length," bdw"]})]}),r.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[!v&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"hidden sm:flex",style:{gap:"8px"},children:[r.jsx("button",{onClick:M=>{M.stopPropagation(),h("all")},style:{padding:"4px 8px",background:d==="all"?"#e94560":"#333",border:"none",borderRadius:"4px",color:"white",cursor:"pointer",fontSize:"10px"},children:"Wszystkie"}),r.jsx("button",{onClick:M=>{M.stopPropagation(),h("error")},style:{padding:"4px 8px",background:d==="error"?"#ff4444":"#333",border:"none",borderRadius:"4px",color:"white",cursor:"pointer",fontSize:"10px"},children:" Bdy"}),r.jsx("button",{onClick:M=>{M.stopPropagation(),h("warning")},style:{padding:"4px 8px",background:d==="warning"?"#ffaa00":"#333",border:"none",borderRadius:"4px",color:"white",cursor:"pointer",fontSize:"10px"},children:" Ostrzeenia"})]}),r.jsx("button",{onClick:M=>{M.stopPropagation(),j()},style:{padding:"4px 12px",background:g?"#4CAF50":"#0f3460",border:"none",borderRadius:"4px",color:"white",cursor:"pointer",fontSize:"10px"},children:g?"":""}),r.jsx("button",{onClick:M=>{M.stopPropagation(),C()},style:{padding:"4px 12px",background:"#333",border:"none",borderRadius:"4px",color:"white",cursor:"pointer",fontSize:"10px"},children:""})]}),r.jsx("button",{onClick:M=>{M.stopPropagation(),x(!v)},style:{padding:"4px 8px",background:"#333",border:"none",borderRadius:"4px",color:"white",cursor:"pointer",fontSize:"14px"},children:v?"":""}),r.jsx("button",{onClick:M=>{M.stopPropagation(),s()},style:{padding:"4px 12px",background:"#e94560",border:"none",borderRadius:"4px",color:"white",cursor:"pointer",fontSize:"10px"},children:""})]})]}),!v&&r.jsx("div",{style:{flex:1,overflowY:"auto",padding:"8px"},children:N.length===0?r.jsx("div",{style:{color:"#666",textAlign:"center",padding:"20px"},children:"Brak logw do wywietlenia"}):[...N].reverse().map(M=>r.jsxs("div",{onClick:()=>b(f===M.id?null:M.id),style:{padding:"8px",marginBottom:"4px",background:M.type==="error"?"rgba(255,68,68,0.1)":M.type==="warning"?"rgba(255,170,0,0.1)":"rgba(68,136,255,0.1)",borderLeft:`3px solid ${M.type==="error"?"#ff4444":M.type==="warning"?"#ffaa00":"#4488ff"}`,borderRadius:"4px",cursor:"pointer"},children:[r.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"flex-start",flexWrap:"wrap"},children:[r.jsx("span",{style:{color:"#666",minWidth:"60px",fontSize:"10px"},children:z(M.timestamp)}),r.jsx("span",{style:{color:M.type==="error"?"#ff4444":M.type==="warning"?"#ffaa00":"#4488ff",fontWeight:"bold",fontSize:"10px"},children:M.type==="error"?"":M.type==="warning"?"":""}),r.jsx("span",{style:{color:"#eee",flex:1,fontSize:"11px",wordBreak:"break-word"},children:M.message})]}),M.context&&r.jsxs("div",{style:{color:"#888",marginTop:"4px",fontSize:"10px"},children:[" ",M.context]}),f===M.id&&M.stack&&r.jsx("pre",{style:{color:"#666",marginTop:"8px",fontSize:"9px",whiteSpace:"pre-wrap",wordBreak:"break-all",maxHeight:"150px",overflow:"auto"},children:M.stack})]},M.id))})]}):null},Wy=({onClick:l})=>{const[s,n]=ee.useState(0);return ee.useEffect(()=>{const o=()=>n(Qy());return o(),Mp(o)},[]),r.jsxs("button",{onClick:l,style:{position:"fixed",bottom:"80px",right:"10px",width:"40px",height:"40px",borderRadius:"50%",background:s>0?"#e94560":"rgba(15, 52, 96, 0.8)",border:"2px solid rgba(255,255,255,0.2)",color:"white",fontSize:"16px",cursor:"pointer",zIndex:9998,display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 2px 10px rgba(0,0,0,0.3)",transition:"all 0.2s"},title:"Otwrz konsol debug",children:["",s>0&&r.jsx("span",{style:{position:"absolute",top:"-5px",right:"-5px",background:"#ff4444",color:"white",borderRadius:"50%",width:"18px",height:"18px",fontSize:"9px",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold"},children:s>9?"9+":s})]})},Fy=({onClose:l})=>r.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4",onClick:l,children:r.jsxs("div",{className:"bg-[#1c2136] w-full max-w-2xl max-h-[80vh] overflow-hidden rounded-2xl border border-white/10 shadow-2xl flex flex-col",onClick:s=>s.stopPropagation(),children:[r.jsxs("div",{className:"p-4 border-b border-white/10 flex justify-between items-center bg-[#15192b]",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"p-2 rounded-lg bg-blue-500/20 text-blue-400",children:r.jsx("span",{className:"material-symbols-outlined text-2xl",children:"info"})}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-bold text-white tracking-wide",children:"Aktualnoci i Zmiany"}),r.jsx("p",{className:"text-xs text-[#929bc9]",children:"Ostatnie aktualizacje (Od wczoraj)"})]})]}),r.jsx("button",{onClick:l,className:"text-[#929bc9] hover:text-white p-2 hover:bg-white/5 rounded-lg transition-colors",children:r.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto p-6 bg-[#0b0d17]/50 space-y-6",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsxs("h3",{className:"text-red-400 font-bold uppercase text-sm border-b border-red-500/20 pb-2 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-lg",children:"swords"}),"Nowy System Walki"]}),r.jsxs("div",{className:"text-sm text-[#cdd6f7] space-y-2",children:[r.jsx("p",{children:"Wprowadzono system kontr (Kamie-Papier-Noyce) dla statkw!"}),r.jsxs("ul",{className:"list-disc list-inside text-[#929bc9] pl-2 space-y-1",children:[r.jsx("li",{children:"Kady statek posiada teraz bonusy przeciwko konkretnym typom jednostek (np. Myliwiec Lekki jest skuteczny przeciwko Krownikom)."}),r.jsx("li",{children:'Informacje o bonusach ("Silny przeciwko") s widoczne w Stoczni oraz Sklepie.'}),r.jsx("li",{children:"Walki s teraz symulowane w rundach (max 6), co daje bardziej realistyczne wyniki star."})]})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"bg-[#111422]/50 p-4 rounded-lg border border-white/5",children:[r.jsxs("h3",{className:"font-bold text-yellow-400 mb-2 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"shopping_cart"}),"Sklep Premium Nowoci"]}),r.jsxs("ul",{className:"list-disc list-inside text-sm text-[#929bc9] space-y-1",children:[r.jsxs("li",{children:[r.jsx("strong",{children:"Nowe Pakiety:"})," Dostpne nowe pakiety surowcw i ulepsze."]}),r.jsxs("li",{children:[r.jsx("strong",{children:"Gwiazda mierci:"})," Teraz dostpna rwnie w ofercie specjalnej."]})]})]}),r.jsxs("div",{className:"bg-[#111422]/50 p-4 rounded-lg border border-white/5",children:[r.jsxs("h3",{className:"font-bold text-primary mb-2 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"new_releases"}),"System Poziomw i Ranking"]}),r.jsxs("ul",{className:"list-disc list-inside text-sm text-[#929bc9] space-y-1",children:[r.jsxs("li",{children:[r.jsx("strong",{children:"System Poziomw:"})," Zbieraj XP za budow i flot, aby awansowa!"]}),r.jsxs("li",{children:[r.jsx("strong",{children:"Korona Lidera:"})," Gracz #1 w rankingu otrzymuje zot koron przy nicku."]}),r.jsx("li",{children:"Ranking jest teraz bardziej dynamiczny i przejrzysty."})]})]}),r.jsxs("div",{className:"bg-[#111422]/50 p-4 rounded-lg border border-white/5",children:[r.jsxs("h3",{className:"font-bold text-blue-400 mb-2 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"shield"}),"System Obrony i Kontry"]}),r.jsxs("ul",{className:"list-disc list-inside text-sm text-[#929bc9] space-y-1",children:[r.jsxs("li",{children:["Dodano informacj ",r.jsx("strong",{children:'"Silny Przeciwko"'})," w widoku Obrony i Stoczni."]}),r.jsx("li",{children:"Teraz atwo sprawdzisz, co najlepiej kontruje dan jednostk."})]})]}),r.jsxs("div",{className:"bg-[#111422]/50 p-4 rounded-lg border border-white/5",children:[r.jsxs("h3",{className:"font-bold text-green-400 mb-2 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"pest_control"}),"Inne Zmiany"]}),r.jsxs("ul",{className:"list-disc list-inside text-sm text-[#929bc9] space-y-1",children:[r.jsxs("li",{children:[r.jsx("strong",{children:"Tryb Penoekranowy:"})," Dostpny w menu bocznym (dla lepszej immersji)."]}),r.jsx("li",{children:"Usunito przycisk debugowania (robaczka) na rzecz tego okna Info."}),r.jsx("li",{children:"Optymalizacja wydajnoci gry."})]})]})]})]}),r.jsxs("div",{className:"p-4 border-t border-white/10 bg-[#15192b] text-center text-xs text-[#555a7a]",children:["Kosmo v2.1.0 - Build ",new Date().toLocaleDateString()]})]})}),ev=({children:l,activeView:s,onNavigate:n})=>{const[o,d]=ee.useState(!1),[h,f]=ee.useState(!1),[b,g]=ee.useState(!1),[p,v]=ee.useState(!1);ee.useEffect(()=>{Zy()},[]);const x=ua(),N=(x==null?void 0:x.logout)||(()=>window.location.reload()),j=(x==null?void 0:x.incomingMissions)||[],C=[{id:"overview",icon:"dashboard",label:"Podgld"},{id:"buildings",icon:"domain",label:"Budynki"},{id:"fleet",icon:"flight_takeoff",label:"Flota"},{id:"galaxy",icon:"public",label:"Galaktyka"}],z=[{id:"overview",label:"Podgld",icon:"dashboard"},{id:"buildings",label:"Budynki",icon:"domain"},{id:"shipyard",label:"Stocznia",icon:"rocket_launch"},{id:"research",label:"Badania",icon:"science"},{id:"fleet",label:"Centrum Floty",icon:"flight_takeoff"},{id:"galaxy",label:"Galaktyka",icon:"public"},{id:"defense",label:"Obrona",icon:"shield"},{id:"clans",label:"Klany",icon:"groups"},{id:"shop",label:"Sklep Premium",icon:"shopping_cart"},{id:"ranking",label:"Ranking",icon:"leaderboard"},{id:"settings",label:"Opcje",icon:"settings"}],M=E=>{n(E),d(!1)};return r.jsxs("div",{className:"flex h-screen w-full bg-[#101322] text-white font-display overflow-hidden relative",children:[r.jsx("div",{className:"absolute inset-0 pointer-events-none z-0",style:{backgroundImage:`
            linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
            linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px)
          `,backgroundSize:"40px 40px"}}),r.jsx($y,{activeView:s,onNavigate:n}),r.jsxs("main",{className:"flex-1 flex flex-col h-full relative z-10 overflow-hidden mb-16 lg:mb-0",children:[r.jsx(Iy,{}),j&&j.length>0&&r.jsxs("div",{className:`mx-2 md:mx-6 lg:mx-8 mt-2 transition-all duration-300 ${h?"bg-red-900/40 border-red-900/30":"bg-red-900/80 border-red-500 animate-pulse"} border-2 rounded-xl overflow-hidden shadow-[0_0_30px_rgba(239,68,68,0.2)]`,children:[r.jsxs("div",{className:`p-2 px-4 flex items-center justify-between cursor-pointer hover:bg-white/5 transition-colors ${h?"py-1":"py-2"}`,onClick:()=>f(!h),children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:`material-symbols-outlined text-red-500 ${!h&&"animate-bounce"}`,children:"warning"}),r.jsx("div",{className:"flex items-center gap-2",children:r.jsxs("h3",{className:`text-red-400 font-bold uppercase tracking-wider flex items-center gap-2 ${h?"text-xs":"text-sm"}`,children:[h?"Wykryto Zagroenie":" WYKRYTO ZAGROENIE!",r.jsxs("span",{className:`font-normal text-red-300 normal-case hidden sm:inline ${h?"text-[10px]":"text-xs"}`,children:["(",j.length," ",j.length===1?"flota":"floty",")"]})]})})]}),!h&&r.jsx("div",{className:"mt-2 text-red-100/80 space-y-2 w-full hidden md:block"}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("div",{className:"text-right",children:[r.jsx("div",{className:`text-red-300 uppercase ${h?"text-[8px] hidden sm:block":"text-[10px]"}`,children:"Kontakt za:"}),r.jsx("div",{className:`text-red-400 font-bold font-mono leading-none ${h?"text-sm":"text-lg"}`,children:Ma(Math.max(0,(j[0].arrivalTime-Date.now())/1e3))})]}),r.jsx("span",{className:"material-symbols-outlined text-red-400 transition-transform duration-300",style:{transform:h?"rotate(180deg)":"rotate(0deg)"},children:"expand_less"})]})]}),!h&&r.jsxs("div",{className:"px-4 pb-2 text-red-100/80 space-y-2",children:[j.map(E=>r.jsxs("div",{className:"text-xs border-t border-red-500/30 pt-2",children:[r.jsx("p",{className:"font-bold text-red-200 mb-1",children:E.attackerName?`Atakuje: ${E.attackerName}`:"Nadciga wroga flota!"}),r.jsxs("p",{className:"opacity-80",children:["Flota: ",Object.entries(E.ships||{}).map(([O,_])=>{var G;return`${((G=Je[O])==null?void 0:G.name)||O}: ${_}`}).join(", ")]})]},E.id)),r.jsx("div",{className:"text-center pt-2",children:r.jsx("span",{className:"text-[10px] text-red-400 opacity-70",children:"(Kliknij, aby zminimalizowa pasek)"})})]})]}),r.jsx("div",{className:"flex-1 overflow-y-auto p-2 md:p-6 lg:p-8 scrollbar-thin scrollbar-thumb-primary scrollbar-track-background-dark",children:r.jsx("div",{className:"max-w-[1400px] mx-auto pb-20 lg:pb-0",children:l})})]}),o&&r.jsxs("div",{className:"lg:hidden fixed inset-0 z-40 bg-[#101322]/95 backdrop-blur-xl flex flex-col animate-in fade-in slide-in-from-bottom-10 duration-200",children:[r.jsxs("div",{className:"p-6 flex items-center justify-between border-b border-white/10",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"bg-center bg-no-repeat bg-cover rounded-full size-12 border-2 border-primary",style:{backgroundImage:`url("${(x==null?void 0:x.avatarUrl)||"/kosmo/avatars/avatar_default.png"}")`}}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("h1",{className:"text-white text-lg font-bold tracking-tight uppercase",children:"Centrum"}),r.jsxs("p",{className:"text-[#929bc9] text-sm font-normal",children:["Kmdr. ",(x==null?void 0:x.nickname)||"Gracz"]})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>{document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen().catch(E=>console.log(E))},className:"p-2 bg-white/5 rounded-full text-white hover:bg-white/10 transition-colors",title:"Peny ekran",children:r.jsx("span",{className:"material-symbols-outlined",children:"fullscreen"})}),r.jsx("button",{onClick:()=>d(!1),className:"p-2 bg-white/5 rounded-full text-white hover:bg-white/10 transition-colors",children:r.jsx("span",{className:"material-symbols-outlined",children:"close"})})]})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto p-4 grid grid-cols-2 gap-3 overscroll-y-contain touch-action-manipulation pb-24",children:[z.map(E=>r.jsxs("button",{onClick:()=>M(E.id),className:`flex flex-col items-center justify-center p-4 rounded-xl border transition-all ${s===E.id?"bg-primary/20 border-primary text-white":"bg-[#1c2136] border-white/5 text-[#929bc9] hover:bg-white/5"}`,children:[r.jsx("span",{className:`material-symbols-outlined text-3xl mb-2 ${E.id==="shop"?"text-yellow-500":""}`,children:E.icon}),r.jsx("span",{className:"text-sm font-bold",children:E.label})]},E.id)),r.jsxs("button",{onClick:()=>N(),className:"flex flex-col items-center justify-center p-4 rounded-xl border border-red-500/20 bg-red-500/10 text-red-400 hover:bg-red-500/20 col-span-2 mt-4",children:[r.jsx("span",{className:"material-symbols-outlined text-3xl mb-2",children:"logout"}),r.jsx("span",{className:"text-sm font-bold",children:"Wyloguj Si"})]})]})]}),r.jsx("nav",{className:"lg:hidden fixed bottom-0 left-0 right-0 bg-[#1c2136]/95 backdrop-blur-md border-t border-white/10 z-50 pb-safe",children:r.jsxs("div",{className:"flex justify-around items-center h-16 px-1",children:[C.map(E=>{const O=s===E.id;return r.jsxs("button",{onClick:()=>{n(E.id),d(!1)},className:`flex flex-col items-center justify-center w-full h-full gap-1 transition-colors ${O?"text-primary":"text-[#929bc9] hover:text-white"}`,children:[r.jsx("span",{className:`material-symbols-outlined transition-transform ${O?"scale-110":""} text-2xl`,children:E.icon}),r.jsx("span",{className:"text-[10px] font-medium leading-none",children:E.label})]},E.id)}),r.jsxs("button",{onClick:()=>d(!o),className:`flex flex-col items-center justify-center w-full h-full gap-1 transition-colors ${o?"text-white":"text-[#929bc9] hover:text-white"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-2xl",children:"menu"}),r.jsx("span",{className:"text-[10px] font-medium leading-none",children:"Menu"})]})]})}),r.jsx(Wy,{onClick:()=>g(!0)}),r.jsx(Xy,{visible:b,onClose:()=>g(!1)}),p&&r.jsx(Fy,{onClose:()=>v(!1)})]})},tv=()=>{const[l,s]=ee.useState(!0),[n,o]=ee.useState(""),[d,h]=ee.useState(""),[f,b]=ee.useState(!1),[g,p]=ee.useState(null),v=async x=>{x.preventDefault(),b(!0),p(null);const N=`${n.trim()}@kosmo.com`;try{if(l){const{error:j}=await de.auth.signInWithPassword({email:N,password:d});if(j)throw j}else{const{data:j,error:C}=await de.auth.signUp({email:N,password:d,options:{data:{full_name:n.trim()}}});if(C)throw C;if(j.user&&!j.session){const{error:z}=await de.auth.signInWithPassword({email:N,password:d});z&&(alert('Konto utworzone! Jeli nie zostae zalogowany automatycznie, sprawd czy wyczye "Confirm Email" w Supabase lub sprbuj si zalogowa.'),s(!0))}}}catch(j){p(j.message)}finally{b(!1)}};return r.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-[#101322] relative overflow-hidden",children:[r.jsxs("div",{className:"absolute inset-0 z-0",children:[r.jsx("div",{className:"absolute top-1/4 left-1/4 w-96 h-96 bg-primary/20 rounded-full blur-[100px] animate-pulse"}),r.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-96 h-96 bg-purple-600/20 rounded-full blur-[100px] animate-pulse",style:{animationDelay:"2s"}})]}),r.jsxs("div",{className:"relative z-10 w-full max-w-md p-6 md:p-8 bg-[#1c2136]/80 backdrop-blur-xl border border-white/10 rounded-2xl shadow-2xl mx-4 animate-in fade-in zoom-in-95 duration-500",children:[r.jsxs("div",{className:"flex flex-col items-center mb-8 group",children:[r.jsxs("div",{className:"rounded-full size-24 border-2 border-primary mb-4 shadow-lg shadow-primary/30 overflow-hidden bg-[#111422] transition-transform duration-500 group-hover:scale-110 group-hover:shadow-primary/50 relative",children:[r.jsx("div",{className:"absolute inset-0 bg-primary/20 animate-pulse z-10 pointer-events-none"}),r.jsx("img",{src:Be.avatar,alt:"Logo",className:"w-full h-full object-cover relative z-0",onError:x=>{x.currentTarget.src="/kosmo/avatars/avatar_default.png"}})]}),r.jsx("h1",{className:"text-4xl font-bold text-white tracking-tight uppercase font-display text-transparent bg-clip-text bg-gradient-to-r from-white to-primary animate-in slide-in-from-top-4 duration-700 delay-150",children:"Kosmo 2.0"}),r.jsx("p",{className:"text-gray-500 mt-2 animate-in slide-in-from-top-2 duration-700 delay-200",children:"v1.2.5 (PvP & Commander Update)"}),r.jsx("p",{className:"text-[#929bc9] text-sm md:text-base text-center mt-2 animate-in slide-in-from-top-2 duration-700 delay-300",children:"Zaloguj si do terminala dowdcy"})]}),r.jsxs("form",{onSubmit:v,className:"flex flex-col gap-4 animate-in slide-in-from-bottom-4 duration-700 delay-300",children:[g&&r.jsx("div",{className:"bg-red-500/10 border border-red-500/20 text-red-400 p-3 rounded-lg text-sm text-center animate-pulse",children:g}),r.jsxs("div",{className:"group",children:[r.jsx("label",{className:"text-xs font-bold text-[#929bc9] uppercase mb-1 block group-focus-within:text-primary transition-colors",children:"Nick Dowdcy"}),r.jsx("input",{type:"text",required:!0,value:n,onChange:x=>o(x.target.value),className:"w-full bg-[#111422] border border-white/10 rounded-lg px-4 py-3 text-white focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary/50 transition-all shadow-inner",placeholder:"Wpisz swj nick..."})]}),r.jsxs("div",{className:"group",children:[r.jsx("label",{className:"text-xs font-bold text-[#929bc9] uppercase mb-1 block group-focus-within:text-primary transition-colors",children:"Haso"}),r.jsx("input",{type:"password",required:!0,value:d,onChange:x=>h(x.target.value),className:"w-full bg-[#111422] border border-white/10 rounded-lg px-4 py-3 text-white focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary/50 transition-all shadow-inner",placeholder:""})]}),r.jsxs("button",{type:"submit",disabled:f,className:`mt-4 py-3 rounded-lg font-bold uppercase tracking-wider transition-all shadow-lg relative overflow-hidden group
                            ${f?"bg-gray-600 cursor-not-allowed":"bg-primary hover:bg-blue-600 text-white shadow-primary/20 hover:shadow-primary/40 hover:-translate-y-0.5"}
                        `,children:[r.jsx("span",{className:"relative z-10",children:f?"Przetwarzanie...":l?"Zaloguj si":"Zarejestruj konto"}),!f&&r.jsx("div",{className:"absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300"})]})]}),r.jsx("div",{className:"mt-6 text-center animate-in fade-in duration-1000 delay-500",children:r.jsx("button",{onClick:()=>s(!l),className:"text-sm text-[#929bc9] hover:text-white transition-colors hover:underline underline-offset-4",children:l?"Nie masz konta? Zarejestruj si":"Masz ju konto? Zaloguj si"})})]}),r.jsx("div",{className:"absolute bottom-4 left-0 right-0 text-center text-xs text-[#929bc9]/50 font-mono",children:"Stworzone przez DareG TV"})]})},av=({session:l,onComplete:s})=>{const[n,o]=ee.useState({galaxy:1,system:1}),[d,h]=ee.useState(new Map),[f,b]=ee.useState(!0),[g,p]=ee.useState(null),[v,x]=ee.useState(null);ee.useEffect(()=>{(async()=>{b(!0);const{data:_,error:G}=await de.from("profiles").select("galaxy_coords, planet_name").not("galaxy_coords","is",null),{data:he,error:Z}=await de.from("planets").select("*");if(!G&&!Z){const ie=new Map;_==null||_.forEach(ge=>{if(ge.galaxy_coords){const we=ge.galaxy_coords;ie.set(`${we.galaxy}:${we.system}:${we.position}`,ge.planet_name||"Gwna Planeta")}}),he==null||he.forEach(ge=>{if(ge.galaxy_coords){const we=ge.galaxy_coords;ie.set(`${we.galaxy}:${we.system}:${we.position}`,ge.planet_name||"Kolonia")}}),ie.set("1:1:2","Piracka Baza"),h(ie)}b(!1)})()},[]);const N=O=>d.has(`${n.galaxy}:${n.system}:${O}`),j=O=>d.get(`${n.galaxy}:${n.system}:${O}`),C=async O=>{if(g||N(O))return;p(O),x(null);const _={galaxy:n.galaxy,system:n.system,position:O},G={metal:500,crystal:300,deuterium:100,darkMatter:0,energy:0,maxEnergy:0,storage:{metal:1e4,crystal:1e4,deuterium:1e4}},he={metal_mine:1,crystal_mine:0,deuterium_synth:0,solar_plant:1,fusion_reactor:0,robot_factory:0,shipyard:0,research_lab:0,metal_storage:0,crystal_storage:0,deuterium_tank:0},Z={light_fighter:0,heavy_fighter:0,cruiser:0,battleship:0,destroyer:0,death_star:0,small_cargo:0,medium_cargo:0,huge_cargo:0,colony_ship:0,espionage_probe:0,pioneer:1,recycler:0},{error:ie}=await de.from("profiles").upsert({id:l.user.id,galaxy_coords:_,planet_name:`Kolonia [${_.galaxy}:${_.system}:${_.position}]`,last_updated:Date.now(),resources:G,buildings:he,ships:Z,research:{},defenses:{},debris:{metal:0,crystal:0},construction_queue:[],shipyard_queue:[],mission_logs:[],points:0,xp:0,level:1,version:1});if(ie){x("Bd przy zapisie pozycji: "+ie.message),p(null);return}s(_)},z=O=>{o(_=>{const G=_.system+O;return G<1||G>499?_:{..._,system:G}})},M=O=>{o(_=>{const G=_.galaxy+O;return G<1||G>9?_:{..._,galaxy:G}})},E=Array.from({length:15},(O,_)=>_+1);return f?r.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-[#101322] flex-col gap-4",children:[r.jsx("div",{className:"w-12 h-12 border-4 border-primary border-t-transparent rounded-full animate-spin"}),r.jsx("div",{className:"text-white text-xl",children:"Skanowanie Galaktyki..."})]}):r.jsxs("div",{className:"min-h-screen bg-[#101322] overflow-y-auto",children:[r.jsxs("div",{className:"max-w-4xl mx-auto p-4 flex flex-col gap-6 pb-20 relative min-h-full",children:[r.jsxs("div",{className:"text-center py-8",children:[r.jsx("h1",{className:"text-3xl font-bold text-white uppercase tracking-tight mb-2",children:"Wybierz miejsce pod koloni"}),r.jsx("p",{className:"text-[#929bc9]",children:'Znajd woln planet w dowolnym ukadzie i kliknij "Zasiedl".'}),v&&r.jsx("div",{className:"mt-4 p-3 bg-red-500/20 text-red-400 rounded-lg",children:v})]}),r.jsx("div",{className:"absolute top-40 left-1/2 -translate-x-1/2 pointer-events-none z-0 opacity-40 w-full flex justify-center overflow-hidden",children:r.jsx("div",{className:"w-[600px] h-[600px] rounded-full bg-blue-500/20 blur-[120px] -translate-y-1/2"})}),r.jsx("div",{className:"bg-[#1c2136] p-4 rounded-xl border border-white/10 shadow-lg sticky top-0 z-20 backdrop-blur-md bg-opacity-90",children:r.jsx("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:r.jsxs("div",{className:"flex gap-2 w-full justify-center",children:[r.jsxs("div",{className:"flex flex-col gap-1 w-32 md:w-40",children:[r.jsx("span",{className:"text-[10px] uppercase font-bold text-[#929bc9] tracking-wider text-center",children:"Galaktyka"}),r.jsxs("div",{className:"flex items-center h-10 md:h-12 bg-[#111422] rounded-lg border border-white/10 overflow-hidden",children:[r.jsx("button",{onClick:()=>M(-1),className:"w-8 md:w-10 h-full hover:bg-white/5 active:bg-white/10 flex items-center justify-center text-[#929bc9]",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"chevron_left"})}),r.jsx("div",{className:"flex-1 text-center font-mono font-bold text-lg text-white",children:n.galaxy}),r.jsx("button",{onClick:()=>M(1),className:"w-8 md:w-10 h-full hover:bg-white/5 active:bg-white/10 flex items-center justify-center text-[#929bc9]",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"chevron_right"})})]})]}),r.jsxs("div",{className:"flex flex-col gap-1 w-32 md:w-40",children:[r.jsx("span",{className:"text-[10px] uppercase font-bold text-[#929bc9] tracking-wider text-center",children:"Ukad"}),r.jsxs("div",{className:"flex items-center h-10 md:h-12 bg-[#111422] rounded-lg border border-white/10 overflow-hidden",children:[r.jsx("button",{onClick:()=>z(-1),className:"w-8 md:w-10 h-full hover:bg-white/5 active:bg-white/10 flex items-center justify-center text-[#929bc9]",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"chevron_left"})}),r.jsx("div",{className:"flex-1 text-center font-mono font-bold text-lg text-white",children:n.system}),r.jsx("button",{onClick:()=>z(1),className:"w-8 md:w-10 h-full hover:bg-white/5 active:bg-white/10 flex items-center justify-center text-[#929bc9]",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"chevron_right"})})]})]})]})})}),r.jsx("div",{className:"flex flex-col gap-3 relative z-10",children:E.map(O=>{const _=N(O),G=j(O),he=n.galaxy===1&&n.system===1&&O===2;return r.jsxs("div",{className:`relative flex items-center gap-2 md:gap-3 p-2 md:p-3 rounded-xl border transition-all ${_?"bg-[#1a2342]/50 border-red-500/20":"bg-[#1c2136] border-white/5 hover:border-green-500/30 hover:bg-[#1c2136]/80"}`,children:[r.jsx("div",{className:"flex flex-col items-center justify-center w-6 md:w-8 text-[#929bc9] font-mono text-xs md:text-sm opacity-50",children:O}),r.jsx("div",{className:"shrink-0",children:_?r.jsxs("div",{className:"w-10 h-10 md:w-12 md:h-12 rounded-full shadow-lg relative overflow-hidden bg-black/20 opacity-80 grayscale-[0.5]",children:[r.jsx("img",{src:he?"https://lh3.googleusercontent.com/aida-public/AB6AXuCttLEph3WsOd3HRlZC0zxgyo5HtGQLhoc_Nr46u_bMbqY6nTEQYuIV_gyR_hpfVBS-J_jj5GGZynbPPZti1oj5iZ3eOY_YBYNi3q8nw6c4ebgmqCgJnaJhFtJwFfpNu4nYT65VMgmQkWQU-ek95Y5Ue6RnI9LCcYQpDhod0Y_eUiJYtnqiu9_aD-u_ukPsujkP5hgKqFchbR8vhUje3E-LrA80lMR4QTQEfNKXUDobsJRFGe11_CQSYumUsrXBnYunhGfRGvl2epw":Be.planet,alt:"Planet",className:"w-full h-full object-cover"}),r.jsx("div",{className:"absolute inset-0 rounded-full bg-red-500/10"})]}):r.jsx("div",{className:"w-10 h-10 md:w-12 md:h-12 rounded-full border-2 border-dashed border-white/10 flex items-center justify-center opacity-40 group-hover:opacity-100 transition-opacity",children:r.jsx("span",{className:"material-symbols-outlined text-white text-base",children:"add_location"})})}),r.jsx("div",{className:"flex-1 min-w-0",children:_?r.jsx("div",{className:"flex flex-col justify-center",children:r.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[r.jsx("span",{className:"font-bold text-sm md:text-base truncate text-white",children:G}),r.jsx("span",{className:"text-red-400 text-xs uppercase font-bold tracking-wider",children:"ZAJTE"})]})}):r.jsxs("div",{className:"flex flex-col justify-center",children:[r.jsx("span",{className:"text-green-400 text-sm font-bold",children:"Wolna przestrzen"}),r.jsx("span",{className:"text-[#929bc9] text-xs",children:"Planeta gotowa do kolonizacji"})]})}),r.jsxs("div",{className:"flex items-center gap-3",children:[!_&&r.jsx("button",{onClick:()=>C(O),disabled:g!==null,className:`px-4 py-2 rounded-lg font-bold text-sm uppercase tracking-wider shadow-lg transition-all ${g===O?"bg-white text-black animate-pulse":"bg-green-600 hover:bg-green-500 text-white"}`,children:g===O?"Zasiedlanie...":"Zasiedl"}),_&&r.jsx("span",{className:"material-symbols-outlined text-white/10",children:"lock"})]})]},O)})})]}),r.jsx("div",{className:"fixed bottom-4 right-4 text-xs text-[#929bc9]/50 font-mono z-50",children:"v1.1.2"})]})},cp=({onNavigate:l})=>{const{constructionQueue:s,buildings:n,ships:o,resources:d,shipyardQueue:h,planetName:f,renamePlanet:b,planetType:g,galaxyCoords:p,incomingMissions:v,activeMissions:x,productionSettings:N,getLevel:j,cancelMission:C,cancelConstruction:z,level:M,xp:E}=ua(),O=g&&kr[g]?kr[g]:kr.default,_=h[0],[G,he]=ee.useState({}),[Z,ie]=ee.useState(""),[ge,we]=ee.useState(!1),[je,Ue]=ee.useState(f);ee.useEffect(()=>{Ue(f)},[f]),ee.useEffect(()=>{const ye=()=>{const V=Date.now(),ne={};if(s.forEach(pe=>{const Te=Math.max(0,Math.floor((pe.endTime-V)/1e3));ne[pe.id]=Ma(Te)}),he(ne),_){const pe=Math.max(0,Math.floor((_.endTime-V)/1e3));ie(Ma(pe))}else ie("")};ye();const S=setInterval(ye,1e3);return()=>clearInterval(S)},[s,_]);const Ce=()=>{je.trim().length>0?b(je.trim()):Ue(f),we(!1)},Ge=ye=>{ye.key==="Enter"?Ce():ye.key==="Escape"&&(Ue(f),we(!1))},qe=Object.values(o).reduce((ye,S)=>ye+S,0);return r.jsxs("div",{className:"space-y-6",children:[v.length>0&&r.jsx("div",{className:"bg-red-900/50 border border-red-500 rounded-xl p-4 flex items-center justify-between animate-pulse shadow-[0_0_20px_rgba(239,68,68,0.4)]",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:"material-symbols-outlined text-red-500 text-3xl",children:"warning"}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-red-400 font-bold text-lg",children:"WYKRYTO ZAGROENIE!"}),r.jsxs("p",{className:"text-red-200 text-sm",children:["Nadciga wroga flota! Szacowany czas kontaktu: ",Ma(Math.max(0,(v[0].arrivalTime-Date.now())/1e3))]})]})]})}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[r.jsx("div",{className:"lg:col-span-5 xl:col-span-4",children:r.jsxs("div",{className:"bg-[#161b2e] rounded-2xl overflow-hidden border border-white/10 shadow-xl relative group",children:[r.jsxs("div",{className:"relative h-48 overflow-hidden",children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#161b2e] via-transparent to-transparent z-10"}),r.jsx("img",{src:O,alt:"Planet",className:"w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-700 opacity-80"}),r.jsx("div",{className:"absolute top-4 right-4 z-20 flex flex-col items-end",children:r.jsxs("div",{className:"flex items-center gap-2 text-[#929bc9] text-sm bg-black/40 px-2 py-1 rounded backdrop-blur-sm",children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"my_location"}),"[",(p==null?void 0:p.galaxy)||1,":",(p==null?void 0:p.system)||1,":",(p==null?void 0:p.position)||1,"]"]})}),r.jsx("div",{className:"absolute bottom-4 left-4 w-full pr-8 z-20",children:r.jsx("div",{className:"flex items-center gap-2 h-10",children:ge?r.jsxs("div",{className:"flex items-center gap-2 bg-black/60 rounded p-1 backdrop-blur-md",children:[r.jsx("input",{autoFocus:!0,value:je,onChange:ye=>Ue(ye.target.value),onBlur:Ce,onKeyDown:Ge,className:"bg-transparent border-b border-primary text-white font-bold text-xl w-32 focus:outline-none"}),r.jsx("button",{onClick:Ce,className:"text-green-400 hover:text-green-300",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"check"})})]}):r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-3xl font-bold text-white mb-1 truncate shadow-black drop-shadow-md",children:f}),r.jsx("button",{onClick:()=>we(!0),className:"w-8 h-8 flex items-center justify-center rounded-full bg-white/10 hover:bg-white/20 text-white border border-white/20 backdrop-blur-sm transition-colors",title:"Zmie nazw",children:r.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})})]})})})]}),r.jsxs("div",{className:"p-6 flex flex-col gap-4",children:[r.jsxs("div",{className:"flex justify-between items-center border-b border-white/5 pb-3",children:[r.jsx("span",{className:"text-[#929bc9] text-sm",children:"rednica"}),r.jsx("span",{className:"text-white font-medium",children:"12,800 km"})]}),r.jsxs("div",{className:"flex justify-between items-center border-b border-white/5 pb-3",children:[r.jsx("span",{className:"text-[#929bc9] text-sm",children:"Temperatura"}),r.jsx("span",{className:"text-white font-medium",children:"12C do 50C"})]}),r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"text-[#929bc9] text-sm",children:"Zajte Pola"}),r.jsx("div",{className:"flex items-center gap-2",children:r.jsxs("span",{className:"text-white font-medium",children:[Object.values(n).reduce((ye,S)=>ye+S,0)," / 163"]})})]})]}),r.jsxs("div",{className:"p-4 border-t border-white/10",children:[r.jsxs("h4",{className:"text-white font-bold text-sm uppercase tracking-wider mb-3 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-primary text-lg",children:"person"}),"Statystyki Dowdcy"]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{className:"bg-[#111422] rounded-lg p-3 text-center",children:[r.jsxs("div",{className:"text-yellow-400 font-bold text-2xl relative group cursor-help",children:[M||1,r.jsxs("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-max max-w-[200px] bg-black/90 border border-white/20 rounded p-2 text-xs text-gray-300 hidden group-hover:block z-50 pointer-events-none shadow-xl",children:[r.jsx("div",{className:"font-bold text-yellow-400 mb-1",children:"Dowiadczenie (XP)"}),r.jsxs("div",{children:["Aktualne: ",r.jsx("span",{className:"text-white",children:ip(Math.floor(E||0))})]}),r.jsxs("div",{children:["Nastpny poziom: ",r.jsx("span",{className:"text-white",children:ip(Math.floor(500*Math.pow(M||1,2)))})]})]})]}),r.jsx("div",{className:"text-[#929bc9] text-xs uppercase mb-2",children:"Poziom"}),r.jsx("div",{className:"w-full h-1.5 bg-black/40 rounded-full overflow-hidden border border-white/5",children:r.jsx("div",{className:"h-full bg-gradient-to-r from-yellow-600 to-yellow-400 transition-all duration-500",style:{width:`${Math.min(100,Math.max(0,((E||0)-500*Math.pow((M||1)-1,2))/(500*Math.pow(M||1,2)-500*Math.pow((M||1)-1,2))*100))}%`}})})]}),r.jsxs("div",{className:"bg-[#111422] rounded-lg p-3 text-center",children:[r.jsx("div",{className:"text-primary font-bold text-2xl",children:qe}),r.jsx("div",{className:"text-[#929bc9] text-xs uppercase",children:"Flota"})]}),r.jsxs("div",{className:"bg-[#111422] rounded-lg p-3 text-center",children:[r.jsx("div",{className:"text-green-400 font-bold text-lg",children:"~2-5k"}),r.jsx("div",{className:"text-[#929bc9] text-xs uppercase",children:"Zysk/Exp."})]}),r.jsxs("div",{className:"bg-[#111422] rounded-lg p-3 text-center",children:[r.jsx("div",{className:"text-purple-400 font-bold text-lg",children:x.length}),r.jsx("div",{className:"text-[#929bc9] text-xs uppercase",children:"Aktywne Misje"})]})]})]})]})}),r.jsxs("div",{className:"lg:col-span-7 xl:col-span-8 flex flex-col gap-6",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsx("h3",{className:"text-2xl font-bold tracking-tight",children:"Status Operacyjny"})}),s.length>0?r.jsx("div",{className:"space-y-4",children:s.map((ye,S)=>{const V=S===0;return r.jsxs("div",{className:`bg-[#232948] border ${V?"border-primary/50":"border-white/10"} rounded-xl p-4 flex flex-col md:flex-row items-center gap-6 relative overflow-hidden group shadow-[0_0_15px_rgba(19,55,236,0.1)]`,children:[V&&r.jsx("div",{className:"absolute top-0 left-0 bottom-0 w-1 bg-primary animate-pulse"}),r.jsx("div",{className:"size-16 rounded-xl bg-[#111422] shrink-0 flex items-center justify-center border border-white/10",children:r.jsx("span",{className:`material-symbols-outlined text-3xl ${V?"text-primary animate-spin-slow":"text-[#929bc9]"}`,style:{animationDuration:"3s"},children:"construction"})}),r.jsxs("div",{className:"flex-1 min-w-0 w-full text-center md:text-left",children:[r.jsxs("div",{className:"flex items-center justify-center md:justify-start gap-3 mb-2",children:[r.jsxs("h4",{className:"text-white font-bold text-lg truncate flex items-center gap-2",children:[V?"Rozbudowa w toku":"W kolejce",!V&&r.jsxs("span",{className:"text-xs bg-white/10 px-2 py-0.5 rounded text-[#929bc9]",children:["#",S+1]})]}),r.jsxs("span",{className:"px-2 py-0.5 rounded text-xs bg-primary/20 text-primary border border-primary/20 font-bold",children:["Lvl ",ye.targetLevel]})]}),r.jsxs("div",{className:"flex items-center gap-4 justify-center md:justify-start text-sm text-[#929bc9]",children:[r.jsx("span",{className:V?"text-primary font-medium animate-pulse":"",children:V?"Pozostay czas:":"Start za:"}),r.jsx("span",{className:`text-2xl font-mono ${V?"text-white font-bold":"text-[#929bc9]"}`,children:G[ye.id]||"..."})]})]}),r.jsxs("button",{onClick:()=>z(ye.id),className:"px-3 py-1.5 bg-red-500/10 hover:bg-red-500/20 text-red-500 border border-red-500/20 rounded-lg text-xs font-bold uppercase transition-colors flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"cancel"}),"Anuluj"]})]},ye.id)})}):r.jsxs("div",{className:"bg-[#1c2136] border border-white/5 rounded-xl p-6 flex flex-col items-center justify-center gap-2 text-center h-28",children:[r.jsx("p",{className:"text-[#929bc9] text-sm",children:"Brak aktywnych procesw budowy."}),r.jsx("button",{onClick:()=>l("buildings"),className:"text-primary hover:text-white text-xs font-bold uppercase tracking-wider transition-colors",children:"Rozpocznij budow "})]}),_?(()=>{const ye=_.type==="defense",S=ye?Ka[_.itemId]:Je[_.itemId],V=(S==null?void 0:S.name)||_.itemId,ne=(S==null?void 0:S.icon)||(ye?"shield":"rocket");return r.jsxs("div",{className:"bg-[#2a2d40] border border-white/10 rounded-xl p-6 flex flex-col md:flex-row items-center gap-6 relative overflow-hidden",children:[r.jsx("div",{className:`absolute top-0 left-0 bottom-0 w-1 ${ye?"bg-blue-500":"bg-orange-500"} animate-pulse`}),r.jsx("div",{className:"size-20 rounded-xl bg-[#111422] shrink-0 flex items-center justify-center border border-white/10",children:r.jsx("span",{className:`material-symbols-outlined text-4xl ${ye?"text-blue-500":"text-orange-500"} animate-pulse`,children:ne})}),r.jsxs("div",{className:"flex-1 min-w-0 w-full text-center md:text-left",children:[r.jsxs("div",{className:"flex items-center justify-center md:justify-start gap-3 mb-2",children:[r.jsx("h4",{className:"text-white font-bold text-xl truncate",children:ye?"Budowa Obrony":"Produkcja Floty"}),r.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${ye?"bg-blue-500/20 text-blue-500 border-blue-500/20":"bg-orange-500/20 text-orange-500 border-orange-500/20"} border font-bold`,children:V})]}),r.jsxs("div",{className:"flex items-center gap-4 justify-center md:justify-start text-sm text-[#929bc9]",children:[r.jsxs("span",{className:`${ye?"text-blue-500":"text-orange-500"} font-medium`,children:["x",_.quantity]}),r.jsx("span",{className:"text-2xl font-mono text-white font-bold",children:Z})]})]})]})})():null]})]}),r.jsxs("div",{className:"bg-[#1c2136] rounded-xl border border-white/10 p-6",children:[r.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined",children:"rocket_launch"}),"Status Floty"]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("div",{className:"bg-[#111422] p-4 rounded-lg border border-white/5",children:[r.jsx("div",{className:"text-[#929bc9] text-xs uppercase font-bold mb-1",children:"Jednostki Bojowe"}),r.jsx("div",{className:"text-2xl text-white font-mono",children:qe})]}),r.jsxs("div",{className:"bg-[#111422] p-4 rounded-lg border border-white/5",children:[r.jsx("div",{className:"text-[#929bc9] text-xs uppercase font-bold mb-1",children:"Gotowo Bojowa"}),r.jsx("div",{className:"text-2xl text-green-400 font-mono",children:"100%"})]}),r.jsxs("div",{className:"bg-[#111422] p-4 rounded-lg border border-white/5",children:[r.jsx("div",{className:"text-[#929bc9] text-xs uppercase font-bold mb-1",children:"Misje w toku"}),r.jsx("div",{className:"text-2xl text-white font-mono",children:"0 / 2"})]})]}),r.jsx("div",{className:"mt-4 flex justify-end",children:r.jsx("button",{onClick:()=>l("shipyard"),className:"text-primary text-sm font-bold hover:text-white transition-colors",children:"Do Stoczni "})})]}),r.jsxs("div",{className:"bg-[#1c2136] rounded-xl border border-white/10 p-6",children:[r.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined",children:"radar"}),"Aktywne Misje"]}),x.length===0?r.jsx("p",{className:"text-[#929bc9] text-sm text-center py-4",children:"Brak aktywnych misji."}):r.jsx("div",{className:"flex flex-col gap-3",children:x.map(ye=>{const S=ye.status==="returning",V=ye.targetCoords,ne=ye.type==="attack"?"Atak":ye.type==="spy"?"Szpiegowanie":ye.type==="expedition"?"Ekspedycja":"Misja";return r.jsxs("div",{className:"bg-[#111422] p-4 rounded-lg border border-white/5 flex flex-col md:flex-row items-center justify-between gap-4",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${S?"bg-blue-500/20 text-blue-400":ye.type==="attack"?"bg-red-500/20 text-red-400":"bg-purple-500/20 text-purple-400"}`,children:r.jsx("span",{className:"material-symbols-outlined",children:S?"keyboard_return":ye.type==="attack"?"swords":"visibility"})}),r.jsxs("div",{children:[r.jsx("div",{className:"font-bold text-white",children:S?`Powrt z ${ne}`:ne}),r.jsxs("div",{className:"text-xs text-[#929bc9]",children:["Cel: [",V.galaxy,":",V.system,":",V.position,"]"]})]})]}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("div",{className:"text-right",children:[r.jsx("div",{className:"text-xs text-[#929bc9]",children:"Czas do celu"}),r.jsx("div",{className:"font-mono text-white font-bold",children:Ma(Math.max(0,((S?ye.returnTime:ye.arrivalTime)-Date.now())/1e3))})]}),ye.status==="flying"&&r.jsx("button",{onClick:()=>C(ye.id),className:"px-3 py-1 bg-red-900/40 hover:bg-red-900/60 text-red-400 border border-red-500/30 rounded text-sm transition-colors uppercase font-bold tracking-wider",children:"Odwoaj"})]})]},ye.id)})})]})]})},sv=()=>{const{buildings:l,research:s,resources:n,upgradeBuilding:o,getCost:d,constructionQueue:h,checkRequirements:f,productionSettings:b,updateProductionSetting:g}=ua(),[p,v]=ee.useState(""),x=Object.values(ts),N=h.find(E=>E.type==="building"),j=l[oe.ROBOT_FACTORY]||0,C=100;ee.useEffect(()=>{if(!N){v("");return}const E=()=>{const _=Date.now(),G=Math.max(0,Math.floor((N.endTime-_)/1e3));v(Ma(G))};E();const O=setInterval(E,1e3);return()=>clearInterval(O)},[N]);const z=(E,O)=>{if(E===oe.METAL_MINE){const _=Math.floor(30*O*Math.pow(1.1,O))*100,G=Math.floor(30*(O+1)*Math.pow(1.1,O+1))*100,he=Math.floor(20*O*Math.pow(1.1,O)),Z=Math.floor(20*(O+1)*Math.pow(1.1,O+1));return{text:`Produkcja: +${(G-_).toLocaleString()}/h`,energyText:`Energia: -${(Z-he).toLocaleString()}`,type:"gain"}}if(E===oe.CRYSTAL_MINE){const _=Math.floor(20*O*Math.pow(1.1,O))*100,G=Math.floor(20*(O+1)*Math.pow(1.1,O+1))*100,he=Math.floor(20*O*Math.pow(1.1,O)),Z=Math.floor(20*(O+1)*Math.pow(1.1,O+1));return{text:`Produkcja: +${(G-_).toLocaleString()}/h`,energyText:`Energia: -${(Z-he).toLocaleString()}`,type:"gain"}}if(E===oe.DEUTERIUM_SYNTH){const _=Math.floor(10*O*Math.pow(1.1,O))*100,G=Math.floor(10*(O+1)*Math.pow(1.1,O+1))*100,he=Math.floor(40*O*Math.pow(1.1,O)),Z=Math.floor(40*(O+1)*Math.pow(1.1,O+1));return{text:`Produkcja: +${(G-_).toLocaleString()}/h`,energyText:`Energia: -${(Z-he).toLocaleString()}`,type:"gain"}}if(E===oe.SOLAR_PLANT){const _=Math.floor(20*O*Math.pow(1.1,O));return{text:`Energia: +${(Math.floor(20*(O+1)*Math.pow(1.1,O+1))-_).toLocaleString()}`,type:"energy"}}if(E===oe.FUSION_REACTOR){const _=Math.floor(30*O*Math.pow(1.05,O));return{text:`Energia: +${(Math.floor(30*(O+1)*Math.pow(1.05,O+1))-_).toLocaleString()}`,type:"energy"}}if(E===oe.METAL_STORAGE){const _=1e4+5e3*Math.floor(Math.pow(2.5,O)),G=1e4+5e3*Math.floor(Math.pow(2.5,O+1));return{text:`Pojemno: ${(_/1e3).toFixed(0)}k -> ${(G/1e3).toFixed(0)}k`,type:"capacity"}}if(E===oe.CRYSTAL_STORAGE){const _=1e4+5e3*Math.floor(Math.pow(2.5,O)),G=1e4+5e3*Math.floor(Math.pow(2.5,O+1));return{text:`Pojemno: ${(_/1e3).toFixed(0)}k -> ${(G/1e3).toFixed(0)}k`,type:"capacity"}}if(E===oe.DEUTERIUM_TANK){const _=1e4+5e3*Math.floor(Math.pow(2.5,O)),G=1e4+5e3*Math.floor(Math.pow(2.5,O+1));return{text:`Pojemno: ${(_/1e3).toFixed(0)}k -> ${(G/1e3).toFixed(0)}k`,type:"capacity"}}if(E===oe.ROBOT_FACTORY){const _=100/(O+1),G=100/(O+2);return O>=20?{text:`Czas budowy: ${_.toFixed(2)}% -> ${G.toFixed(2)}%`,type:"capacity"}:{text:`Czas budowy: ${_.toFixed(1)}% -> ${G.toFixed(1)}%`,type:"capacity"}}return null},M=[oe.METAL_MINE,oe.CRYSTAL_MINE,oe.DEUTERIUM_SYNTH,oe.SOLAR_PLANT,oe.FUSION_REACTOR];return r.jsxs("div",{className:"flex flex-col gap-6",children:[r.jsxs("div",{className:"flex items-center justify-between border-b border-white/10 pb-4",children:[r.jsxs("h2",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[r.jsx("span",{className:"material-symbols-outlined text-3xl text-primary",children:"domain"}),"Infrastruktura"]}),r.jsx("div",{className:"flex gap-2",children:r.jsxs("span",{className:"text-sm text-[#929bc9]",children:["Kolejka: ",h.filter(E=>E.type==="building").length," / 2"]})})]}),r.jsxs("div",{className:"bg-[#1c2136] rounded-xl border border-white/10 p-4",children:[r.jsxs("h3",{className:"text-sm font-bold text-white uppercase mb-3 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-sm text-yellow-400",children:"bolt"}),"Zarzdzanie Energi"]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:M.map(E=>{if(l[E]===0)return null;const _=b[E]??100;return r.jsxs("div",{className:"flex flex-col gap-1 bg-[#111422] p-2 rounded border border-white/5",children:[r.jsxs("div",{className:"flex justify-between text-xs text-[#929bc9]",children:[r.jsx("span",{className:"truncate",children:ts[E].name}),r.jsxs("span",{className:"font-bold text-white",children:[_,"%"]})]}),r.jsx("input",{type:"range",min:"0",max:"100",step:"10",value:_,onChange:G=>g(E,parseInt(G.target.value)),className:"w-full h-1 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-primary"})]},E)})})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-2",children:[r.jsxs("div",{className:"bg-[#1c2136] p-3 rounded-lg border border-white/5 flex items-center justify-between",children:[r.jsx("span",{className:"text-[#929bc9] text-xs uppercase font-bold",children:ts[oe.METAL_STORAGE].name}),r.jsxs("span",{className:`text-sm font-mono ${n.metal>=n.storage.metal?"text-red-400 font-bold":"text-white"}`,children:[Math.floor(n.metal).toLocaleString()," / ",(n.storage.metal/1e3).toFixed(0),"k"]})]}),r.jsxs("div",{className:"bg-[#1c2136] p-3 rounded-lg border border-white/5 flex items-center justify-between",children:[r.jsx("span",{className:"text-[#929bc9] text-xs uppercase font-bold",children:ts[oe.CRYSTAL_STORAGE].name}),r.jsxs("span",{className:`text-sm font-mono ${n.crystal>=n.storage.crystal?"text-red-400 font-bold":"text-white"}`,children:[Math.floor(n.crystal).toLocaleString()," / ",(n.storage.crystal/1e3).toFixed(0),"k"]})]}),r.jsxs("div",{className:"bg-[#1c2136] p-3 rounded-lg border border-white/5 flex items-center justify-between",children:[r.jsx("span",{className:"text-[#929bc9] text-xs uppercase font-bold",children:ts[oe.DEUTERIUM_TANK].name}),r.jsxs("span",{className:`text-sm font-mono ${n.deuterium>=n.storage.deuterium?"text-red-400 font-bold":"text-white"}`,children:[Math.floor(n.deuterium).toLocaleString()," / ",(n.storage.deuterium/1e3).toFixed(0),"k"]})]})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:x.map(E=>{var Ge;const O=l[E.id],_=d("building",E.id,O),G=n.metal>=_.metal&&n.crystal>=_.crystal&&n.deuterium>=_.deuterium,he=(N==null?void 0:N.itemId)===E.id,ie=h.filter(qe=>qe.type==="building").length>=2,ge=f(E.requirements),je=(_.metal+_.crystal)/2500*3600*1e3/(j+1)/C,Ue=Math.max(1,Math.floor(je/1e3)),Ce=z(E.id,O);return r.jsxs("div",{className:`bg-[#1c2136] rounded-xl border border-white/10 overflow-hidden hover:border-primary/50 transition-all group flex flex-col h-full ${ge?"":"opacity-60 grayscale"}`,children:[r.jsxs("div",{className:"h-40 bg-cover bg-center relative",style:{backgroundImage:`url("${E.image}")`},children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#1c2136] to-transparent"}),r.jsxs("div",{className:"absolute top-2 right-2 bg-black/60 backdrop-blur px-2 py-1 rounded text-xs text-white border border-white/10 font-mono",children:["Lvl ",O]}),he&&r.jsxs("div",{className:"absolute inset-0 bg-black/70 flex flex-col items-center justify-center backdrop-blur-sm p-4 text-center",children:[r.jsx("div",{className:"bg-primary text-white px-3 py-1 rounded-full text-xs font-bold animate-pulse shadow-lg mb-2",children:"W Budowie"}),r.jsx("div",{className:"text-2xl font-mono font-bold text-white",children:p})]})]}),r.jsxs("div",{className:"p-4 flex flex-col flex-1",children:[r.jsx("h4",{className:"text-lg font-bold text-white mb-1 group-hover:text-primary transition-colors",children:E.name}),r.jsx("p",{className:"text-xs text-[#929bc9] mb-4 line-clamp-2 min-h-[32px]",children:E.description}),Ce&&r.jsxs("div",{className:"mb-3 flex flex-col gap-0.5",children:[r.jsx("div",{className:`text-xs font-bold ${Ce.type==="energy"?"text-yellow-400":"text-green-400"}`,children:Ce.text}),Ce.energyText&&r.jsx("div",{className:"text-xs font-bold text-red-400",children:Ce.energyText})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs mb-4",children:[r.jsxs("div",{className:`flex items-center gap-1 ${n.metal<_.metal?"text-red-400":"text-[#929bc9]"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"handyman"}),_.metal>=1e3?`${(_.metal/1e3).toFixed(1)}k`:_.metal]}),r.jsxs("div",{className:`flex items-center gap-1 ${n.crystal<_.crystal?"text-red-400":"text-[#929bc9]"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"diamond"}),_.crystal>=1e3?`${(_.crystal/1e3).toFixed(1)}k`:_.crystal]}),r.jsxs("div",{className:`flex items-center gap-1 ${n.deuterium<_.deuterium?"text-red-400":"text-[#929bc9]"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"propane"}),_.deuterium>=1e3?`${(_.deuterium/1e3).toFixed(1)}k`:_.deuterium]})]}),ge?r.jsxs("div",{className:"mt-auto pt-3 border-t border-white/5 flex items-center justify-between",children:[r.jsxs("span",{className:"text-xs text-[#929bc9] flex items-center gap-1",children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"schedule"}),Ma(Ue)]}),r.jsx("button",{onClick:()=>o(E.id),disabled:!G||ie,className:`px-4 py-2 rounded text-xs font-bold uppercase transition-all shadow-lg
                                                ${!G||ie?"bg-[#232948] text-[#929bc9]/50 cursor-not-allowed":"bg-primary hover:bg-blue-600 text-white hover:shadow-primary/30"}
                                            `,children:he?"Czekaj...":G?"Rozbuduj":"Braki"})]}):r.jsxs("div",{className:"mt-auto pt-3 border-t border-red-500/20",children:[r.jsx("p",{className:"text-red-400 text-xs font-bold mb-1",children:"Wymagania:"}),r.jsx("div",{className:"flex flex-col gap-1",children:(Ge=E.requirements)==null?void 0:Ge.map((qe,ye)=>{const S=qe.type==="building"?ts[qe.id].name:Ar[qe.id].name,V=qe.type==="building"?l[qe.id]:s[qe.id];return r.jsxs("div",{className:`text-xs ${V>=qe.level?"text-green-400":"text-red-400/70"}`,children:["- ",S," (Lvl ",qe.level,")"]},ye)})})]})]})]},E.id)})})]})},rv=()=>{var M;const{ships:l,resources:s,buildShip:n,checkRequirements:o,buildings:d,research:h,shipyardQueue:f}=ua(),b=Object.values(Je).sort((E,O)=>{const _=E.baseCost.metal+E.baseCost.crystal+E.baseCost.deuterium,G=O.baseCost.metal+O.baseCost.crystal+O.baseCost.deuterium;return _-G}),g=d[oe.SHIPYARD],[p,v]=ee.useState({}),[x,N]=ee.useState(""),j=f[0];ee.useEffect(()=>{if(!j){N("");return}const E=()=>{const _=Date.now(),G=Math.max(0,Math.floor((j.endTime-_)/1e3));N(Ma(G))};E();const O=setInterval(E,1e3);return()=>clearInterval(O)},[j]);const C=(E,O)=>{const _=parseInt(O,10);!isNaN(_)&&_>=0?v(G=>({...G,[E]:_})):O===""&&v(G=>({...G,[E]:0}))},z=E=>{const O=p[E.id]||0;O>0&&(n(E.id,O),v(_=>({..._,[E.id]:0})))};return g===0?r.jsxs("div",{className:"bg-[#1c2136] border border-red-500/20 rounded-xl p-8 flex flex-col items-center justify-center text-center gap-4 mt-8",children:[r.jsx("span",{className:"material-symbols-outlined text-5xl text-red-500/50",children:"rocket_launch"}),r.jsx("h3",{className:"text-xl font-bold text-white",children:"Stocznia Wymagana"}),r.jsx("p",{className:"text-[#929bc9]",children:"Musisz wybudowa Stoczni w menu Budynki, aby rozpocz budow floty."})]}):r.jsxs("div",{className:"flex flex-col gap-6",children:[r.jsxs("div",{className:"flex items-center justify-between border-b border-white/10 pb-4",children:[r.jsxs("h2",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[r.jsx("span",{className:"material-symbols-outlined text-3xl text-primary",children:"rocket_launch"}),"Stocznia"]}),r.jsxs("div",{className:"flex items-center gap-4",children:[j?r.jsxs("div",{className:"bg-primary/20 border border-primary/30 px-3 py-1 rounded text-xs text-primary flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-sm animate-spin",children:"settings"}),"Budowa: ",((M=Je[j.itemId])==null?void 0:M.name)||j.itemId," (",j.quantity,") - ",x]}):r.jsx("span",{className:"text-sm text-[#929bc9]",children:"Oczekuj na rozkazy"}),r.jsxs("span",{className:"text-sm text-[#929bc9] border-l border-white/10 pl-4",children:["Lvl ",g]})]})]}),f.length>0&&r.jsxs("div",{className:"bg-[#1c2136] border border-white/10 rounded-xl p-4 mb-4",children:[r.jsx("h3",{className:"text-sm font-bold text-[#929bc9] uppercase mb-3",children:"Kolejka Produkcyjna"}),r.jsx("div",{className:"flex flex-col gap-2",children:f.map((E,O)=>{var _;return r.jsxs("div",{className:`flex items-center justify-between p-2 rounded ${O===0?"bg-primary/10 border border-primary/20":"bg-[#111422] border border-white/5"}`,children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("div",{className:"text-xs font-mono text-[#929bc9] w-4",children:[O+1,"."]}),r.jsx("div",{className:"font-bold text-sm text-white",children:((_=Je[E.itemId])==null?void 0:_.name)||E.itemId}),r.jsxs("div",{className:"text-xs text-[#929bc9]",children:["x",E.quantity]})]}),r.jsx("div",{className:"text-xs font-mono text-white",children:O===0?x:Ma(Math.floor((E.endTime-E.startTime)/1e3))})]},E.id)})})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:b.map(E=>{var we;const O=l[E.id],_=p[E.id]||0,G=o(E.requirements),he={metal:E.baseCost.metal*(_||1),crystal:E.baseCost.crystal*(_||1),deuterium:E.baseCost.deuterium*(_||1)},Z=s.metal>=he.metal&&s.crystal>=he.crystal&&s.deuterium>=he.deuterium,ie=E.buildTime*1e3/(g+1),ge=Math.max(1,Math.floor(ie*(_||1)/1e3));return r.jsxs("div",{className:`bg-[#1c2136] border border-white/10 rounded-xl overflow-hidden group hover:border-primary/50 transition-all duration-300 relative ${G?"":"opacity-50"}`,children:[r.jsxs("div",{className:"absolute top-3 right-3 z-10 bg-black/60 backdrop-blur px-2 py-0.5 rounded text-xs text-[#929bc9] border border-white/10",children:["Posiadasz: ",r.jsx("span",{className:"text-white font-bold",children:O})]}),r.jsxs("div",{className:"h-40 lg:h-32 bg-cover bg-center relative",style:{backgroundImage:`url("${E.image}")`},children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#1c2136] to-transparent"}),!G&&r.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-grayscale"})]}),r.jsxs("div",{className:"p-5 lg:p-3 relative",children:[r.jsxs("div",{className:"flex justify-between items-start mb-2",children:[r.jsx("h4",{className:"text-white text-xl font-bold",children:E.name}),r.jsxs("div",{className:"flex flex-col gap-1 text-[10px] items-end",children:[r.jsxs("span",{className:"bg-red-500/10 text-red-400 px-1.5 py-0.5 rounded border border-red-500/20 whitespace-nowrap min-w-[80px] text-center",children:["Atak ",E.attack]}),r.jsxs("span",{className:"bg-blue-500/10 text-blue-400 px-1.5 py-0.5 rounded border border-blue-500/20 whitespace-nowrap min-w-[80px] text-center",children:["Obrona ",E.defense]}),r.jsxs("span",{className:"bg-green-500/10 text-green-400 px-1.5 py-0.5 rounded border border-green-500/20 whitespace-nowrap min-w-[80px] text-center",children:["adowno ",E.capacity]})]})]}),r.jsx("p",{className:"text-[#929bc9] text-xs mb-4 line-clamp-2 h-8",children:E.description}),E.bonuses&&Object.keys(E.bonuses).length>0&&r.jsxs("div",{className:"mb-3 text-[10px] text-[#929bc9]",children:[r.jsx("span",{className:"font-bold text-white uppercase block mb-1",children:"Silny przeciwko:"}),r.jsx("div",{className:"flex flex-wrap gap-1",children:Object.keys(E.bonuses).map(je=>{var Ue,Ce;return r.jsx("span",{className:"bg-primary/10 text-primary border border-primary/20 px-1.5 py-0.5 rounded flex items-center gap-1",children:((Ue=Je[je])==null?void 0:Ue.name)||((Ce=Ka[je])==null?void 0:Ce.name)||je},je)})})]}),G?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-4 p-3 bg-[#111422] rounded-lg border border-white/5",children:[r.jsxs("div",{className:`flex flex-col text-xs ${s.metal<E.baseCost.metal?"text-red-400":"text-[#929bc9]"}`,children:[r.jsx("span",{className:"uppercase text-[10px] tracking-wider",children:"Metal"}),r.jsx("span",{className:"font-mono text-white",children:E.baseCost.metal.toLocaleString()})]}),r.jsxs("div",{className:`flex flex-col text-xs ${s.crystal<E.baseCost.crystal?"text-red-400":"text-[#929bc9]"}`,children:[r.jsx("span",{className:"uppercase text-[10px] tracking-wider",children:"Kryszta"}),r.jsx("span",{className:"font-mono text-white",children:E.baseCost.crystal.toLocaleString()})]}),r.jsxs("div",{className:`flex flex-col text-xs ${s.deuterium<E.baseCost.deuterium?"text-red-400":"text-[#929bc9]"}`,children:[r.jsx("span",{className:"uppercase text-[10px] tracking-wider",children:"Deuter"}),r.jsx("span",{className:"font-mono text-white",children:E.baseCost.deuterium.toLocaleString()})]})]}),r.jsx("div",{className:"flex items-center justify-between mb-3 text-xs text-[#929bc9]",children:r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"schedule"})," ",Ma(ge)," (x",_||1,")"]})}),r.jsxs("div",{className:"flex items-center gap-2 mt-4",children:[r.jsxs("div",{className:"flex items-center bg-[#111422] rounded-lg border border-white/10 overflow-hidden shadow-sm",children:[r.jsx("button",{onClick:()=>C(E.id,Math.max(0,_-1).toString()),className:"w-10 h-10 flex items-center justify-center text-[#929bc9] hover:text-white hover:bg-white/5 active:bg-white/10 transition-colors border-r border-white/5",children:r.jsx("span",{className:"material-symbols-outlined text-base",children:"remove"})}),r.jsx("input",{type:"number",min:"0",placeholder:"0",value:p[E.id]>0?p[E.id]:"",onChange:je=>C(E.id,je.target.value),className:"w-16 bg-transparent text-white text-sm text-center focus:outline-none appearance-none font-mono font-bold"}),r.jsx("button",{onClick:()=>C(E.id,(_+1).toString()),className:"w-10 h-10 flex items-center justify-center text-[#929bc9] hover:text-white hover:bg-white/5 active:bg-white/10 transition-colors border-l border-white/5",children:r.jsx("span",{className:"material-symbols-outlined text-base",children:"add"})})]}),r.jsx("button",{onClick:()=>{const je=Math.floor(s.metal/E.baseCost.metal),Ue=E.baseCost.crystal>0?Math.floor(s.crystal/E.baseCost.crystal):1/0,Ce=E.baseCost.deuterium>0?Math.floor(s.deuterium/E.baseCost.deuterium):1/0,Ge=Math.min(je,Ue,Ce);C(E.id,Ge.toString())},className:"h-10 px-3 rounded-lg bg-[#232948] text-[#929bc9] text-xs font-bold uppercase border border-white/5 hover:bg-primary/20 hover:text-primary hover:border-primary/30 transition-all active:scale-95",children:"Max"}),r.jsxs("button",{onClick:()=>z(E),disabled:_<=0||!Z,className:`flex-1 h-10 rounded-lg text-sm font-bold uppercase transition-all shadow-lg flex items-center justify-center gap-2 active:scale-95
                                                ${_>0&&Z?"bg-primary hover:bg-blue-600 text-white shadow-primary/20":"bg-[#232948] text-[#929bc9] cursor-not-allowed opacity-50"}
                                            `,children:[r.jsx("span",{className:"material-symbols-outlined text-lg",children:"precision_manufacturing"}),r.jsx("span",{children:"Produkuj"})]})]})]}):r.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg",children:[r.jsx("p",{className:"text-red-400 text-xs font-bold mb-1",children:"Wymagane technologie:"}),r.jsx("div",{className:"flex flex-col gap-1",children:(we=E.requirements)==null?void 0:we.map((je,Ue)=>{const Ce=je.type==="building"?ts[je.id].name:Ar[je.id].name,Ge=je.type==="building"?d[je.id]:h[je.id];return r.jsxs("div",{className:`text-xs ${Ge>=je.level?"text-green-400":"text-red-400/70"}`,children:["- ",Ce," (Lvl ",je.level,")"]},Ue)})})]})]})]},E.id)})})]})},nv=()=>{const{planetName:l,ships:s,sendSpyProbe:n,sendAttack:o,sendTransport:d,sendColonize:h,planets:f,resources:b,galaxyCoords:g,mainPlanetCoords:p,planetType:v,getPlayersInSystem:x,userId:N,buildings:j,currentPlanetId:C,mainPlanetName:z,level:M,debris:E}=ua(),[O,_]=ee.useState({galaxy:(g==null?void 0:g.galaxy)||1,system:(g==null?void 0:g.system)||1}),[G,he]=ee.useState([]),[Z,ie]=ee.useState(null),[ge,we]=ee.useState(null),[je,Ue]=ee.useState(null),[Ce,Ge]=ee.useState(null),[qe,ye]=ee.useState({}),[S,V]=ee.useState({metal:0,crystal:0,deuterium:0}),[ne,pe]=ee.useState(1),[Te,A]=ee.useState(null),[Q,fe]=ee.useState({metal:0,crystal:0,deuterium:0}),[be,Ne]=ee.useState(null);_i.useEffect(()=>{x(O.galaxy,O.system).then(he)},[O.galaxy,O.system,x]);const Le=ce=>{var ut,Ht,it,ha,fa;const re=p||g;if(re&&O.galaxy===re.galaxy&&O.system===re.system&&re.position===ce){const Dt=v==="ice"?"Lodowa":v==="desert"?"Pustynna":"Ziemiopodobna";return{name:C?z||"Gwna":l,player:"Ty",rank:M||1,img:kr[v]||Be.planet,type:Dt,isPlayer:!0,activity:"",isSelected:!C,debris:E||{metal:0,crystal:0}}}const Ie=f.find(Dt=>{var ma,Zt,Or;return((ma=Dt.galaxy_coords)==null?void 0:ma.galaxy)===O.galaxy&&((Zt=Dt.galaxy_coords)==null?void 0:Zt.system)===O.system&&((Or=Dt.galaxy_coords)==null?void 0:Or.position)===ce});if(Ie){const Dt=Ie.planet_type==="ice"?"Lodowa":Ie.planet_type==="desert"?"Pustynna":"Ziemiopodobna";return{name:Ie.planet_name||"Kolonia",player:"Ty (Kolonia)",rank:M||1,img:kr[Ie.planet_type]||Be.planet,type:Dt,isPlayer:!0,isColony:!0,colonyId:Ie.id,activity:"",debris:Ie.debris||{metal:0,crystal:0}}}const Ye=G.find(Dt=>{var ma;return((ma=Dt.galaxy_coords)==null?void 0:ma.position)===ce&&Dt.id!==N});if(Ye){const Dt=((ut=Ye.production_settings)==null?void 0:ut.planetType)==="ice"?"Lodowa":((Ht=Ye.production_settings)==null?void 0:Ht.planetType)==="desert"?"Pustynna":"Ziemiopodobna";(it=Ye.production_settings)!=null&&it.avatarUrl;const ma=Ye.level||1;return{name:Ye.planet_name||"Nieznana Kolonia",player:((ha=Ye.production_settings)==null?void 0:ha.nickname)||"Gracz",rank:ma,img:kr[(fa=Ye.production_settings)==null?void 0:fa.planetType]||Be.planet,type:Dt,isPlayer:!1,isBot:!1,activity:"",debris:Ye.debris||{metal:0,crystal:0}}}return null},Xe=ce=>{const re=Le(ce);re&&(we({galaxy:O.galaxy,system:O.system,pos:ce,name:re.name}),pe(1),Ne(null))},zt=async()=>{if(!ge)return;await n(ne,{galaxy:O.galaxy,system:O.system,position:ge.pos})!==!1?(Ne("Wysyanie sond..."),setTimeout(()=>{O.galaxy===1&&O.system===1&&ge.pos===2&&ie({metal:Math.floor(Math.random()*5e4)+1e4,crystal:Math.floor(Math.random()*3e4)+5e3,deuterium:Math.floor(Math.random()*1e4)+2e3,energy:4e3,ships:Math.floor(Math.random()*50),defense:Math.floor(Math.random()*20)}),we(null)},1500)):Ne("Brak wystarczajcej iloci sond!")},ft=ce=>{_(re=>{const Ie=re.system+ce;return Ie<1||Ie>499?re:{...re,system:Ie}})},He=ce=>{_(re=>{const Ie=re.galaxy+ce;return Ie<1||Ie>9?re:{...re,galaxy:Ie}})},Mt=Array.from({length:15},(ce,re)=>re+1),lt=s[ue.ESPIONAGE_PROBE]||0;return r.jsxs("div",{className:"flex flex-col gap-6 pb-20 relative min-h-full",children:[r.jsxs("div",{className:"absolute top-20 left-1/2 -translate-x-1/2 pointer-events-none z-0 opacity-40 w-full flex justify-center overflow-hidden",children:[r.jsx("div",{className:"w-[600px] h-[600px] rounded-full bg-yellow-500/20 blur-[120px] -translate-y-1/2"}),r.jsx("div",{className:"absolute top-0 w-[300px] h-[300px] rounded-full bg-orange-500/10 blur-[60px] animate-pulse -translate-y-1/2"})]}),r.jsx("div",{className:"bg-[#1c2136] p-4 rounded-xl border border-white/10 shadow-lg sticky top-0 z-20 backdrop-blur-md bg-opacity-90",children:r.jsx("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:r.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[r.jsxs("div",{className:"flex-1 flex flex-col gap-1",children:[r.jsx("span",{className:"text-[10px] uppercase font-bold text-[#929bc9] tracking-wider text-center",children:"Galaktyka"}),r.jsxs("div",{className:"flex items-center h-10 md:h-12 bg-[#111422] rounded-lg border border-white/10 overflow-hidden",children:[r.jsx("button",{onClick:()=>He(-1),className:"w-8 md:w-12 h-full hover:bg-white/5 active:bg-white/10 flex items-center justify-center text-[#929bc9]",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"chevron_left"})}),r.jsx("div",{className:"flex-1 text-center font-mono font-bold text-lg md:text-xl text-white",children:O.galaxy}),r.jsx("button",{onClick:()=>He(1),className:"w-8 md:w-12 h-full hover:bg-white/5 active:bg-white/10 flex items-center justify-center text-[#929bc9]",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"chevron_right"})})]})]}),r.jsxs("div",{className:"flex-1 flex flex-col gap-1",children:[r.jsx("span",{className:"text-[10px] uppercase font-bold text-[#929bc9] tracking-wider text-center",children:"Ukad"}),r.jsxs("div",{className:"flex items-center h-10 md:h-12 bg-[#111422] rounded-lg border border-white/10 overflow-hidden",children:[r.jsx("button",{onClick:()=>ft(-1),className:"w-8 md:w-12 h-full hover:bg-white/5 active:bg-white/10 flex items-center justify-center text-[#929bc9]",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"chevron_left"})}),r.jsx("div",{className:"flex-1 text-center font-mono font-bold text-lg md:text-xl text-white",children:O.system}),r.jsx("button",{onClick:()=>ft(1),className:"w-8 md:w-12 h-full hover:bg-white/5 active:bg-white/10 flex items-center justify-center text-[#929bc9]",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"chevron_right"})})]})]})]})})}),r.jsx("div",{className:"flex flex-col gap-3 relative z-10",children:Mt.map(ce=>{const re=Le(ce);return r.jsxs("div",{className:`relative flex items-center gap-2 md:gap-3 p-2 md:p-3 rounded-xl border transition-all ${re!=null&&re.isPlayer?"bg-[#1a2342] border-primary/40 shadow-[0_0_15px_rgba(59,130,246,0.15)]":"bg-[#1c2136] border-white/5 hover:border-white/20"}`,children:[r.jsx("div",{className:"flex flex-col items-center justify-center w-6 md:w-8 text-[#929bc9] font-mono text-xs md:text-sm opacity-50",children:ce}),r.jsx("div",{className:"shrink-0",children:re?r.jsxs("div",{className:"w-10 h-10 md:w-12 md:h-12 rounded-full shadow-lg relative overflow-hidden bg-black/20",children:[r.jsx("img",{src:re.img,alt:"Planet",className:"w-full h-full object-cover"}),r.jsx("div",{className:"absolute inset-0 rounded-full bg-black/10"}),r.jsx("div",{className:"absolute -inset-1 rounded-full border border-white/10 opacity-50"})]}):r.jsx("div",{className:"w-10 h-10 md:w-12 md:h-12 rounded-full border-2 border-dashed border-white/10 flex items-center justify-center opacity-20",children:r.jsx("span",{className:"material-symbols-outlined text-white text-base",children:"add"})})}),r.jsx("div",{className:"flex-1 min-w-0",children:re?r.jsxs("div",{className:"flex flex-col justify-center",children:[r.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[r.jsx("span",{className:`font-bold text-sm md:text-base truncate ${re.isPlayer?"text-primary":re.isBot?"text-red-400":"text-white"}`,children:re.name}),r.jsxs("span",{className:"text-[#929bc9] text-sm",children:["(",re.player,")"]}),re.activity&&r.jsx("span",{className:"text-[9px] text-red-400",children:"(*)"})]}),re.rank&&r.jsxs("div",{className:"text-xs text-green-400 font-mono",children:["Level ",re.rank]}),re.debris&&((re.debris.metal||0)>0||(re.debris.crystal||0)>0)&&r.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-orange-400 mt-1",title:`Pole Zniszcze: Metal ${re.debris.metal||0}, Kryszta ${re.debris.crystal||0}`,children:[r.jsx("span",{className:"material-symbols-outlined text-[10px]",children:"recycling"}),r.jsxs("span",{children:["M:",((re.debris.metal||0)/1e3).toFixed(1),"k C:",((re.debris.crystal||0)/1e3).toFixed(1),"k"]})]})]}):r.jsx("span",{className:"text-white/20 text-xs md:text-sm italic",children:"Pusta przestrze"})}),r.jsx("div",{className:"flex items-center gap-1",children:re?r.jsxs("div",{className:"flex gap-1",children:[re.debris&&((re.debris.metal||0)>0||(re.debris.crystal||0)>0)&&r.jsx("button",{onClick:()=>{console.log("Open Recycle Modal")},className:"w-8 h-8 rounded bg-white/5 hover:bg-orange-500/20 hover:text-orange-400 text-[#929bc9] flex items-center justify-center border border-white/5 transition-colors",title:"Recykling (Wymaga Recyklera)",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"recycling"})}),re.isPlayer&&!re.isSelected?r.jsx("button",{onClick:()=>{Ge({galaxy:O.galaxy,system:O.system,pos:ce,name:re.name}),ye({}),V({metal:0,crystal:0,deuterium:0}),Ne(null)},className:"w-8 h-8 rounded bg-white/5 hover:bg-blue-500/20 hover:text-blue-400 text-[#929bc9] flex items-center justify-center border border-white/5 transition-colors",title:"Transportuj Surowce",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"local_shipping"})}):!re.isPlayer&&!re.isBot?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>Xe(ce),className:"w-8 h-8 rounded bg-white/5 hover:bg-purple-500/20 hover:text-purple-400 text-[#929bc9] flex items-center justify-center border border-white/5 transition-colors",title:"Szpieguj",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"visibility"})}),r.jsx("button",{onClick:()=>{Ue({galaxy:O.galaxy,system:O.system,pos:ce,name:re.name}),ye({}),Ne(null)},className:"w-8 h-8 rounded bg-white/5 hover:bg-red-500/20 hover:text-red-400 text-[#929bc9] flex items-center justify-center border border-white/5 transition-colors",title:"Atakuj",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"swords"})}),r.jsx("button",{onClick:()=>{Ge({galaxy:O.galaxy,system:O.system,pos:ce,name:re.name}),ye({}),V({metal:0,crystal:0,deuterium:0}),Ne(null)},className:"w-8 h-8 rounded bg-white/5 hover:bg-blue-500/20 hover:text-blue-400 text-[#929bc9] flex items-center justify-center border border-white/5 transition-colors",title:"Transportuj",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"local_shipping"})})]}):re.isBot&&r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>Xe(ce),className:"w-8 h-8 rounded bg-white/5 hover:bg-purple-500/20 hover:text-purple-400 text-[#929bc9] flex items-center justify-center border border-white/5 transition-colors",title:"Szpieguj",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"visibility"})}),r.jsx("button",{onClick:()=>{Ue({galaxy:O.galaxy,system:O.system,pos:ce,name:re.name}),ye({}),Ne(null)},className:"w-8 h-8 rounded bg-white/5 hover:bg-red-500/20 hover:text-red-400 text-[#929bc9] flex items-center justify-center border border-white/5 transition-colors",title:"Atakuj",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"swords"})})]})]}):r.jsx("button",{onClick:()=>{if((s[ue.COLONY_SHIP]||0)<1){alert("Potrzebujesz Statku Kolonizacyjnego!");return}if(f.length>=8){alert("Osigne limit 8 planet!");return}A({galaxy:O.galaxy,system:O.system,pos:ce}),fe({metal:0,crystal:0,deuterium:0})},className:"w-8 h-8 rounded bg-white/5 hover:bg-green-500/20 hover:text-green-400 text-[#929bc9] flex items-center justify-center border border-white/5 transition-colors",title:`Kolonizuj (Masz: ${s[ue.COLONY_SHIP]||0} statkw kolonizacyjnych)`,children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"flag"})})})]},ce)})}),ge&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",children:r.jsxs("div",{className:"bg-[#1c2136] w-full max-w-sm rounded-xl border border-purple-500/50 shadow-2xl p-6 relative",children:[r.jsx("button",{onClick:()=>we(null),className:"absolute top-4 right-4 text-[#929bc9] hover:text-white",children:r.jsx("span",{className:"material-symbols-outlined",children:"close"})}),r.jsxs("div",{className:"flex items-center gap-3 mb-6 border-b border-white/10 pb-4",children:[r.jsx("span",{className:"material-symbols-outlined text-purple-400 text-3xl",children:"visibility"}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-bold text-white",children:"Wylij Sondy"}),r.jsxs("p",{className:"text-xs text-[#929bc9]",children:["Cel: ",ge.name," [",ge.galaxy,":",ge.system,":",ge.pos,"]"]})]})]}),be?r.jsx("div",{className:"text-center py-4",children:r.jsx("p",{className:`text-lg font-bold ${be.includes("Wysyanie")?"text-green-400":"text-red-400"}`,children:be})}):r.jsxs("div",{className:"flex flex-col gap-4",children:[r.jsxs("div",{className:"bg-[#111422] p-4 rounded-lg border border-white/5 text-center",children:[r.jsx("p",{className:"text-sm text-[#929bc9] mb-2",children:"Dostpne sondy"}),r.jsx("p",{className:"text-2xl font-mono text-white font-bold",children:lt})]}),r.jsxs("div",{className:"flex items-center bg-[#111422] rounded-lg border border-white/10 overflow-hidden",children:[r.jsx("button",{onClick:()=>pe(Math.max(1,ne-1)),className:"w-12 h-12 flex items-center justify-center text-[#929bc9] hover:bg-white/5",children:r.jsx("span",{className:"material-symbols-outlined",children:"remove"})}),r.jsx("input",{type:"number",className:"flex-1 bg-transparent text-center text-white font-bold text-lg focus:outline-none",value:ne,onFocus:ce=>ce.target.select(),onChange:ce=>pe(Math.min(lt,Math.max(1,parseInt(ce.target.value)||1))),max:lt}),r.jsx("button",{onClick:()=>pe(Math.min(lt,ne+1)),className:"w-12 h-12 flex items-center justify-center text-[#929bc9] hover:bg-white/5",children:r.jsx("span",{className:"material-symbols-outlined",children:"add"})})]}),r.jsx("button",{onClick:zt,disabled:lt<1,className:`w-full py-3 rounded-lg font-bold uppercase tracking-widest transition-colors ${lt>0?"bg-purple-600 hover:bg-purple-500 text-white":"bg-[#232948] text-white/20 cursor-not-allowed"}`,children:"Wylij Flot"})]})]})}),je&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",children:r.jsxs("div",{className:"bg-[#1c2136] w-full max-w-lg rounded-xl border border-red-500/50 shadow-2xl p-6 relative max-h-[90vh] overflow-y-auto",children:[r.jsx("button",{onClick:()=>Ue(null),className:"absolute top-4 right-4 text-[#929bc9] hover:text-white",children:r.jsx("span",{className:"material-symbols-outlined",children:"close"})}),r.jsxs("div",{className:"flex items-center gap-3 mb-6 border-b border-white/10 pb-4",children:[r.jsx("span",{className:"material-symbols-outlined text-red-500 text-3xl",children:"swords"}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-bold text-white",children:"Rozpocznij Atak"}),r.jsxs("p",{className:"text-xs text-[#929bc9]",children:["Cel: ",je.name," [",je.galaxy,":",je.system,":",je.pos,"]"]})]})]}),be?r.jsxs("div",{className:"text-center py-8",children:[r.jsx("p",{className:`text-xl font-bold ${be.includes("Wysyanie")?"text-green-400":"text-red-400"}`,children:be}),be.includes("Wysyanie")&&r.jsx("p",{className:"text-sm text-[#929bc9] mt-2",children:"Flota dotrze do celu za 5 minut."})]}):r.jsxs("div",{className:"flex flex-col gap-4",children:[r.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[Object.entries(s).map(([ce,re])=>{var Ye;if(re<=0||ce==="solarSatellite"||ce==="crawlers")return null;const Ie=qe[ce]||0;return r.jsxs("div",{className:"flex items-center justify-between bg-[#111422] p-3 rounded-lg border border-white/5",children:[r.jsx("span",{className:"text-sm text-[#929bc9] font-bold capitalize",children:(Ye=Je[ce])==null?void 0:Ye.name}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"text-xs text-[#555a7a] mr-2",children:["Dostpne: ",re]}),r.jsx("input",{type:"number",max:re,min:0,value:Ie,onFocus:ut=>ut.target.select(),onChange:ut=>{const Ht=Math.min(re,Math.max(0,parseInt(ut.target.value)||0));ye(it=>({...it,[ce]:Ht}))},className:"w-20 bg-black/20 border border-white/10 rounded px-2 py-1 text-right text-white focus:outline-none focus:border-red-500"}),r.jsx("button",{onClick:()=>ye(ut=>({...ut,[ce]:re})),className:"text-xs text-red-400 hover:text-white px-2 uppercase font-bold",children:"Max"})]})]},ce)}),Object.values(s).every(ce=>!ce)&&r.jsx("p",{className:"text-center text-white/20 italic",children:"Brak dostpnych statkw bojowych."})]}),r.jsx("button",{onClick:()=>{if(!Object.values(qe).some(re=>re>0)){Ne("Wybierz przynajmniej jeden statek!");return}o(qe,{galaxy:O.galaxy,system:O.system,position:je.pos}),Ne("Wysyanie floty..."),setTimeout(()=>Ue(null),2e3)},className:"w-full py-4 mt-2 bg-gradient-to-r from-red-600 to-red-800 hover:from-red-500 hover:to-red-700 text-white font-bold uppercase tracking-widest rounded-lg shadow-lg shadow-red-900/20 transition-all active:scale-95",children:"Wylij Atak"})]})]})}),Ce&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",children:r.jsxs("div",{className:"bg-[#1c2136] w-full max-w-lg rounded-xl border border-blue-500/50 shadow-2xl p-6 relative max-h-[90vh] overflow-y-auto",children:[r.jsx("button",{onClick:()=>Ge(null),className:"absolute top-4 right-4 text-[#929bc9] hover:text-white",children:r.jsx("span",{className:"material-symbols-outlined",children:"close"})}),r.jsxs("div",{className:"flex items-center gap-3 mb-6 border-b border-white/10 pb-4",children:[r.jsx("span",{className:"material-symbols-outlined text-blue-500 text-3xl",children:"local_shipping"}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-bold text-white",children:"Transportuj Surowce"}),r.jsxs("p",{className:"text-xs text-[#929bc9]",children:["Cel: ",Ce.name," [",Ce.galaxy,":",Ce.system,":",Ce.pos,"]"]})]})]}),be?r.jsxs("div",{className:"text-center py-8",children:[r.jsx("p",{className:`text-xl font-bold ${be.includes("Wysyanie")?"text-green-400":"text-blue-400"}`,children:be}),be.includes("Wysyanie")&&r.jsx("p",{className:"text-sm text-[#929bc9] mt-2",children:"Dostawa dotrze za 5 minut."})]}):r.jsxs("div",{className:"flex flex-col gap-6",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-bold text-white mb-2",children:"Wybierz Statki"}),r.jsxs("div",{className:"grid grid-cols-1 gap-2 bg-[#111422] p-2 rounded-lg border border-white/5",children:[Object.entries(s).map(([ce,re])=>{var Ye;if(re<=0||ce==="solarSatellite"||ce==="crawlers"||ce==="espionageProbe")return null;const Ie=qe[ce]||0;return r.jsxs("div",{className:"flex items-center justify-between p-2 rounded hover:bg-white/5",children:[r.jsx("span",{className:"text-xs text-[#929bc9] font-bold capitalize",children:(Ye=Je[ce])==null?void 0:Ye.name}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"text-[10px] text-[#555a7a] mr-1",children:["Max: ",re]}),r.jsx("input",{type:"number",max:re,min:0,value:Ie,onFocus:ut=>ut.target.select(),onChange:ut=>{const Ht=Math.min(re,Math.max(0,parseInt(ut.target.value)||0));ye(it=>({...it,[ce]:Ht}))},className:"w-16 bg-black/20 border border-white/10 rounded px-1 py-1 text-right text-xs text-white focus:outline-none focus:border-blue-500"}),r.jsx("button",{onClick:()=>ye(ut=>({...ut,[ce]:re})),className:"text-[10px] text-blue-400 hover:text-white px-1 font-bold",children:"ALL"})]})]},ce)}),Object.values(s).every(ce=>!ce)&&r.jsx("p",{className:"text-center text-white/20 italic text-xs",children:"Brak dostpnych transporterw."})]})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between items-end mb-2",children:[r.jsx("h4",{className:"text-sm font-bold text-white",children:"Zaaduj Surowce"}),r.jsxs("span",{className:`text-xs font-mono ${S.metal+S.crystal+S.deuterium>Object.entries(qe).reduce((ce,[re,Ie])=>{var Ye;return ce+Ie*(((Ye=Je[re])==null?void 0:Ye.capacity)||0)},0)?"text-red-400":"text-blue-400"}`,children:["adowno: ",(S.metal+S.crystal+S.deuterium).toLocaleString()," / ",Object.entries(qe).reduce((ce,[re,Ie])=>{var Ye;return ce+Ie*(((Ye=Je[re])==null?void 0:Ye.capacity)||0)},0).toLocaleString()]})]}),r.jsx("div",{className:"flex flex-col gap-2",children:["metal","crystal","deuterium"].map(ce=>{const re=ce,Ie=Object.entries(qe).reduce((it,[ha,fa])=>{var Dt;return it+fa*(((Dt=Je[ha])==null?void 0:Dt.capacity)||0)},0),ut=S.metal+S.crystal+S.deuterium-(S[re]||0),Ht=Math.max(0,Ie-ut);return Math.min(b[re]||0,Ht),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-20 text-xs uppercase font-bold text-[#929bc9]",children:ce==="metal"?"Metal":ce==="crystal"?"Kryszta":"Deuter"}),r.jsxs("div",{className:"flex-1 relative",children:[r.jsx("input",{type:"number",value:S[re]||0,onFocus:it=>it.target.select(),onChange:it=>{const ha=Math.max(0,parseInt(it.target.value)||0);V(fa=>({...fa,[re]:ha}))},className:`w-full bg-[#111422] border rounded px-3 py-2 text-white font-mono text-sm focus:border-blue-500 outline-none ${S[re]>(b[re]||0)?"border-red-500 text-red-400":"border-white/10"}`,placeholder:"0"}),r.jsx("button",{onClick:()=>V(it=>{const ha=it[re],fa=it.metal+it.crystal+it.deuterium-ha,Dt=Math.max(0,Ie-fa),ma=Math.min(b[re]||0,Dt);return{...it,[re]:ma}}),className:"absolute right-2 top-1/2 -translate-y-1/2 text-[10px] text-blue-400 hover:text-white font-bold uppercase",children:"MAX"})]}),r.jsxs("div",{className:"text-[10px] text-[#929bc9] w-16 text-right",children:["/ ",(b[re]||0).toLocaleString()]})]},ce)})})]}),r.jsx("button",{onClick:()=>{if(!Object.values(qe).some(Ye=>Ye>0)){Ne("Wybierz statki transportowe!");return}const re=S.metal+S.crystal+S.deuterium,Ie=Object.entries(qe).reduce((Ye,[ut,Ht])=>{var it;return Ye+Ht*(((it=Je[ut])==null?void 0:it.capacity)||0)},0);if(re>Ie){Ne(`Przeadowanie! (Limit: ${Ie.toLocaleString()})`);return}d(qe,S,{galaxy:O.galaxy,system:O.system,position:Ce.pos}),Ne("Wysyanie floty transportowej..."),setTimeout(()=>Ge(null),2e3)},className:"w-full py-4 bg-gradient-to-r from-blue-600 to-blue-800 hover:from-blue-500 hover:to-blue-700 text-white font-bold uppercase tracking-widest rounded-lg shadow-lg shadow-blue-900/20 transition-all active:scale-95",children:"Wylij Transport"})]})]})}),Z&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",children:r.jsxs("div",{className:"bg-[#1c2136] w-full max-w-md rounded-xl border border-purple-500/50 shadow-2xl p-6 relative",children:[r.jsx("button",{onClick:()=>ie(null),className:"absolute top-4 right-4 text-[#929bc9] hover:text-white",children:r.jsx("span",{className:"material-symbols-outlined",children:"close"})}),r.jsxs("div",{className:"flex items-center gap-3 mb-6 border-b border-white/10 pb-4",children:[r.jsx("span",{className:"material-symbols-outlined text-purple-400 text-3xl",children:"description"}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-bold text-white",children:"Raport Szpiegowski"}),r.jsx("p",{className:"text-xs text-[#929bc9]",children:"Baza Piracka [1:1:2]"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[r.jsxs("div",{className:"bg-[#111422] p-3 rounded-lg border border-white/5",children:[r.jsx("span",{className:"text-[10px] uppercase font-bold text-[#929bc9]",children:"Surowce"}),r.jsxs("div",{className:"flex flex-col gap-1 mt-2 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-[#929bc9]",children:"Metal"})," ",r.jsx("span",{className:"text-white font-mono",children:Z.metal.toLocaleString()})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-[#929bc9]",children:"Kryszta"})," ",r.jsx("span",{className:"text-white font-mono",children:Z.crystal.toLocaleString()})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-[#929bc9]",children:"Deuter"})," ",r.jsx("span",{className:"text-white font-mono",children:Z.deuterium.toLocaleString()})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-[#929bc9]",children:"Energia"})," ",r.jsx("span",{className:"text-white font-mono",children:Z.energy.toLocaleString()})]})]})]}),r.jsxs("div",{className:"bg-[#111422] p-3 rounded-lg border border-white/5",children:[r.jsx("span",{className:"text-[10px] uppercase font-bold text-[#929bc9]",children:"Flota i Obrona"}),r.jsxs("div",{className:"flex flex-col gap-1 mt-2 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-[#929bc9]",children:"Statki"})," ",r.jsx("span",{className:"text-red-400 font-mono font-bold",children:Z.ships})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-[#929bc9]",children:"Obrona"})," ",r.jsx("span",{className:"text-blue-400 font-mono font-bold",children:Z.defense})]})]})]})]}),r.jsx("button",{onClick:()=>ie(null),className:"w-full py-3 bg-purple-600 hover:bg-purple-500 text-white font-bold rounded-lg transition-colors",children:"Zamknij Raport"})]})}),Te&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",children:r.jsxs("div",{className:"bg-[#1c2136] w-full max-w-md rounded-xl border border-green-500/50 shadow-2xl p-6 relative",children:[r.jsx("button",{onClick:()=>A(null),className:"absolute top-4 right-4 text-[#929bc9] hover:text-white",children:r.jsx("span",{className:"material-symbols-outlined",children:"close"})}),r.jsxs("div",{className:"flex items-center gap-3 mb-6 border-b border-white/10 pb-4",children:[r.jsx("span",{className:"material-symbols-outlined text-green-400 text-3xl",children:"flag"}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-bold text-white",children:"Kolonizuj Planet"}),r.jsxs("p",{className:"text-xs text-[#929bc9]",children:["[",Te.galaxy,":",Te.system,":",Te.pos,"]"]})]})]}),r.jsxs("div",{className:"bg-[#111422] p-4 rounded-lg border border-white/5 mb-4",children:[r.jsx("p",{className:"text-sm text-[#929bc9] mb-2",children:"Statek Kolonizacyjny zostanie zuyty."}),r.jsxs("p",{className:"text-xs text-green-400",children:["Posiadasz: ",s[ue.COLONY_SHIP]||0," statkw kolonizacyjnych"]}),r.jsxs("p",{className:"text-xs text-yellow-400 mt-1",children:["Planety: ",f.length,"/8"]})]}),r.jsxs("div",{className:"mb-4",children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsx("p",{className:"text-sm font-bold text-white",children:"Wylij surowce z now koloni:"}),r.jsx("button",{onClick:()=>fe({metal:Math.min(b.metal,15e3),crystal:Math.min(b.crystal,15e3),deuterium:Math.min(b.deuterium,15e3)}),className:"px-2 py-1 bg-green-600/20 hover:bg-green-600/40 text-green-400 text-xs font-bold rounded border border-green-500/30",children:"MAX (15k)"})]}),r.jsx("p",{className:"text-xs text-yellow-400 mb-3",children:"Limit: 15,000 kadego surowca"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-[#929bc9] text-xs w-16",children:"Metal:"}),r.jsx("input",{type:"number",min:"0",max:"15000",value:Q.metal,onFocus:ce=>ce.target.select(),onChange:ce=>fe(re=>({...re,metal:Math.min(15e3,Math.max(0,parseInt(ce.target.value)||0))})),className:"flex-1 bg-[#111422] border border-white/10 rounded px-2 py-1 text-white text-sm"}),r.jsx("span",{className:"text-gray-500 text-xs",children:"/ 15k"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-[#929bc9] text-xs w-16",children:"Kryszta:"}),r.jsx("input",{type:"number",min:"0",max:"15000",value:Q.crystal,onFocus:ce=>ce.target.select(),onChange:ce=>fe(re=>({...re,crystal:Math.min(15e3,Math.max(0,parseInt(ce.target.value)||0))})),className:"flex-1 bg-[#111422] border border-white/10 rounded px-2 py-1 text-white text-sm"}),r.jsx("span",{className:"text-gray-500 text-xs",children:"/ 15k"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-[#929bc9] text-xs w-16",children:"Deuter:"}),r.jsx("input",{type:"number",min:"0",max:"15000",value:Q.deuterium,onFocus:ce=>ce.target.select(),onChange:ce=>fe(re=>({...re,deuterium:Math.min(15e3,Math.max(0,parseInt(ce.target.value)||0))})),className:"flex-1 bg-[#111422] border border-white/10 rounded px-2 py-1 text-white text-sm"}),r.jsx("span",{className:"text-gray-500 text-xs",children:"/ 15k"})]})]})]}),r.jsxs("button",{onClick:async()=>{const ce={galaxy:Te.galaxy,system:Te.system,position:Te.pos};console.log(" [COLONIZE] Sending to coords:",ce),await h(ce,Q)&&(A(null),Ne(" Nowa kolonia zaoona!"))},className:"w-full py-3 bg-green-600 hover:bg-green-500 text-white font-bold rounded-lg transition-colors flex items-center justify-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined",children:"rocket_launch"}),"Kolonizuj!"]})]})})]})},iv=()=>{const{research:l,buildings:s,resources:n,upgradeResearch:o,getCost:d,constructionQueue:h,checkRequirements:f}=ua(),[b,g]=ee.useState(""),p=Object.values(Ar),v=s[oe.RESEARCH_LAB],x=h.find(j=>j.type==="research"),N=100;return ee.useEffect(()=>{if(!x){g("");return}const j=()=>{const z=Date.now(),M=Math.max(0,Math.floor((x.endTime-z)/1e3));g(Ma(M))};j();const C=setInterval(j,1e3);return()=>clearInterval(C)},[x]),r.jsxs("div",{className:"flex flex-col gap-6",children:[r.jsxs("div",{className:"flex items-center justify-between border-b border-white/10 pb-4",children:[r.jsxs("h2",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[r.jsx("span",{className:"material-symbols-outlined text-3xl text-purple-400",children:"science"}),"Badania"]}),r.jsx("div",{className:"flex gap-2",children:x?r.jsxs("div",{className:"bg-purple-900/30 border border-purple-500/30 px-3 py-1 rounded text-xs text-purple-300 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-sm animate-spin",children:"sync"}),"Badanie w toku: ",b]}):r.jsxs("span",{className:"text-sm text-[#929bc9]",children:["Laboratorium: Lvl ",v]})})]}),v===0?r.jsxs("div",{className:"bg-[#1c2136] border border-red-500/20 rounded-xl p-8 flex flex-col items-center justify-center text-center gap-4",children:[r.jsx("span",{className:"material-symbols-outlined text-5xl text-red-500/50",children:"block"}),r.jsx("h3",{className:"text-xl font-bold text-white",children:"Laboratorium Badawcze Wymagane"}),r.jsx("p",{className:"text-[#929bc9]",children:"Musisz wybudowa Laboratorium Badawcze w menu Budynki, aby rozpocz badania nad nowymi technologiami."})]}):r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:p.map(j=>{var we;const C=l[j.id],z=d("research",j.id,C),M=n.metal>=z.metal&&n.crystal>=z.crystal&&n.deuterium>=z.deuterium,E=(x==null?void 0:x.itemId)===j.id,O=!!x,_=f(j.requirements),he=(z.metal+z.crystal)/1e3*3600*1e3/(v+1)/N,Z=Math.max(1,Math.floor(he/1e3)),ge=((je,Ue)=>je===xe.WEAPON_TECH?{text:`Atak: +${Ue*10}% -> +${(Ue+1)*10}%`,type:"combat",color:"text-red-400"}:je===xe.SHIELDING_TECH?{text:`Tarcza: +${Ue*5}% -> +${(Ue+1)*5}%`,type:"combat",color:"text-blue-400"}:je===xe.ARMOUR_TECH?{text:`Pancerz: +${Ue*5}% -> +${(Ue+1)*5}%`,type:"combat",color:"text-emerald-400"}:je===xe.ENERGY_TECH?{text:`Reaktor: +${Ue*1}% efektywnoci`,type:"eco",color:"text-yellow-400"}:je===xe.ASTROPHYSICS?{text:`Ekspedycje: +${Ue}`,type:"eco",color:"text-purple-400"}:null)(j.id,C);return r.jsxs("div",{className:`bg-[#1c2136] rounded-xl border border-white/10 overflow-hidden hover:border-purple-500/50 transition-all group flex flex-col h-full ${_?"":"opacity-60 grayscale"}`,children:[r.jsxs("div",{className:"h-40 bg-cover bg-center relative",style:{backgroundImage:`url("${j.image}")`},children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#1c2136] to-transparent mix-blend-multiply"}),r.jsx("div",{className:"absolute inset-0 bg-purple-900/10"}),r.jsxs("div",{className:"absolute top-2 right-2 bg-black/60 backdrop-blur px-2 py-1 rounded text-xs text-purple-300 border border-purple-500/30 font-mono",children:["Lvl ",C]}),E&&r.jsxs("div",{className:"absolute inset-0 bg-black/70 flex flex-col items-center justify-center backdrop-blur-sm p-4 text-center",children:[r.jsx("div",{className:"bg-purple-600 text-white px-3 py-1 rounded-full text-xs font-bold animate-pulse shadow-lg mb-2",children:"Badanie..."}),r.jsx("div",{className:"text-2xl font-mono font-bold text-white",children:b})]})]}),r.jsxs("div",{className:"p-4 flex flex-col flex-1",children:[r.jsx("h4",{className:"text-lg font-bold text-white mb-1 group-hover:text-purple-400 transition-colors",children:j.name}),r.jsx("p",{className:"text-xs text-[#929bc9] mb-4 line-clamp-2 min-h-[32px]",children:j.description}),ge&&r.jsx("div",{className:`mb-3 text-[10px] font-bold uppercase tracking-wider ${ge.color}`,children:ge.text}),r.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs mb-4",children:[r.jsxs("div",{className:`flex items-center gap-1 ${n.metal<z.metal?"text-red-400":"text-[#929bc9]"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"handyman"}),z.metal>=1e3?`${(z.metal/1e3).toFixed(1)}k`:z.metal]}),r.jsxs("div",{className:`flex items-center gap-1 ${n.crystal<z.crystal?"text-red-400":"text-[#929bc9]"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"diamond"}),z.crystal>=1e3?`${(z.crystal/1e3).toFixed(1)}k`:z.crystal]}),r.jsxs("div",{className:`flex items-center gap-1 ${n.deuterium<z.deuterium?"text-red-400":"text-[#929bc9]"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"propane"}),z.deuterium>=1e3?`${(z.deuterium/1e3).toFixed(1)}k`:z.deuterium]})]}),_?r.jsxs("div",{className:"mt-auto pt-3 border-t border-white/5 flex items-center justify-between",children:[r.jsxs("span",{className:"text-xs text-[#929bc9] flex items-center gap-1",children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"schedule"}),Ma(Z)]}),r.jsx("button",{onClick:()=>o(j.id),disabled:!M||O,className:`px-4 py-2 rounded text-xs font-bold uppercase transition-all shadow-lg
                                                    ${!M||O?"bg-[#232948] text-[#929bc9]/50 cursor-not-allowed":"bg-purple-600 hover:bg-purple-500 text-white hover:shadow-purple-500/30"}
                                                `,children:E?"Badanie...":M?"Badaj":"Braki"})]}):r.jsxs("div",{className:"mt-auto pt-3 border-t border-red-500/20",children:[r.jsx("p",{className:"text-red-400 text-xs font-bold mb-1",children:"Wymagania:"}),r.jsx("div",{className:"flex flex-col gap-1",children:(we=j.requirements)==null?void 0:we.map((je,Ue)=>{const Ce=je.type==="building"?ts[je.id].name:Ar[je.id].name,Ge=je.type==="building"?s[je.id]:l[je.id];return r.jsxs("div",{className:`text-xs ${Ge>=je.level?"text-green-400":"text-red-400/70"}`,children:["- ",Ce," (Lvl ",je.level,")"]},Ue)})})]})]})]},j.id)})})]})},lv=({report:l,onClose:s})=>{const[n,o]=ee.useState("summary"),d=l.result==="attacker_win";return(l.loot.metal||0)+(l.loot.crystal||0)+(l.loot.deuterium||0),r.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4",onClick:s,children:r.jsxs("div",{className:"bg-[#1c2136] w-full max-w-4xl max-h-[90vh] overflow-hidden rounded-2xl border border-white/10 shadow-2xl flex flex-col",onClick:h=>h.stopPropagation(),children:[r.jsxs("div",{className:`p-4 border-b border-white/10 flex justify-between items-center ${d?"bg-green-900/20":"bg-red-900/20"}`,children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`p-2 rounded-lg ${d?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:r.jsx("span",{className:"material-symbols-outlined text-2xl",children:d?"emoji_events":"sentiment_very_dissatisfied"})}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-bold text-white uppercase tracking-wider",children:d?"Zwycistwo Agresora":"Zwycistwo Obrocy"}),r.jsx("p",{className:"text-xs text-[#929bc9]",children:"Raport Bojowy"})]})]}),r.jsx("button",{onClick:s,className:"text-[#929bc9] hover:text-white p-2 hover:bg-white/5 rounded-lg transition-colors",children:r.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),r.jsxs("div",{className:"flex border-b border-white/10 bg-[#15192b]",children:[r.jsx("button",{onClick:()=>o("summary"),className:`flex-1 py-3 text-sm font-bold uppercase tracking-wide transition-colors border-b-2 ${n==="summary"?"border-primary text-primary bg-primary/5":"border-transparent text-[#929bc9] hover:bg-white/5"}`,children:"Podsumowanie"}),r.jsx("button",{onClick:()=>o("fleets"),className:`flex-1 py-3 text-sm font-bold uppercase tracking-wide transition-colors border-b-2 ${n==="fleets"?"border-primary text-primary bg-primary/5":"border-transparent text-[#929bc9] hover:bg-white/5"}`,children:"Floty i Straty"}),r.jsx("button",{onClick:()=>o("log"),className:`flex-1 py-3 text-sm font-bold uppercase tracking-wide transition-colors border-b-2 ${n==="log"?"border-primary text-primary bg-primary/5":"border-transparent text-[#929bc9] hover:bg-white/5"}`,children:"Przebieg Walki"})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto p-6 bg-[#0b0d17]/50",children:[n==="summary"&&r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("div",{className:"bg-[#111422] rounded-xl p-4 border border-white/5 flex flex-col items-center",children:[r.jsx("span",{className:"text-xs uppercase text-[#555a7a] font-bold mb-2",children:"Zrabowany Tytan"}),r.jsx("span",{className:"text-2xl font-mono text-blue-400",children:Math.floor(l.loot.metal).toLocaleString()})]}),r.jsxs("div",{className:"bg-[#111422] rounded-xl p-4 border border-white/5 flex flex-col items-center",children:[r.jsx("span",{className:"text-xs uppercase text-[#555a7a] font-bold mb-2",children:"Zrabowany Krzem"}),r.jsx("span",{className:"text-2xl font-mono text-purple-400",children:Math.floor(l.loot.crystal).toLocaleString()})]}),r.jsxs("div",{className:"bg-[#111422] rounded-xl p-4 border border-white/5 flex flex-col items-center",children:[r.jsx("span",{className:"text-xs uppercase text-[#555a7a] font-bold mb-2",children:"Zrabowana Plazma"}),r.jsx("span",{className:"text-2xl font-mono text-green-400",children:Math.floor(l.loot.deuterium).toLocaleString()})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-8",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsx("h4",{className:"text-red-400 font-bold uppercase text-sm border-b border-red-500/20 pb-2",children:"Technologia Agresora"}),r.jsxs("div",{className:"flex justify-between text-sm text-[#929bc9]",children:[r.jsx("span",{children:"Bro:"}),r.jsxs("span",{className:"text-white font-mono",children:["+",Math.round((l.bonuses.attacker.weapon-1)*100),"%"]})]}),r.jsxs("div",{className:"flex justify-between text-sm text-[#929bc9]",children:[r.jsx("span",{children:"Osony:"}),r.jsxs("span",{className:"text-white font-mono",children:["+",Math.round((l.bonuses.attacker.shield-1)*100),"%"]})]}),r.jsxs("div",{className:"flex justify-between text-sm text-[#929bc9]",children:[r.jsx("span",{children:"Pancerz:"}),r.jsxs("span",{className:"text-white font-mono",children:["+",Math.round((l.bonuses.attacker.armour-1)*100),"%"]})]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsx("h4",{className:"text-blue-400 font-bold uppercase text-sm border-b border-blue-500/20 pb-2",children:"Technologia Obrocy"}),r.jsxs("div",{className:"flex justify-between text-sm text-[#929bc9]",children:[r.jsx("span",{children:"Bro:"}),r.jsxs("span",{className:"text-white font-mono",children:["+",Math.round((l.bonuses.defender.weapon-1)*100),"%"]})]}),r.jsxs("div",{className:"flex justify-between text-sm text-[#929bc9]",children:[r.jsx("span",{children:"Osony:"}),r.jsxs("span",{className:"text-white font-mono",children:["+",Math.round((l.bonuses.defender.shield-1)*100),"%"]})]}),r.jsxs("div",{className:"flex justify-between text-sm text-[#929bc9]",children:[r.jsx("span",{children:"Pancerz:"}),r.jsxs("span",{className:"text-white font-mono",children:["+",Math.round((l.bonuses.defender.armour-1)*100),"%"]})]})]})]})]}),n==="fleets"&&r.jsxs("div",{className:"space-y-8",children:[r.jsxs("div",{children:[r.jsxs("h3",{className:"text-red-400 font-bold text-lg mb-4 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined",children:"rocket_launch"}),"Flota Agresora"]}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full text-sm text-left",children:[r.jsx("thead",{className:"bg-[#111422] text-[#555a7a] uppercase font-bold text-xs",children:r.jsxs("tr",{children:[r.jsx("th",{className:"p-3 rounded-tl-lg",children:"Jednostka"}),r.jsx("th",{className:"p-3 text-right",children:"Start"}),r.jsx("th",{className:"p-3 text-right text-red-400",children:"Straty"}),r.jsx("th",{className:"p-3 text-right rounded-tr-lg",children:"Koniec"})]})}),r.jsx("tbody",{className:"divide-y divide-white/5",children:Object.keys(l.initialAttackerShips).map(h=>{var p;const f=l.initialAttackerShips[h]||0,b=l.finalAttackerShips[h]||0,g=l.attackerLosses[h]||0;return f===0?null:r.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[r.jsx("td",{className:"p-3 font-medium text-white",children:((p=Je[h])==null?void 0:p.name)||h}),r.jsx("td",{className:"p-3 text-right font-mono text-[#929bc9]",children:f}),r.jsx("td",{className:"p-3 text-right font-mono text-red-400",children:g>0?`-${g}`:"-"}),r.jsx("td",{className:"p-3 text-right font-mono text-white",children:b})]},h)})})]})})]}),r.jsxs("div",{children:[r.jsxs("h3",{className:"text-blue-400 font-bold text-lg mb-4 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined",children:"shield"}),"Flota i Obrona Obrocy"]}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full text-sm text-left",children:[r.jsx("thead",{className:"bg-[#111422] text-[#555a7a] uppercase font-bold text-xs",children:r.jsxs("tr",{children:[r.jsx("th",{className:"p-3 rounded-tl-lg",children:"Jednostka"}),r.jsx("th",{className:"p-3 text-right",children:"Start"}),r.jsx("th",{className:"p-3 text-right text-red-400",children:"Straty"}),r.jsx("th",{className:"p-3 text-right rounded-tr-lg",children:"Koniec"})]})}),r.jsxs("tbody",{className:"divide-y divide-white/5",children:[Object.keys(l.initialDefenderShips).map(h=>{var p;const f=l.initialDefenderShips[h]||0,b=l.finalDefenderShips[h]||0,g=l.defenderLosses[h]||0;return f===0?null:r.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[r.jsx("td",{className:"p-3 font-medium text-white",children:((p=Je[h])==null?void 0:p.name)||h}),r.jsx("td",{className:"p-3 text-right font-mono text-[#929bc9]",children:f}),r.jsx("td",{className:"p-3 text-right font-mono text-red-400",children:g>0?`-${g}`:"-"}),r.jsx("td",{className:"p-3 text-right font-mono text-white",children:b})]},`ship-${h}`)}),Object.keys(l.initialDefenderDefenses).map(h=>{var p;const f=l.initialDefenderDefenses[h]||0,b=l.finalDefenderDefenses[h]||0,g=l.defenderDefensesLost[h]||0;return f===0&&b===0?null:r.jsxs("tr",{className:"hover:bg-white/5 transition-colors bg-blue-900/5",children:[r.jsx("td",{className:"p-3 font-medium text-blue-200",children:((p=Ka[h])==null?void 0:p.name)||h}),r.jsx("td",{className:"p-3 text-right font-mono text-[#929bc9]",children:f}),r.jsx("td",{className:"p-3 text-right font-mono text-red-400",children:g>0?`-${g}`:"-"}),r.jsx("td",{className:"p-3 text-right font-mono text-white",children:b})]},`def-${h}`)})]})]})})]})]}),n==="log"&&r.jsxs("div",{className:"space-y-2 font-mono text-sm",children:[l.logMessages.map((h,f)=>r.jsx("div",{className:"p-3 bg-[#111422] rounded border border-white/5 text-[#cdd6f7]",children:h},f)),l.logMessages.length===0&&r.jsx("div",{className:"text-center text-[#555a7a] py-8 italic",children:"Brak szczegowego logu walki."})]})]})]})})},ov=({report:l,onClose:s})=>{const n=l.attackerSpyLevel||0,o=l.defenderSpyLevel||0;return r.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4",onClick:s,children:r.jsxs("div",{className:"bg-[#1c2136] w-full max-w-2xl max-h-[90vh] overflow-hidden rounded-2xl border border-white/10 shadow-2xl flex flex-col",onClick:d=>d.stopPropagation(),children:[r.jsxs("div",{className:"p-4 border-b border-white/10 flex justify-between items-center bg-blue-900/20",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"p-2 rounded-lg bg-blue-500/20 text-blue-400",children:r.jsx("span",{className:"material-symbols-outlined text-2xl",children:"visibility"})}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-bold text-white uppercase tracking-wider",children:"Raport Szpiegowski"}),r.jsxs("p",{className:"text-sm text-[#929bc9]",children:["Cel: ",r.jsx("span",{className:"text-white font-bold",children:l.targetName})]})]})]}),r.jsx("button",{onClick:s,className:"text-[#929bc9] hover:text-white p-2 hover:bg-white/5 rounded-lg transition-colors",children:r.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),r.jsxs("div",{className:"bg-[#15192b] px-6 py-3 border-b border-white/5 flex justify-between items-center text-sm",children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[#555a7a] text-xs font-bold uppercase",children:"Twoja Technologia"}),r.jsxs("span",{className:"text-blue-400 font-mono font-bold text-lg",children:["Poziom ",n]})]}),r.jsxs("div",{className:"flex flex-col items-end",children:[r.jsx("span",{className:"text-[#555a7a] text-xs font-bold uppercase",children:"Technologia Celu"}),r.jsxs("span",{className:"text-red-400 font-mono font-bold text-lg",children:["Poziom ",o]})]})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto p-6 bg-[#0b0d17]/50 space-y-6",children:[l.resources&&r.jsxs("div",{children:[r.jsx("h3",{className:"text-[#929bc9] font-bold uppercase text-xs mb-3 border-b border-white/5 pb-1",children:"Zasoby"}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{className:"bg-[#111422] rounded p-3 text-center border border-white/5",children:[r.jsx("div",{className:"text-xs text-[#555a7a] font-bold mb-1",children:"Tytan"}),r.jsx("div",{className:"font-mono text-blue-400",children:Math.floor(l.resources.metal).toLocaleString()})]}),r.jsxs("div",{className:"bg-[#111422] rounded p-3 text-center border border-white/5",children:[r.jsx("div",{className:"text-xs text-[#555a7a] font-bold mb-1",children:"Krzem"}),r.jsx("div",{className:"font-mono text-purple-400",children:Math.floor(l.resources.crystal).toLocaleString()})]}),r.jsxs("div",{className:"bg-[#111422] rounded p-3 text-center border border-white/5",children:[r.jsx("div",{className:"text-xs text-[#555a7a] font-bold mb-1",children:"Plazma"}),r.jsx("div",{className:"font-mono text-green-400",children:Math.floor(l.resources.deuterium).toLocaleString()})]})]})]}),r.jsxs("div",{children:[r.jsxs("h3",{className:"text-[#929bc9] font-bold uppercase text-xs mb-3 border-b border-white/5 pb-1 flex justify-between",children:["Flota",!l.ships&&r.jsx("span",{className:"text-red-500 text-[10px]",children:"Wymagana rnica poziomw: +2"})]}),l.ships?r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[Object.entries(l.ships).map(([d,h])=>{var f;return r.jsxs("div",{className:"flex justify-between p-2 bg-[#111422] rounded border border-white/5 text-sm",children:[r.jsx("span",{className:"text-white",children:((f=Je[d])==null?void 0:f.name)||d}),r.jsx("span",{className:"font-mono text-[#929bc9]",children:h})]},d)}),Object.keys(l.ships).length===0&&r.jsx("span",{className:"text-white/30 italic text-sm",children:"Brak stacjonujcej floty."})]}):r.jsx("div",{className:"p-4 bg-red-900/10 border border-red-500/20 rounded text-center text-red-400 text-sm",children:" Dane niedostpne. Zbadaj wyszy poziom Technologii Szpiegowskiej."})]}),r.jsxs("div",{children:[r.jsxs("h3",{className:"text-[#929bc9] font-bold uppercase text-xs mb-3 border-b border-white/5 pb-1 flex justify-between",children:["Obrona",!l.defenses&&r.jsx("span",{className:"text-red-500 text-[10px]",children:"Wymagana rnica poziomw: +3"})]}),l.defenses?r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[Object.entries(l.defenses).map(([d,h])=>{var f;return r.jsxs("div",{className:"flex justify-between p-2 bg-[#111422] rounded border border-white/5 text-sm",children:[r.jsx("span",{className:"text-white",children:((f=Ka[d])==null?void 0:f.name)||d}),r.jsx("span",{className:"font-mono text-[#929bc9]",children:h})]},d)}),Object.keys(l.defenses).length===0&&r.jsx("span",{className:"text-white/30 italic text-sm",children:"Brak systemw obronnych."})]}):r.jsx("div",{className:"p-4 bg-red-900/10 border border-red-500/20 rounded text-center text-red-400 text-sm",children:" Dane niedostpne."})]}),r.jsxs("div",{children:[r.jsxs("h3",{className:"text-[#929bc9] font-bold uppercase text-xs mb-3 border-b border-white/5 pb-1 flex justify-between",children:["Budynki",!l.buildings&&r.jsx("span",{className:"text-red-500 text-[10px]",children:"Wymagana rnica poziomw: +5"})]}),l.buildings?r.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(l.buildings).map(([d,h])=>r.jsxs("div",{className:"flex justify-between p-2 bg-[#111422] rounded border border-white/5 text-sm",children:[r.jsx("span",{className:"text-white capitalize",children:d.replace(/_/g," ")}),r.jsxs("span",{className:"font-mono text-[#929bc9]",children:["Poz. ",h]})]},d))}):r.jsx("div",{className:"p-4 bg-red-900/10 border border-red-500/20 rounded text-center text-red-400 text-sm",children:" Dane niedostpne."})]})]})]})})},cv=()=>{const{missionLogs:l,clearLogs:s}=ua(),[n,o]=ee.useState("all"),[d,h]=ee.useState(null),f=p=>{var N;const v=((N=p.title)==null?void 0:N.toLowerCase())||"",x=String(p.outcome||"").toLowerCase();return x==="danger"||x==="info"||v.includes("anulowany")||v.includes("wykryto")?"threats":v.includes("bojowy")||v.includes("atak")?"attack":v.includes("ekspedycja")||v.includes("przestrze")||v.includes("pus")||v.includes("zasoby")||v.includes("pirat")||v.includes("obok")||v.includes("znalez")||v.includes("statki")||v.includes("artefakt")||v.includes("materia")||v.includes("pozyskano")?"expedition":v.includes("szpieg")||v.includes("skan")?"spy":v.includes("transport")||v.includes("dostarcz")||v.includes("surow")?"transport":"other"},b=ee.useMemo(()=>n==="all"?l:l.filter(p=>f(p)===n),[l,n]),g=[{id:"all",label:"Wszystkie",icon:"history"},{id:"threats",label:"Zagroenia",icon:"crisis_alert"},{id:"attack",label:"Ataki",icon:"swords"},{id:"spy",label:"Szpiegowskie",icon:"visibility"},{id:"expedition",label:"Ekspedycje",icon:"rocket_launch"},{id:"transport",label:"Transport",icon:"local_shipping"}];return r.jsxs("div",{className:"bg-[#1c2136] rounded-xl border border-white/10 shadow-lg flex flex-col h-[600px]",children:[r.jsxs("div",{className:"flex flex-col border-b border-white/10 bg-[#15192b]",children:[r.jsxs("div",{className:"p-4 flex items-center justify-between",children:[r.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-primary",children:"menu_book"}),"Dziennik Pokadowy"]}),l.length>0&&r.jsx("button",{onClick:s,className:"text-xs text-red-400 hover:text-white px-3 py-1 rounded border border-white/5 hover:bg-red-500/20 transition-colors",children:"Wyczy"})]}),r.jsx("div",{className:"flex overflow-x-auto no-scrollbar px-2 md:px-4 gap-2 pb-3",children:g.map(p=>r.jsxs("button",{onClick:()=>o(p.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold whitespace-nowrap transition-colors border ${n===p.id?"bg-primary/20 border-primary text-white":"bg-[#1c2136] border-white/5 text-[#929bc9] hover:bg-white/5"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-lg",children:p.icon}),p.label]},p.id))})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 bg-[#0b0d17]/50",children:[b.length===0&&r.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-[#555a7a] gap-4",children:[r.jsx("span",{className:"material-symbols-outlined text-6xl opacity-20",children:"inbox"}),r.jsx("p",{children:"Brak raportw w tej kategorii."})]}),b.map(p=>r.jsx(uv,{log:p,type:f(p),onDetail:()=>h(p)},p.id))]}),d&&(d.report?d.title&&d.title.includes("Szpieg")?r.jsx(ov,{report:d.report,onClose:()=>h(null)}):r.jsx(lv,{report:d.report,onClose:()=>h(null)}):r.jsx(dv,{log:d,onClose:()=>h(null)}))]})},uv=({log:l,type:s,onDetail:n})=>{const o=l.outcome==="success",d=l.outcome==="danger";return s==="spy"||s==="threats"&&l.title.toLowerCase().includes("skan")?r.jsxs("div",{className:`${d?"bg-red-900/20 border-red-500/30":"bg-[#1c2136] border-white/10"} border rounded-lg overflow-hidden group hover:border-primary/50 transition-colors`,children:[r.jsxs("div",{className:`${d?"bg-red-900/30 border-red-500/20":"bg-[#111422] border-white/5"} p-3 border-b flex justify-between items-center`,children:[r.jsxs("span",{className:`${d?"text-red-400":"text-orange-400"} font-bold text-sm flex items-center gap-2`,children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"visibility"}),l.title]}),r.jsx("span",{className:"text-[10px] text-[#555a7a] font-mono",children:new Date(l.timestamp).toLocaleTimeString()})]}),r.jsxs("div",{className:"p-3",children:[r.jsx("p",{className:"text-sm text-[#cdd6f7] mb-2",children:l.message}),r.jsx("button",{onClick:n,className:"w-full mt-2 py-2 bg-orange-500/10 hover:bg-orange-500/20 text-orange-300 text-xs font-bold rounded border border-orange-500/20 transition-colors flex items-center justify-center gap-1",children:"Peny Raport"})]})]}):s==="attack"?r.jsxs("div",{className:`rounded-lg border overflow-hidden ${o?"bg-green-900/10 border-green-500/30":"bg-red-900/10 border-red-500/30"}`,children:[r.jsxs("div",{className:"p-3 flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("div",{className:`font-bold text-sm mb-1 ${o?"text-green-400":"text-red-400"}`,children:l.title}),r.jsx("div",{className:"text-xs text-[#929bc9]",children:new Date(l.timestamp).toLocaleString()})]}),l.report&&r.jsxs("div",{className:"text-right",children:[r.jsx("div",{className:"text-[10px] uppercase text-[#555a7a] font-bold",children:"Zrabowano"}),r.jsxs("div",{className:"text-xs text-white font-mono",children:[Math.floor((l.report.loot.metal+l.report.loot.crystal+l.report.loot.deuterium)/1e3),"k"]})]})]}),l.report&&r.jsxs("button",{onClick:n,className:"w-full py-2 bg-black/20 hover:bg-black/40 text-xs text-white/70 hover:text-white border-t border-white/5 transition-colors flex items-center justify-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"sticky_note_2"}),"Zobacz Szczegy"]})]}):r.jsxs("div",{className:`p-4 rounded-lg border ${o?"bg-green-500/5 border-green-500/20":d?"bg-red-500/5 border-red-500/20":"bg-[#1c2136] border-white/5"}`,children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsx("span",{className:`text-sm font-bold ${o?"text-green-400":d?"text-red-400":"text-blue-300"}`,children:l.title}),r.jsx("span",{className:"text-[10px] text-[#555a7a]",children:new Date(l.timestamp).toLocaleTimeString()})]}),r.jsx("p",{className:"text-sm text-[#929bc9] leading-relaxed",children:l.message}),l.rewards&&r.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[Object.entries(l.rewards).map(([h,f])=>!f||h==="items"||h==="ships"?null:r.jsxs("span",{className:"text-[10px] bg-[#111422] border border-white/10 px-2 py-1 rounded text-white font-mono",children:["+",f," ",h.charAt(0).toUpperCase()]},h)),l.rewards.ships&&Object.entries(l.rewards.ships).map(([h,f])=>{var b;return r.jsxs("span",{className:"text-[10px] bg-[#111422] border border-white/10 px-2 py-1 rounded text-white font-mono flex items-center gap-1",children:[r.jsx("span",{className:"material-symbols-outlined text-[10px]",children:"rocket"})," ",f," ",(b=Je[h])==null?void 0:b.name]},h)})]}),l.report&&r.jsxs("button",{onClick:n,className:"w-full mt-3 py-2 bg-white/5 hover:bg-white/10 text-xs text-blue-200 border-t border-white/10 transition-colors flex items-center justify-center gap-2 rounded",children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"assignment"}),"Zobacz Raport Bitewny"]})]})},dv=({log:l,onClose:s})=>{var o,d,h,f,b,g,p,v,x,N;const n=l.report;return r.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4",onClick:s,children:r.jsxs("div",{className:"bg-[#1c2136] w-full max-w-lg max-h-[80vh] overflow-y-auto rounded-2xl border border-white/10 shadow-2xl",onClick:j=>j.stopPropagation(),children:[r.jsxs("div",{className:"sticky top-0 bg-[#1c2136] border-b border-white/10 p-4 flex justify-between items-center z-10",children:[r.jsxs("h3",{className:"text-white font-bold flex items-center gap-2",children:[r.jsx("span",{className:`material-symbols-outlined ${(o=l.title)!=null&&o.toLowerCase().includes("szpieg")?"text-blue-400":(d=l.title)!=null&&d.toLowerCase().includes("transport")||(h=l.title)!=null&&h.toLowerCase().includes("dostawa")?"text-green-400":(f=l.title)!=null&&f.toLowerCase().includes("bojowy")||(b=l.title)!=null&&b.toLowerCase().includes("pirat")?"text-red-500":"text-purple-400"}`,children:(g=l.title)!=null&&g.toLowerCase().includes("szpieg")?"visibility":(p=l.title)!=null&&p.toLowerCase().includes("transport")||(v=l.title)!=null&&v.toLowerCase().includes("dostawa")?"local_shipping":(x=l.title)!=null&&x.toLowerCase().includes("bojowy")||(N=l.title)!=null&&N.toLowerCase().includes("pirat")?"swords":"public"}),l.title]}),r.jsx("button",{onClick:s,className:"text-[#929bc9] hover:text-white",children:r.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),r.jsx("div",{className:"p-4 space-y-6",children:n?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"bg-[#111422] rounded-xl p-4 border border-white/5",children:[r.jsx("div",{className:"text-xs text-[#555a7a] uppercase font-bold mb-3 text-center",children:"Zrabowane Surowce"}),r.jsxs("div",{className:"flex justify-around",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-blue-400 font-bold font-mono",children:Math.floor(n.loot.metal)}),r.jsx("div",{className:"text-[10px] text-[#929bc9]",children:"Metal"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-purple-400 font-bold font-mono",children:Math.floor(n.loot.crystal)}),r.jsx("div",{className:"text-[10px] text-[#929bc9]",children:"Kryszta"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-green-400 font-bold font-mono",children:Math.floor(n.loot.deuterium)}),r.jsx("div",{className:"text-[10px] text-[#929bc9]",children:"Deutery"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx("div",{className:"text-red-400 font-bold text-xs uppercase border-b border-red-500/20 pb-1",children:"Agresor (Ty)"}),Object.entries(n.attackerLosses).length===0?r.jsx("div",{className:"text-green-500 text-xs",children:"Brak strat"}):Object.entries(n.attackerLosses).map(([j,C])=>{var z;return r.jsxs("div",{className:"flex justify-between text-xs text-[#929bc9]",children:[r.jsx("span",{children:(z=Je[j])==null?void 0:z.name}),r.jsxs("span",{className:"text-red-400",children:["-",C]})]},j)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("div",{className:"text-blue-400 font-bold text-xs uppercase border-b border-blue-500/20 pb-1",children:"Obroca"}),Object.entries(n.defenderLosses).length===0&&Object.entries(n.defenderDefensesLost||{}).length===0?r.jsx("div",{className:"text-green-500 text-xs",children:"Brak strat"}):r.jsxs(r.Fragment,{children:[Object.entries(n.defenderLosses).map(([j,C])=>{var z;return r.jsxs("div",{className:"flex justify-between text-xs text-[#929bc9]",children:[r.jsx("span",{children:(z=Je[j])==null?void 0:z.name}),r.jsxs("span",{className:"text-red-400",children:["-",C]})]},j)}),Object.entries(n.defenderDefensesLost||{}).map(([j,C])=>{var z;return r.jsxs("div",{className:"flex justify-between text-xs text-[#929bc9]",children:[r.jsx("span",{children:(z=Ka[j])==null?void 0:z.name}),r.jsxs("span",{className:"text-red-400",children:["-",C]})]},j)})]})]})]})]}):r.jsx("div",{className:"text-[#cdd6f7] text-sm whitespace-pre-wrap leading-relaxed bg-[#111422] p-4 rounded-lg border border-white/5",children:l.message})})]})})},hv=()=>{const{ships:l,sendExpedition:s,sendAttack:n,activeMissions:o,missionLogs:d,clearLogs:h,cancelMission:f,galaxyCoords:b}=ua(),[g,p]=ee.useState({}),[v,x]=ee.useState({galaxy:1,system:1,position:2}),[N,j]=ee.useState(Ze.ATTACK);ee.useEffect(()=>{b&&x({galaxy:b.galaxy||1,system:b.system||1,position:b.position||1})},[b]);const C=(_,G)=>{const he=l[_]||0;let Z=parseInt(G,10);isNaN(Z)&&(Z=0),Z=Math.min(Math.max(0,Z),he),p(ie=>({...ie,[_]:Z}))},z=()=>{const _={};Object.entries(l).forEach(([G,he])=>{const Z=he;Z>0&&(_[G]=Z)}),p(_)},M=()=>{const _={};let G=0;Object.entries(g).forEach(([he,Z])=>{const ie=Z;ie>0&&(_[he]=ie,G+=ie)}),G!==0&&(N===Ze.EXPEDITION?s(_,v):N===Ze.ATTACK&&n(_,v),p({}))},E=Object.values(g).reduce((_,G)=>_+G,0),O=Object.entries(g).reduce((_,[G,he])=>_+Je[G].capacity*he,0);return r.jsxs("div",{className:"flex flex-col gap-6",children:[r.jsxs("div",{className:"flex items-center justify-between border-b border-white/10 pb-4",children:[r.jsxs("h2",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[r.jsx("span",{className:"material-symbols-outlined text-3xl text-primary",children:"flight_takeoff"}),"Centrum Floty"]}),r.jsx("div",{className:"flex gap-4 text-sm text-[#929bc9]",children:r.jsxs("div",{className:"px-3 py-1 bg-white/5 rounded-lg border border-white/10",children:["Flota: ",r.jsx("span",{className:"text-white font-medium",children:Object.values(l).reduce((_,G)=>_+G,0)})]})})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[r.jsxs("div",{className:"bg-[#1a1d2e] border border-white/5 rounded-xl p-4 flex items-center gap-4",children:[r.jsx("div",{className:"w-10 h-10 rounded-lg bg-orange-500/20 flex items-center justify-center",children:r.jsx("span",{className:"material-symbols-outlined text-orange-400",children:"local_gas_station"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-[#929bc9] uppercase tracking-wider",children:"Koszt Utrzymania"}),r.jsxs("div",{className:"text-xl font-bold text-white",children:[(()=>{let _=0;return Object.entries(l).forEach(([he,Z])=>{const ie=Je[he];ie&&(_+=(ie.baseCost.metal+ie.baseCost.crystal)*Z)}),Math.floor(_/1e3*ar).toLocaleString()})()," ",r.jsx("span",{className:"text-sm font-normal text-orange-400",children:"Deuter / h"})]})]})]}),r.jsxs("div",{className:"bg-[#1a1d2e] border border-white/5 rounded-xl p-4 flex items-center gap-4",children:[r.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-500/20 flex items-center justify-center",children:r.jsx("span",{className:"material-symbols-outlined text-blue-400",children:"flight"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-[#929bc9] uppercase tracking-wider",children:"Gotowo Bojowa"}),r.jsx("div",{className:"text-xl font-bold text-white",children:"100%"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[r.jsxs("div",{className:"lg:col-span-7 space-y-6",children:[r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:(()=>{let _=0,G=0,he=0,Z=0;return Object.entries(l).forEach(([ie,ge])=>{const we=Je[ie];ge>0&&we&&(_+=ge,G+=ge*we.attack,he+=ge*we.defense,Z+=ge*we.capacity)}),r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"bg-[#1c2136] p-4 rounded-xl border border-white/10 shadow-lg",children:[r.jsx("div",{className:"text-[#929bc9] text-[10px] uppercase font-bold mb-1",children:"Liczebno Floty"}),r.jsx("div",{className:"text-white text-xl font-mono font-bold",children:_})]}),r.jsxs("div",{className:"bg-[#1c2136] p-4 rounded-xl border border-white/10 shadow-lg",children:[r.jsx("div",{className:"text-[#929bc9] text-[10px] uppercase font-bold mb-1",children:"Sia Ognia"}),r.jsx("div",{className:"text-red-400 text-xl font-mono font-bold",children:G.toLocaleString()})]}),r.jsxs("div",{className:"bg-[#1c2136] p-4 rounded-xl border border-white/10 shadow-lg",children:[r.jsx("div",{className:"text-[#929bc9] text-[10px] uppercase font-bold mb-1",children:"Wytrzymao"}),r.jsx("div",{className:"text-green-400 text-xl font-mono font-bold",children:he.toLocaleString()})]}),r.jsxs("div",{className:"bg-[#1c2136] p-4 rounded-xl border border-white/10 shadow-lg",children:[r.jsx("div",{className:"text-[#929bc9] text-[10px] uppercase font-bold mb-1",children:"adowno (Cak.)"}),r.jsx("div",{className:"text-blue-400 text-xl font-mono font-bold",children:Z.toLocaleString()})]})]})})()}),r.jsxs("div",{className:"bg-[#1c2136] rounded-xl border border-white/10 p-6 shadow-lg",children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-primary",children:"rocket_launch"}),"Dostpna Flota"]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:z,className:"text-xs bg-primary/20 text-primary hover:bg-primary hover:text-white px-3 py-1 rounded font-bold transition-colors",children:"Wybierz wszystkie"}),r.jsx("button",{onClick:()=>p({}),className:"text-xs text-[#929bc9] hover:text-white underline",children:"Zeruj wybr"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[Object.entries(l).map(([_,G])=>{const he=Je[_];if(G<=0)return null;const Z=g[_]>0;return r.jsxs("div",{className:`p-4 rounded-xl border transition-all ${Z?"bg-primary/5 border-primary/30 shadow-lg shadow-primary/5":"bg-[#1c2136] border-white/5 hover:border-white/10"}`,children:[r.jsxs("div",{className:"flex justify-between items-start mb-6",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"size-12 rounded-lg bg-[#111422] flex items-center justify-center border border-white/10 bg-cover bg-center",style:{backgroundImage:`url(${he.image})`},children:!he.image&&r.jsx("span",{className:"material-symbols-outlined text-primary text-2xl",children:"rocket"})}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-white font-bold",children:he.name}),r.jsxs("div",{className:"flex gap-2 text-[10px] mt-1",children:[r.jsxs("span",{className:"text-[#929bc9] bg-white/5 px-1.5 py-0.5 rounded",children:["Dostpne: ",r.jsx("span",{className:"text-white font-mono",children:G})]}),r.jsxs("span",{className:"text-blue-400 bg-blue-500/10 px-1.5 py-0.5 rounded",children:["ad.: ",(he.capacity||0).toLocaleString()]})]})]})]}),r.jsxs("div",{className:"flex flex-col items-end gap-1",children:[r.jsx("div",{className:"text-[10px] text-[#555a7a] uppercase font-bold",children:"Wybierz"}),r.jsx("input",{type:"number",min:"0",max:G,value:g[_]||"",onChange:ie=>C(_,ie.target.value),className:"w-20 bg-[#111422] border border-white/10 rounded px-2 py-1 text-right text-white font-mono text-sm focus:border-primary focus:outline-none",placeholder:"0"})]})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[r.jsx("button",{onClick:()=>C(_,"0"),className:"h-8 text-[10px] uppercase font-bold text-[#555a7a] hover:text-white border border-white/5 hover:bg-white/5 rounded transition-colors",children:"0"}),r.jsx("button",{onClick:()=>C(_,Math.max(0,Math.floor(G/2)).toString()),className:"h-8 text-[10px] uppercase font-bold text-[#929bc9] hover:text-white border border-white/5 hover:bg-white/5 rounded transition-colors",children:"50%"}),r.jsxs("button",{onClick:()=>C(_,G.toString()),className:"col-span-2 h-8 text-[10px] uppercase font-bold text-primary hover:text-white border border-primary/20 hover:bg-primary/20 rounded transition-colors",children:["MAX (",G,")"]})]})]},_)}),Object.values(l).every(_=>_===0)&&r.jsxs("div",{className:"text-center py-8 text-[#929bc9]",children:[r.jsx("span",{className:"material-symbols-outlined text-4xl mb-2 opacity-50",children:"sailing"}),r.jsx("p",{children:"Brak statkw w dokach. Wybuduj flot w Stoczni."})]})]})]})]}),r.jsx("div",{className:"lg:col-span-5 flex flex-col gap-6",children:r.jsxs("div",{className:"bg-[#1c2136] rounded-xl border border-white/10 p-6 shadow-lg",children:[r.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Cel i Misja"}),r.jsxs("div",{className:"flex flex-col gap-4",children:[r.jsxs("div",{className:"p-4 bg-[#111422] rounded-lg border border-white/5",children:[r.jsx("label",{className:"text-xs text-[#929bc9] uppercase font-bold mb-3 block",children:"Wsprzdne Celu"}),r.jsxs("div",{className:"flex items-center justify-center gap-2",children:[r.jsxs("div",{className:"flex flex-col items-center gap-1 w-20",children:[r.jsx("span",{className:"text-[10px] text-[#555a7a] uppercase",children:"Gal"}),r.jsx("input",{type:"number",value:v.galaxy,onChange:_=>x({...v,galaxy:parseInt(_.target.value)||1}),className:"w-full bg-[#232948] text-center py-3 rounded-lg text-white font-mono font-bold border border-white/10 focus:border-primary focus:ring-1 focus:ring-primary outline-none"})]}),r.jsx("span",{className:"text-white/20 text-xl font-light mt-4",children:":"}),r.jsxs("div",{className:"flex flex-col items-center gap-1 w-20",children:[r.jsx("span",{className:"text-[10px] text-[#555a7a] uppercase",children:"Uk"}),r.jsx("input",{type:"number",value:v.system,onChange:_=>x({...v,system:parseInt(_.target.value)||1}),className:"w-full bg-[#232948] text-center py-3 rounded-lg text-white font-mono font-bold border border-white/10 focus:border-primary focus:ring-1 focus:ring-primary outline-none"})]}),r.jsx("span",{className:"text-white/20 text-xl font-light mt-4",children:":"}),r.jsxs("div",{className:"flex flex-col items-center gap-1 w-20",children:[r.jsx("span",{className:"text-[10px] text-[#555a7a] uppercase",children:"Poz"}),r.jsx("input",{type:"number",value:v.position,onChange:_=>x({...v,position:parseInt(_.target.value)||1}),className:"w-full bg-[#232948] text-center py-3 rounded-lg text-white font-mono font-bold border border-white/10 focus:border-primary focus:ring-1 focus:ring-primary outline-none"})]})]}),r.jsxs("div",{className:"flex justify-center mt-3 gap-2",children:[r.jsx("button",{onClick:()=>{x({...v,position:16}),j(Ze.EXPEDITION)},className:`text-xs px-2 py-1 rounded border border-transparent hover:border-white/10 transition-colors ${v.position===16?"text-primary font-bold bg-primary/10":"text-[#929bc9] hover:text-white"}`,children:"[16] Gboka Przestrze"}),r.jsx("button",{onClick:()=>{x({...v,position:2}),j(Ze.ATTACK)},className:`text-xs px-2 py-1 rounded border border-transparent hover:border-white/10 transition-colors ${v.position===2?"text-red-400 font-bold bg-red-500/10":"text-[#929bc9] hover:text-white"}`,children:"[2] Baza Piratw"})]})]}),E>0&&r.jsxs("div",{className:"p-4 bg-[#111422] rounded-lg border border-white/5 flex flex-col gap-2",children:[r.jsxs("div",{className:"flex justify-between items-center text-sm",children:[r.jsx("span",{className:"text-[#929bc9]",children:"Ilo Statkw:"}),r.jsx("span",{className:"text-white font-mono",children:E})]}),r.jsxs("div",{className:"flex justify-between items-center text-sm",children:[r.jsx("span",{className:"text-[#929bc9]",children:"Cakowita adowno:"}),r.jsx("span",{className:"text-green-400 font-mono font-bold",children:O.toLocaleString()})]})]}),r.jsxs("div",{className:"p-4 bg-[#111422] rounded-lg border border-white/5",children:[r.jsx("label",{className:"text-xs text-[#929bc9] uppercase font-bold mb-2 block",children:"Typ Misji"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>j(Ze.EXPEDITION),className:`flex-1 py-3 rounded-lg font-bold text-sm border transition-colors ${N===Ze.EXPEDITION?"bg-primary text-white border-primary/50 shadow-lg shadow-primary/20":"bg-[#232948] text-[#929bc9] border-white/5"}`,children:"Ekspedycja"}),r.jsx("button",{onClick:()=>j(Ze.ATTACK),className:`flex-1 py-3 rounded-lg font-bold text-sm border transition-colors ${N===Ze.ATTACK?"bg-red-500 text-white border-red-500/50 shadow-lg shadow-red-500/20":"bg-[#232948] text-[#929bc9] border-white/5"}`,children:"Atak"})]})]}),r.jsx("button",{onClick:M,disabled:E===0,className:`w-full py-4 rounded-xl font-bold text-lg uppercase tracking-widest transition-all shadow-xl
                                    ${E>0?N===Ze.ATTACK?"bg-gradient-to-r from-red-600 to-orange-600 hover:from-red-500 hover:to-orange-500 text-white transform hover:scale-[1.02] shadow-red-900/30":"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-500 hover:to-indigo-500 text-white transform hover:scale-[1.02] shadow-blue-900/30":"bg-[#232948] text-white/20 cursor-not-allowed"}
                                `,children:r.jsxs("div",{className:"flex flex-col leading-none gap-1",children:[r.jsx("span",{children:N===Ze.ATTACK?"ROZPOCZNIJ ATAK":"WYLIJ FLOT"}),E>0&&r.jsxs("span",{className:"text-[10px] font-normal opacity-70",children:["Statkw: ",E]})]})})]})]})})]}),o.length>0&&r.jsxs("div",{className:"bg-[#1c2136] rounded-xl border border-white/10 p-6 shadow-lg",children:[r.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Aktywne Misje"}),r.jsx("div",{className:"space-y-4",children:o.map(_=>r.jsx(fv,{mission:_,onCancel:f},_.id))})]}),r.jsx(cv,{})]})},fv=({mission:l,onCancel:s})=>{const[n,o]=ee.useState("outbound"),[d,h]=ee.useState(0),[f,b]=ee.useState(""),[g,p]=ee.useState(!1);ee.useEffect(()=>{const x=()=>{const j=Date.now();let C=0,z=0;if(j<l.arrivalTime){o("outbound");const M=l.arrivalTime-l.startTime||6e4,E=j-l.startTime;C=Math.min(100,Math.max(0,E/M*100)),z=Math.max(0,(l.arrivalTime-j)/1e3)}else{o("inbound");const M=l.returnTime-l.arrivalTime||6e4,E=j-l.arrivalTime;C=Math.min(100,Math.max(0,E/M*100)),z=Math.max(0,(l.returnTime-j)/1e3)}(isNaN(C)||!isFinite(C))&&(C=0),(isNaN(z)||!isFinite(z))&&(z=0),h(C),b(Ma(z))};x();const N=setInterval(x,100);return()=>clearInterval(N)},[l]);const v=l.type===Ze.ATTACK;return r.jsxs("div",{className:`rounded-lg p-4 border relative overflow-hidden ${v?"bg-red-900/10 border-red-500/20":"bg-[#111422] border-white/5"}`,children:[r.jsxs("div",{className:"flex items-center justify-between mb-4 relative px-4 py-2",children:[r.jsxs("div",{className:"flex flex-col items-center z-10",children:[r.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-500/20 border border-blue-500 flex items-center justify-center",children:r.jsx("span",{className:"material-symbols-outlined text-sm text-blue-400",children:"home"})}),r.jsx("span",{className:"text-[10px] text-[#929bc9] mt-1",children:"Baza"})]}),r.jsx("div",{className:"flex-1 h-1 bg-white/10 mx-2 relative rounded-full overflow-hidden",children:r.jsx("div",{className:`h-full transition-all duration-100 ease-linear ${n==="outbound"?v?"bg-red-500 origin-left":"bg-primary origin-left":"bg-green-500 origin-right ml-auto"}`,style:{width:`${d}%`}})}),r.jsx("div",{className:"absolute top-1/2 -translate-y-[calc(50%+12px)] transition-all duration-100 ease-linear z-20",style:{left:`calc(10% + ${n==="outbound"?d*.8:(100-d)*.8}%)`},children:r.jsx("span",{className:`material-symbols-outlined text-white text-xl drop-shadow-lg transform ${n==="inbound"?"rotate-180 text-green-400":v?"text-red-500":"text-primary"}`,children:"rocket"})}),r.jsxs("div",{className:"flex flex-col items-center z-10",children:[r.jsx("div",{className:`w-8 h-8 rounded-full border flex items-center justify-center ${n==="inbound"?"bg-green-500/20 border-green-500":v?"bg-red-500/20 border-red-500":l.type==="transport"?"bg-blue-500/20 border-blue-500":"bg-white/5 border-white/20"}`,children:r.jsx("span",{className:`material-symbols-outlined text-sm ${n==="inbound"?"text-green-400":v?"text-red-400":l.type==="transport"?"text-blue-400":"text-[#929bc9]"}`,children:v?"swords":l.type==="transport"?"local_shipping":l.type==="spy"?"visibility":"public"})}),r.jsx("span",{className:"text-[10px] text-[#929bc9] mt-1",children:v?"Bitwa":l.type==="transport"?"Transport":l.type==="spy"?"Szpieg":"Ekspedycja"})]})]}),r.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4 border-t border-white/5 pt-3",children:[r.jsxs("div",{className:"flex flex-col gap-1 w-full md:w-auto",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("div",{className:"text-white font-bold text-sm",children:["Cel: [",l.targetCoords.galaxy,":",l.targetCoords.system,":",l.targetCoords.position,"]"]}),r.jsxs("div",{className:"text-[#929bc9] text-xs",children:["Flota: ",Object.values(l.ships).reduce((x,N)=>x+Number(N),0)," jedn."]})]}),r.jsxs("div",{className:"text-[10px] text-[#555a7a] flex flex-wrap gap-2 mt-1",children:[l.type==="transport"&&l.resources&&r.jsxs("div",{className:"flex gap-2 bg-[#0b0d17] px-2 py-1 rounded border border-white/5",children:[l.resources.metal>0&&r.jsxs("span",{className:"text-blue-400",children:["M: ",Math.floor(l.resources.metal).toLocaleString()]}),l.resources.crystal>0&&r.jsxs("span",{className:"text-purple-400",children:["C: ",Math.floor(l.resources.crystal).toLocaleString()]}),l.resources.deuterium>0&&r.jsxs("span",{className:"text-green-400",children:["D: ",Math.floor(l.resources.deuterium).toLocaleString()]})]}),r.jsx("div",{className:"flex gap-2 bg-[#0b0d17] px-2 py-1 rounded border border-white/5 overflow-x-auto max-w-[300px] scrollbar-hide",children:Object.entries(l.ships).map(([x,N])=>{var j;return N>0&&r.jsxs("span",{className:"text-white whitespace-nowrap",children:[(j=Je[x])==null?void 0:j.name,": ",N]},x)})})]})]}),r.jsxs("div",{className:"text-right flex items-center gap-3 md:shrink-0",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-white font-mono font-bold",children:f}),r.jsx("div",{className:`text-xs animate-pulse ${n==="outbound"?v?"text-red-400":"text-primary":"text-green-400"}`,children:n==="outbound"?v?"Atak w toku!":"Dolot do celu...":"Powrt do bazy..."})]}),n==="outbound"&&r.jsx("button",{onClick:async()=>{p(!0),await s(l.id),p(!1)},disabled:g,className:"px-3 py-2 text-xs font-bold uppercase rounded-lg border border-red-500/30 text-red-400 hover:bg-red-500/20 hover:text-white transition-colors disabled:opacity-50",children:g?"Anulowanie...":"Odwoaj"})]})]})]})},mv=()=>{const{resources:l,buyPremium:s}=ua(),[n,o]=_i.useState("resources"),d=[{id:"metal_small",name:"Maa Paczka Metalu",description:"Dostarcza 50,000 Metalu natychmiast.",cost:100,reward:{metal:5e4},icon:"handyman",color:"from-gray-500 to-gray-700"},{id:"crystal_small",name:"Maa Paczka Krysztau",description:"Dostarcza 25,000 Krysztau natychmiast.",cost:100,reward:{crystal:25e3},icon:"diamond",color:"from-blue-400 to-blue-600"},{id:"deuterium_small",name:"Maa Paczka Deuteru",description:"Dostarcza 10,000 Deuteru natychmiast.",cost:100,reward:{deuterium:1e4},icon:"propane",color:"from-teal-400 to-teal-600"},{id:"metal_large",name:"Wielka Skrzynia Metalu",description:"Ogromny zasb 250,000 Metalu.",cost:400,reward:{metal:25e4},icon:"inventory_2",color:"from-yellow-600 to-yellow-800"},{id:"crystal_large",name:"Wielka Skrzynia Krysztau",description:"Ogromny zasb 125,000 Krysztau.",cost:400,reward:{crystal:125e3},icon:"diamond",color:"from-blue-600 to-blue-800"},{id:"deuterium_large",name:"Wielka Skrzynia Deuteru",description:"Ogromny zasb 50,000 Deuteru.",cost:400,reward:{deuterium:5e4},icon:"science",color:"from-teal-600 to-teal-800"}],h=[{id:"build_speed_1h",name:"Przyspieszenie Budowy (1h)",description:"Skraca czas budowy wszystkich budynkw o 1 godzin.",cost:500,reward:{custom:"build_speed_1h"},icon:"speed",color:"from-green-500 to-green-700"},{id:"research_speed_1h",name:"Przyspieszenie Bada (1h)",description:"Skraca czas trwania bada o 1 godzin.",cost:500,reward:{custom:"research_speed_1h"},icon:"science",color:"from-purple-500 to-purple-700"},{id:"fleet_speed_24h",name:"Dopalacz Napdu (24h)",description:"Zwiksza prdko wszystkich flot o 20% na 24 godziny.",cost:1e3,reward:{custom:"fleet_speed_24h"},icon:"rocket_launch",color:"from-orange-500 to-orange-700"}],f=[{id:"death_star",name:"Projekt Leviathan",description:"Schematy mobilnej stacji bojowej zdolnej do niszczenia planet. (Prototyp)",cost:1e7,reward:{custom:"death_star"},icon:"public_off",color:"from-red-900 to-black",special:!0,unavailable:!0,image:"/kosmo/ships/Death.png"}],b=async p=>{if(p.unavailable)return;if(p.reward.custom){alert("Ten przedmiot jest obecnie niedostpny w sklepie (Wkrtce!).");return}const v=await s(p.cost,p.reward);v==="success"?alert(`Pomylnie zakupiono: ${p.name}`):v==="no_funds"?alert("Niewystarczajca ilo Antymaterii!"):v==="storage_full"&&alert("Magazyny s przepenione! Powiksz magazyny, aby kupi ten pakiet.")},g=()=>{switch(n){case"resources":return d;case"bonuses":return h;case"ships":return f;default:return[]}};return r.jsxs("div",{className:"flex flex-col gap-6",children:[r.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between border-b border-white/10 pb-4",children:[r.jsxs("h2",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[r.jsx("span",{className:"material-symbols-outlined text-3xl text-yellow-500",children:"shopping_cart"}),"Sklep Premium"]}),r.jsxs("div",{className:"bg-purple-900/30 border border-purple-500/50 px-4 py-2 rounded-lg flex items-center gap-2 shadow-lg shadow-purple-900/20",children:[r.jsx("span",{className:"text-[#929bc9] text-sm font-bold uppercase",children:"Twoja Antymateria:"}),r.jsx("span",{className:"text-purple-300 font-mono font-bold text-xl",children:l.darkMatter}),r.jsx("span",{className:"material-symbols-outlined text-purple-400 text-sm",children:"all_inclusive"})]})]}),r.jsxs("div",{className:"flex gap-2 border-b border-white/10 pb-1",children:[r.jsxs("button",{onClick:()=>o("resources"),className:`px-4 py-2 rounded-t-lg font-bold text-sm transition-colors flex items-center gap-2 ${n==="resources"?"bg-yellow-600/20 text-yellow-500 border-b-2 border-yellow-500":"text-[#929bc9] hover:text-white hover:bg-white/5"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-lg",children:"inventory_2"}),"Surowce"]}),r.jsxs("button",{onClick:()=>o("bonuses"),className:`px-4 py-2 rounded-t-lg font-bold text-sm transition-colors flex items-center gap-2 ${n==="bonuses"?"bg-blue-600/20 text-blue-500 border-b-2 border-blue-500":"text-[#929bc9] hover:text-white hover:bg-white/5"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-lg",children:"stars"}),"Bonusy"]}),r.jsxs("button",{onClick:()=>o("ships"),className:`px-4 py-2 rounded-t-lg font-bold text-sm transition-colors flex items-center gap-2 ${n==="ships"?"bg-red-600/20 text-red-500 border-b-2 border-red-500":"text-[#929bc9] hover:text-white hover:bg-white/5"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-lg",children:"rocket"}),"Statki"]})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:g().map(p=>r.jsxs("div",{className:`bg-[#1c2136] rounded-xl border overflow-hidden group transition-all flex flex-col ${p.special?"border-red-500/50 shadow-[0_0_30px_rgba(220,38,38,0.2)]":"border-white/10 hover:border-yellow-500/50"}`,children:[r.jsxs("div",{className:`h-48 bg-gradient-to-br ${p.color} relative flex items-center justify-center overflow-hidden`,children:[p.image?r.jsx("div",{className:"absolute inset-0 bg-cover bg-center transition-transform duration-700 group-hover:scale-110",style:{backgroundImage:`url("${p.image}")`},children:r.jsx("div",{className:"absolute inset-0 bg-black/10"})}):r.jsx("div",{className:"absolute inset-0 bg-black/30"}),p.special&&r.jsx("div",{className:"absolute inset-0 opacity-30 animate-pulse pointer-events-none",style:{background:"radial-gradient(circle at center, rgba(255,0,0,0.4) 0%, transparent 70%)"}}),!p.image&&r.jsx("span",{className:`material-symbols-outlined text-5xl text-white drop-shadow-lg relative z-10 ${p.special?"animate-[pulse_4s_ease-in-out_infinite] opacity-80":""}`,children:p.icon}),r.jsxs("div",{className:"absolute bottom-2 right-2 bg-black/60 backdrop-blur px-2 py-1 rounded text-xs font-mono text-white border border-white/10 z-20",children:[p.cost.toLocaleString()," DM"]})]}),r.jsxs("div",{className:"p-4 flex flex-col flex-1",children:[r.jsx("h4",{className:`text-base font-bold mb-2 truncate ${p.special?"text-red-400":"text-white"}`,children:p.name}),r.jsx("p",{className:"text-xs text-[#929bc9] mb-4 flex-1",children:p.description}),r.jsx("button",{onClick:()=>b(p),disabled:p.unavailable,className:`w-full py-2.5 rounded-lg font-bold uppercase tracking-wider text-xs transition-colors shadow-lg flex items-center justify-center gap-1 ${p.unavailable?"bg-gray-700 text-gray-400 cursor-not-allowed border border-white/5":"bg-yellow-600 hover:bg-yellow-500 text-white shadow-yellow-900/20"}`,children:p.unavailable?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"lock"}),"Niedostpne"]}):r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"payments"}),"Kup"]})})]})]},p.id))}),r.jsxs("div",{className:"bg-[#111422] rounded-xl p-6 border border-white/5 text-center",children:[r.jsx("h3",{className:"text-white font-bold mb-2",children:"Potrzebujesz wicej Antymaterii?"}),r.jsx("p",{className:"text-[#929bc9] text-sm mb-4",children:"Wysyaj ekspedycje w gbok przestrze, aby znale cenne zasoby Antymaterii!"})]})]})},pv=()=>{const{userId:l}=ua(),[s,n]=ee.useState([]),[o,d]=ee.useState(!0);return ee.useEffect(()=>{(async()=>{try{const{data:f,error:b}=await de.from("profiles").select("id, points, production_settings, planet_name, galaxy_coords, nickname, last_updated, level, xp").order("points",{ascending:!1}).limit(50);if(f&&!b){const g=f.map(p=>{var v,x;return{id:p.id,points:p.points||0,avatar_url:((v=p.production_settings)==null?void 0:v.avatarUrl)||Be.avatar,planet_name:p.planet_name||"Nieznana Planeta",nickname:p.nickname||((x=p.production_settings)==null?void 0:x.nickname)||`Dowdca ${p.id.substring(0,6)}`,galaxy_coords:p.galaxy_coords,last_updated:p.last_updated,level:p.level||1,xp:p.xp||0}});n(g)}else b&&console.error("Error fetching ranking:",b)}catch(f){console.error("Ranking fetch error:",f)}d(!1)})()},[]),o?r.jsx("div",{className:"p-8 text-center text-[#929bc9]",children:"adowanie danych wywiadu..."}):s.length===0?r.jsxs("div",{className:"animate-in fade-in duration-500",children:[r.jsxs("h2",{className:"text-2xl font-bold mb-6 text-white tracking-widest uppercase border-b border-white/10 pb-4",children:[r.jsx("span",{className:"text-primary",children:"System"})," Rankingowy"]}),r.jsxs("div",{className:"bg-[#1c2136] rounded-xl border border-white/10 p-8 text-center",children:[r.jsx("span",{className:"material-symbols-outlined text-[#929bc9] text-5xl mb-4",children:"leaderboard"}),r.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Brak graczy w rankingu"}),r.jsx("p",{className:"text-[#929bc9]",children:"Ranking jest pusty. Rozwijaj swoj koloni, aby pojawi si na licie!"})]})]}):r.jsxs("div",{className:"animate-in fade-in duration-500",children:[r.jsxs("h2",{className:"text-2xl font-bold mb-6 text-white tracking-widest uppercase border-b border-white/10 pb-4",children:[r.jsx("span",{className:"text-primary",children:"System"})," Rankingowy",r.jsx("span",{className:"text-xs text-[#929bc9] normal-case ml-4 font-normal tracking-normal",children:"(Dane odwieane co ok. 60s)"})]}),r.jsx("div",{className:"bg-[#1c2136]/50 backdrop-blur-md rounded-2xl border border-white/5 overflow-hidden shadow-xl",children:r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full text-left border-collapse",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-[#111422]/80 text-[#929bc9] text-xs uppercase tracking-wider border-b border-white/5",children:[r.jsx("th",{className:"p-4 font-bold text-center w-16",children:"#"}),r.jsx("th",{className:"p-4 font-bold",children:"Dowdca"}),r.jsx("th",{className:"p-4 font-bold text-center",children:"Poziom"}),r.jsx("th",{className:"p-4 font-bold hidden md:table-cell",children:"Planeta"}),r.jsx("th",{className:"p-4 font-bold text-right",children:"Punkty"})]})}),r.jsx("tbody",{className:"divide-y divide-white/5",children:s.map((h,f)=>{const b=f===0?"text-yellow-400":f===1?"text-gray-300":f===2?"text-amber-600":"text-[#929bc9]",g=h.level||1,p=l===h.id,v=Date.now(),x=h.last_updated&&v-h.last_updated<300*1e3;return r.jsxs("tr",{className:`border-b border-white/5 hover:bg-white/5 transition-colors ${p?"bg-primary/10 border-primary/30":""}`,children:[r.jsxs("td",{className:`p-4 font-bold text-center w-16 ${b} relative`,children:[f===0&&r.jsx("span",{className:"material-symbols-outlined text-yellow-400 absolute top-2 left-1/2 -translate-x-1/2 -mt-1 text-sm animate-bounce",title:"Lider Galaktyki",children:"crown"}),r.jsx("span",{className:f===0?"relative top-1":"",children:f+1})]}),r.jsx("td",{className:"p-4",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"size-10 rounded-full border border-white/10 overflow-hidden bg-[#111422]",children:r.jsx("img",{src:h.avatar_url,alt:"Avatar",className:"w-full h-full object-cover",onError:N=>{N.currentTarget.src="/kosmo/avatars/avatar_default.png"}})}),r.jsx("div",{className:`absolute bottom-0 right-0 size-3 rounded-full border-2 border-[#1c2136] ${x?"bg-green-500 shadow-[0_0_8px_rgba(34,197,94,0.6)]":"bg-gray-500"}`,title:x?"Online":"Offline"})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsxs("span",{className:"font-bold text-white group-hover:text-primary transition-colors flex items-center gap-2",children:[f===0&&r.jsx("span",{className:"material-symbols-outlined text-yellow-400 text-sm animate-pulse",children:"check_circle"}),h.nickname]}),r.jsx("span",{className:"text-xs text-[#929bc9] md:hidden",children:h.planet_name})]})]})}),r.jsx("td",{className:"p-4 text-center font-mono text-green-400 font-bold",children:r.jsx("span",{title:`XP: ${(h.xp||0).toLocaleString()}`,className:"cursor-help border-b border-dashed border-white/20",children:g})}),r.jsx("td",{className:"p-4 text-[#929bc9] font-mono text-sm hidden md:table-cell",children:h.planet_name}),r.jsx("td",{className:"p-4 text-right font-bold font-mono text-white text-lg",children:h.points.toLocaleString()})]},h.id)})})]})})})]})},gv=()=>{const{planetName:l,renamePlanet:s,avatarUrl:n,updateAvatar:o,planetType:d,updatePlanetType:h,nickname:f,renameUser:b,resetGame:g,logout:p,deleteAccount:v,abandonColony:x,session:N,currentPlanetId:j,planets:C,mainPlanetName:z,mainPlanetCoords:M}=ua(),[E,O]=ee.useState(f||""),[_,G]=ee.useState(n||""),he=(Z,ie)=>{const ge=prompt("Podaj now nazw planety:",Z);ge&&ge.trim()&&s(ge.trim(),ie)};return r.jsxs("div",{className:"flex flex-col gap-6 max-w-3xl mx-auto",children:[r.jsx("div",{className:"flex items-center justify-between border-b border-white/10 pb-4",children:r.jsxs("h2",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[r.jsx("span",{className:"material-symbols-outlined text-3xl text-[#929bc9]",children:"settings"}),"Opcje Gry"]})}),r.jsxs("div",{className:"bg-[#1c2136] p-6 rounded-xl border border-white/5 relative overflow-hidden",children:[r.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 opacity-30"}),r.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-primary",children:"badge"}),"Nazwa Dowdcy"]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("input",{type:"text",className:"flex-1 bg-[#111422] border border-white/10 rounded-lg px-4 py-3 text-white focus:border-primary focus:outline-none",placeholder:"Zmie nazw dowdcy",value:E,onChange:Z=>O(Z.target.value)}),r.jsx("button",{onClick:()=>b(E),className:"bg-primary hover:bg-blue-600 text-white px-6 py-3 rounded-lg font-bold transition-colors",children:"Zmie"})]})]}),r.jsxs("div",{className:"bg-[#1c2136] rounded-xl border border-white/10 p-6 shadow-lg",children:[r.jsxs("h3",{className:"text-xl font-bold text-white mb-6 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-blue-400",children:"public"}),"Wygld Planety"]}),r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[{name:"Ziemiopodobna",type:"terran"},{name:"Pustynna",type:"desert"},{name:"Lodowa",type:"ice"}].map(Z=>r.jsxs("div",{className:"flex flex-col gap-2",children:[r.jsx("button",{onClick:()=>h(Z.type),className:`relative w-full aspect-square rounded-xl overflow-hidden border-4 transition-all ${d===Z.type?"border-green-500 shadow-[0_0_20px_rgba(34,197,94,0.4)] scale-95":"border-transparent hover:border-white/20 hover:scale-105"} `,children:r.jsx("img",{src:kr[Z.type]||Be.planet,alt:Z.name,className:"w-full h-full object-cover"})}),r.jsx("span",{className:"text-xs text-center text-[#929bc9] font-medium",children:Z.name})]},Z.type))})]}),r.jsxs("div",{className:"bg-[#1c2136] rounded-xl border border-white/10 p-6 shadow-lg",children:[r.jsxs("h3",{className:"text-xl font-bold text-white mb-6 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-purple-400",children:"face"}),"Personalizacja Dowdcy"]}),r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[{name:"Pomocnik",url:"/kosmo/avatars/avatar_default.png"},{name:"Major (M)",url:"/kosmo/avatars/avatar_major.png"},{name:"Major (K)",url:"/kosmo/avatars/avatar_female.png"},{name:"Cyborg",url:"/kosmo/avatars/avatar_cyber.png"}].map(Z=>r.jsxs("div",{className:"flex flex-col gap-2",children:[r.jsx("button",{onClick:()=>o(Z.url),className:`relative w-full aspect-square rounded-xl overflow-hidden border-4 transition-all ${n===Z.url?"border-green-500 shadow-[0_0_20px_rgba(34,197,94,0.4)] scale-95":"border-transparent hover:border-white/20 hover:scale-105"} `,children:r.jsx("img",{src:Z.url,alt:Z.name,className:"w-full h-full object-cover"})}),r.jsx("span",{className:"text-xs text-center text-[#929bc9] font-medium",children:Z.name})]},Z.name))})]}),r.jsxs("div",{className:"bg-[#1c2136] rounded-xl border border-white/10 p-6 shadow-lg overflow-hidden",children:[r.jsxs("h3",{className:"text-xl font-bold text-white mb-6 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-indigo-400",children:"language"}),"Zarzdzanie Imperium"]}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full text-left border-collapse",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b border-white/10 text-[#929bc9] text-xs uppercase tracking-wider",children:[r.jsx("th",{className:"p-3",children:"Nazwa"}),r.jsx("th",{className:"p-3",children:"Wsprzdne"}),r.jsx("th",{className:"p-3",children:"Typ"}),r.jsx("th",{className:"p-3 text-right",children:"Akcje"})]})}),r.jsxs("tbody",{className:"text-sm",children:[r.jsxs("tr",{className:"border-b border-white/5 bg-white/5 hover:bg-white/10 transition-colors",children:[r.jsxs("td",{className:"p-3 font-bold text-white flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-yellow-400 text-sm",children:"star"}),z||"Gwna Planeta"]}),r.jsxs("td",{className:"p-3 text-[#929bc9] font-mono",children:["[",(M==null?void 0:M.galaxy)||1,":",(M==null?void 0:M.system)||1,":",(M==null?void 0:M.position)||1,"]"]}),r.jsx("td",{className:"p-3 text-[#929bc9]",children:"Gwna"}),r.jsx("td",{className:"p-3 text-right",children:r.jsxs("div",{className:"flex items-center justify-end gap-2",children:[r.jsxs("button",{onClick:()=>he(z||"Gwna Planeta","main"),className:"text-blue-400 hover:text-white bg-blue-500/10 hover:bg-blue-500/30 border border-blue-500/20 px-3 py-1.5 rounded text-xs font-bold uppercase transition-colors flex items-center gap-1",children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"}),"Zmie nazw"]}),r.jsx("span",{className:"text-white/20 italic text-xs px-2",children:"Nieusuwalna"})]})})]}),C.map(Z=>{var ie,ge,we;return r.jsxs("tr",{className:"border-b border-white/5 hover:bg-white/[0.02] transition-colors",children:[r.jsxs("td",{className:"p-3 text-white font-medium pl-8 relative",children:[r.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-1.5 h-1.5 rounded-full bg-blue-500"}),Z.planet_name||"Kolonia"]}),r.jsxs("td",{className:"p-3 text-[#929bc9] font-mono",children:["[",((ie=Z.galaxy_coords)==null?void 0:ie.galaxy)||"?",":",((ge=Z.galaxy_coords)==null?void 0:ge.system)||"?",":",((we=Z.galaxy_coords)==null?void 0:we.position)||"?","]"]}),r.jsx("td",{className:"p-3 text-[#929bc9] capitalize",children:"Kolonia"}),r.jsx("td",{className:"p-3 text-right",children:r.jsxs("div",{className:"flex items-center justify-end gap-2",children:[r.jsxs("button",{onClick:()=>he(Z.planet_name||"Kolonia",Z.id),className:"text-blue-400 hover:text-white bg-blue-500/10 hover:bg-blue-500/30 border border-blue-500/20 px-3 py-1.5 rounded text-xs font-bold uppercase transition-colors flex items-center gap-1",children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"}),"Zmie nazw"]}),r.jsxs("button",{onClick:async()=>{if(!confirm(` Czy na pewno chcesz porzuci koloni: ${Z.planet_name||"Bez nazwy"} [${Z.galaxy}:${Z.system}:${Z.position}]?`)||!confirm(" Wszystkie budynki, flota i surowce na tej planecie zostan UTRACONE. Czy na pewno kontynuowa?"))return;const je=prompt(" Aby potwierdzi usunicie kolonii, wpisz sowo: DELETE");je==="DELETE"?await x(Z.id,je):je&&alert("Bdne haso potwierdzajce. Anulowano.")},className:"text-red-400 hover:text-red-200 bg-red-900/20 hover:bg-red-900/40 border border-red-900/30 px-3 py-1.5 rounded text-xs font-bold uppercase transition-colors flex items-center gap-1",children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"}),"Usu"]})]})})]},Z.id)}),C.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:4,className:"p-8 text-center text-[#555a7a] italic",children:"Nie posiadasz jeszcze adnych kolonii."})})]})]})}),r.jsx("p",{className:"text-xs text-[#555a7a] mt-4 text-center",children:"Gwna planeta nie moe zosta usunita. Kolonie mona porzuci, co jest procesem nieodwracalnym."})]}),r.jsxs("div",{className:"bg-[#1c2136] rounded-xl border border-red-500/20 p-6 shadow-lg",children:[r.jsxs("h3",{className:"text-xl font-bold text-red-400 mb-4 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined",children:"warning"}),"Strefa Niebezpieczna"]}),r.jsx("p",{className:"text-[#929bc9] text-sm mb-6",children:"Te operacje s nieodwracalne. Zresetowanie gry spowoduje utrat wszystkich postpw, budynkw, floty i surowcw."}),r.jsxs("div",{className:"flex flex-col gap-4",children:[r.jsx("button",{onClick:()=>{confirm("Czy na pewno chcesz si wylogowa?")&&p()},className:"bg-yellow-500/10 hover:bg-yellow-500 text-yellow-400 hover:text-white border border-yellow-500/20 px-6 py-3 rounded-lg font-bold uppercase tracking-wider transition-all",children:"Wyloguj si"}),r.jsxs("button",{onClick:v,className:"bg-red-900/50 hover:bg-red-700 text-white border border-red-500/50 px-6 py-3 rounded-lg font-bold uppercase tracking-wider transition-all flex items-center justify-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined",children:"delete_forever"}),"Usu Konto Trwale"]}),r.jsx("p",{className:"text-xs text-red-400 text-center mt-2",children:"Uwaga: Usunicie konta trwale wykasuje Twj profil i misje z bazy danych. Tej akcji nie da si cofn!"})]})]})]})},up=Object.values(Ka),bv=()=>{const{resources:l,buildings:s,buildDefense:n,defenses:o,shipyardQueue:d}=ua(),h=(s==null?void 0:s.shipyard)||0,[f,b]=ee.useState({}),g=(x,N)=>{const j=parseInt(N,10);!isNaN(j)&&j>=0?b(C=>({...C,[x]:j})):N===""&&b(C=>({...C,[x]:0}))},p=x=>{if(x<60)return`${x}s`;const N=Math.floor(x/60),j=Math.floor(x%60);return`${N}m ${j}s`},v=d.filter(x=>x.type==="defense");return r.jsxs("div",{className:"animate-in fade-in duration-500",children:[r.jsxs("h2",{className:"text-2xl font-bold mb-6 text-white tracking-widest uppercase border-b border-white/10 pb-4",children:[r.jsx("span",{className:"text-primary",children:"System"})," Obrony Planetarnej"]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:(()=>{let x=0,N=0,j=0;return up.forEach(C=>{const z=o[C.id]||0;z>0&&(x+=z,N+=z*C.attack,j+=z*C.defense)}),r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"bg-[#1c2136] p-4 rounded-xl border border-white/10 flex items-center gap-4 shadow-lg",children:[r.jsx("div",{className:"size-12 rounded-lg bg-blue-500/20 text-blue-400 flex items-center justify-center",children:r.jsx("span",{className:"material-symbols-outlined text-2xl",children:"shield"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[#929bc9] text-xs uppercase font-bold",children:"Jednostki Obronne"}),r.jsx("div",{className:"text-white text-2xl font-mono font-bold",children:x})]})]}),r.jsxs("div",{className:"bg-[#1c2136] p-4 rounded-xl border border-white/10 flex items-center gap-4 shadow-lg",children:[r.jsx("div",{className:"size-12 rounded-lg bg-red-500/20 text-red-400 flex items-center justify-center",children:r.jsx("span",{className:"material-symbols-outlined text-2xl",children:"swords"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[#929bc9] text-xs uppercase font-bold",children:"Sia Ognia"}),r.jsx("div",{className:"text-white text-2xl font-mono font-bold",children:N.toLocaleString()})]})]}),r.jsxs("div",{className:"bg-[#1c2136] p-4 rounded-xl border border-white/10 flex items-center gap-4 shadow-lg",children:[r.jsx("div",{className:"size-12 rounded-lg bg-green-500/20 text-green-400 flex items-center justify-center",children:r.jsx("span",{className:"material-symbols-outlined text-2xl",children:"security"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[#929bc9] text-xs uppercase font-bold",children:"Wytrzymao Tarcz"}),r.jsx("div",{className:"text-white text-2xl font-mono font-bold",children:j.toLocaleString()})]})]})]})})()}),h<1?r.jsxs("div",{className:"bg-[#1c2136] rounded-xl border border-yellow-500/30 p-8 text-center",children:[r.jsx("span",{className:"material-symbols-outlined text-yellow-500 text-5xl mb-4",children:"construction"}),r.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Wymagana Stocznia"}),r.jsx("p",{className:"text-[#929bc9]",children:"Zbuduj Stoczni (poziom 1), aby odblokowa systemy obronne."})]}):r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[r.jsx("div",{className:"lg:col-span-3 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:up.map(x=>{l.metal>=x.cost.metal&&l.crystal>=x.cost.crystal&&l.deuterium>=x.cost.deuterium;const N=o[x.id]||0,j=Math.floor(x.buildTime*1e3/(h+1)/100/1e3);return r.jsxs("div",{className:"bg-[#1c2136] rounded-xl border border-white/5 p-4 hover:border-primary/30 transition-all group relative overflow-hidden",children:[r.jsxs("div",{className:"absolute top-2 right-2 bg-[#111422]/80 backdrop-blur-sm border border-white/10 px-2 py-1 rounded text-xs text-white font-mono z-10",children:["Ilo: ",r.jsx("span",{className:"text-primary font-bold",children:N})]}),r.jsxs("div",{className:"flex items-start gap-4",children:[r.jsx("div",{className:"size-16 rounded-xl bg-[#111422] flex items-center justify-center border border-white/10 group-hover:border-primary/50 transition-colors shrink-0",children:r.jsx("span",{className:"material-symbols-outlined text-primary text-3xl",children:x.icon})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("h3",{className:"text-white font-bold mb-1 truncate",children:x.name}),r.jsx("p",{className:"text-[#929bc9] text-[10px] mb-2 leading-tight h-8 overflow-hidden",children:x.desc}),r.jsxs("div",{className:"flex gap-2 text-[10px] mb-2",children:[r.jsxs("div",{className:"flex items-center gap-1 bg-red-500/10 px-1.5 py-0.5 rounded text-red-400",children:[r.jsx("span",{className:"material-symbols-outlined text-[10px]",children:"swords"}),r.jsx("span",{children:x.attack})]}),r.jsxs("div",{className:"flex items-center gap-1 bg-blue-500/10 px-1.5 py-0.5 rounded text-blue-400",children:[r.jsx("span",{className:"material-symbols-outlined text-[10px]",children:"shield"}),r.jsx("span",{children:x.defense})]}),r.jsxs("div",{className:"flex items-center gap-1 bg-gray-500/10 px-1.5 py-0.5 rounded text-gray-400",children:[r.jsx("span",{className:"material-symbols-outlined text-[10px]",children:"timer"}),r.jsx("span",{children:p(j)})]})]}),x.bonuses&&Object.keys(x.bonuses).length>0&&r.jsxs("div",{className:"mb-2 text-[10px] text-[#929bc9]",children:[r.jsx("span",{className:"font-bold text-white uppercase block mb-1 text-[9px]",children:"Silny przeciwko:"}),r.jsx("div",{className:"flex flex-wrap gap-1",children:Object.keys(x.bonuses).map(C=>{var z,M;return r.jsx("span",{className:"bg-primary/10 text-primary border border-primary/20 px-1.5 py-0.5 rounded flex items-center gap-1",children:((z=Je[C])==null?void 0:z.name)||((M=Ka[C])==null?void 0:M.name)||C},C)})})]}),r.jsxs("div",{className:"flex flex-wrap gap-1 text-[10px] mb-3",children:[r.jsxs("span",{className:`px-1.5 py-0.5 rounded ${l.metal>=x.cost.metal?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:["M: ",x.cost.metal.toLocaleString()]}),r.jsxs("span",{className:`px-1.5 py-0.5 rounded ${l.crystal>=x.cost.crystal?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:["C: ",x.cost.crystal.toLocaleString()]}),x.cost.deuterium>0&&r.jsxs("span",{className:`px-1.5 py-0.5 rounded ${l.deuterium>=x.cost.deuterium?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:["D: ",x.cost.deuterium.toLocaleString()]})]}),(()=>{const C=f[x.id]||0,z={metal:x.cost.metal*(C||1),crystal:x.cost.crystal*(C||1),deuterium:x.cost.deuterium*(C||1)},M=l.metal>=z.metal&&l.crystal>=z.crystal&&l.deuterium>=z.deuterium;return r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsxs("div",{className:"flex items-center bg-[#111422] rounded border border-white/10 overflow-hidden",children:[r.jsx("button",{onClick:()=>g(x.id,Math.max(0,C-1).toString()),className:"w-7 h-7 flex items-center justify-center text-[#929bc9] hover:text-white hover:bg-white/5",children:r.jsx("span",{className:"material-symbols-outlined text-xs",children:"remove"})}),r.jsx("input",{type:"number",min:"0",placeholder:"0",value:f[x.id]>0?f[x.id]:"",onChange:E=>g(x.id,E.target.value),onFocus:E=>E.target.select(),className:"w-10 bg-transparent text-white text-xs text-center focus:outline-none font-mono font-bold"}),r.jsx("button",{onClick:()=>g(x.id,(C+1).toString()),className:"w-7 h-7 flex items-center justify-center text-[#929bc9] hover:text-white hover:bg-white/5",children:r.jsx("span",{className:"material-symbols-outlined text-xs",children:"add"})})]}),r.jsx("button",{onClick:()=>{const E=Math.floor(l.metal/x.cost.metal),O=x.cost.crystal>0?Math.floor(l.crystal/x.cost.crystal):1/0,_=x.cost.deuterium>0?Math.floor(l.deuterium/x.cost.deuterium):1/0,G=Math.min(E,O,_);g(x.id,G.toString())},className:"h-7 px-2 rounded bg-[#232948] text-[#929bc9] text-[10px] font-bold uppercase border border-white/5 hover:bg-primary/20 hover:text-primary",children:"Max"}),r.jsxs("button",{onClick:()=>{C>0&&(n(x.id,C),b(E=>({...E,[x.id]:0})))},disabled:C<=0||!M,className:`flex-1 h-7 rounded font-bold text-[10px] uppercase transition-all flex items-center justify-center gap-1 ${C>0&&M?"bg-primary hover:bg-blue-600 text-white":"bg-[#111422] text-[#555a7a] cursor-not-allowed"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-xs",children:"build"}),"Buduj"]})]})})()]})]})]},x.id)})}),r.jsxs("div",{className:"lg:col-span-1 space-y-4",children:[r.jsxs("div",{className:"bg-[#1c2136] rounded-xl border border-white/5 p-4 flex flex-col h-fit",children:[r.jsxs("h3",{className:"text-white font-bold mb-3 flex items-center gap-2 text-sm uppercase tracking-wider",children:[r.jsx("span",{className:"material-symbols-outlined text-yellow-500 text-sm",children:"pending_actions"}),"Kolejka Budowy (",v.length,")"]}),v.length===0?r.jsx("div",{className:"text-[#555a7a] text-xs text-center py-4 italic",children:"Brak zada w kolejce."}):r.jsx("div",{className:"space-y-2 max-h-[300px] overflow-y-auto pr-1 scrollbar-thin scrollbar-thumb-white/10 scrollbar-track-transparent",children:v.map((x,N)=>{const j=Ka[x.itemId];return j?r.jsxs("div",{className:"bg-[#111422] p-2 rounded border border-white/5 flex items-center gap-2 relative overflow-hidden",children:[N===0&&r.jsx("div",{className:"absolute bottom-0 left-0 h-0.5 bg-green-500 animate-pulse w-full"}),r.jsx("div",{className:"size-8 rounded bg-[#1c2136] flex items-center justify-center text-primary",children:r.jsx("span",{className:"material-symbols-outlined text-sm",children:(j==null?void 0:j.icon)||"help"})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"text-white text-xs font-bold truncate",children:(j==null?void 0:j.name)||x.itemId}),r.jsxs("span",{className:"text-xs text-yellow-500",children:["x",x.quantity]})]}),r.jsx("div",{className:"text-[10px] text-[#555a7a]",children:N===0?"W trakcie...":"Oczekuje"})]})]},x.id):null})})]}),r.jsxs("div",{className:"bg-[#1c2136]/50 rounded-xl border border-white/5 p-4",children:[r.jsxs("h3",{className:"text-sm font-bold text-white mb-2 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-blue-400 text-sm",children:"info"}),"Info"]}),r.jsxs("ul",{className:"text-[#929bc9] text-[11px] space-y-1.5 list-disc pl-3",children:[r.jsxs("li",{children:[r.jsx("strong",{children:"Obrona"})," jest kluczowa, by chroni surowce przed grabie."]}),r.jsxs("li",{children:["Zniszczone jednostki maj ",r.jsx("strong",{children:"70% szans"})," na napraw."]}),r.jsxs("li",{children:["Czas budowy zaley od poziomu ",r.jsx("strong",{children:"Stoczni"}),"."]}),r.jsx("li",{children:"Obrona nie zuywa deuteru do utrzymania."})]})]})]})]})]})},xv=()=>{const{userId:l,nickname:s}=ua(),[n,o]=ee.useState([]),[d,h]=ee.useState(!0),[f,b]=ee.useState(!1),[g,p]=ee.useState(""),[v,x]=ee.useState("");return ee.useEffect(()=>{o([{id:"1",name:"Kosmiczni owcy",tag:"K",leader_id:"demo",member_count:12,total_points:45e3,description:"Elite hunters of the galaxy",created_at:new Date().toISOString()},{id:"2",name:"Gwiezdna Flota",tag:"GF",leader_id:"demo2",member_count:8,total_points:32e3,description:"United we stand",created_at:new Date().toISOString()},{id:"3",name:"Ciemna Materia",tag:"CM",leader_id:"demo3",member_count:15,total_points:67e3,description:"Power beyond measure",created_at:new Date().toISOString()}]),h(!1)},[]),d?r.jsx("div",{className:"p-8 text-center text-[#929bc9]",children:"adowanie klanw..."}):r.jsxs("div",{className:"animate-in fade-in duration-500",children:[r.jsxs("div",{className:"flex items-center justify-between border-b border-white/10 pb-4 mb-6",children:[r.jsxs("h2",{className:"text-2xl font-bold text-white tracking-widest uppercase",children:[r.jsx("span",{className:"text-primary",children:"System"})," Klanw"]}),r.jsxs("button",{onClick:()=>b(!f),className:"bg-primary hover:bg-blue-600 text-white px-4 py-2 rounded-lg font-bold transition-colors flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined",children:"add"}),"Stwrz Klan"]})]}),f&&r.jsxs("div",{className:"bg-[#1c2136] rounded-xl border border-primary/30 p-6 mb-6 animate-in slide-in-from-top duration-200",children:[r.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-primary",children:"groups"}),"Nowy Klan"]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-sm text-[#929bc9] font-bold uppercase block mb-2",children:"Nazwa Klanu"}),r.jsx("input",{type:"text",value:g,onChange:N=>p(N.target.value),className:"w-full bg-[#111422] border border-white/10 rounded-lg px-4 py-3 text-white focus:border-primary outline-none",placeholder:"np. Kosmiczni Wojownicy",maxLength:24})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm text-[#929bc9] font-bold uppercase block mb-2",children:"Tag (2-4 znaki)"}),r.jsx("input",{type:"text",value:v,onChange:N=>x(N.target.value.toUpperCase()),className:"w-full bg-[#111422] border border-white/10 rounded-lg px-4 py-3 text-white focus:border-primary outline-none uppercase",placeholder:"np. KW",maxLength:4})]})]}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{className:"flex-1 bg-primary hover:bg-blue-600 text-white py-3 rounded-lg font-bold transition-colors",children:"Za Klan (Koszt: 1000 Ciemnej Materii)"}),r.jsx("button",{onClick:()=>b(!1),className:"px-6 py-3 bg-[#111422] text-[#929bc9] rounded-lg hover:text-white transition-colors",children:"Anuluj"})]})]}),r.jsx("div",{className:"grid grid-cols-1 gap-4",children:n.sort((N,j)=>j.total_points-N.total_points).map((N,j)=>r.jsx("div",{className:"bg-[#1c2136] rounded-xl border border-white/5 p-5 hover:border-primary/30 transition-all group",children:r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:`size-12 rounded-xl flex items-center justify-center font-bold text-lg ${j===0?"bg-yellow-500/20 text-yellow-400 border border-yellow-500/30":j===1?"bg-gray-400/20 text-gray-300 border border-gray-400/30":j===2?"bg-amber-600/20 text-amber-500 border border-amber-600/30":"bg-[#111422] text-[#929bc9] border border-white/10"}`,children:j<3?["","",""][j]:j+1}),r.jsx("div",{className:"size-12 rounded-xl bg-primary/20 border border-primary/30 flex items-center justify-center",children:r.jsxs("span",{className:"text-primary font-bold text-sm",children:["[",N.tag,"]"]})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("h3",{className:"text-white font-bold group-hover:text-primary transition-colors",children:N.name}),r.jsx("p",{className:"text-[#929bc9] text-xs",children:N.description||"Brak opisu"})]}),r.jsxs("div",{className:"hidden md:flex items-center gap-6 text-sm",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-[#929bc9] text-xs uppercase",children:"Czonkowie"}),r.jsx("div",{className:"text-white font-bold",children:N.member_count})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-[#929bc9] text-xs uppercase",children:"Punkty"}),r.jsx("div",{className:"text-white font-bold font-mono",children:N.total_points.toLocaleString()})]})]}),r.jsx("button",{className:"bg-[#111422] hover:bg-primary text-[#929bc9] hover:text-white px-4 py-2 rounded-lg font-bold text-sm transition-all border border-white/10 hover:border-primary",children:"Docz"})]})},N.id))}),r.jsxs("div",{className:"mt-8 bg-[#1c2136]/50 rounded-xl border border-white/5 p-6",children:[r.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-yellow-500",children:"info"}),"System Klanw"]}),r.jsxs("ul",{className:"text-[#929bc9] text-sm space-y-2",children:[r.jsx("li",{children:" Klany cz graczy w potne sojusze kosmiczne."}),r.jsx("li",{children:" Czonkowie klanu mog dzieli si zasobami i wsplnie atakowa wrogie planety."}),r.jsx("li",{children:" Zaoenie klanu wymaga 1000 Ciemnej Materii."}),r.jsx("li",{children:" Ranking klanw opiera si na sumie punktw wszystkich czonkw."})]})]})]})},yv=()=>{var Ce,Ge,qe,ye;const{session:l}=ua(),[s,n]=ee.useState([]),[o,d]=ee.useState([]),[h,f]=ee.useState(!1),[b,g]=ee.useState(""),[p,v]=ee.useState(!1),[x,N]=ee.useState(new Set),j=S=>{const V=new Set(x);V.has(S)?V.delete(S):V.add(S),N(V)},C=async()=>{f(!0);const{data:S,error:V}=await de.from("profiles").select("*").order("last_updated",{ascending:!1}),{data:ne,error:pe}=await de.from("planets").select("*");if(V)console.error("Admin fetch error",V),g(`Bd pobierania: ${V.message}`);else{const Te=ne||[],A=(S==null?void 0:S.map(Q=>({...Q,colonies:Te.filter(fe=>fe.owner_id===Q.id)})))||[];n(A)}f(!1)},z=async()=>{const{data:S,error:V}=await de.from("error_logs").select("*").order("created_at",{ascending:!1}).limit(100);V||d(S||[])};ee.useEffect(()=>{C(),z()},[]);const M=async(S,V)=>{var Ne;if(!confirm(`CZY NA PEWNO CHCESZ USUN GRACZA ${V||S}?
Tej operacji nie mona cofn!`))return;f(!0);const{count:ne,error:pe}=await de.from("missions").select("*",{count:"exact",head:!0}).eq("owner_id",S);console.log(`[DEBUG] Found ${ne} missions (Error: ${pe==null?void 0:pe.message})`);const Te=await de.from("missions").delete().eq("owner_id",S).select(),A=await de.from("missions").delete().eq("target_user_id",S).select();console.log(`[DEBUG] Deleted ${Te.count} outgoing, ${A.count} incoming.`);const Q=await de.from("profiles").delete().eq("id",S).select(),fe=Q.error,be=Q.count;if(fe)if(console.error("Profile Delete error:",fe),(Ne=fe.message)!=null&&Ne.includes("foreign key constraint")||fe.code==="23503"){const Le=`
ALTER TABLE missions
DROP CONSTRAINT missions_owner_id_fkey,
ADD CONSTRAINT missions_owner_id_fkey
FOREIGN KEY (owner_id)
REFERENCES profiles(id)
ON DELETE CASCADE;
`;alert(`BLOKADA BAZY DANYCH (Foreign Key):
Nie mona usun gracza, bo trzymaj go misje (ktrych admin nie widzi przez RLS).

NAJLEPSZE ROZWIZANIE:
Wklej ten SQL w Supabase, aby misje usuway si SAME automatycznie:

${Le}`),console.log("SQL TO FIX:",Le)}else alert(`Bd usuwania (DB Error): ${fe.message} (Code: ${fe.code})`);else be===0?alert(`BD: Nie usunito wiersza (Count: 0).
Zablokowane przez RLS tabeli 'profiles'.
Potrzebna polityka: CREATE POLICY "Admin All Access" ...`):(g(`Uytkownik ${V||"Nieznany"} (ID: ${S}) zosta pomylnie usunity.`),C());f(!1)},E=["admin@kosmo.pl","dareg@kosmo.pl","admin@kosmo.com"],O=(Ce=l==null?void 0:l.user)==null?void 0:Ce.email;if(!O||!E.includes(O))return r.jsxs("div",{className:"p-8 text-center text-red-500",children:[r.jsx("h2",{className:"text-2xl font-bold",children:" Brak Uprawnie"}),r.jsx("p",{children:"Tylko administratorzy maj dostp do tego panelu."})]});const[_,G]=ee.useState(null),[he,Z]=ee.useState(""),[ie,ge]=ee.useState("colonyShip"),[we,je]=ee.useState(1),Ue=async()=>{if(!he){alert("Wybierz gracza z listy!");return}const S=s.find(A=>A.id===he);if(!S)return;console.log(" Nadawanie statku dla:",S.nickname||S.id);const V=S.ships||{},ne={...V,[ie]:(V[ie]||0)+we};console.log(" Aktualizacja:",{currentShips:V,newShips:ne,targetId:S.id});const{data:pe,error:Te}=await de.from("profiles").update({ships:ne}).eq("id",S.id).select();console.log(" Wynik aktualizacji:",{updateResult:pe,updateError:Te}),Te?alert(`Bd aktualizacji: ${Te.message}

Moe brakowa RLS policy pozwalajcej adminowi edytowa inne profile.`):!pe||pe.length===0?alert(` Update nie zmieni adnych rekordw!

Prawdopodobnie RLS blokuje edycj innych graczy.

Dodaj w Supabase SQL:
CREATE POLICY "admin_all_access" ON profiles FOR ALL USING (auth.jwt() ->> 'email' IN ('admin@kosmo.pl', 'dareg@kosmo.pl'));`):(alert(` Dodano ${we}x ${ie} graczowi ${S.nickname||"ID:"+S.id}`),je(1),await C())};return r.jsxs("div",{className:"p-4 md:p-8 text-gray-100 max-w-6xl mx-auto pb-24",children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsx("h1",{className:"text-3xl font-bold text-red-500 flex items-center gap-2",children:" PANEL ADMINISTRATORA"}),r.jsx("button",{onClick:C,className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded transition-colors",children:h?"Odwieanie...":"Odwie"})]}),b&&r.jsx("div",{className:"mb-4 p-3 bg-green-900 border border-green-700 rounded text-green-200",children:b}),r.jsxs("div",{className:"mb-6 p-4 bg-gray-800 border border-gray-700 rounded-lg",children:[r.jsx("h3",{className:"text-lg font-bold text-yellow-500 mb-4",children:" Dodaj Statek Graczowi"}),r.jsxs("div",{className:"flex flex-wrap gap-3 items-end",children:[r.jsxs("div",{className:"flex flex-col flex-1 min-w-[200px]",children:[r.jsx("label",{className:"text-xs text-gray-400 mb-1",children:"Gracz"}),r.jsxs("select",{value:he,onChange:S=>Z(S.target.value),className:"px-3 py-2 bg-gray-900 border border-gray-600 rounded text-white focus:border-yellow-500 focus:outline-none w-full",children:[r.jsx("option",{value:"",children:"-- Wybierz Gracza --"}),s.map(S=>r.jsxs("option",{value:S.id,children:[S.nickname," ",S.galaxy_coords?`[${S.galaxy_coords.galaxy}:${S.galaxy_coords.system}:${S.galaxy_coords.position}]`:"[-]"," (ID: ",S.id.slice(0,4),"...)"]},S.id))]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("label",{className:"text-xs text-gray-400 mb-1",children:"Typ Statku"}),r.jsxs("select",{value:ie,onChange:S=>ge(S.target.value),className:"px-3 py-2 bg-gray-900 border border-gray-600 rounded text-white focus:border-yellow-500 focus:outline-none",children:[r.jsx("option",{value:"colonyShip",children:"Statek Kolonizacyjny"}),r.jsx("option",{value:"lightFighter",children:"Myliwiec Lekki"}),r.jsx("option",{value:"heavyFighter",children:"Myliwiec Ciki"}),r.jsx("option",{value:"cruiser",children:"Krownik"}),r.jsx("option",{value:"battleship",children:"Okrt Wojenny"}),r.jsx("option",{value:"destroyer",children:"Niszczyciel"}),r.jsx("option",{value:"deathStar",children:"Pogromca Planet"}),r.jsx("option",{value:"smallCargo",children:"May Transporter"}),r.jsx("option",{value:"mediumCargo",children:"redni Transporter"}),r.jsx("option",{value:"hugeCargo",children:"Ogromny Transporter"}),r.jsx("option",{value:"espionageProbe",children:"Sonda Szpiegowska"}),r.jsx("option",{value:"pioneer",children:"Pionier"})]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("label",{className:"text-xs text-gray-400 mb-1",children:"Ilo"}),r.jsx("input",{type:"number",value:we,onChange:S=>je(Math.max(1,parseInt(S.target.value)||1)),min:1,className:"w-20 px-3 py-2 bg-gray-900 border border-gray-600 rounded text-white focus:border-yellow-500 focus:outline-none"})]}),r.jsx("button",{onClick:Ue,className:"px-4 py-2 bg-yellow-600 hover:bg-yellow-500 text-black font-bold rounded transition-colors",children:"Dodaj"})]})]}),r.jsxs("div",{className:"mb-6 p-4 bg-red-900/20 border border-red-700/50 rounded-lg",children:[r.jsxs("div",{className:"flex justify-between items-center cursor-pointer",onClick:()=>v(!p),children:[r.jsxs("h3",{className:"text-lg font-bold text-red-400 flex items-center gap-2",children:[" Bdy Uytkownikw",r.jsx("span",{className:"text-xs bg-red-600 px-2 py-0.5 rounded",children:o.length})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("button",{onClick:S=>{S.stopPropagation(),z()},className:"text-xs bg-red-600/30 hover:bg-red-600 px-2 py-1 rounded transition-colors",children:"Odwie"}),r.jsx("span",{className:"text-red-400",children:p?"":""})]})]}),p&&r.jsx("div",{className:"mt-4 max-h-[400px] overflow-y-auto",children:o.length===0?r.jsx("p",{className:"text-gray-500 text-sm",children:"Brak zgoszonych bdw. Upewnij si, e tabela error_logs istnieje w Supabase."}):r.jsx("div",{className:"space-y-2",children:o.map((S,V)=>{var ne;return r.jsxs("div",{className:"bg-black/30 p-3 rounded border border-red-500/20 text-xs",children:[r.jsxs("div",{className:"flex justify-between items-start mb-1",children:[r.jsx("span",{className:`font-bold ${S.error_type==="error"?"text-red-400":"text-yellow-400"}`,children:S.error_type==="error"?" ERROR":" WARNING"}),r.jsx("span",{className:"text-gray-500",children:new Date(S.created_at).toLocaleString("pl-PL")})]}),r.jsx("p",{className:"text-white mb-1",children:S.message}),S.context&&r.jsxs("p",{className:"text-gray-400 text-[10px]",children:[" ",S.context]}),S.user_id&&r.jsxs("p",{className:"text-gray-600 text-[10px] font-mono mt-1",children:["User: ",S.user_id.slice(0,8),"... | ",(ne=S.user_agent)==null?void 0:ne.slice(0,50),"..."]}),S.stack&&r.jsxs("details",{className:"mt-2",children:[r.jsx("summary",{className:"text-gray-500 cursor-pointer hover:text-gray-300",children:"Stack trace"}),r.jsx("pre",{className:"text-[9px] text-gray-600 mt-1 whitespace-pre-wrap",children:S.stack})]})]},V)})})})]}),r.jsx("div",{className:"overflow-x-auto bg-gray-900/80 rounded-lg border border-gray-700",children:r.jsxs("table",{className:"w-full text-left border-collapse",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-800 text-gray-400 uppercase text-xs",children:[r.jsx("th",{className:"p-4 border-b border-gray-700",children:"Nick"}),r.jsx("th",{className:"p-4 border-b border-gray-700",children:"Punkty"}),r.jsx("th",{className:"p-4 border-b border-gray-700",children:"Koordynaty"}),r.jsx("th",{className:"p-4 border-b border-gray-700",children:"Ostatnia Akt."}),r.jsx("th",{className:"p-4 border-b border-gray-700 text-right",children:"Akcje"})]})}),r.jsxs("tbody",{children:[s.map(S=>{var V,ne;return r.jsxs(_i.Fragment,{children:[r.jsxs("tr",{className:`hover:bg-gray-800/50 transition-colors border-b border-gray-800 ${x.has(S.id)?"bg-gray-800/30":""}`,children:[r.jsx("td",{className:"p-4",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("button",{onClick:()=>j(S.id),className:`text-gray-400 hover:text-white transition-colors w-6 h-6 flex items-center justify-center rounded border border-gray-700 ${x.has(S.id)?"bg-blue-600 border-blue-500 text-white":""}`,children:x.has(S.id)?"":""}),r.jsxs("div",{children:[r.jsx("div",{className:"font-bold text-blue-300",children:S.nickname||"Nieznany"}),r.jsx("div",{className:"text-xs text-gray-500",children:S.planet_name}),r.jsx("div",{className:"text-[10px] text-gray-600 font-mono",children:S.id})]})]})}),r.jsx("td",{className:"p-4 font-mono text-yellow-400",children:(S.points||0).toLocaleString()}),r.jsx("td",{className:"p-4 font-mono text-gray-300",children:S.galaxy_coords?`[${S.galaxy_coords.galaxy}:${S.galaxy_coords.system}:${S.galaxy_coords.position}]`:"BRAK"}),r.jsxs("td",{className:"p-4 text-sm text-gray-500",children:[S.last_updated?new Date(S.last_updated).toLocaleString():"-",r.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Kolonie: ",((V=S.colonies)==null?void 0:V.length)||0]})]}),r.jsxs("td",{className:"p-4 text-right space-x-2",children:[r.jsx("button",{onClick:()=>G(S),className:"bg-blue-600/20 hover:bg-blue-600 text-blue-500 hover:text-white px-3 py-1 rounded transition-colors font-bold text-xs",children:"INFO"}),r.jsx("button",{onClick:()=>M(S.id,S.nickname),className:"bg-red-600/20 hover:bg-red-600 text-red-500 hover:text-white px-3 py-1 rounded transition-colors font-bold text-xs",title:"Usu Gracza i Planet",children:"USU"})]})]}),x.has(S.id)&&r.jsx("tr",{className:"bg-black/20 animate-in fade-in zoom-in-95 duration-200",children:r.jsx("td",{colSpan:5,className:"p-0",children:r.jsxs("div",{className:"p-4 pl-14 bg-black/40 border-b border-gray-800 shadow-inner",children:[r.jsxs("h4",{className:"text-xs font-bold text-gray-500 uppercase mb-3 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"public"}),"Kolonie gracza (",((ne=S.colonies)==null?void 0:ne.length)||0,")"]}),!S.colonies||S.colonies.length===0?r.jsx("div",{className:"text-gray-600 text-sm italic",children:"Brak kolonii"}):r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:S.colonies.map(pe=>{var Te,A,Q;return r.jsxs("div",{className:"bg-[#111422] p-3 rounded border border-white/5 hover:border-blue-500/30 transition-colors",children:[r.jsxs("div",{className:"flex justify-between items-start mb-2",children:[r.jsx("span",{className:"font-bold text-white text-sm",children:pe.planet_name||"Bez nazwy"}),r.jsxs("span",{className:"font-mono text-xs text-blue-400 bg-blue-900/20 px-1.5 py-0.5 rounded",children:["[",pe.galaxy,":",pe.system,":",pe.position,"]"]})]}),r.jsx("div",{className:"text-[10px] text-gray-500 font-mono mb-2",children:pe.id}),r.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-yellow-600",children:"M:"})," ",Math.floor(((Te=pe.resources)==null?void 0:Te.metal)||0)]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-blue-600",children:"K:"})," ",Math.floor(((A=pe.resources)==null?void 0:A.crystal)||0)]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-green-600",children:"D:"})," ",Math.floor(((Q=pe.resources)==null?void 0:Q.deuterium)||0)]})]})]},pe.id)})})]})})})]},S.id)}),s.length===0&&!h&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"p-8 text-center text-gray-500",children:"Brak uytkownikw"})})]})]})}),_&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4",children:r.jsxs("div",{className:"bg-[#1c2136] border border-blue-500/30 rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto flex flex-col",children:[r.jsxs("div",{className:"p-4 border-b border-white/10 flex justify-between items-center bg-[#111422]",children:[r.jsxs("h2",{className:"text-xl font-bold text-blue-400",children:["Szczegy: ",_.nickname]}),r.jsx("button",{onClick:()=>G(null),className:"text-gray-400 hover:text-white text-2xl",children:""})]}),r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{className:"bg-[#111422] p-3 rounded border border-white/5",children:[r.jsx("div",{className:"text-xs text-gray-500 uppercase",children:"Metal"}),r.jsx("div",{className:"text-yellow-400 font-mono",children:Math.floor(((Ge=_.resources)==null?void 0:Ge.metal)||0).toLocaleString()})]}),r.jsxs("div",{className:"bg-[#111422] p-3 rounded border border-white/5",children:[r.jsx("div",{className:"text-xs text-gray-500 uppercase",children:"Kryszta"}),r.jsx("div",{className:"text-blue-400 font-mono",children:Math.floor(((qe=_.resources)==null?void 0:qe.crystal)||0).toLocaleString()})]}),r.jsxs("div",{className:"bg-[#111422] p-3 rounded border border-white/5",children:[r.jsx("div",{className:"text-xs text-gray-500 uppercase",children:"Deuter"}),r.jsx("div",{className:"text-green-400 font-mono",children:Math.floor(((ye=_.resources)==null?void 0:ye.deuterium)||0).toLocaleString()})]})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-bold text-gray-400 mb-2 uppercase border-b border-white/10 pb-1",children:"Budynki"}),r.jsx("pre",{className:"text-xs font-mono bg-black/30 p-2 rounded text-gray-300 overflow-x-auto",children:JSON.stringify(_.buildings,null,2)})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-bold text-gray-400 mb-2 uppercase border-b border-white/10 pb-1",children:"Flota"}),r.jsx("pre",{className:"text-xs font-mono bg-black/30 p-2 rounded text-gray-300 overflow-x-auto",children:JSON.stringify(_.ships,null,2)})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-bold text-gray-400 mb-2 uppercase border-b border-white/10 pb-1",children:"Obrona"}),r.jsx("pre",{className:"text-xs font-mono bg-black/30 p-2 rounded text-gray-300 overflow-x-auto",children:JSON.stringify(_.defenses,null,2)})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-bold text-gray-400 mb-2 uppercase border-b border-white/10 pb-1",children:"Badania"}),r.jsx("pre",{className:"text-xs font-mono bg-black/30 p-2 rounded text-gray-300 overflow-x-auto",children:JSON.stringify(_.research,null,2)})]}),r.jsx("div",{className:"text-xs text-gray-600 font-mono pt-4 border-t border-white/5",children:"Raw Data Preview (Debug)"})]}),r.jsx("div",{className:"p-4 border-t border-white/10 bg-[#111422] text-right",children:r.jsx("button",{onClick:()=>G(null),className:"px-4 py-2 rounded bg-gray-700 hover:bg-gray-600 text-white transition-colors",children:"Zamknij"})})]})})]})},vv=()=>{const[l,s]=ee.useState(null),[n,o]=ee.useState(!0),[d,h]=ee.useState(null),[f,b]=ee.useState(()=>localStorage.getItem("currentView")||"overview");if(ee.useEffect(()=>{localStorage.setItem("currentView",f)},[f]),ee.useEffect(()=>{de.auth.getSession().then(({data:{session:v}})=>{s(v),o(!1)});const{data:{subscription:p}}=de.auth.onAuthStateChange((v,x)=>{s(x),x||h(null)});return()=>p.unsubscribe()},[]),ee.useEffect(()=>{(async()=>{if(!(l!=null&&l.user)){h(null);return}const{data:v,error:x}=await de.from("profiles").select("galaxy_coords").eq("id",l.user.id).maybeSingle();v&&!x&&v.galaxy_coords?h(!0):h(!1)})()},[l]),n)return r.jsxs("div",{className:"loading-screen",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"adowanie..."})]});if(!l)return r.jsx(tv,{onLogin:s});if(d===null)return r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[#101322]",children:r.jsx("div",{className:"text-white text-xl",children:"Sprawdzanie pozycji..."})});if(d===!1)return r.jsx(av,{session:l,onComplete:()=>h(!0)});const g=()=>{switch(f){case"overview":return r.jsx(cp,{onNavigate:p=>b(p)});case"buildings":return r.jsx(sv,{});case"research":return r.jsx(iv,{});case"shipyard":return r.jsx(rv,{});case"fleet":return r.jsx(hv,{});case"galaxy":return r.jsx(nv,{});case"shop":return r.jsx(mv,{});case"ranking":return r.jsx(pv,{});case"settings":return r.jsx(gv,{});case"defense":return r.jsx(bv,{});case"clans":return r.jsx(xv,{});case"admin":return r.jsx(yv,{});default:return r.jsx(cp,{onNavigate:p=>b(p)})}};return r.jsx(Hy,{session:l,children:r.jsx(ev,{activeView:f,onNavigate:p=>b(p),children:g()})})},Dp=document.getElementById("root");if(!Dp)throw new Error("Could not find root element to mount to");const wv=tb.createRoot(Dp);wv.render(r.jsx(_i.StrictMode,{children:r.jsx(vv,{})}));
