(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))o(d);new MutationObserver(d=>{for(const h of d)if(h.type==="childList")for(const f of h.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&o(f)}).observe(document,{childList:!0,subtree:!0});function n(d){const h={};return d.integrity&&(h.integrity=d.integrity),d.referrerPolicy&&(h.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?h.credentials="include":d.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function o(d){if(d.ep)return;d.ep=!0;const h=n(d);fetch(d.href,h)}})();function up(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var nu={exports:{}},ui={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Em;function G0(){if(Em)return ui;Em=1;var l=Symbol.for("react.transitional.element"),s=Symbol.for("react.fragment");function n(o,d,h){var f=null;if(h!==void 0&&(f=""+h),d.key!==void 0&&(f=""+d.key),"key"in d){h={};for(var b in d)b!=="key"&&(h[b]=d[b])}else h=d;return d=h.ref,{$$typeof:l,type:o,key:f,ref:d!==void 0?d:null,props:h}}return ui.Fragment=s,ui.jsx=n,ui.jsxs=n,ui}var Tm;function Y0(){return Tm||(Tm=1,nu.exports=G0()),nu.exports}var r=Y0(),iu={exports:{}},qe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Am;function K0(){if(Am)return qe;Am=1;var l=Symbol.for("react.transitional.element"),s=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),h=Symbol.for("react.consumer"),f=Symbol.for("react.context"),b=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),_=Symbol.iterator;function j(k){return k===null||typeof k!="object"?null:(k=_&&k[_]||k["@@iterator"],typeof k=="function"?k:null)}var C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},z=Object.assign,M={};function E(k,Z,me){this.props=k,this.context=Z,this.refs=M,this.updater=me||C}E.prototype.isReactComponent={},E.prototype.setState=function(k,Z){if(typeof k!="object"&&typeof k!="function"&&k!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,k,Z,"setState")},E.prototype.forceUpdate=function(k){this.updater.enqueueForceUpdate(this,k,"forceUpdate")};function O(){}O.prototype=E.prototype;function N(k,Z,me){this.props=k,this.context=Z,this.refs=M,this.updater=me||C}var G=N.prototype=new O;G.constructor=N,z(G,E.prototype),G.isPureReactComponent=!0;var fe=Array.isArray;function J(){}var oe={H:null,A:null,T:null,S:null},ge=Object.prototype.hasOwnProperty;function we(k,Z,me){var be=me.ref;return{$$typeof:l,type:k,key:Z,ref:be!==void 0?be:null,props:me}}function je(k,Z){return we(k.type,Z,k.props)}function Ue(k){return typeof k=="object"&&k!==null&&k.$$typeof===l}function Re(k){var Z={"=":"=0",":":"=2"};return"$"+k.replace(/[=:]/g,function(me){return Z[me]})}var Ke=/\/+/g;function Pe(k,Z){return typeof k=="object"&&k!==null&&k.key!=null?Re(""+k.key):Z.toString(36)}function ye(k){switch(k.status){case"fulfilled":return k.value;case"rejected":throw k.reason;default:switch(typeof k.status=="string"?k.then(J,J):(k.status="pending",k.then(function(Z){k.status==="pending"&&(k.status="fulfilled",k.value=Z)},function(Z){k.status==="pending"&&(k.status="rejected",k.reason=Z)})),k.status){case"fulfilled":return k.value;case"rejected":throw k.reason}}throw k}function S(k,Z,me,be,Ne){var Be=typeof k;(Be==="undefined"||Be==="boolean")&&(k=null);var Je=!1;if(k===null)Je=!0;else switch(Be){case"bigint":case"string":case"number":Je=!0;break;case"object":switch(k.$$typeof){case l:case s:Je=!0;break;case v:return Je=k._init,S(Je(k._payload),Z,me,be,Ne)}}if(Je)return Ne=Ne(k),Je=be===""?"."+Pe(k,0):be,fe(Ne)?(me="",Je!=null&&(me=Je.replace(Ke,"$&/")+"/"),S(Ne,Z,me,"",function($e){return $e})):Ne!=null&&(Ue(Ne)&&(Ne=je(Ne,me+(Ne.key==null||k&&k.key===Ne.key?"":(""+Ne.key).replace(Ke,"$&/")+"/")+Je)),Z.push(Ne)),1;Je=0;var Rt=be===""?".":be+":";if(fe(k))for(var dt=0;dt<k.length;dt++)be=k[dt],Be=Rt+Pe(be,dt),Je+=S(be,Z,me,Be,Ne);else if(dt=j(k),typeof dt=="function")for(k=dt.call(k),dt=0;!(be=k.next()).done;)be=be.value,Be=Rt+Pe(be,dt++),Je+=S(be,Z,me,Be,Ne);else if(Be==="object"){if(typeof k.then=="function")return S(ye(k),Z,me,be,Ne);throw Z=String(k),Error("Objects are not valid as a React child (found: "+(Z==="[object Object]"?"object with keys {"+Object.keys(k).join(", ")+"}":Z)+"). If you meant to render a collection of children, use an array instead.")}return Je}function Q(k,Z,me){if(k==null)return k;var be=[],Ne=0;return S(k,be,"","",function(Be){return Z.call(me,Be,Ne++)}),be}function ie(k){if(k._status===-1){var Z=k._result;Z=Z(),Z.then(function(me){(k._status===0||k._status===-1)&&(k._status=1,k._result=me)},function(me){(k._status===0||k._status===-1)&&(k._status=2,k._result=me)}),k._status===-1&&(k._status=0,k._result=Z)}if(k._status===1)return k._result.default;throw k._result}var pe=typeof reportError=="function"?reportError:function(k){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Z=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof k=="object"&&k!==null&&typeof k.message=="string"?String(k.message):String(k),error:k});if(!window.dispatchEvent(Z))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",k);return}console.error(k)},Ae={map:Q,forEach:function(k,Z,me){Q(k,function(){Z.apply(this,arguments)},me)},count:function(k){var Z=0;return Q(k,function(){Z++}),Z},toArray:function(k){return Q(k,function(Z){return Z})||[]},only:function(k){if(!Ue(k))throw Error("React.Children.only expected to receive a single React element child.");return k}};return qe.Activity=x,qe.Children=Ae,qe.Component=E,qe.Fragment=n,qe.Profiler=d,qe.PureComponent=N,qe.StrictMode=o,qe.Suspense=g,qe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=oe,qe.__COMPILER_RUNTIME={__proto__:null,c:function(k){return oe.H.useMemoCache(k)}},qe.cache=function(k){return function(){return k.apply(null,arguments)}},qe.cacheSignal=function(){return null},qe.cloneElement=function(k,Z,me){if(k==null)throw Error("The argument must be a React element, but you passed "+k+".");var be=z({},k.props),Ne=k.key;if(Z!=null)for(Be in Z.key!==void 0&&(Ne=""+Z.key),Z)!ge.call(Z,Be)||Be==="key"||Be==="__self"||Be==="__source"||Be==="ref"&&Z.ref===void 0||(be[Be]=Z[Be]);var Be=arguments.length-2;if(Be===1)be.children=me;else if(1<Be){for(var Je=Array(Be),Rt=0;Rt<Be;Rt++)Je[Rt]=arguments[Rt+2];be.children=Je}return we(k.type,Ne,be)},qe.createContext=function(k){return k={$$typeof:f,_currentValue:k,_currentValue2:k,_threadCount:0,Provider:null,Consumer:null},k.Provider=k,k.Consumer={$$typeof:h,_context:k},k},qe.createElement=function(k,Z,me){var be,Ne={},Be=null;if(Z!=null)for(be in Z.key!==void 0&&(Be=""+Z.key),Z)ge.call(Z,be)&&be!=="key"&&be!=="__self"&&be!=="__source"&&(Ne[be]=Z[be]);var Je=arguments.length-2;if(Je===1)Ne.children=me;else if(1<Je){for(var Rt=Array(Je),dt=0;dt<Je;dt++)Rt[dt]=arguments[dt+2];Ne.children=Rt}if(k&&k.defaultProps)for(be in Je=k.defaultProps,Je)Ne[be]===void 0&&(Ne[be]=Je[be]);return we(k,Be,Ne)},qe.createRef=function(){return{current:null}},qe.forwardRef=function(k){return{$$typeof:b,render:k}},qe.isValidElement=Ue,qe.lazy=function(k){return{$$typeof:v,_payload:{_status:-1,_result:k},_init:ie}},qe.memo=function(k,Z){return{$$typeof:p,type:k,compare:Z===void 0?null:Z}},qe.startTransition=function(k){var Z=oe.T,me={};oe.T=me;try{var be=k(),Ne=oe.S;Ne!==null&&Ne(me,be),typeof be=="object"&&be!==null&&typeof be.then=="function"&&be.then(J,pe)}catch(Be){pe(Be)}finally{Z!==null&&me.types!==null&&(Z.types=me.types),oe.T=Z}},qe.unstable_useCacheRefresh=function(){return oe.H.useCacheRefresh()},qe.use=function(k){return oe.H.use(k)},qe.useActionState=function(k,Z,me){return oe.H.useActionState(k,Z,me)},qe.useCallback=function(k,Z){return oe.H.useCallback(k,Z)},qe.useContext=function(k){return oe.H.useContext(k)},qe.useDebugValue=function(){},qe.useDeferredValue=function(k,Z){return oe.H.useDeferredValue(k,Z)},qe.useEffect=function(k,Z){return oe.H.useEffect(k,Z)},qe.useEffectEvent=function(k){return oe.H.useEffectEvent(k)},qe.useId=function(){return oe.H.useId()},qe.useImperativeHandle=function(k,Z,me){return oe.H.useImperativeHandle(k,Z,me)},qe.useInsertionEffect=function(k,Z){return oe.H.useInsertionEffect(k,Z)},qe.useLayoutEffect=function(k,Z){return oe.H.useLayoutEffect(k,Z)},qe.useMemo=function(k,Z){return oe.H.useMemo(k,Z)},qe.useOptimistic=function(k,Z){return oe.H.useOptimistic(k,Z)},qe.useReducer=function(k,Z,me){return oe.H.useReducer(k,Z,me)},qe.useRef=function(k){return oe.H.useRef(k)},qe.useState=function(k){return oe.H.useState(k)},qe.useSyncExternalStore=function(k,Z,me){return oe.H.useSyncExternalStore(k,Z,me)},qe.useTransition=function(){return oe.H.useTransition()},qe.version="19.2.3",qe}var km;function Ru(){return km||(km=1,iu.exports=K0()),iu.exports}var F=Ru();const _i=up(F);var lu={exports:{}},di={},ou={exports:{}},cu={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Om;function V0(){return Om||(Om=1,(function(l){function s(S,Q){var ie=S.length;S.push(Q);e:for(;0<ie;){var pe=ie-1>>>1,Ae=S[pe];if(0<d(Ae,Q))S[pe]=Q,S[ie]=Ae,ie=pe;else break e}}function n(S){return S.length===0?null:S[0]}function o(S){if(S.length===0)return null;var Q=S[0],ie=S.pop();if(ie!==Q){S[0]=ie;e:for(var pe=0,Ae=S.length,k=Ae>>>1;pe<k;){var Z=2*(pe+1)-1,me=S[Z],be=Z+1,Ne=S[be];if(0>d(me,ie))be<Ae&&0>d(Ne,me)?(S[pe]=Ne,S[be]=ie,pe=be):(S[pe]=me,S[Z]=ie,pe=Z);else if(be<Ae&&0>d(Ne,ie))S[pe]=Ne,S[be]=ie,pe=be;else break e}}return Q}function d(S,Q){var ie=S.sortIndex-Q.sortIndex;return ie!==0?ie:S.id-Q.id}if(l.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var h=performance;l.unstable_now=function(){return h.now()}}else{var f=Date,b=f.now();l.unstable_now=function(){return f.now()-b}}var g=[],p=[],v=1,x=null,_=3,j=!1,C=!1,z=!1,M=!1,E=typeof setTimeout=="function"?setTimeout:null,O=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;function G(S){for(var Q=n(p);Q!==null;){if(Q.callback===null)o(p);else if(Q.startTime<=S)o(p),Q.sortIndex=Q.expirationTime,s(g,Q);else break;Q=n(p)}}function fe(S){if(z=!1,G(S),!C)if(n(g)!==null)C=!0,J||(J=!0,Re());else{var Q=n(p);Q!==null&&ye(fe,Q.startTime-S)}}var J=!1,oe=-1,ge=5,we=-1;function je(){return M?!0:!(l.unstable_now()-we<ge)}function Ue(){if(M=!1,J){var S=l.unstable_now();we=S;var Q=!0;try{e:{C=!1,z&&(z=!1,O(oe),oe=-1),j=!0;var ie=_;try{t:{for(G(S),x=n(g);x!==null&&!(x.expirationTime>S&&je());){var pe=x.callback;if(typeof pe=="function"){x.callback=null,_=x.priorityLevel;var Ae=pe(x.expirationTime<=S);if(S=l.unstable_now(),typeof Ae=="function"){x.callback=Ae,G(S),Q=!0;break t}x===n(g)&&o(g),G(S)}else o(g);x=n(g)}if(x!==null)Q=!0;else{var k=n(p);k!==null&&ye(fe,k.startTime-S),Q=!1}}break e}finally{x=null,_=ie,j=!1}Q=void 0}}finally{Q?Re():J=!1}}}var Re;if(typeof N=="function")Re=function(){N(Ue)};else if(typeof MessageChannel<"u"){var Ke=new MessageChannel,Pe=Ke.port2;Ke.port1.onmessage=Ue,Re=function(){Pe.postMessage(null)}}else Re=function(){E(Ue,0)};function ye(S,Q){oe=E(function(){S(l.unstable_now())},Q)}l.unstable_IdlePriority=5,l.unstable_ImmediatePriority=1,l.unstable_LowPriority=4,l.unstable_NormalPriority=3,l.unstable_Profiling=null,l.unstable_UserBlockingPriority=2,l.unstable_cancelCallback=function(S){S.callback=null},l.unstable_forceFrameRate=function(S){0>S||125<S?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ge=0<S?Math.floor(1e3/S):5},l.unstable_getCurrentPriorityLevel=function(){return _},l.unstable_next=function(S){switch(_){case 1:case 2:case 3:var Q=3;break;default:Q=_}var ie=_;_=Q;try{return S()}finally{_=ie}},l.unstable_requestPaint=function(){M=!0},l.unstable_runWithPriority=function(S,Q){switch(S){case 1:case 2:case 3:case 4:case 5:break;default:S=3}var ie=_;_=S;try{return Q()}finally{_=ie}},l.unstable_scheduleCallback=function(S,Q,ie){var pe=l.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?pe+ie:pe):ie=pe,S){case 1:var Ae=-1;break;case 2:Ae=250;break;case 5:Ae=1073741823;break;case 4:Ae=1e4;break;default:Ae=5e3}return Ae=ie+Ae,S={id:v++,callback:Q,priorityLevel:S,startTime:ie,expirationTime:Ae,sortIndex:-1},ie>pe?(S.sortIndex=ie,s(p,S),n(g)===null&&S===n(p)&&(z?(O(oe),oe=-1):z=!0,ye(fe,ie-pe))):(S.sortIndex=Ae,s(g,S),C||j||(C=!0,J||(J=!0,Re()))),S},l.unstable_shouldYield=je,l.unstable_wrapCallback=function(S){var Q=_;return function(){var ie=_;_=Q;try{return S.apply(this,arguments)}finally{_=ie}}}})(cu)),cu}var Cm;function Q0(){return Cm||(Cm=1,ou.exports=V0()),ou.exports}var uu={exports:{}},oa={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rm;function Z0(){if(Rm)return oa;Rm=1;var l=Ru();function s(g){var p="https://react.dev/errors/"+g;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)p+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+g+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var o={d:{f:n,r:function(){throw Error(s(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},d=Symbol.for("react.portal");function h(g,p,v){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:d,key:x==null?null:""+x,children:g,containerInfo:p,implementation:v}}var f=l.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function b(g,p){if(g==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return oa.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=o,oa.createPortal=function(g,p){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(s(299));return h(g,p,null,v)},oa.flushSync=function(g){var p=f.T,v=o.p;try{if(f.T=null,o.p=2,g)return g()}finally{f.T=p,o.p=v,o.d.f()}},oa.preconnect=function(g,p){typeof g=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,o.d.C(g,p))},oa.prefetchDNS=function(g){typeof g=="string"&&o.d.D(g)},oa.preinit=function(g,p){if(typeof g=="string"&&p&&typeof p.as=="string"){var v=p.as,x=b(v,p.crossOrigin),_=typeof p.integrity=="string"?p.integrity:void 0,j=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;v==="style"?o.d.S(g,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:x,integrity:_,fetchPriority:j}):v==="script"&&o.d.X(g,{crossOrigin:x,integrity:_,fetchPriority:j,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},oa.preinitModule=function(g,p){if(typeof g=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var v=b(p.as,p.crossOrigin);o.d.M(g,{crossOrigin:v,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&o.d.M(g)},oa.preload=function(g,p){if(typeof g=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var v=p.as,x=b(v,p.crossOrigin);o.d.L(g,v,{crossOrigin:x,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},oa.preloadModule=function(g,p){if(typeof g=="string")if(p){var v=b(p.as,p.crossOrigin);o.d.m(g,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:v,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else o.d.m(g)},oa.requestFormReset=function(g){o.d.r(g)},oa.unstable_batchedUpdates=function(g,p){return g(p)},oa.useFormState=function(g,p,v){return f.H.useFormState(g,p,v)},oa.useFormStatus=function(){return f.H.useHostTransitionStatus()},oa.version="19.2.3",oa}var zm;function J0(){if(zm)return uu.exports;zm=1;function l(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(l)}catch(s){console.error(s)}}return l(),uu.exports=Z0(),uu.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mm;function X0(){if(Mm)return di;Mm=1;var l=Q0(),s=Ru(),n=J0();function o(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)t+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function d(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function h(e){var t=e,a=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(a=t.return),e=t.return;while(e)}return t.tag===3?a:null}function f(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function b(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function g(e){if(h(e)!==e)throw Error(o(188))}function p(e){var t=e.alternate;if(!t){if(t=h(e),t===null)throw Error(o(188));return t!==e?null:e}for(var a=e,i=t;;){var c=a.return;if(c===null)break;var u=c.alternate;if(u===null){if(i=c.return,i!==null){a=i;continue}break}if(c.child===u.child){for(u=c.child;u;){if(u===a)return g(c),e;if(u===i)return g(c),t;u=u.sibling}throw Error(o(188))}if(a.return!==i.return)a=c,i=u;else{for(var m=!1,y=c.child;y;){if(y===a){m=!0,a=c,i=u;break}if(y===i){m=!0,i=c,a=u;break}y=y.sibling}if(!m){for(y=u.child;y;){if(y===a){m=!0,a=u,i=c;break}if(y===i){m=!0,i=u,a=c;break}y=y.sibling}if(!m)throw Error(o(189))}}if(a.alternate!==i)throw Error(o(190))}if(a.tag!==3)throw Error(o(188));return a.stateNode.current===a?e:t}function v(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=v(e),t!==null)return t;e=e.sibling}return null}var x=Object.assign,_=Symbol.for("react.element"),j=Symbol.for("react.transitional.element"),C=Symbol.for("react.portal"),z=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),O=Symbol.for("react.consumer"),N=Symbol.for("react.context"),G=Symbol.for("react.forward_ref"),fe=Symbol.for("react.suspense"),J=Symbol.for("react.suspense_list"),oe=Symbol.for("react.memo"),ge=Symbol.for("react.lazy"),we=Symbol.for("react.activity"),je=Symbol.for("react.memo_cache_sentinel"),Ue=Symbol.iterator;function Re(e){return e===null||typeof e!="object"?null:(e=Ue&&e[Ue]||e["@@iterator"],typeof e=="function"?e:null)}var Ke=Symbol.for("react.client.reference");function Pe(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===Ke?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case z:return"Fragment";case E:return"Profiler";case M:return"StrictMode";case fe:return"Suspense";case J:return"SuspenseList";case we:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case C:return"Portal";case N:return e.displayName||"Context";case O:return(e._context.displayName||"Context")+".Consumer";case G:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case oe:return t=e.displayName||null,t!==null?t:Pe(e.type)||"Memo";case ge:t=e._payload,e=e._init;try{return Pe(e(t))}catch{}}return null}var ye=Array.isArray,S=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ie={pending:!1,data:null,method:null,action:null},pe=[],Ae=-1;function k(e){return{current:e}}function Z(e){0>Ae||(e.current=pe[Ae],pe[Ae]=null,Ae--)}function me(e,t){Ae++,pe[Ae]=e.current,e.current=t}var be=k(null),Ne=k(null),Be=k(null),Je=k(null);function Rt(e,t){switch(me(Be,t),me(Ne,e),me(be,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?Zf(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=Zf(t),e=Jf(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}Z(be),me(be,e)}function dt(){Z(be),Z(Ne),Z(Be)}function $e(e){e.memoizedState!==null&&me(Je,e);var t=be.current,a=Jf(t,e.type);t!==a&&(me(Ne,e),me(be,a))}function zt(e){Ne.current===e&&(Z(be),Z(Ne)),Je.current===e&&(Z(Je),ii._currentValue=ie)}var Xe,de;function ae(e){if(Xe===void 0)try{throw Error()}catch(a){var t=a.stack.trim().match(/\n( *(at )?)/);Xe=t&&t[1]||"",de=-1<a.stack.indexOf(`
    at`)?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Xe+e+de}var Ge=!1;function Ve(e,t){if(!e||Ge)return"";Ge=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(t){var se=function(){throw Error()};if(Object.defineProperty(se.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(se,[])}catch(Y){var q=Y}Reflect.construct(e,[],se)}else{try{se.call()}catch(Y){q=Y}e.call(se.prototype)}}else{try{throw Error()}catch(Y){q=Y}(se=e())&&typeof se.catch=="function"&&se.catch(function(){})}}catch(Y){if(Y&&q&&typeof Y.stack=="string")return[Y.stack,q.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var c=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");c&&c.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var u=i.DetermineComponentFrameRoot(),m=u[0],y=u[1];if(m&&y){var T=m.split(`
`),$=y.split(`
`);for(c=i=0;i<T.length&&!T[i].includes("DetermineComponentFrameRoot");)i++;for(;c<$.length&&!$[c].includes("DetermineComponentFrameRoot");)c++;if(i===T.length||c===$.length)for(i=T.length-1,c=$.length-1;1<=i&&0<=c&&T[i]!==$[c];)c--;for(;1<=i&&0<=c;i--,c--)if(T[i]!==$[c]){if(i!==1||c!==1)do if(i--,c--,0>c||T[i]!==$[c]){var W=`
`+T[i].replace(" at new "," at ");return e.displayName&&W.includes("<anonymous>")&&(W=W.replace("<anonymous>",e.displayName)),W}while(1<=i&&0<=c);break}}}finally{Ge=!1,Error.prepareStackTrace=a}return(a=e?e.displayName||e.name:"")?ae(a):""}function ct(e,t){switch(e.tag){case 26:case 27:case 5:return ae(e.type);case 16:return ae("Lazy");case 13:return e.child!==t&&t!==null?ae("Suspense Fallback"):ae("Suspense");case 19:return ae("SuspenseList");case 0:case 15:return Ve(e.type,!1);case 11:return Ve(e.type.render,!1);case 1:return Ve(e.type,!0);case 31:return ae("Activity");default:return""}}function Bt(e){try{var t="",a=null;do t+=ct(e,a),a=e,e=e.return;while(e);return t}catch(i){return`
Error generating stack: `+i.message+`
`+i.stack}}var nt=Object.prototype.hasOwnProperty,ha=l.unstable_scheduleCallback,ua=l.unstable_cancelCallback,Ht=l.unstable_shouldYield,fa=l.unstable_requestPaint,Zt=l.unstable_now,Ar=l.unstable_getCurrentPriorityLevel,Si=l.unstable_ImmediatePriority,Ma=l.unstable_UserBlockingPriority,Os=l.unstable_NormalPriority,Jl=l.unstable_LowPriority,w=l.unstable_IdlePriority,A=l.log,U=l.unstable_setDisableYieldValue,B=null,D=null;function ne(e){if(typeof A=="function"&&U(e),D&&typeof D.setStrictMode=="function")try{D.setStrictMode(B,e)}catch{}}var re=Math.clz32?Math.clz32:ee,X=Math.log,K=Math.LN2;function ee(e){return e>>>=0,e===0?32:31-(X(e)/K|0)|0}var P=256,I=262144,V=4194304;function he(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ee(e,t,a){var i=e.pendingLanes;if(i===0)return 0;var c=0,u=e.suspendedLanes,m=e.pingedLanes;e=e.warmLanes;var y=i&134217727;return y!==0?(i=y&~u,i!==0?c=he(i):(m&=y,m!==0?c=he(m):a||(a=y&~e,a!==0&&(c=he(a))))):(y=i&~u,y!==0?c=he(y):m!==0?c=he(m):a||(a=i&~e,a!==0&&(c=he(a)))),c===0?0:t!==0&&t!==c&&(t&u)===0&&(u=c&-c,a=t&-t,u>=a||u===32&&(a&4194048)!==0)?t:c}function Oe(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function Tt(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ht(){var e=V;return V<<=1,(V&62914560)===0&&(V=4194304),e}function et(e){for(var t=[],a=0;31>a;a++)t.push(e);return t}function ft(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Wt(e,t,a,i,c,u){var m=e.pendingLanes;e.pendingLanes=a,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=a,e.entangledLanes&=a,e.errorRecoveryDisabledLanes&=a,e.shellSuspendCounter=0;var y=e.entanglements,T=e.expirationTimes,$=e.hiddenUpdates;for(a=m&~a;0<a;){var W=31-re(a),se=1<<W;y[W]=0,T[W]=-1;var q=$[W];if(q!==null)for($[W]=null,W=0;W<q.length;W++){var Y=q[W];Y!==null&&(Y.lane&=-536870913)}a&=~se}i!==0&&ia(e,i,0),u!==0&&c===0&&e.tag!==0&&(e.suspendedLanes|=u&~(m&~t))}function ia(e,t,a){e.pendingLanes|=t,e.suspendedLanes&=~t;var i=31-re(t);e.entangledLanes|=t,e.entanglements[i]=e.entanglements[i]|1073741824|a&261930}function Se(e,t){var a=e.entangledLanes|=t;for(e=e.entanglements;a;){var i=31-re(a),c=1<<i;c&t|e[i]&t&&(e[i]|=t),a&=~c}}function kt(e,t){var a=t&-t;return a=(a&42)!==0?1:mt(a),(a&(e.suspendedLanes|t))!==0?0:a}function mt(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function $t(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function ve(){var e=Q.p;return e!==0?e:(e=window.event,e===void 0?32:ym(e.type))}function it(e,t){var a=Q.p;try{return Q.p=e,t()}finally{Q.p=a}}var pt=Math.random().toString(36).slice(2),Ie="__reactFiber$"+pt,Le="__reactProps$"+pt,wt="__reactContainer$"+pt,Da="__reactEvents$"+pt,jn="__reactListeners$"+pt,sr="__reactHandles$"+pt,Ei="__reactResources$"+pt,os="__reactMarker$"+pt;function Mt(e){delete e[Ie],delete e[Le],delete e[Da],delete e[jn],delete e[sr]}function Ot(e){var t=e[Ie];if(t)return t;for(var a=e.parentNode;a;){if(t=a[wt]||a[Ie]){if(a=t.alternate,t.child!==null||a!==null&&a.child!==null)for(e=sm(e);e!==null;){if(a=e[Ie])return a;e=sm(e)}return t}e=a,a=e.parentNode}return null}function Ua(e){if(e=e[Ie]||e[wt]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function La(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(o(33))}function la(e){var t=e[Ei];return t||(t=e[Ei]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function _t(e){e[os]=!0}var Cs=new Set,ma={};function as(e,t){kr(e,t),kr(e+"Capture",t)}function kr(e,t){for(ma[e]=t,e=0;e<t.length;e++)Cs.add(t[e])}var Dp=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Bu={},Hu={};function Up(e){return nt.call(Hu,e)?!0:nt.call(Bu,e)?!1:Dp.test(e)?Hu[e]=!0:(Bu[e]=!0,!1)}function Ti(e,t,a){if(Up(t))if(a===null)e.removeAttribute(t);else{switch(typeof a){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var i=t.toLowerCase().slice(0,5);if(i!=="data-"&&i!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+a)}}function Ai(e,t,a){if(a===null)e.removeAttribute(t);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+a)}}function cs(e,t,a,i){if(i===null)e.removeAttribute(a);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(a);return}e.setAttributeNS(t,a,""+i)}}function Ba(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function $u(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Lp(e,t,a){var i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var c=i.get,u=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return c.call(this)},set:function(m){a=""+m,u.call(this,m)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return a},setValue:function(m){a=""+m},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Xl(e){if(!e._valueTracker){var t=$u(e)?"checked":"value";e._valueTracker=Lp(e,t,""+e[t])}}function Iu(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var a=t.getValue(),i="";return e&&(i=$u(e)?e.checked?"true":"false":e.value),e=i,e!==a?(t.setValue(e),!0):!1}function ki(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var Bp=/[\n"\\]/g;function Ha(e){return e.replace(Bp,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function Wl(e,t,a,i,c,u,m,y){e.name="",m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"?e.type=m:e.removeAttribute("type"),t!=null?m==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+Ba(t)):e.value!==""+Ba(t)&&(e.value=""+Ba(t)):m!=="submit"&&m!=="reset"||e.removeAttribute("value"),t!=null?Fl(e,m,Ba(t)):a!=null?Fl(e,m,Ba(a)):i!=null&&e.removeAttribute("value"),c==null&&u!=null&&(e.defaultChecked=!!u),c!=null&&(e.checked=c&&typeof c!="function"&&typeof c!="symbol"),y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"?e.name=""+Ba(y):e.removeAttribute("name")}function qu(e,t,a,i,c,u,m,y){if(u!=null&&typeof u!="function"&&typeof u!="symbol"&&typeof u!="boolean"&&(e.type=u),t!=null||a!=null){if(!(u!=="submit"&&u!=="reset"||t!=null)){Xl(e);return}a=a!=null?""+Ba(a):"",t=t!=null?""+Ba(t):a,y||t===e.value||(e.value=t),e.defaultValue=t}i=i??c,i=typeof i!="function"&&typeof i!="symbol"&&!!i,e.checked=y?e.checked:!!i,e.defaultChecked=!!i,m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(e.name=m),Xl(e)}function Fl(e,t,a){t==="number"&&ki(e.ownerDocument)===e||e.defaultValue===""+a||(e.defaultValue=""+a)}function Or(e,t,a,i){if(e=e.options,t){t={};for(var c=0;c<a.length;c++)t["$"+a[c]]=!0;for(a=0;a<e.length;a++)c=t.hasOwnProperty("$"+e[a].value),e[a].selected!==c&&(e[a].selected=c),c&&i&&(e[a].defaultSelected=!0)}else{for(a=""+Ba(a),t=null,c=0;c<e.length;c++){if(e[c].value===a){e[c].selected=!0,i&&(e[c].defaultSelected=!0);return}t!==null||e[c].disabled||(t=e[c])}t!==null&&(t.selected=!0)}}function Pu(e,t,a){if(t!=null&&(t=""+Ba(t),t!==e.value&&(e.value=t),a==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=a!=null?""+Ba(a):""}function Gu(e,t,a,i){if(t==null){if(i!=null){if(a!=null)throw Error(o(92));if(ye(i)){if(1<i.length)throw Error(o(93));i=i[0]}a=i}a==null&&(a=""),t=a}a=Ba(t),e.defaultValue=a,i=e.textContent,i===a&&i!==""&&i!==null&&(e.value=i),Xl(e)}function Cr(e,t){if(t){var a=e.firstChild;if(a&&a===e.lastChild&&a.nodeType===3){a.nodeValue=t;return}}e.textContent=t}var Hp=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Yu(e,t,a){var i=t.indexOf("--")===0;a==null||typeof a=="boolean"||a===""?i?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":i?e.setProperty(t,a):typeof a!="number"||a===0||Hp.has(t)?t==="float"?e.cssFloat=a:e[t]=(""+a).trim():e[t]=a+"px"}function Ku(e,t,a){if(t!=null&&typeof t!="object")throw Error(o(62));if(e=e.style,a!=null){for(var i in a)!a.hasOwnProperty(i)||t!=null&&t.hasOwnProperty(i)||(i.indexOf("--")===0?e.setProperty(i,""):i==="float"?e.cssFloat="":e[i]="");for(var c in t)i=t[c],t.hasOwnProperty(c)&&a[c]!==i&&Yu(e,c,i)}else for(var u in t)t.hasOwnProperty(u)&&Yu(e,u,t[u])}function eo(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var $p=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ip=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Oi(e){return Ip.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function us(){}var to=null;function ao(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Rr=null,zr=null;function Vu(e){var t=Ua(e);if(t&&(e=t.stateNode)){var a=e[Le]||null;e:switch(e=t.stateNode,t.type){case"input":if(Wl(e,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),t=a.name,a.type==="radio"&&t!=null){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+Ha(""+t)+'"][type="radio"]'),t=0;t<a.length;t++){var i=a[t];if(i!==e&&i.form===e.form){var c=i[Le]||null;if(!c)throw Error(o(90));Wl(i,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name)}}for(t=0;t<a.length;t++)i=a[t],i.form===e.form&&Iu(i)}break e;case"textarea":Pu(e,a.value,a.defaultValue);break e;case"select":t=a.value,t!=null&&Or(e,!!a.multiple,t,!1)}}}var so=!1;function Qu(e,t,a){if(so)return e(t,a);so=!0;try{var i=e(t);return i}finally{if(so=!1,(Rr!==null||zr!==null)&&(bl(),Rr&&(t=Rr,e=zr,zr=Rr=null,Vu(t),e)))for(t=0;t<e.length;t++)Vu(e[t])}}function _n(e,t){var a=e.stateNode;if(a===null)return null;var i=a[Le]||null;if(i===null)return null;a=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(a&&typeof a!="function")throw Error(o(231,t,typeof a));return a}var ds=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ro=!1;if(ds)try{var Nn={};Object.defineProperty(Nn,"passive",{get:function(){ro=!0}}),window.addEventListener("test",Nn,Nn),window.removeEventListener("test",Nn,Nn)}catch{ro=!1}var Rs=null,no=null,Ci=null;function Zu(){if(Ci)return Ci;var e,t=no,a=t.length,i,c="value"in Rs?Rs.value:Rs.textContent,u=c.length;for(e=0;e<a&&t[e]===c[e];e++);var m=a-e;for(i=1;i<=m&&t[a-i]===c[u-i];i++);return Ci=c.slice(e,1<i?1-i:void 0)}function Ri(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function zi(){return!0}function Ju(){return!1}function pa(e){function t(a,i,c,u,m){this._reactName=a,this._targetInst=c,this.type=i,this.nativeEvent=u,this.target=m,this.currentTarget=null;for(var y in e)e.hasOwnProperty(y)&&(a=e[y],this[y]=a?a(u):u[y]);return this.isDefaultPrevented=(u.defaultPrevented!=null?u.defaultPrevented:u.returnValue===!1)?zi:Ju,this.isPropagationStopped=Ju,this}return x(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=zi)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=zi)},persist:function(){},isPersistent:zi}),t}var rr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Mi=pa(rr),Sn=x({},rr,{view:0,detail:0}),qp=pa(Sn),io,lo,En,Di=x({},Sn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:co,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==En&&(En&&e.type==="mousemove"?(io=e.screenX-En.screenX,lo=e.screenY-En.screenY):lo=io=0,En=e),io)},movementY:function(e){return"movementY"in e?e.movementY:lo}}),Xu=pa(Di),Pp=x({},Di,{dataTransfer:0}),Gp=pa(Pp),Yp=x({},Sn,{relatedTarget:0}),oo=pa(Yp),Kp=x({},rr,{animationName:0,elapsedTime:0,pseudoElement:0}),Vp=pa(Kp),Qp=x({},rr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Zp=pa(Qp),Jp=x({},rr,{data:0}),Wu=pa(Jp),Xp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Wp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Fp={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function eg(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Fp[e])?!!t[e]:!1}function co(){return eg}var tg=x({},Sn,{key:function(e){if(e.key){var t=Xp[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ri(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Wp[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:co,charCode:function(e){return e.type==="keypress"?Ri(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ri(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),ag=pa(tg),sg=x({},Di,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fu=pa(sg),rg=x({},Sn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:co}),ng=pa(rg),ig=x({},rr,{propertyName:0,elapsedTime:0,pseudoElement:0}),lg=pa(ig),og=x({},Di,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),cg=pa(og),ug=x({},rr,{newState:0,oldState:0}),dg=pa(ug),hg=[9,13,27,32],uo=ds&&"CompositionEvent"in window,Tn=null;ds&&"documentMode"in document&&(Tn=document.documentMode);var fg=ds&&"TextEvent"in window&&!Tn,ed=ds&&(!uo||Tn&&8<Tn&&11>=Tn),td=" ",ad=!1;function sd(e,t){switch(e){case"keyup":return hg.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rd(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Mr=!1;function mg(e,t){switch(e){case"compositionend":return rd(t);case"keypress":return t.which!==32?null:(ad=!0,td);case"textInput":return e=t.data,e===td&&ad?null:e;default:return null}}function pg(e,t){if(Mr)return e==="compositionend"||!uo&&sd(e,t)?(e=Zu(),Ci=no=Rs=null,Mr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return ed&&t.locale!=="ko"?null:t.data;default:return null}}var gg={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function nd(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!gg[e.type]:t==="textarea"}function id(e,t,a,i){Rr?zr?zr.push(i):zr=[i]:Rr=i,t=Nl(t,"onChange"),0<t.length&&(a=new Mi("onChange","change",null,a,i),e.push({event:a,listeners:t}))}var An=null,kn=null;function bg(e){Pf(e,0)}function Ui(e){var t=La(e);if(Iu(t))return e}function ld(e,t){if(e==="change")return t}var od=!1;if(ds){var ho;if(ds){var fo="oninput"in document;if(!fo){var cd=document.createElement("div");cd.setAttribute("oninput","return;"),fo=typeof cd.oninput=="function"}ho=fo}else ho=!1;od=ho&&(!document.documentMode||9<document.documentMode)}function ud(){An&&(An.detachEvent("onpropertychange",dd),kn=An=null)}function dd(e){if(e.propertyName==="value"&&Ui(kn)){var t=[];id(t,kn,e,ao(e)),Qu(bg,t)}}function xg(e,t,a){e==="focusin"?(ud(),An=t,kn=a,An.attachEvent("onpropertychange",dd)):e==="focusout"&&ud()}function yg(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ui(kn)}function vg(e,t){if(e==="click")return Ui(t)}function wg(e,t){if(e==="input"||e==="change")return Ui(t)}function jg(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ja=typeof Object.is=="function"?Object.is:jg;function On(e,t){if(ja(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var a=Object.keys(e),i=Object.keys(t);if(a.length!==i.length)return!1;for(i=0;i<a.length;i++){var c=a[i];if(!nt.call(t,c)||!ja(e[c],t[c]))return!1}return!0}function hd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function fd(e,t){var a=hd(e);e=0;for(var i;a;){if(a.nodeType===3){if(i=e+a.textContent.length,e<=t&&i>=t)return{node:a,offset:t-e};e=i}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=hd(a)}}function md(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?md(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function pd(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=ki(e.document);t instanceof e.HTMLIFrameElement;){try{var a=typeof t.contentWindow.location.href=="string"}catch{a=!1}if(a)e=t.contentWindow;else break;t=ki(e.document)}return t}function mo(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var _g=ds&&"documentMode"in document&&11>=document.documentMode,Dr=null,po=null,Cn=null,go=!1;function gd(e,t,a){var i=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;go||Dr==null||Dr!==ki(i)||(i=Dr,"selectionStart"in i&&mo(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Cn&&On(Cn,i)||(Cn=i,i=Nl(po,"onSelect"),0<i.length&&(t=new Mi("onSelect","select",null,t,a),e.push({event:t,listeners:i}),t.target=Dr)))}function nr(e,t){var a={};return a[e.toLowerCase()]=t.toLowerCase(),a["Webkit"+e]="webkit"+t,a["Moz"+e]="moz"+t,a}var Ur={animationend:nr("Animation","AnimationEnd"),animationiteration:nr("Animation","AnimationIteration"),animationstart:nr("Animation","AnimationStart"),transitionrun:nr("Transition","TransitionRun"),transitionstart:nr("Transition","TransitionStart"),transitioncancel:nr("Transition","TransitionCancel"),transitionend:nr("Transition","TransitionEnd")},bo={},bd={};ds&&(bd=document.createElement("div").style,"AnimationEvent"in window||(delete Ur.animationend.animation,delete Ur.animationiteration.animation,delete Ur.animationstart.animation),"TransitionEvent"in window||delete Ur.transitionend.transition);function ir(e){if(bo[e])return bo[e];if(!Ur[e])return e;var t=Ur[e],a;for(a in t)if(t.hasOwnProperty(a)&&a in bd)return bo[e]=t[a];return e}var xd=ir("animationend"),yd=ir("animationiteration"),vd=ir("animationstart"),Ng=ir("transitionrun"),Sg=ir("transitionstart"),Eg=ir("transitioncancel"),wd=ir("transitionend"),jd=new Map,xo="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");xo.push("scrollEnd");function Za(e,t){jd.set(e,t),as(t,[e])}var Li=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},$a=[],Lr=0,yo=0;function Bi(){for(var e=Lr,t=yo=Lr=0;t<e;){var a=$a[t];$a[t++]=null;var i=$a[t];$a[t++]=null;var c=$a[t];$a[t++]=null;var u=$a[t];if($a[t++]=null,i!==null&&c!==null){var m=i.pending;m===null?c.next=c:(c.next=m.next,m.next=c),i.pending=c}u!==0&&_d(a,c,u)}}function Hi(e,t,a,i){$a[Lr++]=e,$a[Lr++]=t,$a[Lr++]=a,$a[Lr++]=i,yo|=i,e.lanes|=i,e=e.alternate,e!==null&&(e.lanes|=i)}function vo(e,t,a,i){return Hi(e,t,a,i),$i(e)}function lr(e,t){return Hi(e,null,null,t),$i(e)}function _d(e,t,a){e.lanes|=a;var i=e.alternate;i!==null&&(i.lanes|=a);for(var c=!1,u=e.return;u!==null;)u.childLanes|=a,i=u.alternate,i!==null&&(i.childLanes|=a),u.tag===22&&(e=u.stateNode,e===null||e._visibility&1||(c=!0)),e=u,u=u.return;return e.tag===3?(u=e.stateNode,c&&t!==null&&(c=31-re(a),e=u.hiddenUpdates,i=e[c],i===null?e[c]=[t]:i.push(t),t.lane=a|536870912),u):null}function $i(e){if(50<Fn)throw Fn=0,kc=null,Error(o(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var Br={};function Tg(e,t,a,i){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function _a(e,t,a,i){return new Tg(e,t,a,i)}function wo(e){return e=e.prototype,!(!e||!e.isReactComponent)}function hs(e,t){var a=e.alternate;return a===null?(a=_a(e.tag,t,e.key,e.mode),a.elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=t,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=e.flags&65011712,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,t=e.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a.refCleanup=e.refCleanup,a}function Nd(e,t){e.flags&=65011714;var a=e.alternate;return a===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=a.childLanes,e.lanes=a.lanes,e.child=a.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=a.memoizedProps,e.memoizedState=a.memoizedState,e.updateQueue=a.updateQueue,e.type=a.type,t=a.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Ii(e,t,a,i,c,u){var m=0;if(i=e,typeof e=="function")wo(e)&&(m=1);else if(typeof e=="string")m=R0(e,a,be.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case we:return e=_a(31,a,t,c),e.elementType=we,e.lanes=u,e;case z:return or(a.children,c,u,t);case M:m=8,c|=24;break;case E:return e=_a(12,a,t,c|2),e.elementType=E,e.lanes=u,e;case fe:return e=_a(13,a,t,c),e.elementType=fe,e.lanes=u,e;case J:return e=_a(19,a,t,c),e.elementType=J,e.lanes=u,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case N:m=10;break e;case O:m=9;break e;case G:m=11;break e;case oe:m=14;break e;case ge:m=16,i=null;break e}m=29,a=Error(o(130,e===null?"null":typeof e,"")),i=null}return t=_a(m,a,t,c),t.elementType=e,t.type=i,t.lanes=u,t}function or(e,t,a,i){return e=_a(7,e,i,t),e.lanes=a,e}function jo(e,t,a){return e=_a(6,e,null,t),e.lanes=a,e}function Sd(e){var t=_a(18,null,null,0);return t.stateNode=e,t}function _o(e,t,a){return t=_a(4,e.children!==null?e.children:[],e.key,t),t.lanes=a,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Ed=new WeakMap;function Ia(e,t){if(typeof e=="object"&&e!==null){var a=Ed.get(e);return a!==void 0?a:(t={value:e,source:t,stack:Bt(t)},Ed.set(e,t),t)}return{value:e,source:t,stack:Bt(t)}}var Hr=[],$r=0,qi=null,Rn=0,qa=[],Pa=0,zs=null,ss=1,rs="";function fs(e,t){Hr[$r++]=Rn,Hr[$r++]=qi,qi=e,Rn=t}function Td(e,t,a){qa[Pa++]=ss,qa[Pa++]=rs,qa[Pa++]=zs,zs=e;var i=ss;e=rs;var c=32-re(i)-1;i&=~(1<<c),a+=1;var u=32-re(t)+c;if(30<u){var m=c-c%5;u=(i&(1<<m)-1).toString(32),i>>=m,c-=m,ss=1<<32-re(t)+c|a<<c|i,rs=u+e}else ss=1<<u|a<<c|i,rs=e}function No(e){e.return!==null&&(fs(e,1),Td(e,1,0))}function So(e){for(;e===qi;)qi=Hr[--$r],Hr[$r]=null,Rn=Hr[--$r],Hr[$r]=null;for(;e===zs;)zs=qa[--Pa],qa[Pa]=null,rs=qa[--Pa],qa[Pa]=null,ss=qa[--Pa],qa[Pa]=null}function Ad(e,t){qa[Pa++]=ss,qa[Pa++]=rs,qa[Pa++]=zs,ss=t.id,rs=t.overflow,zs=e}var ea=null,St=null,rt=!1,Ms=null,Ga=!1,Eo=Error(o(519));function Ds(e){var t=Error(o(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw zn(Ia(t,e)),Eo}function kd(e){var t=e.stateNode,a=e.type,i=e.memoizedProps;switch(t[Ie]=e,t[Le]=i,a){case"dialog":Fe("cancel",t),Fe("close",t);break;case"iframe":case"object":case"embed":Fe("load",t);break;case"video":case"audio":for(a=0;a<ti.length;a++)Fe(ti[a],t);break;case"source":Fe("error",t);break;case"img":case"image":case"link":Fe("error",t),Fe("load",t);break;case"details":Fe("toggle",t);break;case"input":Fe("invalid",t),qu(t,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0);break;case"select":Fe("invalid",t);break;case"textarea":Fe("invalid",t),Gu(t,i.value,i.defaultValue,i.children)}a=i.children,typeof a!="string"&&typeof a!="number"&&typeof a!="bigint"||t.textContent===""+a||i.suppressHydrationWarning===!0||Vf(t.textContent,a)?(i.popover!=null&&(Fe("beforetoggle",t),Fe("toggle",t)),i.onScroll!=null&&Fe("scroll",t),i.onScrollEnd!=null&&Fe("scrollend",t),i.onClick!=null&&(t.onclick=us),t=!0):t=!1,t||Ds(e,!0)}function Od(e){for(ea=e.return;ea;)switch(ea.tag){case 5:case 31:case 13:Ga=!1;return;case 27:case 3:Ga=!0;return;default:ea=ea.return}}function Ir(e){if(e!==ea)return!1;if(!rt)return Od(e),rt=!0,!1;var t=e.tag,a;if((a=t!==3&&t!==27)&&((a=t===5)&&(a=e.type,a=!(a!=="form"&&a!=="button")||Gc(e.type,e.memoizedProps)),a=!a),a&&St&&Ds(e),Od(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(o(317));St=am(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(o(317));St=am(e)}else t===27?(t=St,Zs(e.type)?(e=Zc,Zc=null,St=e):St=t):St=ea?Ka(e.stateNode.nextSibling):null;return!0}function cr(){St=ea=null,rt=!1}function To(){var e=Ms;return e!==null&&(ya===null?ya=e:ya.push.apply(ya,e),Ms=null),e}function zn(e){Ms===null?Ms=[e]:Ms.push(e)}var Ao=k(null),ur=null,ms=null;function Us(e,t,a){me(Ao,t._currentValue),t._currentValue=a}function ps(e){e._currentValue=Ao.current,Z(Ao)}function ko(e,t,a){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===a)break;e=e.return}}function Oo(e,t,a,i){var c=e.child;for(c!==null&&(c.return=e);c!==null;){var u=c.dependencies;if(u!==null){var m=c.child;u=u.firstContext;e:for(;u!==null;){var y=u;u=c;for(var T=0;T<t.length;T++)if(y.context===t[T]){u.lanes|=a,y=u.alternate,y!==null&&(y.lanes|=a),ko(u.return,a,e),i||(m=null);break e}u=y.next}}else if(c.tag===18){if(m=c.return,m===null)throw Error(o(341));m.lanes|=a,u=m.alternate,u!==null&&(u.lanes|=a),ko(m,a,e),m=null}else m=c.child;if(m!==null)m.return=c;else for(m=c;m!==null;){if(m===e){m=null;break}if(c=m.sibling,c!==null){c.return=m.return,m=c;break}m=m.return}c=m}}function qr(e,t,a,i){e=null;for(var c=t,u=!1;c!==null;){if(!u){if((c.flags&524288)!==0)u=!0;else if((c.flags&262144)!==0)break}if(c.tag===10){var m=c.alternate;if(m===null)throw Error(o(387));if(m=m.memoizedProps,m!==null){var y=c.type;ja(c.pendingProps.value,m.value)||(e!==null?e.push(y):e=[y])}}else if(c===Je.current){if(m=c.alternate,m===null)throw Error(o(387));m.memoizedState.memoizedState!==c.memoizedState.memoizedState&&(e!==null?e.push(ii):e=[ii])}c=c.return}e!==null&&Oo(t,e,a,i),t.flags|=262144}function Pi(e){for(e=e.firstContext;e!==null;){if(!ja(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function dr(e){ur=e,ms=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function ta(e){return Cd(ur,e)}function Gi(e,t){return ur===null&&dr(e),Cd(e,t)}function Cd(e,t){var a=t._currentValue;if(t={context:t,memoizedValue:a,next:null},ms===null){if(e===null)throw Error(o(308));ms=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else ms=ms.next=t;return a}var Ag=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(a,i){e.push(i)}};this.abort=function(){t.aborted=!0,e.forEach(function(a){return a()})}},kg=l.unstable_scheduleCallback,Og=l.unstable_NormalPriority,Gt={$$typeof:N,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Co(){return{controller:new Ag,data:new Map,refCount:0}}function Mn(e){e.refCount--,e.refCount===0&&kg(Og,function(){e.controller.abort()})}var Dn=null,Ro=0,Pr=0,Gr=null;function Cg(e,t){if(Dn===null){var a=Dn=[];Ro=0,Pr=Dc(),Gr={status:"pending",value:void 0,then:function(i){a.push(i)}}}return Ro++,t.then(Rd,Rd),t}function Rd(){if(--Ro===0&&Dn!==null){Gr!==null&&(Gr.status="fulfilled");var e=Dn;Dn=null,Pr=0,Gr=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function Rg(e,t){var a=[],i={status:"pending",value:null,reason:null,then:function(c){a.push(c)}};return e.then(function(){i.status="fulfilled",i.value=t;for(var c=0;c<a.length;c++)(0,a[c])(t)},function(c){for(i.status="rejected",i.reason=c,c=0;c<a.length;c++)(0,a[c])(void 0)}),i}var zd=S.S;S.S=function(e,t){bf=Zt(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&Cg(e,t),zd!==null&&zd(e,t)};var hr=k(null);function zo(){var e=hr.current;return e!==null?e:jt.pooledCache}function Yi(e,t){t===null?me(hr,hr.current):me(hr,t.pool)}function Md(){var e=zo();return e===null?null:{parent:Gt._currentValue,pool:e}}var Yr=Error(o(460)),Mo=Error(o(474)),Ki=Error(o(542)),Vi={then:function(){}};function Dd(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Ud(e,t,a){switch(a=e[a],a===void 0?e.push(t):a!==t&&(t.then(us,us),t=a),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Bd(e),e;default:if(typeof t.status=="string")t.then(us,us);else{if(e=jt,e!==null&&100<e.shellSuspendCounter)throw Error(o(482));e=t,e.status="pending",e.then(function(i){if(t.status==="pending"){var c=t;c.status="fulfilled",c.value=i}},function(i){if(t.status==="pending"){var c=t;c.status="rejected",c.reason=i}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Bd(e),e}throw mr=t,Yr}}function fr(e){try{var t=e._init;return t(e._payload)}catch(a){throw a!==null&&typeof a=="object"&&typeof a.then=="function"?(mr=a,Yr):a}}var mr=null;function Ld(){if(mr===null)throw Error(o(459));var e=mr;return mr=null,e}function Bd(e){if(e===Yr||e===Ki)throw Error(o(483))}var Kr=null,Un=0;function Qi(e){var t=Un;return Un+=1,Kr===null&&(Kr=[]),Ud(Kr,e,t)}function Ln(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function Zi(e,t){throw t.$$typeof===_?Error(o(525)):(e=Object.prototype.toString.call(t),Error(o(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function Hd(e){function t(L,R){if(e){var H=L.deletions;H===null?(L.deletions=[R],L.flags|=16):H.push(R)}}function a(L,R){if(!e)return null;for(;R!==null;)t(L,R),R=R.sibling;return null}function i(L){for(var R=new Map;L!==null;)L.key!==null?R.set(L.key,L):R.set(L.index,L),L=L.sibling;return R}function c(L,R){return L=hs(L,R),L.index=0,L.sibling=null,L}function u(L,R,H){return L.index=H,e?(H=L.alternate,H!==null?(H=H.index,H<R?(L.flags|=67108866,R):H):(L.flags|=67108866,R)):(L.flags|=1048576,R)}function m(L){return e&&L.alternate===null&&(L.flags|=67108866),L}function y(L,R,H,te){return R===null||R.tag!==6?(R=jo(H,L.mode,te),R.return=L,R):(R=c(R,H),R.return=L,R)}function T(L,R,H,te){var Ce=H.type;return Ce===z?W(L,R,H.props.children,te,H.key):R!==null&&(R.elementType===Ce||typeof Ce=="object"&&Ce!==null&&Ce.$$typeof===ge&&fr(Ce)===R.type)?(R=c(R,H.props),Ln(R,H),R.return=L,R):(R=Ii(H.type,H.key,H.props,null,L.mode,te),Ln(R,H),R.return=L,R)}function $(L,R,H,te){return R===null||R.tag!==4||R.stateNode.containerInfo!==H.containerInfo||R.stateNode.implementation!==H.implementation?(R=_o(H,L.mode,te),R.return=L,R):(R=c(R,H.children||[]),R.return=L,R)}function W(L,R,H,te,Ce){return R===null||R.tag!==7?(R=or(H,L.mode,te,Ce),R.return=L,R):(R=c(R,H),R.return=L,R)}function se(L,R,H){if(typeof R=="string"&&R!==""||typeof R=="number"||typeof R=="bigint")return R=jo(""+R,L.mode,H),R.return=L,R;if(typeof R=="object"&&R!==null){switch(R.$$typeof){case j:return H=Ii(R.type,R.key,R.props,null,L.mode,H),Ln(H,R),H.return=L,H;case C:return R=_o(R,L.mode,H),R.return=L,R;case ge:return R=fr(R),se(L,R,H)}if(ye(R)||Re(R))return R=or(R,L.mode,H,null),R.return=L,R;if(typeof R.then=="function")return se(L,Qi(R),H);if(R.$$typeof===N)return se(L,Gi(L,R),H);Zi(L,R)}return null}function q(L,R,H,te){var Ce=R!==null?R.key:null;if(typeof H=="string"&&H!==""||typeof H=="number"||typeof H=="bigint")return Ce!==null?null:y(L,R,""+H,te);if(typeof H=="object"&&H!==null){switch(H.$$typeof){case j:return H.key===Ce?T(L,R,H,te):null;case C:return H.key===Ce?$(L,R,H,te):null;case ge:return H=fr(H),q(L,R,H,te)}if(ye(H)||Re(H))return Ce!==null?null:W(L,R,H,te,null);if(typeof H.then=="function")return q(L,R,Qi(H),te);if(H.$$typeof===N)return q(L,R,Gi(L,H),te);Zi(L,H)}return null}function Y(L,R,H,te,Ce){if(typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint")return L=L.get(H)||null,y(R,L,""+te,Ce);if(typeof te=="object"&&te!==null){switch(te.$$typeof){case j:return L=L.get(te.key===null?H:te.key)||null,T(R,L,te,Ce);case C:return L=L.get(te.key===null?H:te.key)||null,$(R,L,te,Ce);case ge:return te=fr(te),Y(L,R,H,te,Ce)}if(ye(te)||Re(te))return L=L.get(H)||null,W(R,L,te,Ce,null);if(typeof te.then=="function")return Y(L,R,H,Qi(te),Ce);if(te.$$typeof===N)return Y(L,R,H,Gi(R,te),Ce);Zi(R,te)}return null}function _e(L,R,H,te){for(var Ce=null,lt=null,Te=R,Qe=R=0,at=null;Te!==null&&Qe<H.length;Qe++){Te.index>Qe?(at=Te,Te=null):at=Te.sibling;var ot=q(L,Te,H[Qe],te);if(ot===null){Te===null&&(Te=at);break}e&&Te&&ot.alternate===null&&t(L,Te),R=u(ot,R,Qe),lt===null?Ce=ot:lt.sibling=ot,lt=ot,Te=at}if(Qe===H.length)return a(L,Te),rt&&fs(L,Qe),Ce;if(Te===null){for(;Qe<H.length;Qe++)Te=se(L,H[Qe],te),Te!==null&&(R=u(Te,R,Qe),lt===null?Ce=Te:lt.sibling=Te,lt=Te);return rt&&fs(L,Qe),Ce}for(Te=i(Te);Qe<H.length;Qe++)at=Y(Te,L,Qe,H[Qe],te),at!==null&&(e&&at.alternate!==null&&Te.delete(at.key===null?Qe:at.key),R=u(at,R,Qe),lt===null?Ce=at:lt.sibling=at,lt=at);return e&&Te.forEach(function(er){return t(L,er)}),rt&&fs(L,Qe),Ce}function ze(L,R,H,te){if(H==null)throw Error(o(151));for(var Ce=null,lt=null,Te=R,Qe=R=0,at=null,ot=H.next();Te!==null&&!ot.done;Qe++,ot=H.next()){Te.index>Qe?(at=Te,Te=null):at=Te.sibling;var er=q(L,Te,ot.value,te);if(er===null){Te===null&&(Te=at);break}e&&Te&&er.alternate===null&&t(L,Te),R=u(er,R,Qe),lt===null?Ce=er:lt.sibling=er,lt=er,Te=at}if(ot.done)return a(L,Te),rt&&fs(L,Qe),Ce;if(Te===null){for(;!ot.done;Qe++,ot=H.next())ot=se(L,ot.value,te),ot!==null&&(R=u(ot,R,Qe),lt===null?Ce=ot:lt.sibling=ot,lt=ot);return rt&&fs(L,Qe),Ce}for(Te=i(Te);!ot.done;Qe++,ot=H.next())ot=Y(Te,L,Qe,ot.value,te),ot!==null&&(e&&ot.alternate!==null&&Te.delete(ot.key===null?Qe:ot.key),R=u(ot,R,Qe),lt===null?Ce=ot:lt.sibling=ot,lt=ot);return e&&Te.forEach(function(P0){return t(L,P0)}),rt&&fs(L,Qe),Ce}function vt(L,R,H,te){if(typeof H=="object"&&H!==null&&H.type===z&&H.key===null&&(H=H.props.children),typeof H=="object"&&H!==null){switch(H.$$typeof){case j:e:{for(var Ce=H.key;R!==null;){if(R.key===Ce){if(Ce=H.type,Ce===z){if(R.tag===7){a(L,R.sibling),te=c(R,H.props.children),te.return=L,L=te;break e}}else if(R.elementType===Ce||typeof Ce=="object"&&Ce!==null&&Ce.$$typeof===ge&&fr(Ce)===R.type){a(L,R.sibling),te=c(R,H.props),Ln(te,H),te.return=L,L=te;break e}a(L,R);break}else t(L,R);R=R.sibling}H.type===z?(te=or(H.props.children,L.mode,te,H.key),te.return=L,L=te):(te=Ii(H.type,H.key,H.props,null,L.mode,te),Ln(te,H),te.return=L,L=te)}return m(L);case C:e:{for(Ce=H.key;R!==null;){if(R.key===Ce)if(R.tag===4&&R.stateNode.containerInfo===H.containerInfo&&R.stateNode.implementation===H.implementation){a(L,R.sibling),te=c(R,H.children||[]),te.return=L,L=te;break e}else{a(L,R);break}else t(L,R);R=R.sibling}te=_o(H,L.mode,te),te.return=L,L=te}return m(L);case ge:return H=fr(H),vt(L,R,H,te)}if(ye(H))return _e(L,R,H,te);if(Re(H)){if(Ce=Re(H),typeof Ce!="function")throw Error(o(150));return H=Ce.call(H),ze(L,R,H,te)}if(typeof H.then=="function")return vt(L,R,Qi(H),te);if(H.$$typeof===N)return vt(L,R,Gi(L,H),te);Zi(L,H)}return typeof H=="string"&&H!==""||typeof H=="number"||typeof H=="bigint"?(H=""+H,R!==null&&R.tag===6?(a(L,R.sibling),te=c(R,H),te.return=L,L=te):(a(L,R),te=jo(H,L.mode,te),te.return=L,L=te),m(L)):a(L,R)}return function(L,R,H,te){try{Un=0;var Ce=vt(L,R,H,te);return Kr=null,Ce}catch(Te){if(Te===Yr||Te===Ki)throw Te;var lt=_a(29,Te,null,L.mode);return lt.lanes=te,lt.return=L,lt}finally{}}}var pr=Hd(!0),$d=Hd(!1),Ls=!1;function Do(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Uo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Bs(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Hs(e,t,a){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,(ut&2)!==0){var c=i.pending;return c===null?t.next=t:(t.next=c.next,c.next=t),i.pending=t,t=$i(e),_d(e,null,a),t}return Hi(e,i,t,a),$i(e)}function Bn(e,t,a){if(t=t.updateQueue,t!==null&&(t=t.shared,(a&4194048)!==0)){var i=t.lanes;i&=e.pendingLanes,a|=i,t.lanes=a,Se(e,a)}}function Lo(e,t){var a=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,a===i)){var c=null,u=null;if(a=a.firstBaseUpdate,a!==null){do{var m={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};u===null?c=u=m:u=u.next=m,a=a.next}while(a!==null);u===null?c=u=t:u=u.next=t}else c=u=t;a={baseState:i.baseState,firstBaseUpdate:c,lastBaseUpdate:u,shared:i.shared,callbacks:i.callbacks},e.updateQueue=a;return}e=a.lastBaseUpdate,e===null?a.firstBaseUpdate=t:e.next=t,a.lastBaseUpdate=t}var Bo=!1;function Hn(){if(Bo){var e=Gr;if(e!==null)throw e}}function $n(e,t,a,i){Bo=!1;var c=e.updateQueue;Ls=!1;var u=c.firstBaseUpdate,m=c.lastBaseUpdate,y=c.shared.pending;if(y!==null){c.shared.pending=null;var T=y,$=T.next;T.next=null,m===null?u=$:m.next=$,m=T;var W=e.alternate;W!==null&&(W=W.updateQueue,y=W.lastBaseUpdate,y!==m&&(y===null?W.firstBaseUpdate=$:y.next=$,W.lastBaseUpdate=T))}if(u!==null){var se=c.baseState;m=0,W=$=T=null,y=u;do{var q=y.lane&-536870913,Y=q!==y.lane;if(Y?(tt&q)===q:(i&q)===q){q!==0&&q===Pr&&(Bo=!0),W!==null&&(W=W.next={lane:0,tag:y.tag,payload:y.payload,callback:null,next:null});e:{var _e=e,ze=y;q=t;var vt=a;switch(ze.tag){case 1:if(_e=ze.payload,typeof _e=="function"){se=_e.call(vt,se,q);break e}se=_e;break e;case 3:_e.flags=_e.flags&-65537|128;case 0:if(_e=ze.payload,q=typeof _e=="function"?_e.call(vt,se,q):_e,q==null)break e;se=x({},se,q);break e;case 2:Ls=!0}}q=y.callback,q!==null&&(e.flags|=64,Y&&(e.flags|=8192),Y=c.callbacks,Y===null?c.callbacks=[q]:Y.push(q))}else Y={lane:q,tag:y.tag,payload:y.payload,callback:y.callback,next:null},W===null?($=W=Y,T=se):W=W.next=Y,m|=q;if(y=y.next,y===null){if(y=c.shared.pending,y===null)break;Y=y,y=Y.next,Y.next=null,c.lastBaseUpdate=Y,c.shared.pending=null}}while(!0);W===null&&(T=se),c.baseState=T,c.firstBaseUpdate=$,c.lastBaseUpdate=W,u===null&&(c.shared.lanes=0),Gs|=m,e.lanes=m,e.memoizedState=se}}function Id(e,t){if(typeof e!="function")throw Error(o(191,e));e.call(t)}function qd(e,t){var a=e.callbacks;if(a!==null)for(e.callbacks=null,e=0;e<a.length;e++)Id(a[e],t)}var Vr=k(null),Ji=k(0);function Pd(e,t){e=Ns,me(Ji,e),me(Vr,t),Ns=e|t.baseLanes}function Ho(){me(Ji,Ns),me(Vr,Vr.current)}function $o(){Ns=Ji.current,Z(Vr),Z(Ji)}var Na=k(null),Ya=null;function $s(e){var t=e.alternate;me(It,It.current&1),me(Na,e),Ya===null&&(t===null||Vr.current!==null||t.memoizedState!==null)&&(Ya=e)}function Io(e){me(It,It.current),me(Na,e),Ya===null&&(Ya=e)}function Gd(e){e.tag===22?(me(It,It.current),me(Na,e),Ya===null&&(Ya=e)):Is()}function Is(){me(It,It.current),me(Na,Na.current)}function Sa(e){Z(Na),Ya===e&&(Ya=null),Z(It)}var It=k(0);function Xi(e){for(var t=e;t!==null;){if(t.tag===13){var a=t.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||Vc(a)||Qc(a)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var gs=0,Ye=null,xt=null,Yt=null,Wi=!1,Qr=!1,gr=!1,Fi=0,In=0,Zr=null,zg=0;function Dt(){throw Error(o(321))}function qo(e,t){if(t===null)return!1;for(var a=0;a<t.length&&a<e.length;a++)if(!ja(e[a],t[a]))return!1;return!0}function Po(e,t,a,i,c,u){return gs=u,Ye=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,S.H=e===null||e.memoizedState===null?Th:rc,gr=!1,u=a(i,c),gr=!1,Qr&&(u=Kd(t,a,i,c)),Yd(e),u}function Yd(e){S.H=Gn;var t=xt!==null&&xt.next!==null;if(gs=0,Yt=xt=Ye=null,Wi=!1,In=0,Zr=null,t)throw Error(o(300));e===null||Kt||(e=e.dependencies,e!==null&&Pi(e)&&(Kt=!0))}function Kd(e,t,a,i){Ye=e;var c=0;do{if(Qr&&(Zr=null),In=0,Qr=!1,25<=c)throw Error(o(301));if(c+=1,Yt=xt=null,e.updateQueue!=null){var u=e.updateQueue;u.lastEffect=null,u.events=null,u.stores=null,u.memoCache!=null&&(u.memoCache.index=0)}S.H=Ah,u=t(a,i)}while(Qr);return u}function Mg(){var e=S.H,t=e.useState()[0];return t=typeof t.then=="function"?qn(t):t,e=e.useState()[0],(xt!==null?xt.memoizedState:null)!==e&&(Ye.flags|=1024),t}function Go(){var e=Fi!==0;return Fi=0,e}function Yo(e,t,a){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a}function Ko(e){if(Wi){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}Wi=!1}gs=0,Yt=xt=Ye=null,Qr=!1,In=Fi=0,Zr=null}function da(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yt===null?Ye.memoizedState=Yt=e:Yt=Yt.next=e,Yt}function qt(){if(xt===null){var e=Ye.alternate;e=e!==null?e.memoizedState:null}else e=xt.next;var t=Yt===null?Ye.memoizedState:Yt.next;if(t!==null)Yt=t,xt=e;else{if(e===null)throw Ye.alternate===null?Error(o(467)):Error(o(310));xt=e,e={memoizedState:xt.memoizedState,baseState:xt.baseState,baseQueue:xt.baseQueue,queue:xt.queue,next:null},Yt===null?Ye.memoizedState=Yt=e:Yt=Yt.next=e}return Yt}function el(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function qn(e){var t=In;return In+=1,Zr===null&&(Zr=[]),e=Ud(Zr,e,t),t=Ye,(Yt===null?t.memoizedState:Yt.next)===null&&(t=t.alternate,S.H=t===null||t.memoizedState===null?Th:rc),e}function tl(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return qn(e);if(e.$$typeof===N)return ta(e)}throw Error(o(438,String(e)))}function Vo(e){var t=null,a=Ye.updateQueue;if(a!==null&&(t=a.memoCache),t==null){var i=Ye.alternate;i!==null&&(i=i.updateQueue,i!==null&&(i=i.memoCache,i!=null&&(t={data:i.data.map(function(c){return c.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),a===null&&(a=el(),Ye.updateQueue=a),a.memoCache=t,a=t.data[t.index],a===void 0)for(a=t.data[t.index]=Array(e),i=0;i<e;i++)a[i]=je;return t.index++,a}function bs(e,t){return typeof t=="function"?t(e):t}function al(e){var t=qt();return Qo(t,xt,e)}function Qo(e,t,a){var i=e.queue;if(i===null)throw Error(o(311));i.lastRenderedReducer=a;var c=e.baseQueue,u=i.pending;if(u!==null){if(c!==null){var m=c.next;c.next=u.next,u.next=m}t.baseQueue=c=u,i.pending=null}if(u=e.baseState,c===null)e.memoizedState=u;else{t=c.next;var y=m=null,T=null,$=t,W=!1;do{var se=$.lane&-536870913;if(se!==$.lane?(tt&se)===se:(gs&se)===se){var q=$.revertLane;if(q===0)T!==null&&(T=T.next={lane:0,revertLane:0,gesture:null,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null}),se===Pr&&(W=!0);else if((gs&q)===q){$=$.next,q===Pr&&(W=!0);continue}else se={lane:0,revertLane:$.revertLane,gesture:null,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null},T===null?(y=T=se,m=u):T=T.next=se,Ye.lanes|=q,Gs|=q;se=$.action,gr&&a(u,se),u=$.hasEagerState?$.eagerState:a(u,se)}else q={lane:se,revertLane:$.revertLane,gesture:$.gesture,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null},T===null?(y=T=q,m=u):T=T.next=q,Ye.lanes|=se,Gs|=se;$=$.next}while($!==null&&$!==t);if(T===null?m=u:T.next=y,!ja(u,e.memoizedState)&&(Kt=!0,W&&(a=Gr,a!==null)))throw a;e.memoizedState=u,e.baseState=m,e.baseQueue=T,i.lastRenderedState=u}return c===null&&(i.lanes=0),[e.memoizedState,i.dispatch]}function Zo(e){var t=qt(),a=t.queue;if(a===null)throw Error(o(311));a.lastRenderedReducer=e;var i=a.dispatch,c=a.pending,u=t.memoizedState;if(c!==null){a.pending=null;var m=c=c.next;do u=e(u,m.action),m=m.next;while(m!==c);ja(u,t.memoizedState)||(Kt=!0),t.memoizedState=u,t.baseQueue===null&&(t.baseState=u),a.lastRenderedState=u}return[u,i]}function Vd(e,t,a){var i=Ye,c=qt(),u=rt;if(u){if(a===void 0)throw Error(o(407));a=a()}else a=t();var m=!ja((xt||c).memoizedState,a);if(m&&(c.memoizedState=a,Kt=!0),c=c.queue,Wo(Jd.bind(null,i,c,e),[e]),c.getSnapshot!==t||m||Yt!==null&&Yt.memoizedState.tag&1){if(i.flags|=2048,Jr(9,{destroy:void 0},Zd.bind(null,i,c,a,t),null),jt===null)throw Error(o(349));u||(gs&127)!==0||Qd(i,t,a)}return a}function Qd(e,t,a){e.flags|=16384,e={getSnapshot:t,value:a},t=Ye.updateQueue,t===null?(t=el(),Ye.updateQueue=t,t.stores=[e]):(a=t.stores,a===null?t.stores=[e]:a.push(e))}function Zd(e,t,a,i){t.value=a,t.getSnapshot=i,Xd(t)&&Wd(e)}function Jd(e,t,a){return a(function(){Xd(t)&&Wd(e)})}function Xd(e){var t=e.getSnapshot;e=e.value;try{var a=t();return!ja(e,a)}catch{return!0}}function Wd(e){var t=lr(e,2);t!==null&&va(t,e,2)}function Jo(e){var t=da();if(typeof e=="function"){var a=e;if(e=a(),gr){ne(!0);try{a()}finally{ne(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:bs,lastRenderedState:e},t}function Fd(e,t,a,i){return e.baseState=a,Qo(e,xt,typeof i=="function"?i:bs)}function Dg(e,t,a,i,c){if(nl(e))throw Error(o(485));if(e=t.action,e!==null){var u={payload:c,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(m){u.listeners.push(m)}};S.T!==null?a(!0):u.isTransition=!1,i(u),a=t.pending,a===null?(u.next=t.pending=u,eh(t,u)):(u.next=a.next,t.pending=a.next=u)}}function eh(e,t){var a=t.action,i=t.payload,c=e.state;if(t.isTransition){var u=S.T,m={};S.T=m;try{var y=a(c,i),T=S.S;T!==null&&T(m,y),th(e,t,y)}catch($){Xo(e,t,$)}finally{u!==null&&m.types!==null&&(u.types=m.types),S.T=u}}else try{u=a(c,i),th(e,t,u)}catch($){Xo(e,t,$)}}function th(e,t,a){a!==null&&typeof a=="object"&&typeof a.then=="function"?a.then(function(i){ah(e,t,i)},function(i){return Xo(e,t,i)}):ah(e,t,a)}function ah(e,t,a){t.status="fulfilled",t.value=a,sh(t),e.state=a,t=e.pending,t!==null&&(a=t.next,a===t?e.pending=null:(a=a.next,t.next=a,eh(e,a)))}function Xo(e,t,a){var i=e.pending;if(e.pending=null,i!==null){i=i.next;do t.status="rejected",t.reason=a,sh(t),t=t.next;while(t!==i)}e.action=null}function sh(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function rh(e,t){return t}function nh(e,t){if(rt){var a=jt.formState;if(a!==null){e:{var i=Ye;if(rt){if(St){t:{for(var c=St,u=Ga;c.nodeType!==8;){if(!u){c=null;break t}if(c=Ka(c.nextSibling),c===null){c=null;break t}}u=c.data,c=u==="F!"||u==="F"?c:null}if(c){St=Ka(c.nextSibling),i=c.data==="F!";break e}}Ds(i)}i=!1}i&&(t=a[0])}}return a=da(),a.memoizedState=a.baseState=t,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:rh,lastRenderedState:t},a.queue=i,a=Nh.bind(null,Ye,i),i.dispatch=a,i=Jo(!1),u=sc.bind(null,Ye,!1,i.queue),i=da(),c={state:t,dispatch:null,action:e,pending:null},i.queue=c,a=Dg.bind(null,Ye,c,u,a),c.dispatch=a,i.memoizedState=e,[t,a,!1]}function ih(e){var t=qt();return lh(t,xt,e)}function lh(e,t,a){if(t=Qo(e,t,rh)[0],e=al(bs)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var i=qn(t)}catch(m){throw m===Yr?Ki:m}else i=t;t=qt();var c=t.queue,u=c.dispatch;return a!==t.memoizedState&&(Ye.flags|=2048,Jr(9,{destroy:void 0},Ug.bind(null,c,a),null)),[i,u,e]}function Ug(e,t){e.action=t}function oh(e){var t=qt(),a=xt;if(a!==null)return lh(t,a,e);qt(),t=t.memoizedState,a=qt();var i=a.queue.dispatch;return a.memoizedState=e,[t,i,!1]}function Jr(e,t,a,i){return e={tag:e,create:a,deps:i,inst:t,next:null},t=Ye.updateQueue,t===null&&(t=el(),Ye.updateQueue=t),a=t.lastEffect,a===null?t.lastEffect=e.next=e:(i=a.next,a.next=e,e.next=i,t.lastEffect=e),e}function ch(){return qt().memoizedState}function sl(e,t,a,i){var c=da();Ye.flags|=e,c.memoizedState=Jr(1|t,{destroy:void 0},a,i===void 0?null:i)}function rl(e,t,a,i){var c=qt();i=i===void 0?null:i;var u=c.memoizedState.inst;xt!==null&&i!==null&&qo(i,xt.memoizedState.deps)?c.memoizedState=Jr(t,u,a,i):(Ye.flags|=e,c.memoizedState=Jr(1|t,u,a,i))}function uh(e,t){sl(8390656,8,e,t)}function Wo(e,t){rl(2048,8,e,t)}function Lg(e){Ye.flags|=4;var t=Ye.updateQueue;if(t===null)t=el(),Ye.updateQueue=t,t.events=[e];else{var a=t.events;a===null?t.events=[e]:a.push(e)}}function dh(e){var t=qt().memoizedState;return Lg({ref:t,nextImpl:e}),function(){if((ut&2)!==0)throw Error(o(440));return t.impl.apply(void 0,arguments)}}function hh(e,t){return rl(4,2,e,t)}function fh(e,t){return rl(4,4,e,t)}function mh(e,t){if(typeof t=="function"){e=e();var a=t(e);return function(){typeof a=="function"?a():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function ph(e,t,a){a=a!=null?a.concat([e]):null,rl(4,4,mh.bind(null,t,e),a)}function Fo(){}function gh(e,t){var a=qt();t=t===void 0?null:t;var i=a.memoizedState;return t!==null&&qo(t,i[1])?i[0]:(a.memoizedState=[e,t],e)}function bh(e,t){var a=qt();t=t===void 0?null:t;var i=a.memoizedState;if(t!==null&&qo(t,i[1]))return i[0];if(i=e(),gr){ne(!0);try{e()}finally{ne(!1)}}return a.memoizedState=[i,t],i}function ec(e,t,a){return a===void 0||(gs&1073741824)!==0&&(tt&261930)===0?e.memoizedState=t:(e.memoizedState=a,e=yf(),Ye.lanes|=e,Gs|=e,a)}function xh(e,t,a,i){return ja(a,t)?a:Vr.current!==null?(e=ec(e,a,i),ja(e,t)||(Kt=!0),e):(gs&42)===0||(gs&1073741824)!==0&&(tt&261930)===0?(Kt=!0,e.memoizedState=a):(e=yf(),Ye.lanes|=e,Gs|=e,t)}function yh(e,t,a,i,c){var u=Q.p;Q.p=u!==0&&8>u?u:8;var m=S.T,y={};S.T=y,sc(e,!1,t,a);try{var T=c(),$=S.S;if($!==null&&$(y,T),T!==null&&typeof T=="object"&&typeof T.then=="function"){var W=Rg(T,i);Pn(e,t,W,Aa(e))}else Pn(e,t,i,Aa(e))}catch(se){Pn(e,t,{then:function(){},status:"rejected",reason:se},Aa())}finally{Q.p=u,m!==null&&y.types!==null&&(m.types=y.types),S.T=m}}function Bg(){}function tc(e,t,a,i){if(e.tag!==5)throw Error(o(476));var c=vh(e).queue;yh(e,c,t,ie,a===null?Bg:function(){return wh(e),a(i)})}function vh(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:ie,baseState:ie,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:bs,lastRenderedState:ie},next:null};var a={};return t.next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:bs,lastRenderedState:a},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function wh(e){var t=vh(e);t.next===null&&(t=e.alternate.memoizedState),Pn(e,t.next.queue,{},Aa())}function ac(){return ta(ii)}function jh(){return qt().memoizedState}function _h(){return qt().memoizedState}function Hg(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var a=Aa();e=Bs(a);var i=Hs(t,e,a);i!==null&&(va(i,t,a),Bn(i,t,a)),t={cache:Co()},e.payload=t;return}t=t.return}}function $g(e,t,a){var i=Aa();a={lane:i,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null},nl(e)?Sh(t,a):(a=vo(e,t,a,i),a!==null&&(va(a,e,i),Eh(a,t,i)))}function Nh(e,t,a){var i=Aa();Pn(e,t,a,i)}function Pn(e,t,a,i){var c={lane:i,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null};if(nl(e))Sh(t,c);else{var u=e.alternate;if(e.lanes===0&&(u===null||u.lanes===0)&&(u=t.lastRenderedReducer,u!==null))try{var m=t.lastRenderedState,y=u(m,a);if(c.hasEagerState=!0,c.eagerState=y,ja(y,m))return Hi(e,t,c,0),jt===null&&Bi(),!1}catch{}finally{}if(a=vo(e,t,c,i),a!==null)return va(a,e,i),Eh(a,t,i),!0}return!1}function sc(e,t,a,i){if(i={lane:2,revertLane:Dc(),gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},nl(e)){if(t)throw Error(o(479))}else t=vo(e,a,i,2),t!==null&&va(t,e,2)}function nl(e){var t=e.alternate;return e===Ye||t!==null&&t===Ye}function Sh(e,t){Qr=Wi=!0;var a=e.pending;a===null?t.next=t:(t.next=a.next,a.next=t),e.pending=t}function Eh(e,t,a){if((a&4194048)!==0){var i=t.lanes;i&=e.pendingLanes,a|=i,t.lanes=a,Se(e,a)}}var Gn={readContext:ta,use:tl,useCallback:Dt,useContext:Dt,useEffect:Dt,useImperativeHandle:Dt,useLayoutEffect:Dt,useInsertionEffect:Dt,useMemo:Dt,useReducer:Dt,useRef:Dt,useState:Dt,useDebugValue:Dt,useDeferredValue:Dt,useTransition:Dt,useSyncExternalStore:Dt,useId:Dt,useHostTransitionStatus:Dt,useFormState:Dt,useActionState:Dt,useOptimistic:Dt,useMemoCache:Dt,useCacheRefresh:Dt};Gn.useEffectEvent=Dt;var Th={readContext:ta,use:tl,useCallback:function(e,t){return da().memoizedState=[e,t===void 0?null:t],e},useContext:ta,useEffect:uh,useImperativeHandle:function(e,t,a){a=a!=null?a.concat([e]):null,sl(4194308,4,mh.bind(null,t,e),a)},useLayoutEffect:function(e,t){return sl(4194308,4,e,t)},useInsertionEffect:function(e,t){sl(4,2,e,t)},useMemo:function(e,t){var a=da();t=t===void 0?null:t;var i=e();if(gr){ne(!0);try{e()}finally{ne(!1)}}return a.memoizedState=[i,t],i},useReducer:function(e,t,a){var i=da();if(a!==void 0){var c=a(t);if(gr){ne(!0);try{a(t)}finally{ne(!1)}}}else c=t;return i.memoizedState=i.baseState=c,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:c},i.queue=e,e=e.dispatch=$g.bind(null,Ye,e),[i.memoizedState,e]},useRef:function(e){var t=da();return e={current:e},t.memoizedState=e},useState:function(e){e=Jo(e);var t=e.queue,a=Nh.bind(null,Ye,t);return t.dispatch=a,[e.memoizedState,a]},useDebugValue:Fo,useDeferredValue:function(e,t){var a=da();return ec(a,e,t)},useTransition:function(){var e=Jo(!1);return e=yh.bind(null,Ye,e.queue,!0,!1),da().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,a){var i=Ye,c=da();if(rt){if(a===void 0)throw Error(o(407));a=a()}else{if(a=t(),jt===null)throw Error(o(349));(tt&127)!==0||Qd(i,t,a)}c.memoizedState=a;var u={value:a,getSnapshot:t};return c.queue=u,uh(Jd.bind(null,i,u,e),[e]),i.flags|=2048,Jr(9,{destroy:void 0},Zd.bind(null,i,u,a,t),null),a},useId:function(){var e=da(),t=jt.identifierPrefix;if(rt){var a=rs,i=ss;a=(i&~(1<<32-re(i)-1)).toString(32)+a,t="_"+t+"R_"+a,a=Fi++,0<a&&(t+="H"+a.toString(32)),t+="_"}else a=zg++,t="_"+t+"r_"+a.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:ac,useFormState:nh,useActionState:nh,useOptimistic:function(e){var t=da();t.memoizedState=t.baseState=e;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=a,t=sc.bind(null,Ye,!0,a),a.dispatch=t,[e,t]},useMemoCache:Vo,useCacheRefresh:function(){return da().memoizedState=Hg.bind(null,Ye)},useEffectEvent:function(e){var t=da(),a={impl:e};return t.memoizedState=a,function(){if((ut&2)!==0)throw Error(o(440));return a.impl.apply(void 0,arguments)}}},rc={readContext:ta,use:tl,useCallback:gh,useContext:ta,useEffect:Wo,useImperativeHandle:ph,useInsertionEffect:hh,useLayoutEffect:fh,useMemo:bh,useReducer:al,useRef:ch,useState:function(){return al(bs)},useDebugValue:Fo,useDeferredValue:function(e,t){var a=qt();return xh(a,xt.memoizedState,e,t)},useTransition:function(){var e=al(bs)[0],t=qt().memoizedState;return[typeof e=="boolean"?e:qn(e),t]},useSyncExternalStore:Vd,useId:jh,useHostTransitionStatus:ac,useFormState:ih,useActionState:ih,useOptimistic:function(e,t){var a=qt();return Fd(a,xt,e,t)},useMemoCache:Vo,useCacheRefresh:_h};rc.useEffectEvent=dh;var Ah={readContext:ta,use:tl,useCallback:gh,useContext:ta,useEffect:Wo,useImperativeHandle:ph,useInsertionEffect:hh,useLayoutEffect:fh,useMemo:bh,useReducer:Zo,useRef:ch,useState:function(){return Zo(bs)},useDebugValue:Fo,useDeferredValue:function(e,t){var a=qt();return xt===null?ec(a,e,t):xh(a,xt.memoizedState,e,t)},useTransition:function(){var e=Zo(bs)[0],t=qt().memoizedState;return[typeof e=="boolean"?e:qn(e),t]},useSyncExternalStore:Vd,useId:jh,useHostTransitionStatus:ac,useFormState:oh,useActionState:oh,useOptimistic:function(e,t){var a=qt();return xt!==null?Fd(a,xt,e,t):(a.baseState=e,[e,a.queue.dispatch])},useMemoCache:Vo,useCacheRefresh:_h};Ah.useEffectEvent=dh;function nc(e,t,a,i){t=e.memoizedState,a=a(i,t),a=a==null?t:x({},t,a),e.memoizedState=a,e.lanes===0&&(e.updateQueue.baseState=a)}var ic={enqueueSetState:function(e,t,a){e=e._reactInternals;var i=Aa(),c=Bs(i);c.payload=t,a!=null&&(c.callback=a),t=Hs(e,c,i),t!==null&&(va(t,e,i),Bn(t,e,i))},enqueueReplaceState:function(e,t,a){e=e._reactInternals;var i=Aa(),c=Bs(i);c.tag=1,c.payload=t,a!=null&&(c.callback=a),t=Hs(e,c,i),t!==null&&(va(t,e,i),Bn(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var a=Aa(),i=Bs(a);i.tag=2,t!=null&&(i.callback=t),t=Hs(e,i,a),t!==null&&(va(t,e,a),Bn(t,e,a))}};function kh(e,t,a,i,c,u,m){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,u,m):t.prototype&&t.prototype.isPureReactComponent?!On(a,i)||!On(c,u):!0}function Oh(e,t,a,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(a,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(a,i),t.state!==e&&ic.enqueueReplaceState(t,t.state,null)}function br(e,t){var a=t;if("ref"in t){a={};for(var i in t)i!=="ref"&&(a[i]=t[i])}if(e=e.defaultProps){a===t&&(a=x({},a));for(var c in e)a[c]===void 0&&(a[c]=e[c])}return a}function Ch(e){Li(e)}function Rh(e){console.error(e)}function zh(e){Li(e)}function il(e,t){try{var a=e.onUncaughtError;a(t.value,{componentStack:t.stack})}catch(i){setTimeout(function(){throw i})}}function Mh(e,t,a){try{var i=e.onCaughtError;i(a.value,{componentStack:a.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(c){setTimeout(function(){throw c})}}function lc(e,t,a){return a=Bs(a),a.tag=3,a.payload={element:null},a.callback=function(){il(e,t)},a}function Dh(e){return e=Bs(e),e.tag=3,e}function Uh(e,t,a,i){var c=a.type.getDerivedStateFromError;if(typeof c=="function"){var u=i.value;e.payload=function(){return c(u)},e.callback=function(){Mh(t,a,i)}}var m=a.stateNode;m!==null&&typeof m.componentDidCatch=="function"&&(e.callback=function(){Mh(t,a,i),typeof c!="function"&&(Ys===null?Ys=new Set([this]):Ys.add(this));var y=i.stack;this.componentDidCatch(i.value,{componentStack:y!==null?y:""})})}function Ig(e,t,a,i,c){if(a.flags|=32768,i!==null&&typeof i=="object"&&typeof i.then=="function"){if(t=a.alternate,t!==null&&qr(t,a,c,!0),a=Na.current,a!==null){switch(a.tag){case 31:case 13:return Ya===null?xl():a.alternate===null&&Ut===0&&(Ut=3),a.flags&=-257,a.flags|=65536,a.lanes=c,i===Vi?a.flags|=16384:(t=a.updateQueue,t===null?a.updateQueue=new Set([i]):t.add(i),Rc(e,i,c)),!1;case 22:return a.flags|=65536,i===Vi?a.flags|=16384:(t=a.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([i])},a.updateQueue=t):(a=t.retryQueue,a===null?t.retryQueue=new Set([i]):a.add(i)),Rc(e,i,c)),!1}throw Error(o(435,a.tag))}return Rc(e,i,c),xl(),!1}if(rt)return t=Na.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=c,i!==Eo&&(e=Error(o(422),{cause:i}),zn(Ia(e,a)))):(i!==Eo&&(t=Error(o(423),{cause:i}),zn(Ia(t,a))),e=e.current.alternate,e.flags|=65536,c&=-c,e.lanes|=c,i=Ia(i,a),c=lc(e.stateNode,i,c),Lo(e,c),Ut!==4&&(Ut=2)),!1;var u=Error(o(520),{cause:i});if(u=Ia(u,a),Wn===null?Wn=[u]:Wn.push(u),Ut!==4&&(Ut=2),t===null)return!0;i=Ia(i,a),a=t;do{switch(a.tag){case 3:return a.flags|=65536,e=c&-c,a.lanes|=e,e=lc(a.stateNode,i,e),Lo(a,e),!1;case 1:if(t=a.type,u=a.stateNode,(a.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||u!==null&&typeof u.componentDidCatch=="function"&&(Ys===null||!Ys.has(u))))return a.flags|=65536,c&=-c,a.lanes|=c,c=Dh(c),Uh(c,e,a,i),Lo(a,c),!1}a=a.return}while(a!==null);return!1}var oc=Error(o(461)),Kt=!1;function aa(e,t,a,i){t.child=e===null?$d(t,null,a,i):pr(t,e.child,a,i)}function Lh(e,t,a,i,c){a=a.render;var u=t.ref;if("ref"in i){var m={};for(var y in i)y!=="ref"&&(m[y]=i[y])}else m=i;return dr(t),i=Po(e,t,a,m,u,c),y=Go(),e!==null&&!Kt?(Yo(e,t,c),xs(e,t,c)):(rt&&y&&No(t),t.flags|=1,aa(e,t,i,c),t.child)}function Bh(e,t,a,i,c){if(e===null){var u=a.type;return typeof u=="function"&&!wo(u)&&u.defaultProps===void 0&&a.compare===null?(t.tag=15,t.type=u,Hh(e,t,u,i,c)):(e=Ii(a.type,null,i,t,t.mode,c),e.ref=t.ref,e.return=t,t.child=e)}if(u=e.child,!gc(e,c)){var m=u.memoizedProps;if(a=a.compare,a=a!==null?a:On,a(m,i)&&e.ref===t.ref)return xs(e,t,c)}return t.flags|=1,e=hs(u,i),e.ref=t.ref,e.return=t,t.child=e}function Hh(e,t,a,i,c){if(e!==null){var u=e.memoizedProps;if(On(u,i)&&e.ref===t.ref)if(Kt=!1,t.pendingProps=i=u,gc(e,c))(e.flags&131072)!==0&&(Kt=!0);else return t.lanes=e.lanes,xs(e,t,c)}return cc(e,t,a,i,c)}function $h(e,t,a,i){var c=i.children,u=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.mode==="hidden"){if((t.flags&128)!==0){if(u=u!==null?u.baseLanes|a:a,e!==null){for(i=t.child=e.child,c=0;i!==null;)c=c|i.lanes|i.childLanes,i=i.sibling;i=c&~u}else i=0,t.child=null;return Ih(e,t,u,a,i)}if((a&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&Yi(t,u!==null?u.cachePool:null),u!==null?Pd(t,u):Ho(),Gd(t);else return i=t.lanes=536870912,Ih(e,t,u!==null?u.baseLanes|a:a,a,i)}else u!==null?(Yi(t,u.cachePool),Pd(t,u),Is(),t.memoizedState=null):(e!==null&&Yi(t,null),Ho(),Is());return aa(e,t,c,a),t.child}function Yn(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Ih(e,t,a,i,c){var u=zo();return u=u===null?null:{parent:Gt._currentValue,pool:u},t.memoizedState={baseLanes:a,cachePool:u},e!==null&&Yi(t,null),Ho(),Gd(t),e!==null&&qr(e,t,i,!0),t.childLanes=c,null}function ll(e,t){return t=cl({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function qh(e,t,a){return pr(t,e.child,null,a),e=ll(t,t.pendingProps),e.flags|=2,Sa(t),t.memoizedState=null,e}function qg(e,t,a){var i=t.pendingProps,c=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(rt){if(i.mode==="hidden")return e=ll(t,i),t.lanes=536870912,Yn(null,e);if(Io(t),(e=St)?(e=tm(e,Ga),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:zs!==null?{id:ss,overflow:rs}:null,retryLane:536870912,hydrationErrors:null},a=Sd(e),a.return=t,t.child=a,ea=t,St=null)):e=null,e===null)throw Ds(t);return t.lanes=536870912,null}return ll(t,i)}var u=e.memoizedState;if(u!==null){var m=u.dehydrated;if(Io(t),c)if(t.flags&256)t.flags&=-257,t=qh(e,t,a);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(o(558));else if(Kt||qr(e,t,a,!1),c=(a&e.childLanes)!==0,Kt||c){if(i=jt,i!==null&&(m=kt(i,a),m!==0&&m!==u.retryLane))throw u.retryLane=m,lr(e,m),va(i,e,m),oc;xl(),t=qh(e,t,a)}else e=u.treeContext,St=Ka(m.nextSibling),ea=t,rt=!0,Ms=null,Ga=!1,e!==null&&Ad(t,e),t=ll(t,i),t.flags|=4096;return t}return e=hs(e.child,{mode:i.mode,children:i.children}),e.ref=t.ref,t.child=e,e.return=t,e}function ol(e,t){var a=t.ref;if(a===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof a!="function"&&typeof a!="object")throw Error(o(284));(e===null||e.ref!==a)&&(t.flags|=4194816)}}function cc(e,t,a,i,c){return dr(t),a=Po(e,t,a,i,void 0,c),i=Go(),e!==null&&!Kt?(Yo(e,t,c),xs(e,t,c)):(rt&&i&&No(t),t.flags|=1,aa(e,t,a,c),t.child)}function Ph(e,t,a,i,c,u){return dr(t),t.updateQueue=null,a=Kd(t,i,a,c),Yd(e),i=Go(),e!==null&&!Kt?(Yo(e,t,u),xs(e,t,u)):(rt&&i&&No(t),t.flags|=1,aa(e,t,a,u),t.child)}function Gh(e,t,a,i,c){if(dr(t),t.stateNode===null){var u=Br,m=a.contextType;typeof m=="object"&&m!==null&&(u=ta(m)),u=new a(i,u),t.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,u.updater=ic,t.stateNode=u,u._reactInternals=t,u=t.stateNode,u.props=i,u.state=t.memoizedState,u.refs={},Do(t),m=a.contextType,u.context=typeof m=="object"&&m!==null?ta(m):Br,u.state=t.memoizedState,m=a.getDerivedStateFromProps,typeof m=="function"&&(nc(t,a,m,i),u.state=t.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof u.getSnapshotBeforeUpdate=="function"||typeof u.UNSAFE_componentWillMount!="function"&&typeof u.componentWillMount!="function"||(m=u.state,typeof u.componentWillMount=="function"&&u.componentWillMount(),typeof u.UNSAFE_componentWillMount=="function"&&u.UNSAFE_componentWillMount(),m!==u.state&&ic.enqueueReplaceState(u,u.state,null),$n(t,i,u,c),Hn(),u.state=t.memoizedState),typeof u.componentDidMount=="function"&&(t.flags|=4194308),i=!0}else if(e===null){u=t.stateNode;var y=t.memoizedProps,T=br(a,y);u.props=T;var $=u.context,W=a.contextType;m=Br,typeof W=="object"&&W!==null&&(m=ta(W));var se=a.getDerivedStateFromProps;W=typeof se=="function"||typeof u.getSnapshotBeforeUpdate=="function",y=t.pendingProps!==y,W||typeof u.UNSAFE_componentWillReceiveProps!="function"&&typeof u.componentWillReceiveProps!="function"||(y||$!==m)&&Oh(t,u,i,m),Ls=!1;var q=t.memoizedState;u.state=q,$n(t,i,u,c),Hn(),$=t.memoizedState,y||q!==$||Ls?(typeof se=="function"&&(nc(t,a,se,i),$=t.memoizedState),(T=Ls||kh(t,a,T,i,q,$,m))?(W||typeof u.UNSAFE_componentWillMount!="function"&&typeof u.componentWillMount!="function"||(typeof u.componentWillMount=="function"&&u.componentWillMount(),typeof u.UNSAFE_componentWillMount=="function"&&u.UNSAFE_componentWillMount()),typeof u.componentDidMount=="function"&&(t.flags|=4194308)):(typeof u.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=$),u.props=i,u.state=$,u.context=m,i=T):(typeof u.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{u=t.stateNode,Uo(e,t),m=t.memoizedProps,W=br(a,m),u.props=W,se=t.pendingProps,q=u.context,$=a.contextType,T=Br,typeof $=="object"&&$!==null&&(T=ta($)),y=a.getDerivedStateFromProps,($=typeof y=="function"||typeof u.getSnapshotBeforeUpdate=="function")||typeof u.UNSAFE_componentWillReceiveProps!="function"&&typeof u.componentWillReceiveProps!="function"||(m!==se||q!==T)&&Oh(t,u,i,T),Ls=!1,q=t.memoizedState,u.state=q,$n(t,i,u,c),Hn();var Y=t.memoizedState;m!==se||q!==Y||Ls||e!==null&&e.dependencies!==null&&Pi(e.dependencies)?(typeof y=="function"&&(nc(t,a,y,i),Y=t.memoizedState),(W=Ls||kh(t,a,W,i,q,Y,T)||e!==null&&e.dependencies!==null&&Pi(e.dependencies))?($||typeof u.UNSAFE_componentWillUpdate!="function"&&typeof u.componentWillUpdate!="function"||(typeof u.componentWillUpdate=="function"&&u.componentWillUpdate(i,Y,T),typeof u.UNSAFE_componentWillUpdate=="function"&&u.UNSAFE_componentWillUpdate(i,Y,T)),typeof u.componentDidUpdate=="function"&&(t.flags|=4),typeof u.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof u.componentDidUpdate!="function"||m===e.memoizedProps&&q===e.memoizedState||(t.flags|=4),typeof u.getSnapshotBeforeUpdate!="function"||m===e.memoizedProps&&q===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=Y),u.props=i,u.state=Y,u.context=T,i=W):(typeof u.componentDidUpdate!="function"||m===e.memoizedProps&&q===e.memoizedState||(t.flags|=4),typeof u.getSnapshotBeforeUpdate!="function"||m===e.memoizedProps&&q===e.memoizedState||(t.flags|=1024),i=!1)}return u=i,ol(e,t),i=(t.flags&128)!==0,u||i?(u=t.stateNode,a=i&&typeof a.getDerivedStateFromError!="function"?null:u.render(),t.flags|=1,e!==null&&i?(t.child=pr(t,e.child,null,c),t.child=pr(t,null,a,c)):aa(e,t,a,c),t.memoizedState=u.state,e=t.child):e=xs(e,t,c),e}function Yh(e,t,a,i){return cr(),t.flags|=256,aa(e,t,a,i),t.child}var uc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function dc(e){return{baseLanes:e,cachePool:Md()}}function hc(e,t,a){return e=e!==null?e.childLanes&~a:0,t&&(e|=Ta),e}function Kh(e,t,a){var i=t.pendingProps,c=!1,u=(t.flags&128)!==0,m;if((m=u)||(m=e!==null&&e.memoizedState===null?!1:(It.current&2)!==0),m&&(c=!0,t.flags&=-129),m=(t.flags&32)!==0,t.flags&=-33,e===null){if(rt){if(c?$s(t):Is(),(e=St)?(e=tm(e,Ga),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:zs!==null?{id:ss,overflow:rs}:null,retryLane:536870912,hydrationErrors:null},a=Sd(e),a.return=t,t.child=a,ea=t,St=null)):e=null,e===null)throw Ds(t);return Qc(e)?t.lanes=32:t.lanes=536870912,null}var y=i.children;return i=i.fallback,c?(Is(),c=t.mode,y=cl({mode:"hidden",children:y},c),i=or(i,c,a,null),y.return=t,i.return=t,y.sibling=i,t.child=y,i=t.child,i.memoizedState=dc(a),i.childLanes=hc(e,m,a),t.memoizedState=uc,Yn(null,i)):($s(t),fc(t,y))}var T=e.memoizedState;if(T!==null&&(y=T.dehydrated,y!==null)){if(u)t.flags&256?($s(t),t.flags&=-257,t=mc(e,t,a)):t.memoizedState!==null?(Is(),t.child=e.child,t.flags|=128,t=null):(Is(),y=i.fallback,c=t.mode,i=cl({mode:"visible",children:i.children},c),y=or(y,c,a,null),y.flags|=2,i.return=t,y.return=t,i.sibling=y,t.child=i,pr(t,e.child,null,a),i=t.child,i.memoizedState=dc(a),i.childLanes=hc(e,m,a),t.memoizedState=uc,t=Yn(null,i));else if($s(t),Qc(y)){if(m=y.nextSibling&&y.nextSibling.dataset,m)var $=m.dgst;m=$,i=Error(o(419)),i.stack="",i.digest=m,zn({value:i,source:null,stack:null}),t=mc(e,t,a)}else if(Kt||qr(e,t,a,!1),m=(a&e.childLanes)!==0,Kt||m){if(m=jt,m!==null&&(i=kt(m,a),i!==0&&i!==T.retryLane))throw T.retryLane=i,lr(e,i),va(m,e,i),oc;Vc(y)||xl(),t=mc(e,t,a)}else Vc(y)?(t.flags|=192,t.child=e.child,t=null):(e=T.treeContext,St=Ka(y.nextSibling),ea=t,rt=!0,Ms=null,Ga=!1,e!==null&&Ad(t,e),t=fc(t,i.children),t.flags|=4096);return t}return c?(Is(),y=i.fallback,c=t.mode,T=e.child,$=T.sibling,i=hs(T,{mode:"hidden",children:i.children}),i.subtreeFlags=T.subtreeFlags&65011712,$!==null?y=hs($,y):(y=or(y,c,a,null),y.flags|=2),y.return=t,i.return=t,i.sibling=y,t.child=i,Yn(null,i),i=t.child,y=e.child.memoizedState,y===null?y=dc(a):(c=y.cachePool,c!==null?(T=Gt._currentValue,c=c.parent!==T?{parent:T,pool:T}:c):c=Md(),y={baseLanes:y.baseLanes|a,cachePool:c}),i.memoizedState=y,i.childLanes=hc(e,m,a),t.memoizedState=uc,Yn(e.child,i)):($s(t),a=e.child,e=a.sibling,a=hs(a,{mode:"visible",children:i.children}),a.return=t,a.sibling=null,e!==null&&(m=t.deletions,m===null?(t.deletions=[e],t.flags|=16):m.push(e)),t.child=a,t.memoizedState=null,a)}function fc(e,t){return t=cl({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function cl(e,t){return e=_a(22,e,null,t),e.lanes=0,e}function mc(e,t,a){return pr(t,e.child,null,a),e=fc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Vh(e,t,a){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),ko(e.return,t,a)}function pc(e,t,a,i,c,u){var m=e.memoizedState;m===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:a,tailMode:c,treeForkCount:u}:(m.isBackwards=t,m.rendering=null,m.renderingStartTime=0,m.last=i,m.tail=a,m.tailMode=c,m.treeForkCount=u)}function Qh(e,t,a){var i=t.pendingProps,c=i.revealOrder,u=i.tail;i=i.children;var m=It.current,y=(m&2)!==0;if(y?(m=m&1|2,t.flags|=128):m&=1,me(It,m),aa(e,t,i,a),i=rt?Rn:0,!y&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Vh(e,a,t);else if(e.tag===19)Vh(e,a,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(c){case"forwards":for(a=t.child,c=null;a!==null;)e=a.alternate,e!==null&&Xi(e)===null&&(c=a),a=a.sibling;a=c,a===null?(c=t.child,t.child=null):(c=a.sibling,a.sibling=null),pc(t,!1,c,a,u,i);break;case"backwards":case"unstable_legacy-backwards":for(a=null,c=t.child,t.child=null;c!==null;){if(e=c.alternate,e!==null&&Xi(e)===null){t.child=c;break}e=c.sibling,c.sibling=a,a=c,c=e}pc(t,!0,a,null,u,i);break;case"together":pc(t,!1,null,null,void 0,i);break;default:t.memoizedState=null}return t.child}function xs(e,t,a){if(e!==null&&(t.dependencies=e.dependencies),Gs|=t.lanes,(a&t.childLanes)===0)if(e!==null){if(qr(e,t,a,!1),(a&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(o(153));if(t.child!==null){for(e=t.child,a=hs(e,e.pendingProps),t.child=a,a.return=t;e.sibling!==null;)e=e.sibling,a=a.sibling=hs(e,e.pendingProps),a.return=t;a.sibling=null}return t.child}function gc(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&Pi(e)))}function Pg(e,t,a){switch(t.tag){case 3:Rt(t,t.stateNode.containerInfo),Us(t,Gt,e.memoizedState.cache),cr();break;case 27:case 5:$e(t);break;case 4:Rt(t,t.stateNode.containerInfo);break;case 10:Us(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,Io(t),null;break;case 13:var i=t.memoizedState;if(i!==null)return i.dehydrated!==null?($s(t),t.flags|=128,null):(a&t.child.childLanes)!==0?Kh(e,t,a):($s(t),e=xs(e,t,a),e!==null?e.sibling:null);$s(t);break;case 19:var c=(e.flags&128)!==0;if(i=(a&t.childLanes)!==0,i||(qr(e,t,a,!1),i=(a&t.childLanes)!==0),c){if(i)return Qh(e,t,a);t.flags|=128}if(c=t.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),me(It,It.current),i)break;return null;case 22:return t.lanes=0,$h(e,t,a,t.pendingProps);case 24:Us(t,Gt,e.memoizedState.cache)}return xs(e,t,a)}function Zh(e,t,a){if(e!==null)if(e.memoizedProps!==t.pendingProps)Kt=!0;else{if(!gc(e,a)&&(t.flags&128)===0)return Kt=!1,Pg(e,t,a);Kt=(e.flags&131072)!==0}else Kt=!1,rt&&(t.flags&1048576)!==0&&Td(t,Rn,t.index);switch(t.lanes=0,t.tag){case 16:e:{var i=t.pendingProps;if(e=fr(t.elementType),t.type=e,typeof e=="function")wo(e)?(i=br(e,i),t.tag=1,t=Gh(null,t,e,i,a)):(t.tag=0,t=cc(null,t,e,i,a));else{if(e!=null){var c=e.$$typeof;if(c===G){t.tag=11,t=Lh(null,t,e,i,a);break e}else if(c===oe){t.tag=14,t=Bh(null,t,e,i,a);break e}}throw t=Pe(e)||e,Error(o(306,t,""))}}return t;case 0:return cc(e,t,t.type,t.pendingProps,a);case 1:return i=t.type,c=br(i,t.pendingProps),Gh(e,t,i,c,a);case 3:e:{if(Rt(t,t.stateNode.containerInfo),e===null)throw Error(o(387));i=t.pendingProps;var u=t.memoizedState;c=u.element,Uo(e,t),$n(t,i,null,a);var m=t.memoizedState;if(i=m.cache,Us(t,Gt,i),i!==u.cache&&Oo(t,[Gt],a,!0),Hn(),i=m.element,u.isDehydrated)if(u={element:i,isDehydrated:!1,cache:m.cache},t.updateQueue.baseState=u,t.memoizedState=u,t.flags&256){t=Yh(e,t,i,a);break e}else if(i!==c){c=Ia(Error(o(424)),t),zn(c),t=Yh(e,t,i,a);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(St=Ka(e.firstChild),ea=t,rt=!0,Ms=null,Ga=!0,a=$d(t,null,i,a),t.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling}else{if(cr(),i===c){t=xs(e,t,a);break e}aa(e,t,i,a)}t=t.child}return t;case 26:return ol(e,t),e===null?(a=lm(t.type,null,t.pendingProps,null))?t.memoizedState=a:rt||(a=t.type,e=t.pendingProps,i=Sl(Be.current).createElement(a),i[Ie]=t,i[Le]=e,sa(i,a,e),_t(i),t.stateNode=i):t.memoizedState=lm(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return $e(t),e===null&&rt&&(i=t.stateNode=rm(t.type,t.pendingProps,Be.current),ea=t,Ga=!0,c=St,Zs(t.type)?(Zc=c,St=Ka(i.firstChild)):St=c),aa(e,t,t.pendingProps.children,a),ol(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&rt&&((c=i=St)&&(i=y0(i,t.type,t.pendingProps,Ga),i!==null?(t.stateNode=i,ea=t,St=Ka(i.firstChild),Ga=!1,c=!0):c=!1),c||Ds(t)),$e(t),c=t.type,u=t.pendingProps,m=e!==null?e.memoizedProps:null,i=u.children,Gc(c,u)?i=null:m!==null&&Gc(c,m)&&(t.flags|=32),t.memoizedState!==null&&(c=Po(e,t,Mg,null,null,a),ii._currentValue=c),ol(e,t),aa(e,t,i,a),t.child;case 6:return e===null&&rt&&((e=a=St)&&(a=v0(a,t.pendingProps,Ga),a!==null?(t.stateNode=a,ea=t,St=null,e=!0):e=!1),e||Ds(t)),null;case 13:return Kh(e,t,a);case 4:return Rt(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=pr(t,null,i,a):aa(e,t,i,a),t.child;case 11:return Lh(e,t,t.type,t.pendingProps,a);case 7:return aa(e,t,t.pendingProps,a),t.child;case 8:return aa(e,t,t.pendingProps.children,a),t.child;case 12:return aa(e,t,t.pendingProps.children,a),t.child;case 10:return i=t.pendingProps,Us(t,t.type,i.value),aa(e,t,i.children,a),t.child;case 9:return c=t.type._context,i=t.pendingProps.children,dr(t),c=ta(c),i=i(c),t.flags|=1,aa(e,t,i,a),t.child;case 14:return Bh(e,t,t.type,t.pendingProps,a);case 15:return Hh(e,t,t.type,t.pendingProps,a);case 19:return Qh(e,t,a);case 31:return qg(e,t,a);case 22:return $h(e,t,a,t.pendingProps);case 24:return dr(t),i=ta(Gt),e===null?(c=zo(),c===null&&(c=jt,u=Co(),c.pooledCache=u,u.refCount++,u!==null&&(c.pooledCacheLanes|=a),c=u),t.memoizedState={parent:i,cache:c},Do(t),Us(t,Gt,c)):((e.lanes&a)!==0&&(Uo(e,t),$n(t,null,null,a),Hn()),c=e.memoizedState,u=t.memoizedState,c.parent!==i?(c={parent:i,cache:i},t.memoizedState=c,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=c),Us(t,Gt,i)):(i=u.cache,Us(t,Gt,i),i!==c.cache&&Oo(t,[Gt],a,!0))),aa(e,t,t.pendingProps.children,a),t.child;case 29:throw t.pendingProps}throw Error(o(156,t.tag))}function ys(e){e.flags|=4}function bc(e,t,a,i,c){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(c&335544128)===c)if(e.stateNode.complete)e.flags|=8192;else if(_f())e.flags|=8192;else throw mr=Vi,Mo}else e.flags&=-16777217}function Jh(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!hm(t))if(_f())e.flags|=8192;else throw mr=Vi,Mo}function ul(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?ht():536870912,e.lanes|=t,en|=t)}function Kn(e,t){if(!rt)switch(e.tailMode){case"hidden":t=e.tail;for(var a=null;t!==null;)t.alternate!==null&&(a=t),t=t.sibling;a===null?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var i=null;a!==null;)a.alternate!==null&&(i=a),a=a.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Et(e){var t=e.alternate!==null&&e.alternate.child===e.child,a=0,i=0;if(t)for(var c=e.child;c!==null;)a|=c.lanes|c.childLanes,i|=c.subtreeFlags&65011712,i|=c.flags&65011712,c.return=e,c=c.sibling;else for(c=e.child;c!==null;)a|=c.lanes|c.childLanes,i|=c.subtreeFlags,i|=c.flags,c.return=e,c=c.sibling;return e.subtreeFlags|=i,e.childLanes=a,t}function Gg(e,t,a){var i=t.pendingProps;switch(So(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Et(t),null;case 1:return Et(t),null;case 3:return a=t.stateNode,i=null,e!==null&&(i=e.memoizedState.cache),t.memoizedState.cache!==i&&(t.flags|=2048),ps(Gt),dt(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(Ir(t)?ys(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,To())),Et(t),null;case 26:var c=t.type,u=t.memoizedState;return e===null?(ys(t),u!==null?(Et(t),Jh(t,u)):(Et(t),bc(t,c,null,i,a))):u?u!==e.memoizedState?(ys(t),Et(t),Jh(t,u)):(Et(t),t.flags&=-16777217):(e=e.memoizedProps,e!==i&&ys(t),Et(t),bc(t,c,e,i,a)),null;case 27:if(zt(t),a=Be.current,c=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==i&&ys(t);else{if(!i){if(t.stateNode===null)throw Error(o(166));return Et(t),null}e=be.current,Ir(t)?kd(t):(e=rm(c,i,a),t.stateNode=e,ys(t))}return Et(t),null;case 5:if(zt(t),c=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==i&&ys(t);else{if(!i){if(t.stateNode===null)throw Error(o(166));return Et(t),null}if(u=be.current,Ir(t))kd(t);else{var m=Sl(Be.current);switch(u){case 1:u=m.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:u=m.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":u=m.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":u=m.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":u=m.createElement("div"),u.innerHTML="<script><\/script>",u=u.removeChild(u.firstChild);break;case"select":u=typeof i.is=="string"?m.createElement("select",{is:i.is}):m.createElement("select"),i.multiple?u.multiple=!0:i.size&&(u.size=i.size);break;default:u=typeof i.is=="string"?m.createElement(c,{is:i.is}):m.createElement(c)}}u[Ie]=t,u[Le]=i;e:for(m=t.child;m!==null;){if(m.tag===5||m.tag===6)u.appendChild(m.stateNode);else if(m.tag!==4&&m.tag!==27&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}t.stateNode=u;e:switch(sa(u,c,i),c){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&ys(t)}}return Et(t),bc(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,a),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==i&&ys(t);else{if(typeof i!="string"&&t.stateNode===null)throw Error(o(166));if(e=Be.current,Ir(t)){if(e=t.stateNode,a=t.memoizedProps,i=null,c=ea,c!==null)switch(c.tag){case 27:case 5:i=c.memoizedProps}e[Ie]=t,e=!!(e.nodeValue===a||i!==null&&i.suppressHydrationWarning===!0||Vf(e.nodeValue,a)),e||Ds(t,!0)}else e=Sl(e).createTextNode(i),e[Ie]=t,t.stateNode=e}return Et(t),null;case 31:if(a=t.memoizedState,e===null||e.memoizedState!==null){if(i=Ir(t),a!==null){if(e===null){if(!i)throw Error(o(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(o(557));e[Ie]=t}else cr(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Et(t),e=!1}else a=To(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=a),e=!0;if(!e)return t.flags&256?(Sa(t),t):(Sa(t),null);if((t.flags&128)!==0)throw Error(o(558))}return Et(t),null;case 13:if(i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(c=Ir(t),i!==null&&i.dehydrated!==null){if(e===null){if(!c)throw Error(o(318));if(c=t.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(o(317));c[Ie]=t}else cr(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Et(t),c=!1}else c=To(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=c),c=!0;if(!c)return t.flags&256?(Sa(t),t):(Sa(t),null)}return Sa(t),(t.flags&128)!==0?(t.lanes=a,t):(a=i!==null,e=e!==null&&e.memoizedState!==null,a&&(i=t.child,c=null,i.alternate!==null&&i.alternate.memoizedState!==null&&i.alternate.memoizedState.cachePool!==null&&(c=i.alternate.memoizedState.cachePool.pool),u=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),u!==c&&(i.flags|=2048)),a!==e&&a&&(t.child.flags|=8192),ul(t,t.updateQueue),Et(t),null);case 4:return dt(),e===null&&Hc(t.stateNode.containerInfo),Et(t),null;case 10:return ps(t.type),Et(t),null;case 19:if(Z(It),i=t.memoizedState,i===null)return Et(t),null;if(c=(t.flags&128)!==0,u=i.rendering,u===null)if(c)Kn(i,!1);else{if(Ut!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(u=Xi(e),u!==null){for(t.flags|=128,Kn(i,!1),e=u.updateQueue,t.updateQueue=e,ul(t,e),t.subtreeFlags=0,e=a,a=t.child;a!==null;)Nd(a,e),a=a.sibling;return me(It,It.current&1|2),rt&&fs(t,i.treeForkCount),t.child}e=e.sibling}i.tail!==null&&Zt()>pl&&(t.flags|=128,c=!0,Kn(i,!1),t.lanes=4194304)}else{if(!c)if(e=Xi(u),e!==null){if(t.flags|=128,c=!0,e=e.updateQueue,t.updateQueue=e,ul(t,e),Kn(i,!0),i.tail===null&&i.tailMode==="hidden"&&!u.alternate&&!rt)return Et(t),null}else 2*Zt()-i.renderingStartTime>pl&&a!==536870912&&(t.flags|=128,c=!0,Kn(i,!1),t.lanes=4194304);i.isBackwards?(u.sibling=t.child,t.child=u):(e=i.last,e!==null?e.sibling=u:t.child=u,i.last=u)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Zt(),e.sibling=null,a=It.current,me(It,c?a&1|2:a&1),rt&&fs(t,i.treeForkCount),e):(Et(t),null);case 22:case 23:return Sa(t),$o(),i=t.memoizedState!==null,e!==null?e.memoizedState!==null!==i&&(t.flags|=8192):i&&(t.flags|=8192),i?(a&536870912)!==0&&(t.flags&128)===0&&(Et(t),t.subtreeFlags&6&&(t.flags|=8192)):Et(t),a=t.updateQueue,a!==null&&ul(t,a.retryQueue),a=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),i=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(i=t.memoizedState.cachePool.pool),i!==a&&(t.flags|=2048),e!==null&&Z(hr),null;case 24:return a=null,e!==null&&(a=e.memoizedState.cache),t.memoizedState.cache!==a&&(t.flags|=2048),ps(Gt),Et(t),null;case 25:return null;case 30:return null}throw Error(o(156,t.tag))}function Yg(e,t){switch(So(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ps(Gt),dt(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return zt(t),null;case 31:if(t.memoizedState!==null){if(Sa(t),t.alternate===null)throw Error(o(340));cr()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(Sa(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(o(340));cr()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Z(It),null;case 4:return dt(),null;case 10:return ps(t.type),null;case 22:case 23:return Sa(t),$o(),e!==null&&Z(hr),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return ps(Gt),null;case 25:return null;default:return null}}function Xh(e,t){switch(So(t),t.tag){case 3:ps(Gt),dt();break;case 26:case 27:case 5:zt(t);break;case 4:dt();break;case 31:t.memoizedState!==null&&Sa(t);break;case 13:Sa(t);break;case 19:Z(It);break;case 10:ps(t.type);break;case 22:case 23:Sa(t),$o(),e!==null&&Z(hr);break;case 24:ps(Gt)}}function Vn(e,t){try{var a=t.updateQueue,i=a!==null?a.lastEffect:null;if(i!==null){var c=i.next;a=c;do{if((a.tag&e)===e){i=void 0;var u=a.create,m=a.inst;i=u(),m.destroy=i}a=a.next}while(a!==c)}}catch(y){bt(t,t.return,y)}}function qs(e,t,a){try{var i=t.updateQueue,c=i!==null?i.lastEffect:null;if(c!==null){var u=c.next;i=u;do{if((i.tag&e)===e){var m=i.inst,y=m.destroy;if(y!==void 0){m.destroy=void 0,c=t;var T=a,$=y;try{$()}catch(W){bt(c,T,W)}}}i=i.next}while(i!==u)}}catch(W){bt(t,t.return,W)}}function Wh(e){var t=e.updateQueue;if(t!==null){var a=e.stateNode;try{qd(t,a)}catch(i){bt(e,e.return,i)}}}function Fh(e,t,a){a.props=br(e.type,e.memoizedProps),a.state=e.memoizedState;try{a.componentWillUnmount()}catch(i){bt(e,t,i)}}function Qn(e,t){try{var a=e.ref;if(a!==null){switch(e.tag){case 26:case 27:case 5:var i=e.stateNode;break;case 30:i=e.stateNode;break;default:i=e.stateNode}typeof a=="function"?e.refCleanup=a(i):a.current=i}}catch(c){bt(e,t,c)}}function ns(e,t){var a=e.ref,i=e.refCleanup;if(a!==null)if(typeof i=="function")try{i()}catch(c){bt(e,t,c)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof a=="function")try{a(null)}catch(c){bt(e,t,c)}else a.current=null}function ef(e){var t=e.type,a=e.memoizedProps,i=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":a.autoFocus&&i.focus();break e;case"img":a.src?i.src=a.src:a.srcSet&&(i.srcset=a.srcSet)}}catch(c){bt(e,e.return,c)}}function xc(e,t,a){try{var i=e.stateNode;f0(i,e.type,a,t),i[Le]=t}catch(c){bt(e,e.return,c)}}function tf(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Zs(e.type)||e.tag===4}function yc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||tf(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Zs(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function vc(e,t,a){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a).insertBefore(e,t):(t=a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,t.appendChild(e),a=a._reactRootContainer,a!=null||t.onclick!==null||(t.onclick=us));else if(i!==4&&(i===27&&Zs(e.type)&&(a=e.stateNode,t=null),e=e.child,e!==null))for(vc(e,t,a),e=e.sibling;e!==null;)vc(e,t,a),e=e.sibling}function dl(e,t,a){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?a.insertBefore(e,t):a.appendChild(e);else if(i!==4&&(i===27&&Zs(e.type)&&(a=e.stateNode),e=e.child,e!==null))for(dl(e,t,a),e=e.sibling;e!==null;)dl(e,t,a),e=e.sibling}function af(e){var t=e.stateNode,a=e.memoizedProps;try{for(var i=e.type,c=t.attributes;c.length;)t.removeAttributeNode(c[0]);sa(t,i,a),t[Ie]=e,t[Le]=a}catch(u){bt(e,e.return,u)}}var vs=!1,Vt=!1,wc=!1,sf=typeof WeakSet=="function"?WeakSet:Set,Ft=null;function Kg(e,t){if(e=e.containerInfo,qc=Rl,e=pd(e),mo(e)){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else e:{a=(a=e.ownerDocument)&&a.defaultView||window;var i=a.getSelection&&a.getSelection();if(i&&i.rangeCount!==0){a=i.anchorNode;var c=i.anchorOffset,u=i.focusNode;i=i.focusOffset;try{a.nodeType,u.nodeType}catch{a=null;break e}var m=0,y=-1,T=-1,$=0,W=0,se=e,q=null;t:for(;;){for(var Y;se!==a||c!==0&&se.nodeType!==3||(y=m+c),se!==u||i!==0&&se.nodeType!==3||(T=m+i),se.nodeType===3&&(m+=se.nodeValue.length),(Y=se.firstChild)!==null;)q=se,se=Y;for(;;){if(se===e)break t;if(q===a&&++$===c&&(y=m),q===u&&++W===i&&(T=m),(Y=se.nextSibling)!==null)break;se=q,q=se.parentNode}se=Y}a=y===-1||T===-1?null:{start:y,end:T}}else a=null}a=a||{start:0,end:0}}else a=null;for(Pc={focusedElem:e,selectionRange:a},Rl=!1,Ft=t;Ft!==null;)if(t=Ft,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ft=e;else for(;Ft!==null;){switch(t=Ft,u=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(a=0;a<e.length;a++)c=e[a],c.ref.impl=c.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&u!==null){e=void 0,a=t,c=u.memoizedProps,u=u.memoizedState,i=a.stateNode;try{var _e=br(a.type,c);e=i.getSnapshotBeforeUpdate(_e,u),i.__reactInternalSnapshotBeforeUpdate=e}catch(ze){bt(a,a.return,ze)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,a=e.nodeType,a===9)Kc(e);else if(a===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Kc(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(o(163))}if(e=t.sibling,e!==null){e.return=t.return,Ft=e;break}Ft=t.return}}function rf(e,t,a){var i=a.flags;switch(a.tag){case 0:case 11:case 15:js(e,a),i&4&&Vn(5,a);break;case 1:if(js(e,a),i&4)if(e=a.stateNode,t===null)try{e.componentDidMount()}catch(m){bt(a,a.return,m)}else{var c=br(a.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(c,t,e.__reactInternalSnapshotBeforeUpdate)}catch(m){bt(a,a.return,m)}}i&64&&Wh(a),i&512&&Qn(a,a.return);break;case 3:if(js(e,a),i&64&&(e=a.updateQueue,e!==null)){if(t=null,a.child!==null)switch(a.child.tag){case 27:case 5:t=a.child.stateNode;break;case 1:t=a.child.stateNode}try{qd(e,t)}catch(m){bt(a,a.return,m)}}break;case 27:t===null&&i&4&&af(a);case 26:case 5:js(e,a),t===null&&i&4&&ef(a),i&512&&Qn(a,a.return);break;case 12:js(e,a);break;case 31:js(e,a),i&4&&of(e,a);break;case 13:js(e,a),i&4&&cf(e,a),i&64&&(e=a.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(a=t0.bind(null,a),w0(e,a))));break;case 22:if(i=a.memoizedState!==null||vs,!i){t=t!==null&&t.memoizedState!==null||Vt,c=vs;var u=Vt;vs=i,(Vt=t)&&!u?_s(e,a,(a.subtreeFlags&8772)!==0):js(e,a),vs=c,Vt=u}break;case 30:break;default:js(e,a)}}function nf(e){var t=e.alternate;t!==null&&(e.alternate=null,nf(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&Mt(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var At=null,ga=!1;function ws(e,t,a){for(a=a.child;a!==null;)lf(e,t,a),a=a.sibling}function lf(e,t,a){if(D&&typeof D.onCommitFiberUnmount=="function")try{D.onCommitFiberUnmount(B,a)}catch{}switch(a.tag){case 26:Vt||ns(a,t),ws(e,t,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode,a.parentNode.removeChild(a));break;case 27:Vt||ns(a,t);var i=At,c=ga;Zs(a.type)&&(At=a.stateNode,ga=!1),ws(e,t,a),si(a.stateNode),At=i,ga=c;break;case 5:Vt||ns(a,t);case 6:if(i=At,c=ga,At=null,ws(e,t,a),At=i,ga=c,At!==null)if(ga)try{(At.nodeType===9?At.body:At.nodeName==="HTML"?At.ownerDocument.body:At).removeChild(a.stateNode)}catch(u){bt(a,t,u)}else try{At.removeChild(a.stateNode)}catch(u){bt(a,t,u)}break;case 18:At!==null&&(ga?(e=At,Ff(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,a.stateNode),cn(e)):Ff(At,a.stateNode));break;case 4:i=At,c=ga,At=a.stateNode.containerInfo,ga=!0,ws(e,t,a),At=i,ga=c;break;case 0:case 11:case 14:case 15:qs(2,a,t),Vt||qs(4,a,t),ws(e,t,a);break;case 1:Vt||(ns(a,t),i=a.stateNode,typeof i.componentWillUnmount=="function"&&Fh(a,t,i)),ws(e,t,a);break;case 21:ws(e,t,a);break;case 22:Vt=(i=Vt)||a.memoizedState!==null,ws(e,t,a),Vt=i;break;default:ws(e,t,a)}}function of(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{cn(e)}catch(a){bt(t,t.return,a)}}}function cf(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{cn(e)}catch(a){bt(t,t.return,a)}}function Vg(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new sf),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new sf),t;default:throw Error(o(435,e.tag))}}function hl(e,t){var a=Vg(e);t.forEach(function(i){if(!a.has(i)){a.add(i);var c=a0.bind(null,e,i);i.then(c,c)}})}function ba(e,t){var a=t.deletions;if(a!==null)for(var i=0;i<a.length;i++){var c=a[i],u=e,m=t,y=m;e:for(;y!==null;){switch(y.tag){case 27:if(Zs(y.type)){At=y.stateNode,ga=!1;break e}break;case 5:At=y.stateNode,ga=!1;break e;case 3:case 4:At=y.stateNode.containerInfo,ga=!0;break e}y=y.return}if(At===null)throw Error(o(160));lf(u,m,c),At=null,ga=!1,u=c.alternate,u!==null&&(u.return=null),c.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)uf(t,e),t=t.sibling}var Ja=null;function uf(e,t){var a=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:ba(t,e),xa(e),i&4&&(qs(3,e,e.return),Vn(3,e),qs(5,e,e.return));break;case 1:ba(t,e),xa(e),i&512&&(Vt||a===null||ns(a,a.return)),i&64&&vs&&(e=e.updateQueue,e!==null&&(i=e.callbacks,i!==null&&(a=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=a===null?i:a.concat(i))));break;case 26:var c=Ja;if(ba(t,e),xa(e),i&512&&(Vt||a===null||ns(a,a.return)),i&4){var u=a!==null?a.memoizedState:null;if(i=e.memoizedState,a===null)if(i===null)if(e.stateNode===null){e:{i=e.type,a=e.memoizedProps,c=c.ownerDocument||c;t:switch(i){case"title":u=c.getElementsByTagName("title")[0],(!u||u[os]||u[Ie]||u.namespaceURI==="http://www.w3.org/2000/svg"||u.hasAttribute("itemprop"))&&(u=c.createElement(i),c.head.insertBefore(u,c.querySelector("head > title"))),sa(u,i,a),u[Ie]=e,_t(u),i=u;break e;case"link":var m=um("link","href",c).get(i+(a.href||""));if(m){for(var y=0;y<m.length;y++)if(u=m[y],u.getAttribute("href")===(a.href==null||a.href===""?null:a.href)&&u.getAttribute("rel")===(a.rel==null?null:a.rel)&&u.getAttribute("title")===(a.title==null?null:a.title)&&u.getAttribute("crossorigin")===(a.crossOrigin==null?null:a.crossOrigin)){m.splice(y,1);break t}}u=c.createElement(i),sa(u,i,a),c.head.appendChild(u);break;case"meta":if(m=um("meta","content",c).get(i+(a.content||""))){for(y=0;y<m.length;y++)if(u=m[y],u.getAttribute("content")===(a.content==null?null:""+a.content)&&u.getAttribute("name")===(a.name==null?null:a.name)&&u.getAttribute("property")===(a.property==null?null:a.property)&&u.getAttribute("http-equiv")===(a.httpEquiv==null?null:a.httpEquiv)&&u.getAttribute("charset")===(a.charSet==null?null:a.charSet)){m.splice(y,1);break t}}u=c.createElement(i),sa(u,i,a),c.head.appendChild(u);break;default:throw Error(o(468,i))}u[Ie]=e,_t(u),i=u}e.stateNode=i}else dm(c,e.type,e.stateNode);else e.stateNode=cm(c,i,e.memoizedProps);else u!==i?(u===null?a.stateNode!==null&&(a=a.stateNode,a.parentNode.removeChild(a)):u.count--,i===null?dm(c,e.type,e.stateNode):cm(c,i,e.memoizedProps)):i===null&&e.stateNode!==null&&xc(e,e.memoizedProps,a.memoizedProps)}break;case 27:ba(t,e),xa(e),i&512&&(Vt||a===null||ns(a,a.return)),a!==null&&i&4&&xc(e,e.memoizedProps,a.memoizedProps);break;case 5:if(ba(t,e),xa(e),i&512&&(Vt||a===null||ns(a,a.return)),e.flags&32){c=e.stateNode;try{Cr(c,"")}catch(_e){bt(e,e.return,_e)}}i&4&&e.stateNode!=null&&(c=e.memoizedProps,xc(e,c,a!==null?a.memoizedProps:c)),i&1024&&(wc=!0);break;case 6:if(ba(t,e),xa(e),i&4){if(e.stateNode===null)throw Error(o(162));i=e.memoizedProps,a=e.stateNode;try{a.nodeValue=i}catch(_e){bt(e,e.return,_e)}}break;case 3:if(Al=null,c=Ja,Ja=El(t.containerInfo),ba(t,e),Ja=c,xa(e),i&4&&a!==null&&a.memoizedState.isDehydrated)try{cn(t.containerInfo)}catch(_e){bt(e,e.return,_e)}wc&&(wc=!1,df(e));break;case 4:i=Ja,Ja=El(e.stateNode.containerInfo),ba(t,e),xa(e),Ja=i;break;case 12:ba(t,e),xa(e);break;case 31:ba(t,e),xa(e),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,hl(e,i)));break;case 13:ba(t,e),xa(e),e.child.flags&8192&&e.memoizedState!==null!=(a!==null&&a.memoizedState!==null)&&(ml=Zt()),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,hl(e,i)));break;case 22:c=e.memoizedState!==null;var T=a!==null&&a.memoizedState!==null,$=vs,W=Vt;if(vs=$||c,Vt=W||T,ba(t,e),Vt=W,vs=$,xa(e),i&8192)e:for(t=e.stateNode,t._visibility=c?t._visibility&-2:t._visibility|1,c&&(a===null||T||vs||Vt||xr(e)),a=null,t=e;;){if(t.tag===5||t.tag===26){if(a===null){T=a=t;try{if(u=T.stateNode,c)m=u.style,typeof m.setProperty=="function"?m.setProperty("display","none","important"):m.display="none";else{y=T.stateNode;var se=T.memoizedProps.style,q=se!=null&&se.hasOwnProperty("display")?se.display:null;y.style.display=q==null||typeof q=="boolean"?"":(""+q).trim()}}catch(_e){bt(T,T.return,_e)}}}else if(t.tag===6){if(a===null){T=t;try{T.stateNode.nodeValue=c?"":T.memoizedProps}catch(_e){bt(T,T.return,_e)}}}else if(t.tag===18){if(a===null){T=t;try{var Y=T.stateNode;c?em(Y,!0):em(T.stateNode,!1)}catch(_e){bt(T,T.return,_e)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;a===t&&(a=null),t=t.return}a===t&&(a=null),t.sibling.return=t.return,t=t.sibling}i&4&&(i=e.updateQueue,i!==null&&(a=i.retryQueue,a!==null&&(i.retryQueue=null,hl(e,a))));break;case 19:ba(t,e),xa(e),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,hl(e,i)));break;case 30:break;case 21:break;default:ba(t,e),xa(e)}}function xa(e){var t=e.flags;if(t&2){try{for(var a,i=e.return;i!==null;){if(tf(i)){a=i;break}i=i.return}if(a==null)throw Error(o(160));switch(a.tag){case 27:var c=a.stateNode,u=yc(e);dl(e,u,c);break;case 5:var m=a.stateNode;a.flags&32&&(Cr(m,""),a.flags&=-33);var y=yc(e);dl(e,y,m);break;case 3:case 4:var T=a.stateNode.containerInfo,$=yc(e);vc(e,$,T);break;default:throw Error(o(161))}}catch(W){bt(e,e.return,W)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function df(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;df(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function js(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)rf(e,t.alternate,t),t=t.sibling}function xr(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:qs(4,t,t.return),xr(t);break;case 1:ns(t,t.return);var a=t.stateNode;typeof a.componentWillUnmount=="function"&&Fh(t,t.return,a),xr(t);break;case 27:si(t.stateNode);case 26:case 5:ns(t,t.return),xr(t);break;case 22:t.memoizedState===null&&xr(t);break;case 30:xr(t);break;default:xr(t)}e=e.sibling}}function _s(e,t,a){for(a=a&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var i=t.alternate,c=e,u=t,m=u.flags;switch(u.tag){case 0:case 11:case 15:_s(c,u,a),Vn(4,u);break;case 1:if(_s(c,u,a),i=u,c=i.stateNode,typeof c.componentDidMount=="function")try{c.componentDidMount()}catch($){bt(i,i.return,$)}if(i=u,c=i.updateQueue,c!==null){var y=i.stateNode;try{var T=c.shared.hiddenCallbacks;if(T!==null)for(c.shared.hiddenCallbacks=null,c=0;c<T.length;c++)Id(T[c],y)}catch($){bt(i,i.return,$)}}a&&m&64&&Wh(u),Qn(u,u.return);break;case 27:af(u);case 26:case 5:_s(c,u,a),a&&i===null&&m&4&&ef(u),Qn(u,u.return);break;case 12:_s(c,u,a);break;case 31:_s(c,u,a),a&&m&4&&of(c,u);break;case 13:_s(c,u,a),a&&m&4&&cf(c,u);break;case 22:u.memoizedState===null&&_s(c,u,a),Qn(u,u.return);break;case 30:break;default:_s(c,u,a)}t=t.sibling}}function jc(e,t){var a=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==a&&(e!=null&&e.refCount++,a!=null&&Mn(a))}function _c(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Mn(e))}function Xa(e,t,a,i){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)hf(e,t,a,i),t=t.sibling}function hf(e,t,a,i){var c=t.flags;switch(t.tag){case 0:case 11:case 15:Xa(e,t,a,i),c&2048&&Vn(9,t);break;case 1:Xa(e,t,a,i);break;case 3:Xa(e,t,a,i),c&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Mn(e)));break;case 12:if(c&2048){Xa(e,t,a,i),e=t.stateNode;try{var u=t.memoizedProps,m=u.id,y=u.onPostCommit;typeof y=="function"&&y(m,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(T){bt(t,t.return,T)}}else Xa(e,t,a,i);break;case 31:Xa(e,t,a,i);break;case 13:Xa(e,t,a,i);break;case 23:break;case 22:u=t.stateNode,m=t.alternate,t.memoizedState!==null?u._visibility&2?Xa(e,t,a,i):Zn(e,t):u._visibility&2?Xa(e,t,a,i):(u._visibility|=2,Xr(e,t,a,i,(t.subtreeFlags&10256)!==0||!1)),c&2048&&jc(m,t);break;case 24:Xa(e,t,a,i),c&2048&&_c(t.alternate,t);break;default:Xa(e,t,a,i)}}function Xr(e,t,a,i,c){for(c=c&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var u=e,m=t,y=a,T=i,$=m.flags;switch(m.tag){case 0:case 11:case 15:Xr(u,m,y,T,c),Vn(8,m);break;case 23:break;case 22:var W=m.stateNode;m.memoizedState!==null?W._visibility&2?Xr(u,m,y,T,c):Zn(u,m):(W._visibility|=2,Xr(u,m,y,T,c)),c&&$&2048&&jc(m.alternate,m);break;case 24:Xr(u,m,y,T,c),c&&$&2048&&_c(m.alternate,m);break;default:Xr(u,m,y,T,c)}t=t.sibling}}function Zn(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var a=e,i=t,c=i.flags;switch(i.tag){case 22:Zn(a,i),c&2048&&jc(i.alternate,i);break;case 24:Zn(a,i),c&2048&&_c(i.alternate,i);break;default:Zn(a,i)}t=t.sibling}}var Jn=8192;function Wr(e,t,a){if(e.subtreeFlags&Jn)for(e=e.child;e!==null;)ff(e,t,a),e=e.sibling}function ff(e,t,a){switch(e.tag){case 26:Wr(e,t,a),e.flags&Jn&&e.memoizedState!==null&&z0(a,Ja,e.memoizedState,e.memoizedProps);break;case 5:Wr(e,t,a);break;case 3:case 4:var i=Ja;Ja=El(e.stateNode.containerInfo),Wr(e,t,a),Ja=i;break;case 22:e.memoizedState===null&&(i=e.alternate,i!==null&&i.memoizedState!==null?(i=Jn,Jn=16777216,Wr(e,t,a),Jn=i):Wr(e,t,a));break;default:Wr(e,t,a)}}function mf(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function Xn(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var a=0;a<t.length;a++){var i=t[a];Ft=i,gf(i,e)}mf(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)pf(e),e=e.sibling}function pf(e){switch(e.tag){case 0:case 11:case 15:Xn(e),e.flags&2048&&qs(9,e,e.return);break;case 3:Xn(e);break;case 12:Xn(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,fl(e)):Xn(e);break;default:Xn(e)}}function fl(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var a=0;a<t.length;a++){var i=t[a];Ft=i,gf(i,e)}mf(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:qs(8,t,t.return),fl(t);break;case 22:a=t.stateNode,a._visibility&2&&(a._visibility&=-3,fl(t));break;default:fl(t)}e=e.sibling}}function gf(e,t){for(;Ft!==null;){var a=Ft;switch(a.tag){case 0:case 11:case 15:qs(8,a,t);break;case 23:case 22:if(a.memoizedState!==null&&a.memoizedState.cachePool!==null){var i=a.memoizedState.cachePool.pool;i!=null&&i.refCount++}break;case 24:Mn(a.memoizedState.cache)}if(i=a.child,i!==null)i.return=a,Ft=i;else e:for(a=e;Ft!==null;){i=Ft;var c=i.sibling,u=i.return;if(nf(i),i===a){Ft=null;break e}if(c!==null){c.return=u,Ft=c;break e}Ft=u}}}var Qg={getCacheForType:function(e){var t=ta(Gt),a=t.data.get(e);return a===void 0&&(a=e(),t.data.set(e,a)),a},cacheSignal:function(){return ta(Gt).controller.signal}},Zg=typeof WeakMap=="function"?WeakMap:Map,ut=0,jt=null,We=null,tt=0,gt=0,Ea=null,Ps=!1,Fr=!1,Nc=!1,Ns=0,Ut=0,Gs=0,yr=0,Sc=0,Ta=0,en=0,Wn=null,ya=null,Ec=!1,ml=0,bf=0,pl=1/0,gl=null,Ys=null,Jt=0,Ks=null,tn=null,Ss=0,Tc=0,Ac=null,xf=null,Fn=0,kc=null;function Aa(){return(ut&2)!==0&&tt!==0?tt&-tt:S.T!==null?Dc():ve()}function yf(){if(Ta===0)if((tt&536870912)===0||rt){var e=I;I<<=1,(I&3932160)===0&&(I=262144),Ta=e}else Ta=536870912;return e=Na.current,e!==null&&(e.flags|=32),Ta}function va(e,t,a){(e===jt&&(gt===2||gt===9)||e.cancelPendingCommit!==null)&&(an(e,0),Vs(e,tt,Ta,!1)),ft(e,a),((ut&2)===0||e!==jt)&&(e===jt&&((ut&2)===0&&(yr|=a),Ut===4&&Vs(e,tt,Ta,!1)),is(e))}function vf(e,t,a){if((ut&6)!==0)throw Error(o(327));var i=!a&&(t&127)===0&&(t&e.expiredLanes)===0||Oe(e,t),c=i?Wg(e,t):Cc(e,t,!0),u=i;do{if(c===0){Fr&&!i&&Vs(e,t,0,!1);break}else{if(a=e.current.alternate,u&&!Jg(a)){c=Cc(e,t,!1),u=!1;continue}if(c===2){if(u=t,e.errorRecoveryDisabledLanes&u)var m=0;else m=e.pendingLanes&-536870913,m=m!==0?m:m&536870912?536870912:0;if(m!==0){t=m;e:{var y=e;c=Wn;var T=y.current.memoizedState.isDehydrated;if(T&&(an(y,m).flags|=256),m=Cc(y,m,!1),m!==2){if(Nc&&!T){y.errorRecoveryDisabledLanes|=u,yr|=u,c=4;break e}u=ya,ya=c,u!==null&&(ya===null?ya=u:ya.push.apply(ya,u))}c=m}if(u=!1,c!==2)continue}}if(c===1){an(e,0),Vs(e,t,0,!0);break}e:{switch(i=e,u=c,u){case 0:case 1:throw Error(o(345));case 4:if((t&4194048)!==t)break;case 6:Vs(i,t,Ta,!Ps);break e;case 2:ya=null;break;case 3:case 5:break;default:throw Error(o(329))}if((t&62914560)===t&&(c=ml+300-Zt(),10<c)){if(Vs(i,t,Ta,!Ps),Ee(i,0,!0)!==0)break e;Ss=t,i.timeoutHandle=Xf(wf.bind(null,i,a,ya,gl,Ec,t,Ta,yr,en,Ps,u,"Throttled",-0,0),c);break e}wf(i,a,ya,gl,Ec,t,Ta,yr,en,Ps,u,null,-0,0)}}break}while(!0);is(e)}function wf(e,t,a,i,c,u,m,y,T,$,W,se,q,Y){if(e.timeoutHandle=-1,se=t.subtreeFlags,se&8192||(se&16785408)===16785408){se={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:us},ff(t,u,se);var _e=(u&62914560)===u?ml-Zt():(u&4194048)===u?bf-Zt():0;if(_e=M0(se,_e),_e!==null){Ss=u,e.cancelPendingCommit=_e(kf.bind(null,e,t,u,a,i,c,m,y,T,W,se,null,q,Y)),Vs(e,u,m,!$);return}}kf(e,t,u,a,i,c,m,y,T)}function Jg(e){for(var t=e;;){var a=t.tag;if((a===0||a===11||a===15)&&t.flags&16384&&(a=t.updateQueue,a!==null&&(a=a.stores,a!==null)))for(var i=0;i<a.length;i++){var c=a[i],u=c.getSnapshot;c=c.value;try{if(!ja(u(),c))return!1}catch{return!1}}if(a=t.child,t.subtreeFlags&16384&&a!==null)a.return=t,t=a;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Vs(e,t,a,i){t&=~Sc,t&=~yr,e.suspendedLanes|=t,e.pingedLanes&=~t,i&&(e.warmLanes|=t),i=e.expirationTimes;for(var c=t;0<c;){var u=31-re(c),m=1<<u;i[u]=-1,c&=~m}a!==0&&ia(e,a,t)}function bl(){return(ut&6)===0?(ei(0),!1):!0}function Oc(){if(We!==null){if(gt===0)var e=We.return;else e=We,ms=ur=null,Ko(e),Kr=null,Un=0,e=We;for(;e!==null;)Xh(e.alternate,e),e=e.return;We=null}}function an(e,t){var a=e.timeoutHandle;a!==-1&&(e.timeoutHandle=-1,g0(a)),a=e.cancelPendingCommit,a!==null&&(e.cancelPendingCommit=null,a()),Ss=0,Oc(),jt=e,We=a=hs(e.current,null),tt=t,gt=0,Ea=null,Ps=!1,Fr=Oe(e,t),Nc=!1,en=Ta=Sc=yr=Gs=Ut=0,ya=Wn=null,Ec=!1,(t&8)!==0&&(t|=t&32);var i=e.entangledLanes;if(i!==0)for(e=e.entanglements,i&=t;0<i;){var c=31-re(i),u=1<<c;t|=e[c],i&=~u}return Ns=t,Bi(),a}function jf(e,t){Ye=null,S.H=Gn,t===Yr||t===Ki?(t=Ld(),gt=3):t===Mo?(t=Ld(),gt=4):gt=t===oc?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,Ea=t,We===null&&(Ut=1,il(e,Ia(t,e.current)))}function _f(){var e=Na.current;return e===null?!0:(tt&4194048)===tt?Ya===null:(tt&62914560)===tt||(tt&536870912)!==0?e===Ya:!1}function Nf(){var e=S.H;return S.H=Gn,e===null?Gn:e}function Sf(){var e=S.A;return S.A=Qg,e}function xl(){Ut=4,Ps||(tt&4194048)!==tt&&Na.current!==null||(Fr=!0),(Gs&134217727)===0&&(yr&134217727)===0||jt===null||Vs(jt,tt,Ta,!1)}function Cc(e,t,a){var i=ut;ut|=2;var c=Nf(),u=Sf();(jt!==e||tt!==t)&&(gl=null,an(e,t)),t=!1;var m=Ut;e:do try{if(gt!==0&&We!==null){var y=We,T=Ea;switch(gt){case 8:Oc(),m=6;break e;case 3:case 2:case 9:case 6:Na.current===null&&(t=!0);var $=gt;if(gt=0,Ea=null,sn(e,y,T,$),a&&Fr){m=0;break e}break;default:$=gt,gt=0,Ea=null,sn(e,y,T,$)}}Xg(),m=Ut;break}catch(W){jf(e,W)}while(!0);return t&&e.shellSuspendCounter++,ms=ur=null,ut=i,S.H=c,S.A=u,We===null&&(jt=null,tt=0,Bi()),m}function Xg(){for(;We!==null;)Ef(We)}function Wg(e,t){var a=ut;ut|=2;var i=Nf(),c=Sf();jt!==e||tt!==t?(gl=null,pl=Zt()+500,an(e,t)):Fr=Oe(e,t);e:do try{if(gt!==0&&We!==null){t=We;var u=Ea;t:switch(gt){case 1:gt=0,Ea=null,sn(e,t,u,1);break;case 2:case 9:if(Dd(u)){gt=0,Ea=null,Tf(t);break}t=function(){gt!==2&&gt!==9||jt!==e||(gt=7),is(e)},u.then(t,t);break e;case 3:gt=7;break e;case 4:gt=5;break e;case 7:Dd(u)?(gt=0,Ea=null,Tf(t)):(gt=0,Ea=null,sn(e,t,u,7));break;case 5:var m=null;switch(We.tag){case 26:m=We.memoizedState;case 5:case 27:var y=We;if(m?hm(m):y.stateNode.complete){gt=0,Ea=null;var T=y.sibling;if(T!==null)We=T;else{var $=y.return;$!==null?(We=$,yl($)):We=null}break t}}gt=0,Ea=null,sn(e,t,u,5);break;case 6:gt=0,Ea=null,sn(e,t,u,6);break;case 8:Oc(),Ut=6;break e;default:throw Error(o(462))}}Fg();break}catch(W){jf(e,W)}while(!0);return ms=ur=null,S.H=i,S.A=c,ut=a,We!==null?0:(jt=null,tt=0,Bi(),Ut)}function Fg(){for(;We!==null&&!Ht();)Ef(We)}function Ef(e){var t=Zh(e.alternate,e,Ns);e.memoizedProps=e.pendingProps,t===null?yl(e):We=t}function Tf(e){var t=e,a=t.alternate;switch(t.tag){case 15:case 0:t=Ph(a,t,t.pendingProps,t.type,void 0,tt);break;case 11:t=Ph(a,t,t.pendingProps,t.type.render,t.ref,tt);break;case 5:Ko(t);default:Xh(a,t),t=We=Nd(t,Ns),t=Zh(a,t,Ns)}e.memoizedProps=e.pendingProps,t===null?yl(e):We=t}function sn(e,t,a,i){ms=ur=null,Ko(t),Kr=null,Un=0;var c=t.return;try{if(Ig(e,c,t,a,tt)){Ut=1,il(e,Ia(a,e.current)),We=null;return}}catch(u){if(c!==null)throw We=c,u;Ut=1,il(e,Ia(a,e.current)),We=null;return}t.flags&32768?(rt||i===1?e=!0:Fr||(tt&536870912)!==0?e=!1:(Ps=e=!0,(i===2||i===9||i===3||i===6)&&(i=Na.current,i!==null&&i.tag===13&&(i.flags|=16384))),Af(t,e)):yl(t)}function yl(e){var t=e;do{if((t.flags&32768)!==0){Af(t,Ps);return}e=t.return;var a=Gg(t.alternate,t,Ns);if(a!==null){We=a;return}if(t=t.sibling,t!==null){We=t;return}We=t=e}while(t!==null);Ut===0&&(Ut=5)}function Af(e,t){do{var a=Yg(e.alternate,e);if(a!==null){a.flags&=32767,We=a;return}if(a=e.return,a!==null&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!t&&(e=e.sibling,e!==null)){We=e;return}We=e=a}while(e!==null);Ut=6,We=null}function kf(e,t,a,i,c,u,m,y,T){e.cancelPendingCommit=null;do vl();while(Jt!==0);if((ut&6)!==0)throw Error(o(327));if(t!==null){if(t===e.current)throw Error(o(177));if(u=t.lanes|t.childLanes,u|=yo,Wt(e,a,u,m,y,T),e===jt&&(We=jt=null,tt=0),tn=t,Ks=e,Ss=a,Tc=u,Ac=c,xf=i,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,s0(Os,function(){return Mf(),null})):(e.callbackNode=null,e.callbackPriority=0),i=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||i){i=S.T,S.T=null,c=Q.p,Q.p=2,m=ut,ut|=4;try{Kg(e,t,a)}finally{ut=m,Q.p=c,S.T=i}}Jt=1,Of(),Cf(),Rf()}}function Of(){if(Jt===1){Jt=0;var e=Ks,t=tn,a=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||a){a=S.T,S.T=null;var i=Q.p;Q.p=2;var c=ut;ut|=4;try{uf(t,e);var u=Pc,m=pd(e.containerInfo),y=u.focusedElem,T=u.selectionRange;if(m!==y&&y&&y.ownerDocument&&md(y.ownerDocument.documentElement,y)){if(T!==null&&mo(y)){var $=T.start,W=T.end;if(W===void 0&&(W=$),"selectionStart"in y)y.selectionStart=$,y.selectionEnd=Math.min(W,y.value.length);else{var se=y.ownerDocument||document,q=se&&se.defaultView||window;if(q.getSelection){var Y=q.getSelection(),_e=y.textContent.length,ze=Math.min(T.start,_e),vt=T.end===void 0?ze:Math.min(T.end,_e);!Y.extend&&ze>vt&&(m=vt,vt=ze,ze=m);var L=fd(y,ze),R=fd(y,vt);if(L&&R&&(Y.rangeCount!==1||Y.anchorNode!==L.node||Y.anchorOffset!==L.offset||Y.focusNode!==R.node||Y.focusOffset!==R.offset)){var H=se.createRange();H.setStart(L.node,L.offset),Y.removeAllRanges(),ze>vt?(Y.addRange(H),Y.extend(R.node,R.offset)):(H.setEnd(R.node,R.offset),Y.addRange(H))}}}}for(se=[],Y=y;Y=Y.parentNode;)Y.nodeType===1&&se.push({element:Y,left:Y.scrollLeft,top:Y.scrollTop});for(typeof y.focus=="function"&&y.focus(),y=0;y<se.length;y++){var te=se[y];te.element.scrollLeft=te.left,te.element.scrollTop=te.top}}Rl=!!qc,Pc=qc=null}finally{ut=c,Q.p=i,S.T=a}}e.current=t,Jt=2}}function Cf(){if(Jt===2){Jt=0;var e=Ks,t=tn,a=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||a){a=S.T,S.T=null;var i=Q.p;Q.p=2;var c=ut;ut|=4;try{rf(e,t.alternate,t)}finally{ut=c,Q.p=i,S.T=a}}Jt=3}}function Rf(){if(Jt===4||Jt===3){Jt=0,fa();var e=Ks,t=tn,a=Ss,i=xf;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?Jt=5:(Jt=0,tn=Ks=null,zf(e,e.pendingLanes));var c=e.pendingLanes;if(c===0&&(Ys=null),$t(a),t=t.stateNode,D&&typeof D.onCommitFiberRoot=="function")try{D.onCommitFiberRoot(B,t,void 0,(t.current.flags&128)===128)}catch{}if(i!==null){t=S.T,c=Q.p,Q.p=2,S.T=null;try{for(var u=e.onRecoverableError,m=0;m<i.length;m++){var y=i[m];u(y.value,{componentStack:y.stack})}}finally{S.T=t,Q.p=c}}(Ss&3)!==0&&vl(),is(e),c=e.pendingLanes,(a&261930)!==0&&(c&42)!==0?e===kc?Fn++:(Fn=0,kc=e):Fn=0,ei(0)}}function zf(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,Mn(t)))}function vl(){return Of(),Cf(),Rf(),Mf()}function Mf(){if(Jt!==5)return!1;var e=Ks,t=Tc;Tc=0;var a=$t(Ss),i=S.T,c=Q.p;try{Q.p=32>a?32:a,S.T=null,a=Ac,Ac=null;var u=Ks,m=Ss;if(Jt=0,tn=Ks=null,Ss=0,(ut&6)!==0)throw Error(o(331));var y=ut;if(ut|=4,pf(u.current),hf(u,u.current,m,a),ut=y,ei(0,!1),D&&typeof D.onPostCommitFiberRoot=="function")try{D.onPostCommitFiberRoot(B,u)}catch{}return!0}finally{Q.p=c,S.T=i,zf(e,t)}}function Df(e,t,a){t=Ia(a,t),t=lc(e.stateNode,t,2),e=Hs(e,t,2),e!==null&&(ft(e,2),is(e))}function bt(e,t,a){if(e.tag===3)Df(e,e,a);else for(;t!==null;){if(t.tag===3){Df(t,e,a);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Ys===null||!Ys.has(i))){e=Ia(a,e),a=Dh(2),i=Hs(t,a,2),i!==null&&(Uh(a,i,t,e),ft(i,2),is(i));break}}t=t.return}}function Rc(e,t,a){var i=e.pingCache;if(i===null){i=e.pingCache=new Zg;var c=new Set;i.set(t,c)}else c=i.get(t),c===void 0&&(c=new Set,i.set(t,c));c.has(a)||(Nc=!0,c.add(a),e=e0.bind(null,e,t,a),t.then(e,e))}function e0(e,t,a){var i=e.pingCache;i!==null&&i.delete(t),e.pingedLanes|=e.suspendedLanes&a,e.warmLanes&=~a,jt===e&&(tt&a)===a&&(Ut===4||Ut===3&&(tt&62914560)===tt&&300>Zt()-ml?(ut&2)===0&&an(e,0):Sc|=a,en===tt&&(en=0)),is(e)}function Uf(e,t){t===0&&(t=ht()),e=lr(e,t),e!==null&&(ft(e,t),is(e))}function t0(e){var t=e.memoizedState,a=0;t!==null&&(a=t.retryLane),Uf(e,a)}function a0(e,t){var a=0;switch(e.tag){case 31:case 13:var i=e.stateNode,c=e.memoizedState;c!==null&&(a=c.retryLane);break;case 19:i=e.stateNode;break;case 22:i=e.stateNode._retryCache;break;default:throw Error(o(314))}i!==null&&i.delete(t),Uf(e,a)}function s0(e,t){return ha(e,t)}var wl=null,rn=null,zc=!1,jl=!1,Mc=!1,Qs=0;function is(e){e!==rn&&e.next===null&&(rn===null?wl=rn=e:rn=rn.next=e),jl=!0,zc||(zc=!0,n0())}function ei(e,t){if(!Mc&&jl){Mc=!0;do for(var a=!1,i=wl;i!==null;){if(e!==0){var c=i.pendingLanes;if(c===0)var u=0;else{var m=i.suspendedLanes,y=i.pingedLanes;u=(1<<31-re(42|e)+1)-1,u&=c&~(m&~y),u=u&201326741?u&201326741|1:u?u|2:0}u!==0&&(a=!0,$f(i,u))}else u=tt,u=Ee(i,i===jt?u:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),(u&3)===0||Oe(i,u)||(a=!0,$f(i,u));i=i.next}while(a);Mc=!1}}function r0(){Lf()}function Lf(){jl=zc=!1;var e=0;Qs!==0&&p0()&&(e=Qs);for(var t=Zt(),a=null,i=wl;i!==null;){var c=i.next,u=Bf(i,t);u===0?(i.next=null,a===null?wl=c:a.next=c,c===null&&(rn=a)):(a=i,(e!==0||(u&3)!==0)&&(jl=!0)),i=c}Jt!==0&&Jt!==5||ei(e),Qs!==0&&(Qs=0)}function Bf(e,t){for(var a=e.suspendedLanes,i=e.pingedLanes,c=e.expirationTimes,u=e.pendingLanes&-62914561;0<u;){var m=31-re(u),y=1<<m,T=c[m];T===-1?((y&a)===0||(y&i)!==0)&&(c[m]=Tt(y,t)):T<=t&&(e.expiredLanes|=y),u&=~y}if(t=jt,a=tt,a=Ee(e,e===t?a:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),i=e.callbackNode,a===0||e===t&&(gt===2||gt===9)||e.cancelPendingCommit!==null)return i!==null&&i!==null&&ua(i),e.callbackNode=null,e.callbackPriority=0;if((a&3)===0||Oe(e,a)){if(t=a&-a,t===e.callbackPriority)return t;switch(i!==null&&ua(i),$t(a)){case 2:case 8:a=Ma;break;case 32:a=Os;break;case 268435456:a=w;break;default:a=Os}return i=Hf.bind(null,e),a=ha(a,i),e.callbackPriority=t,e.callbackNode=a,t}return i!==null&&i!==null&&ua(i),e.callbackPriority=2,e.callbackNode=null,2}function Hf(e,t){if(Jt!==0&&Jt!==5)return e.callbackNode=null,e.callbackPriority=0,null;var a=e.callbackNode;if(vl()&&e.callbackNode!==a)return null;var i=tt;return i=Ee(e,e===jt?i:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),i===0?null:(vf(e,i,t),Bf(e,Zt()),e.callbackNode!=null&&e.callbackNode===a?Hf.bind(null,e):null)}function $f(e,t){if(vl())return null;vf(e,t,!0)}function n0(){b0(function(){(ut&6)!==0?ha(Si,r0):Lf()})}function Dc(){if(Qs===0){var e=Pr;e===0&&(e=P,P<<=1,(P&261888)===0&&(P=256)),Qs=e}return Qs}function If(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Oi(""+e)}function qf(e,t){var a=t.ownerDocument.createElement("input");return a.name=t.name,a.value=t.value,e.id&&a.setAttribute("form",e.id),t.parentNode.insertBefore(a,t),e=new FormData(e),a.parentNode.removeChild(a),e}function i0(e,t,a,i,c){if(t==="submit"&&a&&a.stateNode===c){var u=If((c[Le]||null).action),m=i.submitter;m&&(t=(t=m[Le]||null)?If(t.formAction):m.getAttribute("formAction"),t!==null&&(u=t,m=null));var y=new Mi("action","action",null,i,c);e.push({event:y,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(Qs!==0){var T=m?qf(c,m):new FormData(c);tc(a,{pending:!0,data:T,method:c.method,action:u},null,T)}}else typeof u=="function"&&(y.preventDefault(),T=m?qf(c,m):new FormData(c),tc(a,{pending:!0,data:T,method:c.method,action:u},u,T))},currentTarget:c}]})}}for(var Uc=0;Uc<xo.length;Uc++){var Lc=xo[Uc],l0=Lc.toLowerCase(),o0=Lc[0].toUpperCase()+Lc.slice(1);Za(l0,"on"+o0)}Za(xd,"onAnimationEnd"),Za(yd,"onAnimationIteration"),Za(vd,"onAnimationStart"),Za("dblclick","onDoubleClick"),Za("focusin","onFocus"),Za("focusout","onBlur"),Za(Ng,"onTransitionRun"),Za(Sg,"onTransitionStart"),Za(Eg,"onTransitionCancel"),Za(wd,"onTransitionEnd"),kr("onMouseEnter",["mouseout","mouseover"]),kr("onMouseLeave",["mouseout","mouseover"]),kr("onPointerEnter",["pointerout","pointerover"]),kr("onPointerLeave",["pointerout","pointerover"]),as("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),as("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),as("onBeforeInput",["compositionend","keypress","textInput","paste"]),as("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),as("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),as("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ti="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),c0=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ti));function Pf(e,t){t=(t&4)!==0;for(var a=0;a<e.length;a++){var i=e[a],c=i.event;i=i.listeners;e:{var u=void 0;if(t)for(var m=i.length-1;0<=m;m--){var y=i[m],T=y.instance,$=y.currentTarget;if(y=y.listener,T!==u&&c.isPropagationStopped())break e;u=y,c.currentTarget=$;try{u(c)}catch(W){Li(W)}c.currentTarget=null,u=T}else for(m=0;m<i.length;m++){if(y=i[m],T=y.instance,$=y.currentTarget,y=y.listener,T!==u&&c.isPropagationStopped())break e;u=y,c.currentTarget=$;try{u(c)}catch(W){Li(W)}c.currentTarget=null,u=T}}}}function Fe(e,t){var a=t[Da];a===void 0&&(a=t[Da]=new Set);var i=e+"__bubble";a.has(i)||(Gf(t,e,2,!1),a.add(i))}function Bc(e,t,a){var i=0;t&&(i|=4),Gf(a,e,i,t)}var _l="_reactListening"+Math.random().toString(36).slice(2);function Hc(e){if(!e[_l]){e[_l]=!0,Cs.forEach(function(a){a!=="selectionchange"&&(c0.has(a)||Bc(a,!1,e),Bc(a,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[_l]||(t[_l]=!0,Bc("selectionchange",!1,t))}}function Gf(e,t,a,i){switch(ym(t)){case 2:var c=L0;break;case 8:c=B0;break;default:c=eu}a=c.bind(null,t,a,e),c=void 0,!ro||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(c=!0),i?c!==void 0?e.addEventListener(t,a,{capture:!0,passive:c}):e.addEventListener(t,a,!0):c!==void 0?e.addEventListener(t,a,{passive:c}):e.addEventListener(t,a,!1)}function $c(e,t,a,i,c){var u=i;if((t&1)===0&&(t&2)===0&&i!==null)e:for(;;){if(i===null)return;var m=i.tag;if(m===3||m===4){var y=i.stateNode.containerInfo;if(y===c)break;if(m===4)for(m=i.return;m!==null;){var T=m.tag;if((T===3||T===4)&&m.stateNode.containerInfo===c)return;m=m.return}for(;y!==null;){if(m=Ot(y),m===null)return;if(T=m.tag,T===5||T===6||T===26||T===27){i=u=m;continue e}y=y.parentNode}}i=i.return}Qu(function(){var $=u,W=ao(a),se=[];e:{var q=jd.get(e);if(q!==void 0){var Y=Mi,_e=e;switch(e){case"keypress":if(Ri(a)===0)break e;case"keydown":case"keyup":Y=ag;break;case"focusin":_e="focus",Y=oo;break;case"focusout":_e="blur",Y=oo;break;case"beforeblur":case"afterblur":Y=oo;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Y=Xu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Y=Gp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Y=ng;break;case xd:case yd:case vd:Y=Vp;break;case wd:Y=lg;break;case"scroll":case"scrollend":Y=qp;break;case"wheel":Y=cg;break;case"copy":case"cut":case"paste":Y=Zp;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Y=Fu;break;case"toggle":case"beforetoggle":Y=dg}var ze=(t&4)!==0,vt=!ze&&(e==="scroll"||e==="scrollend"),L=ze?q!==null?q+"Capture":null:q;ze=[];for(var R=$,H;R!==null;){var te=R;if(H=te.stateNode,te=te.tag,te!==5&&te!==26&&te!==27||H===null||L===null||(te=_n(R,L),te!=null&&ze.push(ai(R,te,H))),vt)break;R=R.return}0<ze.length&&(q=new Y(q,_e,null,a,W),se.push({event:q,listeners:ze}))}}if((t&7)===0){e:{if(q=e==="mouseover"||e==="pointerover",Y=e==="mouseout"||e==="pointerout",q&&a!==to&&(_e=a.relatedTarget||a.fromElement)&&(Ot(_e)||_e[wt]))break e;if((Y||q)&&(q=W.window===W?W:(q=W.ownerDocument)?q.defaultView||q.parentWindow:window,Y?(_e=a.relatedTarget||a.toElement,Y=$,_e=_e?Ot(_e):null,_e!==null&&(vt=h(_e),ze=_e.tag,_e!==vt||ze!==5&&ze!==27&&ze!==6)&&(_e=null)):(Y=null,_e=$),Y!==_e)){if(ze=Xu,te="onMouseLeave",L="onMouseEnter",R="mouse",(e==="pointerout"||e==="pointerover")&&(ze=Fu,te="onPointerLeave",L="onPointerEnter",R="pointer"),vt=Y==null?q:La(Y),H=_e==null?q:La(_e),q=new ze(te,R+"leave",Y,a,W),q.target=vt,q.relatedTarget=H,te=null,Ot(W)===$&&(ze=new ze(L,R+"enter",_e,a,W),ze.target=H,ze.relatedTarget=vt,te=ze),vt=te,Y&&_e)t:{for(ze=u0,L=Y,R=_e,H=0,te=L;te;te=ze(te))H++;te=0;for(var Ce=R;Ce;Ce=ze(Ce))te++;for(;0<H-te;)L=ze(L),H--;for(;0<te-H;)R=ze(R),te--;for(;H--;){if(L===R||R!==null&&L===R.alternate){ze=L;break t}L=ze(L),R=ze(R)}ze=null}else ze=null;Y!==null&&Yf(se,q,Y,ze,!1),_e!==null&&vt!==null&&Yf(se,vt,_e,ze,!0)}}e:{if(q=$?La($):window,Y=q.nodeName&&q.nodeName.toLowerCase(),Y==="select"||Y==="input"&&q.type==="file")var lt=ld;else if(nd(q))if(od)lt=wg;else{lt=yg;var Te=xg}else Y=q.nodeName,!Y||Y.toLowerCase()!=="input"||q.type!=="checkbox"&&q.type!=="radio"?$&&eo($.elementType)&&(lt=ld):lt=vg;if(lt&&(lt=lt(e,$))){id(se,lt,a,W);break e}Te&&Te(e,q,$),e==="focusout"&&$&&q.type==="number"&&$.memoizedProps.value!=null&&Fl(q,"number",q.value)}switch(Te=$?La($):window,e){case"focusin":(nd(Te)||Te.contentEditable==="true")&&(Dr=Te,po=$,Cn=null);break;case"focusout":Cn=po=Dr=null;break;case"mousedown":go=!0;break;case"contextmenu":case"mouseup":case"dragend":go=!1,gd(se,a,W);break;case"selectionchange":if(_g)break;case"keydown":case"keyup":gd(se,a,W)}var Qe;if(uo)e:{switch(e){case"compositionstart":var at="onCompositionStart";break e;case"compositionend":at="onCompositionEnd";break e;case"compositionupdate":at="onCompositionUpdate";break e}at=void 0}else Mr?sd(e,a)&&(at="onCompositionEnd"):e==="keydown"&&a.keyCode===229&&(at="onCompositionStart");at&&(ed&&a.locale!=="ko"&&(Mr||at!=="onCompositionStart"?at==="onCompositionEnd"&&Mr&&(Qe=Zu()):(Rs=W,no="value"in Rs?Rs.value:Rs.textContent,Mr=!0)),Te=Nl($,at),0<Te.length&&(at=new Wu(at,e,null,a,W),se.push({event:at,listeners:Te}),Qe?at.data=Qe:(Qe=rd(a),Qe!==null&&(at.data=Qe)))),(Qe=fg?mg(e,a):pg(e,a))&&(at=Nl($,"onBeforeInput"),0<at.length&&(Te=new Wu("onBeforeInput","beforeinput",null,a,W),se.push({event:Te,listeners:at}),Te.data=Qe)),i0(se,e,$,a,W)}Pf(se,t)})}function ai(e,t,a){return{instance:e,listener:t,currentTarget:a}}function Nl(e,t){for(var a=t+"Capture",i=[];e!==null;){var c=e,u=c.stateNode;if(c=c.tag,c!==5&&c!==26&&c!==27||u===null||(c=_n(e,a),c!=null&&i.unshift(ai(e,c,u)),c=_n(e,t),c!=null&&i.push(ai(e,c,u))),e.tag===3)return i;e=e.return}return[]}function u0(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Yf(e,t,a,i,c){for(var u=t._reactName,m=[];a!==null&&a!==i;){var y=a,T=y.alternate,$=y.stateNode;if(y=y.tag,T!==null&&T===i)break;y!==5&&y!==26&&y!==27||$===null||(T=$,c?($=_n(a,u),$!=null&&m.unshift(ai(a,$,T))):c||($=_n(a,u),$!=null&&m.push(ai(a,$,T)))),a=a.return}m.length!==0&&e.push({event:t,listeners:m})}var d0=/\r\n?/g,h0=/\u0000|\uFFFD/g;function Kf(e){return(typeof e=="string"?e:""+e).replace(d0,`
`).replace(h0,"")}function Vf(e,t){return t=Kf(t),Kf(e)===t}function yt(e,t,a,i,c,u){switch(a){case"children":typeof i=="string"?t==="body"||t==="textarea"&&i===""||Cr(e,i):(typeof i=="number"||typeof i=="bigint")&&t!=="body"&&Cr(e,""+i);break;case"className":Ai(e,"class",i);break;case"tabIndex":Ai(e,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":Ai(e,a,i);break;case"style":Ku(e,i,u);break;case"data":if(t!=="object"){Ai(e,"data",i);break}case"src":case"href":if(i===""&&(t!=="a"||a!=="href")){e.removeAttribute(a);break}if(i==null||typeof i=="function"||typeof i=="symbol"||typeof i=="boolean"){e.removeAttribute(a);break}i=Oi(""+i),e.setAttribute(a,i);break;case"action":case"formAction":if(typeof i=="function"){e.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof u=="function"&&(a==="formAction"?(t!=="input"&&yt(e,t,"name",c.name,c,null),yt(e,t,"formEncType",c.formEncType,c,null),yt(e,t,"formMethod",c.formMethod,c,null),yt(e,t,"formTarget",c.formTarget,c,null)):(yt(e,t,"encType",c.encType,c,null),yt(e,t,"method",c.method,c,null),yt(e,t,"target",c.target,c,null)));if(i==null||typeof i=="symbol"||typeof i=="boolean"){e.removeAttribute(a);break}i=Oi(""+i),e.setAttribute(a,i);break;case"onClick":i!=null&&(e.onclick=us);break;case"onScroll":i!=null&&Fe("scroll",e);break;case"onScrollEnd":i!=null&&Fe("scrollend",e);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(o(61));if(a=i.__html,a!=null){if(c.children!=null)throw Error(o(60));e.innerHTML=a}}break;case"multiple":e.multiple=i&&typeof i!="function"&&typeof i!="symbol";break;case"muted":e.muted=i&&typeof i!="function"&&typeof i!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(i==null||typeof i=="function"||typeof i=="boolean"||typeof i=="symbol"){e.removeAttribute("xlink:href");break}a=Oi(""+i),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":i!=null&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(a,""+i):e.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(a,""):e.removeAttribute(a);break;case"capture":case"download":i===!0?e.setAttribute(a,""):i!==!1&&i!=null&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(a,i):e.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":i!=null&&typeof i!="function"&&typeof i!="symbol"&&!isNaN(i)&&1<=i?e.setAttribute(a,i):e.removeAttribute(a);break;case"rowSpan":case"start":i==null||typeof i=="function"||typeof i=="symbol"||isNaN(i)?e.removeAttribute(a):e.setAttribute(a,i);break;case"popover":Fe("beforetoggle",e),Fe("toggle",e),Ti(e,"popover",i);break;case"xlinkActuate":cs(e,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":cs(e,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":cs(e,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":cs(e,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":cs(e,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":cs(e,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":cs(e,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":cs(e,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":cs(e,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":Ti(e,"is",i);break;case"innerText":case"textContent":break;default:(!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(a=$p.get(a)||a,Ti(e,a,i))}}function Ic(e,t,a,i,c,u){switch(a){case"style":Ku(e,i,u);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(o(61));if(a=i.__html,a!=null){if(c.children!=null)throw Error(o(60));e.innerHTML=a}}break;case"children":typeof i=="string"?Cr(e,i):(typeof i=="number"||typeof i=="bigint")&&Cr(e,""+i);break;case"onScroll":i!=null&&Fe("scroll",e);break;case"onScrollEnd":i!=null&&Fe("scrollend",e);break;case"onClick":i!=null&&(e.onclick=us);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ma.hasOwnProperty(a))e:{if(a[0]==="o"&&a[1]==="n"&&(c=a.endsWith("Capture"),t=a.slice(2,c?a.length-7:void 0),u=e[Le]||null,u=u!=null?u[a]:null,typeof u=="function"&&e.removeEventListener(t,u,c),typeof i=="function")){typeof u!="function"&&u!==null&&(a in e?e[a]=null:e.hasAttribute(a)&&e.removeAttribute(a)),e.addEventListener(t,i,c);break e}a in e?e[a]=i:i===!0?e.setAttribute(a,""):Ti(e,a,i)}}}function sa(e,t,a){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Fe("error",e),Fe("load",e);var i=!1,c=!1,u;for(u in a)if(a.hasOwnProperty(u)){var m=a[u];if(m!=null)switch(u){case"src":i=!0;break;case"srcSet":c=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(o(137,t));default:yt(e,t,u,m,a,null)}}c&&yt(e,t,"srcSet",a.srcSet,a,null),i&&yt(e,t,"src",a.src,a,null);return;case"input":Fe("invalid",e);var y=u=m=c=null,T=null,$=null;for(i in a)if(a.hasOwnProperty(i)){var W=a[i];if(W!=null)switch(i){case"name":c=W;break;case"type":m=W;break;case"checked":T=W;break;case"defaultChecked":$=W;break;case"value":u=W;break;case"defaultValue":y=W;break;case"children":case"dangerouslySetInnerHTML":if(W!=null)throw Error(o(137,t));break;default:yt(e,t,i,W,a,null)}}qu(e,u,y,T,$,m,c,!1);return;case"select":Fe("invalid",e),i=m=u=null;for(c in a)if(a.hasOwnProperty(c)&&(y=a[c],y!=null))switch(c){case"value":u=y;break;case"defaultValue":m=y;break;case"multiple":i=y;default:yt(e,t,c,y,a,null)}t=u,a=m,e.multiple=!!i,t!=null?Or(e,!!i,t,!1):a!=null&&Or(e,!!i,a,!0);return;case"textarea":Fe("invalid",e),u=c=i=null;for(m in a)if(a.hasOwnProperty(m)&&(y=a[m],y!=null))switch(m){case"value":i=y;break;case"defaultValue":c=y;break;case"children":u=y;break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(o(91));break;default:yt(e,t,m,y,a,null)}Gu(e,i,c,u);return;case"option":for(T in a)if(a.hasOwnProperty(T)&&(i=a[T],i!=null))switch(T){case"selected":e.selected=i&&typeof i!="function"&&typeof i!="symbol";break;default:yt(e,t,T,i,a,null)}return;case"dialog":Fe("beforetoggle",e),Fe("toggle",e),Fe("cancel",e),Fe("close",e);break;case"iframe":case"object":Fe("load",e);break;case"video":case"audio":for(i=0;i<ti.length;i++)Fe(ti[i],e);break;case"image":Fe("error",e),Fe("load",e);break;case"details":Fe("toggle",e);break;case"embed":case"source":case"link":Fe("error",e),Fe("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for($ in a)if(a.hasOwnProperty($)&&(i=a[$],i!=null))switch($){case"children":case"dangerouslySetInnerHTML":throw Error(o(137,t));default:yt(e,t,$,i,a,null)}return;default:if(eo(t)){for(W in a)a.hasOwnProperty(W)&&(i=a[W],i!==void 0&&Ic(e,t,W,i,a,void 0));return}}for(y in a)a.hasOwnProperty(y)&&(i=a[y],i!=null&&yt(e,t,y,i,a,null))}function f0(e,t,a,i){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var c=null,u=null,m=null,y=null,T=null,$=null,W=null;for(Y in a){var se=a[Y];if(a.hasOwnProperty(Y)&&se!=null)switch(Y){case"checked":break;case"value":break;case"defaultValue":T=se;default:i.hasOwnProperty(Y)||yt(e,t,Y,null,i,se)}}for(var q in i){var Y=i[q];if(se=a[q],i.hasOwnProperty(q)&&(Y!=null||se!=null))switch(q){case"type":u=Y;break;case"name":c=Y;break;case"checked":$=Y;break;case"defaultChecked":W=Y;break;case"value":m=Y;break;case"defaultValue":y=Y;break;case"children":case"dangerouslySetInnerHTML":if(Y!=null)throw Error(o(137,t));break;default:Y!==se&&yt(e,t,q,Y,i,se)}}Wl(e,m,y,T,$,W,u,c);return;case"select":Y=m=y=q=null;for(u in a)if(T=a[u],a.hasOwnProperty(u)&&T!=null)switch(u){case"value":break;case"multiple":Y=T;default:i.hasOwnProperty(u)||yt(e,t,u,null,i,T)}for(c in i)if(u=i[c],T=a[c],i.hasOwnProperty(c)&&(u!=null||T!=null))switch(c){case"value":q=u;break;case"defaultValue":y=u;break;case"multiple":m=u;default:u!==T&&yt(e,t,c,u,i,T)}t=y,a=m,i=Y,q!=null?Or(e,!!a,q,!1):!!i!=!!a&&(t!=null?Or(e,!!a,t,!0):Or(e,!!a,a?[]:"",!1));return;case"textarea":Y=q=null;for(y in a)if(c=a[y],a.hasOwnProperty(y)&&c!=null&&!i.hasOwnProperty(y))switch(y){case"value":break;case"children":break;default:yt(e,t,y,null,i,c)}for(m in i)if(c=i[m],u=a[m],i.hasOwnProperty(m)&&(c!=null||u!=null))switch(m){case"value":q=c;break;case"defaultValue":Y=c;break;case"children":break;case"dangerouslySetInnerHTML":if(c!=null)throw Error(o(91));break;default:c!==u&&yt(e,t,m,c,i,u)}Pu(e,q,Y);return;case"option":for(var _e in a)if(q=a[_e],a.hasOwnProperty(_e)&&q!=null&&!i.hasOwnProperty(_e))switch(_e){case"selected":e.selected=!1;break;default:yt(e,t,_e,null,i,q)}for(T in i)if(q=i[T],Y=a[T],i.hasOwnProperty(T)&&q!==Y&&(q!=null||Y!=null))switch(T){case"selected":e.selected=q&&typeof q!="function"&&typeof q!="symbol";break;default:yt(e,t,T,q,i,Y)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ze in a)q=a[ze],a.hasOwnProperty(ze)&&q!=null&&!i.hasOwnProperty(ze)&&yt(e,t,ze,null,i,q);for($ in i)if(q=i[$],Y=a[$],i.hasOwnProperty($)&&q!==Y&&(q!=null||Y!=null))switch($){case"children":case"dangerouslySetInnerHTML":if(q!=null)throw Error(o(137,t));break;default:yt(e,t,$,q,i,Y)}return;default:if(eo(t)){for(var vt in a)q=a[vt],a.hasOwnProperty(vt)&&q!==void 0&&!i.hasOwnProperty(vt)&&Ic(e,t,vt,void 0,i,q);for(W in i)q=i[W],Y=a[W],!i.hasOwnProperty(W)||q===Y||q===void 0&&Y===void 0||Ic(e,t,W,q,i,Y);return}}for(var L in a)q=a[L],a.hasOwnProperty(L)&&q!=null&&!i.hasOwnProperty(L)&&yt(e,t,L,null,i,q);for(se in i)q=i[se],Y=a[se],!i.hasOwnProperty(se)||q===Y||q==null&&Y==null||yt(e,t,se,q,i,Y)}function Qf(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function m0(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,a=performance.getEntriesByType("resource"),i=0;i<a.length;i++){var c=a[i],u=c.transferSize,m=c.initiatorType,y=c.duration;if(u&&y&&Qf(m)){for(m=0,y=c.responseEnd,i+=1;i<a.length;i++){var T=a[i],$=T.startTime;if($>y)break;var W=T.transferSize,se=T.initiatorType;W&&Qf(se)&&(T=T.responseEnd,m+=W*(T<y?1:(y-$)/(T-$)))}if(--i,t+=8*(u+m)/(c.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var qc=null,Pc=null;function Sl(e){return e.nodeType===9?e:e.ownerDocument}function Zf(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Jf(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function Gc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Yc=null;function p0(){var e=window.event;return e&&e.type==="popstate"?e===Yc?!1:(Yc=e,!0):(Yc=null,!1)}var Xf=typeof setTimeout=="function"?setTimeout:void 0,g0=typeof clearTimeout=="function"?clearTimeout:void 0,Wf=typeof Promise=="function"?Promise:void 0,b0=typeof queueMicrotask=="function"?queueMicrotask:typeof Wf<"u"?function(e){return Wf.resolve(null).then(e).catch(x0)}:Xf;function x0(e){setTimeout(function(){throw e})}function Zs(e){return e==="head"}function Ff(e,t){var a=t,i=0;do{var c=a.nextSibling;if(e.removeChild(a),c&&c.nodeType===8)if(a=c.data,a==="/$"||a==="/&"){if(i===0){e.removeChild(c),cn(t);return}i--}else if(a==="$"||a==="$?"||a==="$~"||a==="$!"||a==="&")i++;else if(a==="html")si(e.ownerDocument.documentElement);else if(a==="head"){a=e.ownerDocument.head,si(a);for(var u=a.firstChild;u;){var m=u.nextSibling,y=u.nodeName;u[os]||y==="SCRIPT"||y==="STYLE"||y==="LINK"&&u.rel.toLowerCase()==="stylesheet"||a.removeChild(u),u=m}}else a==="body"&&si(e.ownerDocument.body);a=c}while(a);cn(t)}function em(e,t){var a=e;e=0;do{var i=a.nextSibling;if(a.nodeType===1?t?(a._stashedDisplay=a.style.display,a.style.display="none"):(a.style.display=a._stashedDisplay||"",a.getAttribute("style")===""&&a.removeAttribute("style")):a.nodeType===3&&(t?(a._stashedText=a.nodeValue,a.nodeValue=""):a.nodeValue=a._stashedText||""),i&&i.nodeType===8)if(a=i.data,a==="/$"){if(e===0)break;e--}else a!=="$"&&a!=="$?"&&a!=="$~"&&a!=="$!"||e++;a=i}while(a)}function Kc(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var a=t;switch(t=t.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":Kc(a),Mt(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(a.rel.toLowerCase()==="stylesheet")continue}e.removeChild(a)}}function y0(e,t,a,i){for(;e.nodeType===1;){var c=a;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!i&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(i){if(!e[os])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(u=e.getAttribute("rel"),u==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(u!==c.rel||e.getAttribute("href")!==(c.href==null||c.href===""?null:c.href)||e.getAttribute("crossorigin")!==(c.crossOrigin==null?null:c.crossOrigin)||e.getAttribute("title")!==(c.title==null?null:c.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(u=e.getAttribute("src"),(u!==(c.src==null?null:c.src)||e.getAttribute("type")!==(c.type==null?null:c.type)||e.getAttribute("crossorigin")!==(c.crossOrigin==null?null:c.crossOrigin))&&u&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var u=c.name==null?null:""+c.name;if(c.type==="hidden"&&e.getAttribute("name")===u)return e}else return e;if(e=Ka(e.nextSibling),e===null)break}return null}function v0(e,t,a){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!a||(e=Ka(e.nextSibling),e===null))return null;return e}function tm(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=Ka(e.nextSibling),e===null))return null;return e}function Vc(e){return e.data==="$?"||e.data==="$~"}function Qc(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function w0(e,t){var a=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||a.readyState!=="loading")t();else{var i=function(){t(),a.removeEventListener("DOMContentLoaded",i)};a.addEventListener("DOMContentLoaded",i),e._reactRetry=i}}function Ka(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var Zc=null;function am(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var a=e.data;if(a==="/$"||a==="/&"){if(t===0)return Ka(e.nextSibling);t--}else a!=="$"&&a!=="$!"&&a!=="$?"&&a!=="$~"&&a!=="&"||t++}e=e.nextSibling}return null}function sm(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var a=e.data;if(a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"){if(t===0)return e;t--}else a!=="/$"&&a!=="/&"||t++}e=e.previousSibling}return null}function rm(e,t,a){switch(t=Sl(a),e){case"html":if(e=t.documentElement,!e)throw Error(o(452));return e;case"head":if(e=t.head,!e)throw Error(o(453));return e;case"body":if(e=t.body,!e)throw Error(o(454));return e;default:throw Error(o(451))}}function si(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Mt(e)}var Va=new Map,nm=new Set;function El(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var Es=Q.d;Q.d={f:j0,r:_0,D:N0,C:S0,L:E0,m:T0,X:k0,S:A0,M:O0};function j0(){var e=Es.f(),t=bl();return e||t}function _0(e){var t=Ua(e);t!==null&&t.tag===5&&t.type==="form"?wh(t):Es.r(e)}var nn=typeof document>"u"?null:document;function im(e,t,a){var i=nn;if(i&&typeof t=="string"&&t){var c=Ha(t);c='link[rel="'+e+'"][href="'+c+'"]',typeof a=="string"&&(c+='[crossorigin="'+a+'"]'),nm.has(c)||(nm.add(c),e={rel:e,crossOrigin:a,href:t},i.querySelector(c)===null&&(t=i.createElement("link"),sa(t,"link",e),_t(t),i.head.appendChild(t)))}}function N0(e){Es.D(e),im("dns-prefetch",e,null)}function S0(e,t){Es.C(e,t),im("preconnect",e,t)}function E0(e,t,a){Es.L(e,t,a);var i=nn;if(i&&e&&t){var c='link[rel="preload"][as="'+Ha(t)+'"]';t==="image"&&a&&a.imageSrcSet?(c+='[imagesrcset="'+Ha(a.imageSrcSet)+'"]',typeof a.imageSizes=="string"&&(c+='[imagesizes="'+Ha(a.imageSizes)+'"]')):c+='[href="'+Ha(e)+'"]';var u=c;switch(t){case"style":u=ln(e);break;case"script":u=on(e)}Va.has(u)||(e=x({rel:"preload",href:t==="image"&&a&&a.imageSrcSet?void 0:e,as:t},a),Va.set(u,e),i.querySelector(c)!==null||t==="style"&&i.querySelector(ri(u))||t==="script"&&i.querySelector(ni(u))||(t=i.createElement("link"),sa(t,"link",e),_t(t),i.head.appendChild(t)))}}function T0(e,t){Es.m(e,t);var a=nn;if(a&&e){var i=t&&typeof t.as=="string"?t.as:"script",c='link[rel="modulepreload"][as="'+Ha(i)+'"][href="'+Ha(e)+'"]',u=c;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":u=on(e)}if(!Va.has(u)&&(e=x({rel:"modulepreload",href:e},t),Va.set(u,e),a.querySelector(c)===null)){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(ni(u)))return}i=a.createElement("link"),sa(i,"link",e),_t(i),a.head.appendChild(i)}}}function A0(e,t,a){Es.S(e,t,a);var i=nn;if(i&&e){var c=la(i).hoistableStyles,u=ln(e);t=t||"default";var m=c.get(u);if(!m){var y={loading:0,preload:null};if(m=i.querySelector(ri(u)))y.loading=5;else{e=x({rel:"stylesheet",href:e,"data-precedence":t},a),(a=Va.get(u))&&Jc(e,a);var T=m=i.createElement("link");_t(T),sa(T,"link",e),T._p=new Promise(function($,W){T.onload=$,T.onerror=W}),T.addEventListener("load",function(){y.loading|=1}),T.addEventListener("error",function(){y.loading|=2}),y.loading|=4,Tl(m,t,i)}m={type:"stylesheet",instance:m,count:1,state:y},c.set(u,m)}}}function k0(e,t){Es.X(e,t);var a=nn;if(a&&e){var i=la(a).hoistableScripts,c=on(e),u=i.get(c);u||(u=a.querySelector(ni(c)),u||(e=x({src:e,async:!0},t),(t=Va.get(c))&&Xc(e,t),u=a.createElement("script"),_t(u),sa(u,"link",e),a.head.appendChild(u)),u={type:"script",instance:u,count:1,state:null},i.set(c,u))}}function O0(e,t){Es.M(e,t);var a=nn;if(a&&e){var i=la(a).hoistableScripts,c=on(e),u=i.get(c);u||(u=a.querySelector(ni(c)),u||(e=x({src:e,async:!0,type:"module"},t),(t=Va.get(c))&&Xc(e,t),u=a.createElement("script"),_t(u),sa(u,"link",e),a.head.appendChild(u)),u={type:"script",instance:u,count:1,state:null},i.set(c,u))}}function lm(e,t,a,i){var c=(c=Be.current)?El(c):null;if(!c)throw Error(o(446));switch(e){case"meta":case"title":return null;case"style":return typeof a.precedence=="string"&&typeof a.href=="string"?(t=ln(a.href),a=la(c).hoistableStyles,i=a.get(t),i||(i={type:"style",instance:null,count:0,state:null},a.set(t,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if(a.rel==="stylesheet"&&typeof a.href=="string"&&typeof a.precedence=="string"){e=ln(a.href);var u=la(c).hoistableStyles,m=u.get(e);if(m||(c=c.ownerDocument||c,m={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,m),(u=c.querySelector(ri(e)))&&!u._p&&(m.instance=u,m.state.loading=5),Va.has(e)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},Va.set(e,a),u||C0(c,e,a,m.state))),t&&i===null)throw Error(o(528,""));return m}if(t&&i!==null)throw Error(o(529,""));return null;case"script":return t=a.async,a=a.src,typeof a=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=on(a),a=la(c).hoistableScripts,i=a.get(t),i||(i={type:"script",instance:null,count:0,state:null},a.set(t,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(o(444,e))}}function ln(e){return'href="'+Ha(e)+'"'}function ri(e){return'link[rel="stylesheet"]['+e+"]"}function om(e){return x({},e,{"data-precedence":e.precedence,precedence:null})}function C0(e,t,a,i){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?i.loading=1:(t=e.createElement("link"),i.preload=t,t.addEventListener("load",function(){return i.loading|=1}),t.addEventListener("error",function(){return i.loading|=2}),sa(t,"link",a),_t(t),e.head.appendChild(t))}function on(e){return'[src="'+Ha(e)+'"]'}function ni(e){return"script[async]"+e}function cm(e,t,a){if(t.count++,t.instance===null)switch(t.type){case"style":var i=e.querySelector('style[data-href~="'+Ha(a.href)+'"]');if(i)return t.instance=i,_t(i),i;var c=x({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return i=(e.ownerDocument||e).createElement("style"),_t(i),sa(i,"style",c),Tl(i,a.precedence,e),t.instance=i;case"stylesheet":c=ln(a.href);var u=e.querySelector(ri(c));if(u)return t.state.loading|=4,t.instance=u,_t(u),u;i=om(a),(c=Va.get(c))&&Jc(i,c),u=(e.ownerDocument||e).createElement("link"),_t(u);var m=u;return m._p=new Promise(function(y,T){m.onload=y,m.onerror=T}),sa(u,"link",i),t.state.loading|=4,Tl(u,a.precedence,e),t.instance=u;case"script":return u=on(a.src),(c=e.querySelector(ni(u)))?(t.instance=c,_t(c),c):(i=a,(c=Va.get(u))&&(i=x({},a),Xc(i,c)),e=e.ownerDocument||e,c=e.createElement("script"),_t(c),sa(c,"link",i),e.head.appendChild(c),t.instance=c);case"void":return null;default:throw Error(o(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(i=t.instance,t.state.loading|=4,Tl(i,a.precedence,e));return t.instance}function Tl(e,t,a){for(var i=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),c=i.length?i[i.length-1]:null,u=c,m=0;m<i.length;m++){var y=i[m];if(y.dataset.precedence===t)u=y;else if(u!==c)break}u?u.parentNode.insertBefore(e,u.nextSibling):(t=a.nodeType===9?a.head:a,t.insertBefore(e,t.firstChild))}function Jc(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Xc(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var Al=null;function um(e,t,a){if(Al===null){var i=new Map,c=Al=new Map;c.set(a,i)}else c=Al,i=c.get(a),i||(i=new Map,c.set(a,i));if(i.has(e))return i;for(i.set(e,null),a=a.getElementsByTagName(e),c=0;c<a.length;c++){var u=a[c];if(!(u[os]||u[Ie]||e==="link"&&u.getAttribute("rel")==="stylesheet")&&u.namespaceURI!=="http://www.w3.org/2000/svg"){var m=u.getAttribute(t)||"";m=e+m;var y=i.get(m);y?y.push(u):i.set(m,[u])}}return i}function dm(e,t,a){e=e.ownerDocument||e,e.head.insertBefore(a,t==="title"?e.querySelector("head > title"):null)}function R0(e,t,a){if(a===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function hm(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function z0(e,t,a,i){if(a.type==="stylesheet"&&(typeof i.media!="string"||matchMedia(i.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var c=ln(i.href),u=t.querySelector(ri(c));if(u){t=u._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=kl.bind(e),t.then(e,e)),a.state.loading|=4,a.instance=u,_t(u);return}u=t.ownerDocument||t,i=om(i),(c=Va.get(c))&&Jc(i,c),u=u.createElement("link"),_t(u);var m=u;m._p=new Promise(function(y,T){m.onload=y,m.onerror=T}),sa(u,"link",i),a.instance=u}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(a,t),(t=a.state.preload)&&(a.state.loading&3)===0&&(e.count++,a=kl.bind(e),t.addEventListener("load",a),t.addEventListener("error",a))}}var Wc=0;function M0(e,t){return e.stylesheets&&e.count===0&&Cl(e,e.stylesheets),0<e.count||0<e.imgCount?function(a){var i=setTimeout(function(){if(e.stylesheets&&Cl(e,e.stylesheets),e.unsuspend){var u=e.unsuspend;e.unsuspend=null,u()}},6e4+t);0<e.imgBytes&&Wc===0&&(Wc=62500*m0());var c=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&Cl(e,e.stylesheets),e.unsuspend)){var u=e.unsuspend;e.unsuspend=null,u()}},(e.imgBytes>Wc?50:800)+t);return e.unsuspend=a,function(){e.unsuspend=null,clearTimeout(i),clearTimeout(c)}}:null}function kl(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Cl(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Ol=null;function Cl(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Ol=new Map,t.forEach(D0,e),Ol=null,kl.call(e))}function D0(e,t){if(!(t.state.loading&4)){var a=Ol.get(e);if(a)var i=a.get(null);else{a=new Map,Ol.set(e,a);for(var c=e.querySelectorAll("link[data-precedence],style[data-precedence]"),u=0;u<c.length;u++){var m=c[u];(m.nodeName==="LINK"||m.getAttribute("media")!=="not all")&&(a.set(m.dataset.precedence,m),i=m)}i&&a.set(null,i)}c=t.instance,m=c.getAttribute("data-precedence"),u=a.get(m)||i,u===i&&a.set(null,c),a.set(m,c),this.count++,i=kl.bind(this),c.addEventListener("load",i),c.addEventListener("error",i),u?u.parentNode.insertBefore(c,u.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(c,e.firstChild)),t.state.loading|=4}}var ii={$$typeof:N,Provider:null,Consumer:null,_currentValue:ie,_currentValue2:ie,_threadCount:0};function U0(e,t,a,i,c,u,m,y,T){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=et(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=et(0),this.hiddenUpdates=et(null),this.identifierPrefix=i,this.onUncaughtError=c,this.onCaughtError=u,this.onRecoverableError=m,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=T,this.incompleteTransitions=new Map}function fm(e,t,a,i,c,u,m,y,T,$,W,se){return e=new U0(e,t,a,m,T,$,W,se,y),t=1,u===!0&&(t|=24),u=_a(3,null,null,t),e.current=u,u.stateNode=e,t=Co(),t.refCount++,e.pooledCache=t,t.refCount++,u.memoizedState={element:i,isDehydrated:a,cache:t},Do(u),e}function mm(e){return e?(e=Br,e):Br}function pm(e,t,a,i,c,u){c=mm(c),i.context===null?i.context=c:i.pendingContext=c,i=Bs(t),i.payload={element:a},u=u===void 0?null:u,u!==null&&(i.callback=u),a=Hs(e,i,t),a!==null&&(va(a,e,t),Bn(a,e,t))}function gm(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var a=e.retryLane;e.retryLane=a!==0&&a<t?a:t}}function Fc(e,t){gm(e,t),(e=e.alternate)&&gm(e,t)}function bm(e){if(e.tag===13||e.tag===31){var t=lr(e,67108864);t!==null&&va(t,e,67108864),Fc(e,67108864)}}function xm(e){if(e.tag===13||e.tag===31){var t=Aa();t=mt(t);var a=lr(e,t);a!==null&&va(a,e,t),Fc(e,t)}}var Rl=!0;function L0(e,t,a,i){var c=S.T;S.T=null;var u=Q.p;try{Q.p=2,eu(e,t,a,i)}finally{Q.p=u,S.T=c}}function B0(e,t,a,i){var c=S.T;S.T=null;var u=Q.p;try{Q.p=8,eu(e,t,a,i)}finally{Q.p=u,S.T=c}}function eu(e,t,a,i){if(Rl){var c=tu(i);if(c===null)$c(e,t,i,zl,a),vm(e,i);else if($0(c,e,t,a,i))i.stopPropagation();else if(vm(e,i),t&4&&-1<H0.indexOf(e)){for(;c!==null;){var u=Ua(c);if(u!==null)switch(u.tag){case 3:if(u=u.stateNode,u.current.memoizedState.isDehydrated){var m=he(u.pendingLanes);if(m!==0){var y=u;for(y.pendingLanes|=2,y.entangledLanes|=2;m;){var T=1<<31-re(m);y.entanglements[1]|=T,m&=~T}is(u),(ut&6)===0&&(pl=Zt()+500,ei(0))}}break;case 31:case 13:y=lr(u,2),y!==null&&va(y,u,2),bl(),Fc(u,2)}if(u=tu(i),u===null&&$c(e,t,i,zl,a),u===c)break;c=u}c!==null&&i.stopPropagation()}else $c(e,t,i,null,a)}}function tu(e){return e=ao(e),au(e)}var zl=null;function au(e){if(zl=null,e=Ot(e),e!==null){var t=h(e);if(t===null)e=null;else{var a=t.tag;if(a===13){if(e=f(t),e!==null)return e;e=null}else if(a===31){if(e=b(t),e!==null)return e;e=null}else if(a===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return zl=e,null}function ym(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ar()){case Si:return 2;case Ma:return 8;case Os:case Jl:return 32;case w:return 268435456;default:return 32}default:return 32}}var su=!1,Js=null,Xs=null,Ws=null,li=new Map,oi=new Map,Fs=[],H0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function vm(e,t){switch(e){case"focusin":case"focusout":Js=null;break;case"dragenter":case"dragleave":Xs=null;break;case"mouseover":case"mouseout":Ws=null;break;case"pointerover":case"pointerout":li.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":oi.delete(t.pointerId)}}function ci(e,t,a,i,c,u){return e===null||e.nativeEvent!==u?(e={blockedOn:t,domEventName:a,eventSystemFlags:i,nativeEvent:u,targetContainers:[c]},t!==null&&(t=Ua(t),t!==null&&bm(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,c!==null&&t.indexOf(c)===-1&&t.push(c),e)}function $0(e,t,a,i,c){switch(t){case"focusin":return Js=ci(Js,e,t,a,i,c),!0;case"dragenter":return Xs=ci(Xs,e,t,a,i,c),!0;case"mouseover":return Ws=ci(Ws,e,t,a,i,c),!0;case"pointerover":var u=c.pointerId;return li.set(u,ci(li.get(u)||null,e,t,a,i,c)),!0;case"gotpointercapture":return u=c.pointerId,oi.set(u,ci(oi.get(u)||null,e,t,a,i,c)),!0}return!1}function wm(e){var t=Ot(e.target);if(t!==null){var a=h(t);if(a!==null){if(t=a.tag,t===13){if(t=f(a),t!==null){e.blockedOn=t,it(e.priority,function(){xm(a)});return}}else if(t===31){if(t=b(a),t!==null){e.blockedOn=t,it(e.priority,function(){xm(a)});return}}else if(t===3&&a.stateNode.current.memoizedState.isDehydrated){e.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ml(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var a=tu(e.nativeEvent);if(a===null){a=e.nativeEvent;var i=new a.constructor(a.type,a);to=i,a.target.dispatchEvent(i),to=null}else return t=Ua(a),t!==null&&bm(t),e.blockedOn=a,!1;t.shift()}return!0}function jm(e,t,a){Ml(e)&&a.delete(t)}function I0(){su=!1,Js!==null&&Ml(Js)&&(Js=null),Xs!==null&&Ml(Xs)&&(Xs=null),Ws!==null&&Ml(Ws)&&(Ws=null),li.forEach(jm),oi.forEach(jm)}function Dl(e,t){e.blockedOn===t&&(e.blockedOn=null,su||(su=!0,l.unstable_scheduleCallback(l.unstable_NormalPriority,I0)))}var Ul=null;function _m(e){Ul!==e&&(Ul=e,l.unstable_scheduleCallback(l.unstable_NormalPriority,function(){Ul===e&&(Ul=null);for(var t=0;t<e.length;t+=3){var a=e[t],i=e[t+1],c=e[t+2];if(typeof i!="function"){if(au(i||a)===null)continue;break}var u=Ua(a);u!==null&&(e.splice(t,3),t-=3,tc(u,{pending:!0,data:c,method:a.method,action:i},i,c))}}))}function cn(e){function t(T){return Dl(T,e)}Js!==null&&Dl(Js,e),Xs!==null&&Dl(Xs,e),Ws!==null&&Dl(Ws,e),li.forEach(t),oi.forEach(t);for(var a=0;a<Fs.length;a++){var i=Fs[a];i.blockedOn===e&&(i.blockedOn=null)}for(;0<Fs.length&&(a=Fs[0],a.blockedOn===null);)wm(a),a.blockedOn===null&&Fs.shift();if(a=(e.ownerDocument||e).$$reactFormReplay,a!=null)for(i=0;i<a.length;i+=3){var c=a[i],u=a[i+1],m=c[Le]||null;if(typeof u=="function")m||_m(a);else if(m){var y=null;if(u&&u.hasAttribute("formAction")){if(c=u,m=u[Le]||null)y=m.formAction;else if(au(c)!==null)continue}else y=m.action;typeof y=="function"?a[i+1]=y:(a.splice(i,3),i-=3),_m(a)}}}function Nm(){function e(u){u.canIntercept&&u.info==="react-transition"&&u.intercept({handler:function(){return new Promise(function(m){return c=m})},focusReset:"manual",scroll:"manual"})}function t(){c!==null&&(c(),c=null),i||setTimeout(a,20)}function a(){if(!i&&!navigation.transition){var u=navigation.currentEntry;u&&u.url!=null&&navigation.navigate(u.url,{state:u.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var i=!1,c=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(a,100),function(){i=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),c!==null&&(c(),c=null)}}}function ru(e){this._internalRoot=e}Ll.prototype.render=ru.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(o(409));var a=t.current,i=Aa();pm(a,i,e,t,null,null)},Ll.prototype.unmount=ru.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;pm(e.current,2,null,e,null,null),bl(),t[wt]=null}};function Ll(e){this._internalRoot=e}Ll.prototype.unstable_scheduleHydration=function(e){if(e){var t=ve();e={blockedOn:null,target:e,priority:t};for(var a=0;a<Fs.length&&t!==0&&t<Fs[a].priority;a++);Fs.splice(a,0,e),a===0&&wm(e)}};var Sm=s.version;if(Sm!=="19.2.3")throw Error(o(527,Sm,"19.2.3"));Q.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(o(188)):(e=Object.keys(e).join(","),Error(o(268,e)));return e=p(t),e=e!==null?v(e):null,e=e===null?null:e.stateNode,e};var q0={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:S,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Bl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Bl.isDisabled&&Bl.supportsFiber)try{B=Bl.inject(q0),D=Bl}catch{}}return di.createRoot=function(e,t){if(!d(e))throw Error(o(299));var a=!1,i="",c=Ch,u=Rh,m=zh;return t!=null&&(t.unstable_strictMode===!0&&(a=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onUncaughtError!==void 0&&(c=t.onUncaughtError),t.onCaughtError!==void 0&&(u=t.onCaughtError),t.onRecoverableError!==void 0&&(m=t.onRecoverableError)),t=fm(e,1,!1,null,null,a,i,null,c,u,m,Nm),e[wt]=t.current,Hc(e),new ru(t)},di.hydrateRoot=function(e,t,a){if(!d(e))throw Error(o(299));var i=!1,c="",u=Ch,m=Rh,y=zh,T=null;return a!=null&&(a.unstable_strictMode===!0&&(i=!0),a.identifierPrefix!==void 0&&(c=a.identifierPrefix),a.onUncaughtError!==void 0&&(u=a.onUncaughtError),a.onCaughtError!==void 0&&(m=a.onCaughtError),a.onRecoverableError!==void 0&&(y=a.onRecoverableError),a.formState!==void 0&&(T=a.formState)),t=fm(e,1,!0,t,a??null,i,c,T,u,m,y,Nm),t.context=mm(null),a=t.current,i=Aa(),i=mt(i),c=Bs(i),c.callback=null,Hs(a,c,i),a=i,t.current.lanes=a,ft(t,a),is(t),e[wt]=t.current,Hc(e),new Ll(t)},di.version="19.2.3",di}var Dm;function W0(){if(Dm)return lu.exports;Dm=1;function l(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(l)}catch(s){console.error(s)}}return l(),lu.exports=X0(),lu.exports}var F0=W0();const eb=up(F0);function Vl(l,s){var n={};for(var o in l)Object.prototype.hasOwnProperty.call(l,o)&&s.indexOf(o)<0&&(n[o]=l[o]);if(l!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,o=Object.getOwnPropertySymbols(l);d<o.length;d++)s.indexOf(o[d])<0&&Object.prototype.propertyIsEnumerable.call(l,o[d])&&(n[o[d]]=l[o[d]]);return n}function tb(l,s,n,o){function d(h){return h instanceof n?h:new n(function(f){f(h)})}return new(n||(n=Promise))(function(h,f){function b(v){try{p(o.next(v))}catch(x){f(x)}}function g(v){try{p(o.throw(v))}catch(x){f(x)}}function p(v){v.done?h(v.value):d(v.value).then(b,g)}p((o=o.apply(l,s||[])).next())})}const ab=l=>l?(...s)=>l(...s):(...s)=>fetch(...s);class zu extends Error{constructor(s,n="FunctionsError",o){super(s),this.name=n,this.context=o}}class sb extends zu{constructor(s){super("Failed to send a request to the Edge Function","FunctionsFetchError",s)}}class Um extends zu{constructor(s){super("Relay Error invoking the Edge Function","FunctionsRelayError",s)}}class Lm extends zu{constructor(s){super("Edge Function returned a non-2xx status code","FunctionsHttpError",s)}}var wu;(function(l){l.Any="any",l.ApNortheast1="ap-northeast-1",l.ApNortheast2="ap-northeast-2",l.ApSouth1="ap-south-1",l.ApSoutheast1="ap-southeast-1",l.ApSoutheast2="ap-southeast-2",l.CaCentral1="ca-central-1",l.EuCentral1="eu-central-1",l.EuWest1="eu-west-1",l.EuWest2="eu-west-2",l.EuWest3="eu-west-3",l.SaEast1="sa-east-1",l.UsEast1="us-east-1",l.UsWest1="us-west-1",l.UsWest2="us-west-2"})(wu||(wu={}));class rb{constructor(s,{headers:n={},customFetch:o,region:d=wu.Any}={}){this.url=s,this.headers=n,this.region=d,this.fetch=ab(o)}setAuth(s){this.headers.Authorization=`Bearer ${s}`}invoke(s){return tb(this,arguments,void 0,function*(n,o={}){var d;let h,f;try{const{headers:b,method:g,body:p,signal:v,timeout:x}=o;let _={},{region:j}=o;j||(j=this.region);const C=new URL(`${this.url}/${n}`);j&&j!=="any"&&(_["x-region"]=j,C.searchParams.set("forceFunctionRegion",j));let z;p&&(b&&!Object.prototype.hasOwnProperty.call(b,"Content-Type")||!b)?typeof Blob<"u"&&p instanceof Blob||p instanceof ArrayBuffer?(_["Content-Type"]="application/octet-stream",z=p):typeof p=="string"?(_["Content-Type"]="text/plain",z=p):typeof FormData<"u"&&p instanceof FormData?z=p:(_["Content-Type"]="application/json",z=JSON.stringify(p)):z=p;let M=v;x&&(f=new AbortController,h=setTimeout(()=>f.abort(),x),v?(M=f.signal,v.addEventListener("abort",()=>f.abort())):M=f.signal);const E=yield this.fetch(C.toString(),{method:g||"POST",headers:Object.assign(Object.assign(Object.assign({},_),this.headers),b),body:z,signal:M}).catch(fe=>{throw new sb(fe)}),O=E.headers.get("x-relay-error");if(O&&O==="true")throw new Um(E);if(!E.ok)throw new Lm(E);let N=((d=E.headers.get("Content-Type"))!==null&&d!==void 0?d:"text/plain").split(";")[0].trim(),G;return N==="application/json"?G=yield E.json():N==="application/octet-stream"||N==="application/pdf"?G=yield E.blob():N==="text/event-stream"?G=E:N==="multipart/form-data"?G=yield E.formData():G=yield E.text(),{data:G,error:null,response:E}}catch(b){return{data:null,error:b,response:b instanceof Lm||b instanceof Um?b.context:void 0}}finally{h&&clearTimeout(h)}})}}var nb=class extends Error{constructor(l){super(l.message),this.name="PostgrestError",this.details=l.details,this.hint=l.hint,this.code=l.code}},ib=class{constructor(l){var s,n;this.shouldThrowOnError=!1,this.method=l.method,this.url=l.url,this.headers=new Headers(l.headers),this.schema=l.schema,this.body=l.body,this.shouldThrowOnError=(s=l.shouldThrowOnError)!==null&&s!==void 0?s:!1,this.signal=l.signal,this.isMaybeSingle=(n=l.isMaybeSingle)!==null&&n!==void 0?n:!1,l.fetch?this.fetch=l.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(l,s){return this.headers=new Headers(this.headers),this.headers.set(l,s),this}then(l,s){var n=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const o=this.fetch;let d=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async h=>{let f=null,b=null,g=null,p=h.status,v=h.statusText;if(h.ok){var x,_;if(n.method!=="HEAD"){var j;const E=await h.text();E===""||(n.headers.get("Accept")==="text/csv"||n.headers.get("Accept")&&(!((j=n.headers.get("Accept"))===null||j===void 0)&&j.includes("application/vnd.pgrst.plan+text"))?b=E:b=JSON.parse(E))}const z=(x=n.headers.get("Prefer"))===null||x===void 0?void 0:x.match(/count=(exact|planned|estimated)/),M=(_=h.headers.get("content-range"))===null||_===void 0?void 0:_.split("/");z&&M&&M.length>1&&(g=parseInt(M[1])),n.isMaybeSingle&&n.method==="GET"&&Array.isArray(b)&&(b.length>1?(f={code:"PGRST116",details:`Results contain ${b.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},b=null,g=null,p=406,v="Not Acceptable"):b.length===1?b=b[0]:b=null)}else{var C;const z=await h.text();try{f=JSON.parse(z),Array.isArray(f)&&h.status===404&&(b=[],f=null,p=200,v="OK")}catch{h.status===404&&z===""?(p=204,v="No Content"):f={message:z}}if(f&&n.isMaybeSingle&&(!(f==null||(C=f.details)===null||C===void 0)&&C.includes("0 rows"))&&(f=null,p=200,v="OK"),f&&n.shouldThrowOnError)throw new nb(f)}return{error:f,data:b,count:g,status:p,statusText:v}});return this.shouldThrowOnError||(d=d.catch(h=>{var f;let b="";const g=h==null?void 0:h.cause;if(g){var p,v,x,_;const C=(p=g==null?void 0:g.message)!==null&&p!==void 0?p:"",z=(v=g==null?void 0:g.code)!==null&&v!==void 0?v:"";b=`${(x=h==null?void 0:h.name)!==null&&x!==void 0?x:"FetchError"}: ${h==null?void 0:h.message}`,b+=`

Caused by: ${(_=g==null?void 0:g.name)!==null&&_!==void 0?_:"Error"}: ${C}`,z&&(b+=` (${z})`),g!=null&&g.stack&&(b+=`
${g.stack}`)}else{var j;b=(j=h==null?void 0:h.stack)!==null&&j!==void 0?j:""}return{error:{message:`${(f=h==null?void 0:h.name)!==null&&f!==void 0?f:"FetchError"}: ${h==null?void 0:h.message}`,details:b,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),d.then(l,s)}returns(){return this}overrideTypes(){return this}},lb=class extends ib{select(l){let s=!1;const n=(l??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(l,{ascending:s=!0,nullsFirst:n,foreignTable:o,referencedTable:d=o}={}){const h=d?`${d}.order`:"order",f=this.url.searchParams.get(h);return this.url.searchParams.set(h,`${f?`${f},`:""}${l}.${s?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(l,{foreignTable:s,referencedTable:n=s}={}){const o=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(o,`${l}`),this}range(l,s,{foreignTable:n,referencedTable:o=n}={}){const d=typeof o>"u"?"offset":`${o}.offset`,h=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(d,`${l}`),this.url.searchParams.set(h,`${s-l+1}`),this}abortSignal(l){return this.signal=l,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:l=!1,verbose:s=!1,settings:n=!1,buffers:o=!1,wal:d=!1,format:h="text"}={}){var f;const b=[l?"analyze":null,s?"verbose":null,n?"settings":null,o?"buffers":null,d?"wal":null].filter(Boolean).join("|"),g=(f=this.headers.get("Accept"))!==null&&f!==void 0?f:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${h}; for="${g}"; options=${b};`),h==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(l){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${l}`),this}};const Bm=new RegExp("[,()]");var bn=class extends lb{eq(l,s){return this.url.searchParams.append(l,`eq.${s}`),this}neq(l,s){return this.url.searchParams.append(l,`neq.${s}`),this}gt(l,s){return this.url.searchParams.append(l,`gt.${s}`),this}gte(l,s){return this.url.searchParams.append(l,`gte.${s}`),this}lt(l,s){return this.url.searchParams.append(l,`lt.${s}`),this}lte(l,s){return this.url.searchParams.append(l,`lte.${s}`),this}like(l,s){return this.url.searchParams.append(l,`like.${s}`),this}likeAllOf(l,s){return this.url.searchParams.append(l,`like(all).{${s.join(",")}}`),this}likeAnyOf(l,s){return this.url.searchParams.append(l,`like(any).{${s.join(",")}}`),this}ilike(l,s){return this.url.searchParams.append(l,`ilike.${s}`),this}ilikeAllOf(l,s){return this.url.searchParams.append(l,`ilike(all).{${s.join(",")}}`),this}ilikeAnyOf(l,s){return this.url.searchParams.append(l,`ilike(any).{${s.join(",")}}`),this}regexMatch(l,s){return this.url.searchParams.append(l,`match.${s}`),this}regexIMatch(l,s){return this.url.searchParams.append(l,`imatch.${s}`),this}is(l,s){return this.url.searchParams.append(l,`is.${s}`),this}isDistinct(l,s){return this.url.searchParams.append(l,`isdistinct.${s}`),this}in(l,s){const n=Array.from(new Set(s)).map(o=>typeof o=="string"&&Bm.test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(l,`in.(${n})`),this}notIn(l,s){const n=Array.from(new Set(s)).map(o=>typeof o=="string"&&Bm.test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(l,`not.in.(${n})`),this}contains(l,s){return typeof s=="string"?this.url.searchParams.append(l,`cs.${s}`):Array.isArray(s)?this.url.searchParams.append(l,`cs.{${s.join(",")}}`):this.url.searchParams.append(l,`cs.${JSON.stringify(s)}`),this}containedBy(l,s){return typeof s=="string"?this.url.searchParams.append(l,`cd.${s}`):Array.isArray(s)?this.url.searchParams.append(l,`cd.{${s.join(",")}}`):this.url.searchParams.append(l,`cd.${JSON.stringify(s)}`),this}rangeGt(l,s){return this.url.searchParams.append(l,`sr.${s}`),this}rangeGte(l,s){return this.url.searchParams.append(l,`nxl.${s}`),this}rangeLt(l,s){return this.url.searchParams.append(l,`sl.${s}`),this}rangeLte(l,s){return this.url.searchParams.append(l,`nxr.${s}`),this}rangeAdjacent(l,s){return this.url.searchParams.append(l,`adj.${s}`),this}overlaps(l,s){return typeof s=="string"?this.url.searchParams.append(l,`ov.${s}`):this.url.searchParams.append(l,`ov.{${s.join(",")}}`),this}textSearch(l,s,{config:n,type:o}={}){let d="";o==="plain"?d="pl":o==="phrase"?d="ph":o==="websearch"&&(d="w");const h=n===void 0?"":`(${n})`;return this.url.searchParams.append(l,`${d}fts${h}.${s}`),this}match(l){return Object.entries(l).forEach(([s,n])=>{this.url.searchParams.append(s,`eq.${n}`)}),this}not(l,s,n){return this.url.searchParams.append(l,`not.${s}.${n}`),this}or(l,{foreignTable:s,referencedTable:n=s}={}){const o=n?`${n}.or`:"or";return this.url.searchParams.append(o,`(${l})`),this}filter(l,s,n){return this.url.searchParams.append(l,`${s}.${n}`),this}},ob=class{constructor(l,{headers:s={},schema:n,fetch:o}){this.url=l,this.headers=new Headers(s),this.schema=n,this.fetch=o}select(l,s){const{head:n=!1,count:o}=s??{},d=n?"HEAD":"GET";let h=!1;const f=(l??"*").split("").map(b=>/\s/.test(b)&&!h?"":(b==='"'&&(h=!h),b)).join("");return this.url.searchParams.set("select",f),o&&this.headers.append("Prefer",`count=${o}`),new bn({method:d,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(l,{count:s,defaultToNull:n=!0}={}){var o;const d="POST";if(s&&this.headers.append("Prefer",`count=${s}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(l)){const h=l.reduce((f,b)=>f.concat(Object.keys(b)),[]);if(h.length>0){const f=[...new Set(h)].map(b=>`"${b}"`);this.url.searchParams.set("columns",f.join(","))}}return new bn({method:d,url:this.url,headers:this.headers,schema:this.schema,body:l,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}upsert(l,{onConflict:s,ignoreDuplicates:n=!1,count:o,defaultToNull:d=!0}={}){var h;const f="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),s!==void 0&&this.url.searchParams.set("on_conflict",s),o&&this.headers.append("Prefer",`count=${o}`),d||this.headers.append("Prefer","missing=default"),Array.isArray(l)){const b=l.reduce((g,p)=>g.concat(Object.keys(p)),[]);if(b.length>0){const g=[...new Set(b)].map(p=>`"${p}"`);this.url.searchParams.set("columns",g.join(","))}}return new bn({method:f,url:this.url,headers:this.headers,schema:this.schema,body:l,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}update(l,{count:s}={}){var n;const o="PATCH";return s&&this.headers.append("Prefer",`count=${s}`),new bn({method:o,url:this.url,headers:this.headers,schema:this.schema,body:l,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:l}={}){var s;const n="DELETE";return l&&this.headers.append("Prefer",`count=${l}`),new bn({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}},cb=class dp{constructor(s,{headers:n={},schema:o,fetch:d}={}){this.url=s,this.headers=new Headers(n),this.schemaName=o,this.fetch=d}from(s){if(!s||typeof s!="string"||s.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new ob(new URL(`${this.url}/${s}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(s){return new dp(this.url,{headers:this.headers,schema:s,fetch:this.fetch})}rpc(s,n={},{head:o=!1,get:d=!1,count:h}={}){var f;let b;const g=new URL(`${this.url}/rpc/${s}`);let p;o||d?(b=o?"HEAD":"GET",Object.entries(n).filter(([x,_])=>_!==void 0).map(([x,_])=>[x,Array.isArray(_)?`{${_.join(",")}}`:`${_}`]).forEach(([x,_])=>{g.searchParams.append(x,_)})):(b="POST",p=n);const v=new Headers(this.headers);return h&&v.set("Prefer",`count=${h}`),new bn({method:b,url:g,headers:v,schema:this.schemaName,body:p,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}};class ub{constructor(){}static detectEnvironment(){var s;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((s=navigator.userAgent)===null||s===void 0)&&s.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const o=n.node,d=parseInt(o.replace(/^v/,"").split(".")[0]);return d>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${d} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${d} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const s=this.detectEnvironment();if(s.constructor)return s.constructor;let n=s.error||"WebSocket not supported in this environment.";throw s.workaround&&(n+=`

Suggested solution: ${s.workaround}`),new Error(n)}static createWebSocket(s,n){const o=this.getWebSocketConstructor();return new o(s,n)}static isWebSocketSupported(){try{const s=this.detectEnvironment();return s.type==="native"||s.type==="ws"}catch{return!1}}}const db="2.89.0",hb=`realtime-js/${db}`,hp="1.0.0",fb="2.0.0",Hm=hp,ju=1e4,mb=1e3,pb=100;var tr;(function(l){l[l.connecting=0]="connecting",l[l.open=1]="open",l[l.closing=2]="closing",l[l.closed=3]="closed"})(tr||(tr={}));var Xt;(function(l){l.closed="closed",l.errored="errored",l.joined="joined",l.joining="joining",l.leaving="leaving"})(Xt||(Xt={}));var es;(function(l){l.close="phx_close",l.error="phx_error",l.join="phx_join",l.reply="phx_reply",l.leave="phx_leave",l.access_token="access_token"})(es||(es={}));var _u;(function(l){l.websocket="websocket"})(_u||(_u={}));var _r;(function(l){l.Connecting="connecting",l.Open="open",l.Closing="closing",l.Closed="closed"})(_r||(_r={}));class gb{constructor(s){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=s??[]}encode(s,n){if(s.event===this.BROADCAST_EVENT&&!(s.payload instanceof ArrayBuffer)&&typeof s.payload.event=="string")return n(this._binaryEncodeUserBroadcastPush(s));let o=[s.join_ref,s.ref,s.topic,s.event,s.payload];return n(JSON.stringify(o))}_binaryEncodeUserBroadcastPush(s){var n;return this._isArrayBuffer((n=s.payload)===null||n===void 0?void 0:n.payload)?this._encodeBinaryUserBroadcastPush(s):this._encodeJsonUserBroadcastPush(s)}_encodeBinaryUserBroadcastPush(s){var n,o;const d=(o=(n=s.payload)===null||n===void 0?void 0:n.payload)!==null&&o!==void 0?o:new ArrayBuffer(0);return this._encodeUserBroadcastPush(s,this.BINARY_ENCODING,d)}_encodeJsonUserBroadcastPush(s){var n,o;const d=(o=(n=s.payload)===null||n===void 0?void 0:n.payload)!==null&&o!==void 0?o:{},f=new TextEncoder().encode(JSON.stringify(d)).buffer;return this._encodeUserBroadcastPush(s,this.JSON_ENCODING,f)}_encodeUserBroadcastPush(s,n,o){var d,h;const f=s.topic,b=(d=s.ref)!==null&&d!==void 0?d:"",g=(h=s.join_ref)!==null&&h!==void 0?h:"",p=s.payload.event,v=this.allowedMetadataKeys?this._pick(s.payload,this.allowedMetadataKeys):{},x=Object.keys(v).length===0?"":JSON.stringify(v);if(g.length>255)throw new Error(`joinRef length ${g.length} exceeds maximum of 255`);if(b.length>255)throw new Error(`ref length ${b.length} exceeds maximum of 255`);if(f.length>255)throw new Error(`topic length ${f.length} exceeds maximum of 255`);if(p.length>255)throw new Error(`userEvent length ${p.length} exceeds maximum of 255`);if(x.length>255)throw new Error(`metadata length ${x.length} exceeds maximum of 255`);const _=this.USER_BROADCAST_PUSH_META_LENGTH+g.length+b.length+f.length+p.length+x.length,j=new ArrayBuffer(this.HEADER_LENGTH+_);let C=new DataView(j),z=0;C.setUint8(z++,this.KINDS.userBroadcastPush),C.setUint8(z++,g.length),C.setUint8(z++,b.length),C.setUint8(z++,f.length),C.setUint8(z++,p.length),C.setUint8(z++,x.length),C.setUint8(z++,n),Array.from(g,E=>C.setUint8(z++,E.charCodeAt(0))),Array.from(b,E=>C.setUint8(z++,E.charCodeAt(0))),Array.from(f,E=>C.setUint8(z++,E.charCodeAt(0))),Array.from(p,E=>C.setUint8(z++,E.charCodeAt(0))),Array.from(x,E=>C.setUint8(z++,E.charCodeAt(0)));var M=new Uint8Array(j.byteLength+o.byteLength);return M.set(new Uint8Array(j),0),M.set(new Uint8Array(o),j.byteLength),M.buffer}decode(s,n){if(this._isArrayBuffer(s)){let o=this._binaryDecode(s);return n(o)}if(typeof s=="string"){const o=JSON.parse(s),[d,h,f,b,g]=o;return n({join_ref:d,ref:h,topic:f,event:b,payload:g})}return n({})}_binaryDecode(s){const n=new DataView(s),o=n.getUint8(0),d=new TextDecoder;switch(o){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(s,n,d)}}_decodeUserBroadcast(s,n,o){const d=n.getUint8(1),h=n.getUint8(2),f=n.getUint8(3),b=n.getUint8(4);let g=this.HEADER_LENGTH+4;const p=o.decode(s.slice(g,g+d));g=g+d;const v=o.decode(s.slice(g,g+h));g=g+h;const x=o.decode(s.slice(g,g+f));g=g+f;const _=s.slice(g,s.byteLength),j=b===this.JSON_ENCODING?JSON.parse(o.decode(_)):_,C={type:this.BROADCAST_EVENT,event:v,payload:j};return f>0&&(C.meta=JSON.parse(x)),{join_ref:null,ref:null,topic:p,event:this.BROADCAST_EVENT,payload:C}}_isArrayBuffer(s){var n;return s instanceof ArrayBuffer||((n=s==null?void 0:s.constructor)===null||n===void 0?void 0:n.name)==="ArrayBuffer"}_pick(s,n){return!s||typeof s!="object"?{}:Object.fromEntries(Object.entries(s).filter(([o])=>n.includes(o)))}}class fp{constructor(s,n){this.callback=s,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=s,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Nt;(function(l){l.abstime="abstime",l.bool="bool",l.date="date",l.daterange="daterange",l.float4="float4",l.float8="float8",l.int2="int2",l.int4="int4",l.int4range="int4range",l.int8="int8",l.int8range="int8range",l.json="json",l.jsonb="jsonb",l.money="money",l.numeric="numeric",l.oid="oid",l.reltime="reltime",l.text="text",l.time="time",l.timestamp="timestamp",l.timestamptz="timestamptz",l.timetz="timetz",l.tsrange="tsrange",l.tstzrange="tstzrange"})(Nt||(Nt={}));const $m=(l,s,n={})=>{var o;const d=(o=n.skipTypes)!==null&&o!==void 0?o:[];return s?Object.keys(s).reduce((h,f)=>(h[f]=bb(f,l,s,d),h),{}):{}},bb=(l,s,n,o)=>{const d=s.find(b=>b.name===l),h=d==null?void 0:d.type,f=n[l];return h&&!o.includes(h)?mp(h,f):Nu(f)},mp=(l,s)=>{if(l.charAt(0)==="_"){const n=l.slice(1,l.length);return wb(s,n)}switch(l){case Nt.bool:return xb(s);case Nt.float4:case Nt.float8:case Nt.int2:case Nt.int4:case Nt.int8:case Nt.numeric:case Nt.oid:return yb(s);case Nt.json:case Nt.jsonb:return vb(s);case Nt.timestamp:return jb(s);case Nt.abstime:case Nt.date:case Nt.daterange:case Nt.int4range:case Nt.int8range:case Nt.money:case Nt.reltime:case Nt.text:case Nt.time:case Nt.timestamptz:case Nt.timetz:case Nt.tsrange:case Nt.tstzrange:return Nu(s);default:return Nu(s)}},Nu=l=>l,xb=l=>{switch(l){case"t":return!0;case"f":return!1;default:return l}},yb=l=>{if(typeof l=="string"){const s=parseFloat(l);if(!Number.isNaN(s))return s}return l},vb=l=>{if(typeof l=="string")try{return JSON.parse(l)}catch{return l}return l},wb=(l,s)=>{if(typeof l!="string")return l;const n=l.length-1,o=l[n];if(l[0]==="{"&&o==="}"){let h;const f=l.slice(1,n);try{h=JSON.parse("["+f+"]")}catch{h=f?f.split(","):[]}return h.map(b=>mp(s,b))}return l},jb=l=>typeof l=="string"?l.replace(" ","T"):l,pp=l=>{const s=new URL(l);return s.protocol=s.protocol.replace(/^ws/i,"http"),s.pathname=s.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),s.pathname===""||s.pathname==="/"?s.pathname="/api/broadcast":s.pathname=s.pathname+"/api/broadcast",s.href};class du{constructor(s,n,o={},d=ju){this.channel=s,this.event=n,this.payload=o,this.timeout=d,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(s){this.timeout=s,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(s){this.payload=Object.assign(Object.assign({},this.payload),s)}receive(s,n){var o;return this._hasReceived(s)&&n((o=this.receivedResp)===null||o===void 0?void 0:o.response),this.recHooks.push({status:s,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const s=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},s),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(s,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:s,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:s,response:n}){this.recHooks.filter(o=>o.status===s).forEach(o=>o.callback(n))}_hasReceived(s){return this.receivedResp&&this.receivedResp.status===s}}var Im;(function(l){l.SYNC="sync",l.JOIN="join",l.LEAVE="leave"})(Im||(Im={}));class pi{constructor(s,n){this.channel=s,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const o=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(o.state,{},d=>{const{onJoin:h,onLeave:f,onSync:b}=this.caller;this.joinRef=this.channel._joinRef(),this.state=pi.syncState(this.state,d,h,f),this.pendingDiffs.forEach(g=>{this.state=pi.syncDiff(this.state,g,h,f)}),this.pendingDiffs=[],b()}),this.channel._on(o.diff,{},d=>{const{onJoin:h,onLeave:f,onSync:b}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(d):(this.state=pi.syncDiff(this.state,d,h,f),b())}),this.onJoin((d,h,f)=>{this.channel._trigger("presence",{event:"join",key:d,currentPresences:h,newPresences:f})}),this.onLeave((d,h,f)=>{this.channel._trigger("presence",{event:"leave",key:d,currentPresences:h,leftPresences:f})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(s,n,o,d){const h=this.cloneDeep(s),f=this.transformState(n),b={},g={};return this.map(h,(p,v)=>{f[p]||(g[p]=v)}),this.map(f,(p,v)=>{const x=h[p];if(x){const _=v.map(M=>M.presence_ref),j=x.map(M=>M.presence_ref),C=v.filter(M=>j.indexOf(M.presence_ref)<0),z=x.filter(M=>_.indexOf(M.presence_ref)<0);C.length>0&&(b[p]=C),z.length>0&&(g[p]=z)}else b[p]=v}),this.syncDiff(h,{joins:b,leaves:g},o,d)}static syncDiff(s,n,o,d){const{joins:h,leaves:f}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return o||(o=()=>{}),d||(d=()=>{}),this.map(h,(b,g)=>{var p;const v=(p=s[b])!==null&&p!==void 0?p:[];if(s[b]=this.cloneDeep(g),v.length>0){const x=s[b].map(j=>j.presence_ref),_=v.filter(j=>x.indexOf(j.presence_ref)<0);s[b].unshift(..._)}o(b,v,g)}),this.map(f,(b,g)=>{let p=s[b];if(!p)return;const v=g.map(x=>x.presence_ref);p=p.filter(x=>v.indexOf(x.presence_ref)<0),s[b]=p,d(b,p,g),p.length===0&&delete s[b]}),s}static map(s,n){return Object.getOwnPropertyNames(s).map(o=>n(o,s[o]))}static transformState(s){return s=this.cloneDeep(s),Object.getOwnPropertyNames(s).reduce((n,o)=>{const d=s[o];return"metas"in d?n[o]=d.metas.map(h=>(h.presence_ref=h.phx_ref,delete h.phx_ref,delete h.phx_ref_prev,h)):n[o]=d,n},{})}static cloneDeep(s){return JSON.parse(JSON.stringify(s))}onJoin(s){this.caller.onJoin=s}onLeave(s){this.caller.onLeave=s}onSync(s){this.caller.onSync=s}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var qm;(function(l){l.ALL="*",l.INSERT="INSERT",l.UPDATE="UPDATE",l.DELETE="DELETE"})(qm||(qm={}));var gi;(function(l){l.BROADCAST="broadcast",l.PRESENCE="presence",l.POSTGRES_CHANGES="postgres_changes",l.SYSTEM="system"})(gi||(gi={}));var As;(function(l){l.SUBSCRIBED="SUBSCRIBED",l.TIMED_OUT="TIMED_OUT",l.CLOSED="CLOSED",l.CHANNEL_ERROR="CHANNEL_ERROR"})(As||(As={}));class vn{constructor(s,n={config:{}},o){var d,h;if(this.topic=s,this.params=n,this.socket=o,this.bindings={},this.state=Xt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=s.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new du(this,es.join,this.params,this.timeout),this.rejoinTimer=new fp(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Xt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(f=>f.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Xt.closed,this.socket._remove(this)}),this._onError(f=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,f),this.state=Xt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Xt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",f=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,f),this.state=Xt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(es.reply,{},(f,b)=>{this._trigger(this._replyEventName(b),f)}),this.presence=new pi(this),this.broadcastEndpointURL=pp(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((h=(d=this.params.config)===null||d===void 0?void 0:d.broadcast)===null||h===void 0)&&h.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(s,n=this.timeout){var o,d,h;if(this.socket.isConnected()||this.socket.connect(),this.state==Xt.closed){const{config:{broadcast:f,presence:b,private:g}}=this.params,p=(d=(o=this.bindings.postgres_changes)===null||o===void 0?void 0:o.map(j=>j.filter))!==null&&d!==void 0?d:[],v=!!this.bindings[gi.PRESENCE]&&this.bindings[gi.PRESENCE].length>0||((h=this.params.config.presence)===null||h===void 0?void 0:h.enabled)===!0,x={},_={broadcast:f,presence:Object.assign(Object.assign({},b),{enabled:v}),postgres_changes:p,private:g};this.socket.accessTokenValue&&(x.access_token=this.socket.accessTokenValue),this._onError(j=>s==null?void 0:s(As.CHANNEL_ERROR,j)),this._onClose(()=>s==null?void 0:s(As.CLOSED)),this.updateJoinPayload(Object.assign({config:_},x)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:j})=>{var C;if(this.socket._isManualToken()||this.socket.setAuth(),j===void 0){s==null||s(As.SUBSCRIBED);return}else{const z=this.bindings.postgres_changes,M=(C=z==null?void 0:z.length)!==null&&C!==void 0?C:0,E=[];for(let O=0;O<M;O++){const N=z[O],{filter:{event:G,schema:fe,table:J,filter:oe}}=N,ge=j&&j[O];if(ge&&ge.event===G&&vn.isFilterValueEqual(ge.schema,fe)&&vn.isFilterValueEqual(ge.table,J)&&vn.isFilterValueEqual(ge.filter,oe))E.push(Object.assign(Object.assign({},N),{id:ge.id}));else{this.unsubscribe(),this.state=Xt.errored,s==null||s(As.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=E,s&&s(As.SUBSCRIBED);return}}).receive("error",j=>{this.state=Xt.errored,s==null||s(As.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(j).join(", ")||"error")))}).receive("timeout",()=>{s==null||s(As.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(s,n={}){return await this.send({type:"presence",event:"track",payload:s},n.timeout||this.timeout)}async untrack(s={}){return await this.send({type:"presence",event:"untrack"},s)}on(s,n,o){return this.state===Xt.joined&&s===gi.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(s,n,o)}async httpSend(s,n,o={}){var d;if(n==null)return Promise.reject("Payload is required for httpSend()");const h={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(h.Authorization=`Bearer ${this.socket.accessTokenValue}`);const f={method:"POST",headers:h,body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:n,private:this.private}]})},b=await this._fetchWithTimeout(this.broadcastEndpointURL,f,(d=o.timeout)!==null&&d!==void 0?d:this.timeout);if(b.status===202)return{success:!0};let g=b.statusText;try{const p=await b.json();g=p.error||p.message||g}catch{}return Promise.reject(new Error(g))}async send(s,n={}){var o,d;if(!this._canPush()&&s.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:h,payload:f}=s,b={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(b.Authorization=`Bearer ${this.socket.accessTokenValue}`);const g={method:"POST",headers:b,body:JSON.stringify({messages:[{topic:this.subTopic,event:h,payload:f,private:this.private}]})};try{const p=await this._fetchWithTimeout(this.broadcastEndpointURL,g,(o=n.timeout)!==null&&o!==void 0?o:this.timeout);return await((d=p.body)===null||d===void 0?void 0:d.cancel()),p.ok?"ok":"error"}catch(p){return p.name==="AbortError"?"timed out":"error"}}else return new Promise(h=>{var f,b,g;const p=this._push(s.type,s,n.timeout||this.timeout);s.type==="broadcast"&&!(!((g=(b=(f=this.params)===null||f===void 0?void 0:f.config)===null||b===void 0?void 0:b.broadcast)===null||g===void 0)&&g.ack)&&h("ok"),p.receive("ok",()=>h("ok")),p.receive("error",()=>h("error")),p.receive("timeout",()=>h("timed out"))})}updateJoinPayload(s){this.joinPush.updatePayload(s)}unsubscribe(s=this.timeout){this.state=Xt.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(es.close,"leave",this._joinRef())};this.joinPush.destroy();let o=null;return new Promise(d=>{o=new du(this,es.leave,{},s),o.receive("ok",()=>{n(),d("ok")}).receive("timeout",()=>{n(),d("timed out")}).receive("error",()=>{d("error")}),o.send(),this._canPush()||o.trigger("ok",{})}).finally(()=>{o==null||o.destroy()})}teardown(){this.pushBuffer.forEach(s=>s.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Xt.closed,this.bindings={}}async _fetchWithTimeout(s,n,o){const d=new AbortController,h=setTimeout(()=>d.abort(),o),f=await this.socket.fetch(s,Object.assign(Object.assign({},n),{signal:d.signal}));return clearTimeout(h),f}_push(s,n,o=this.timeout){if(!this.joinedOnce)throw`tried to push '${s}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let d=new du(this,s,n,o);return this._canPush()?d.send():this._addToPushBuffer(d),d}_addToPushBuffer(s){if(s.startTimeout(),this.pushBuffer.push(s),this.pushBuffer.length>pb){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(s,n,o){return n}_isMember(s){return this.topic===s}_joinRef(){return this.joinPush.ref}_trigger(s,n,o){var d,h;const f=s.toLocaleLowerCase(),{close:b,error:g,leave:p,join:v}=es;if(o&&[b,g,p,v].indexOf(f)>=0&&o!==this._joinRef())return;let _=this._onMessage(f,n,o);if(n&&!_)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(f)?(d=this.bindings.postgres_changes)===null||d===void 0||d.filter(j=>{var C,z,M;return((C=j.filter)===null||C===void 0?void 0:C.event)==="*"||((M=(z=j.filter)===null||z===void 0?void 0:z.event)===null||M===void 0?void 0:M.toLocaleLowerCase())===f}).map(j=>j.callback(_,o)):(h=this.bindings[f])===null||h===void 0||h.filter(j=>{var C,z,M,E,O,N;if(["broadcast","presence","postgres_changes"].includes(f))if("id"in j){const G=j.id,fe=(C=j.filter)===null||C===void 0?void 0:C.event;return G&&((z=n.ids)===null||z===void 0?void 0:z.includes(G))&&(fe==="*"||(fe==null?void 0:fe.toLocaleLowerCase())===((M=n.data)===null||M===void 0?void 0:M.type.toLocaleLowerCase()))}else{const G=(O=(E=j==null?void 0:j.filter)===null||E===void 0?void 0:E.event)===null||O===void 0?void 0:O.toLocaleLowerCase();return G==="*"||G===((N=n==null?void 0:n.event)===null||N===void 0?void 0:N.toLocaleLowerCase())}else return j.type.toLocaleLowerCase()===f}).map(j=>{if(typeof _=="object"&&"ids"in _){const C=_.data,{schema:z,table:M,commit_timestamp:E,type:O,errors:N}=C;_=Object.assign(Object.assign({},{schema:z,table:M,commit_timestamp:E,eventType:O,new:{},old:{},errors:N}),this._getPayloadRecords(C))}j.callback(_,o)})}_isClosed(){return this.state===Xt.closed}_isJoined(){return this.state===Xt.joined}_isJoining(){return this.state===Xt.joining}_isLeaving(){return this.state===Xt.leaving}_replyEventName(s){return`chan_reply_${s}`}_on(s,n,o){const d=s.toLocaleLowerCase(),h={type:d,filter:n,callback:o};return this.bindings[d]?this.bindings[d].push(h):this.bindings[d]=[h],this}_off(s,n){const o=s.toLocaleLowerCase();return this.bindings[o]&&(this.bindings[o]=this.bindings[o].filter(d=>{var h;return!(((h=d.type)===null||h===void 0?void 0:h.toLocaleLowerCase())===o&&vn.isEqual(d.filter,n))})),this}static isEqual(s,n){if(Object.keys(s).length!==Object.keys(n).length)return!1;for(const o in s)if(s[o]!==n[o])return!1;return!0}static isFilterValueEqual(s,n){return(s??void 0)===(n??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(s){this._on(es.close,{},s)}_onError(s){this._on(es.error,{},n=>s(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(s=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Xt.joining,this.joinPush.resend(s))}_getPayloadRecords(s){const n={new:{},old:{}};return(s.type==="INSERT"||s.type==="UPDATE")&&(n.new=$m(s.columns,s.record)),(s.type==="UPDATE"||s.type==="DELETE")&&(n.old=$m(s.columns,s.old_record)),n}}const hu=()=>{},Hl={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},_b=[1e3,2e3,5e3,1e4],Nb=1e4,Sb=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Eb{constructor(s,n){var o;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=ju,this.transport=null,this.heartbeatIntervalMs=Hl.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=hu,this.ref=0,this.reconnectTimer=null,this.vsn=Hm,this.logger=hu,this.conn=null,this.sendBuffer=[],this.serializer=new gb,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=d=>d?(...h)=>d(...h):(...h)=>fetch(...h),!(!((o=n==null?void 0:n.params)===null||o===void 0)&&o.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${s}/${_u.websocket}`,this.httpEndpoint=pp(s),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=ub.createWebSocket(this.endpointURL())}catch(s){this._setConnectionState("disconnected");const n=s.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(s,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const o=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(o),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(s?this.conn.close(s,n??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(s){const n=await s.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const s=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),s}log(s,n,o){this.logger(s,n,o)}connectionState(){switch(this.conn&&this.conn.readyState){case tr.connecting:return _r.Connecting;case tr.open:return _r.Open;case tr.closing:return _r.Closing;default:return _r.Closed}}isConnected(){return this.connectionState()===_r.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(s,n={config:{}}){const o=`realtime:${s}`,d=this.getChannels().find(h=>h.topic===o);if(d)return d;{const h=new vn(`realtime:${s}`,n,this);return this.channels.push(h),h}}push(s){const{topic:n,event:o,payload:d,ref:h}=s,f=()=>{this.encode(s,b=>{var g;(g=this.conn)===null||g===void 0||g.send(b)})};this.log("push",`${n} ${o} (${h})`,d),this.isConnected()?f():this.sendBuffer.push(f)}async setAuth(s=null){this._authPromise=this._performAuth(s);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var s;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(s=this.conn)===null||s===void 0||s.close(mb,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},Hl.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(s){this.heartbeatCallback=s}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(s=>s()),this.sendBuffer=[])}_makeRef(){let s=this.ref+1;return s===this.ref?this.ref=0:this.ref=s,this.ref.toString()}_leaveOpenTopic(s){let n=this.channels.find(o=>o.topic===s&&(o._isJoined()||o._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${s}"`),n.unsubscribe())}_remove(s){this.channels=this.channels.filter(n=>n.topic!==s.topic)}_onConnMessage(s){this.decode(s.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(p){this.log("error","error in heartbeat callback",p)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:o,event:d,payload:h,ref:f}=n,b=f?`(${f})`:"",g=h.status||"";this.log("receive",`${g} ${o} ${d} ${b}`.trim(),h),this.channels.filter(p=>p._isMember(o)).forEach(p=>p._trigger(d,h,f)),this._triggerStateCallbacks("message",n)})}_clearTimer(s){var n;s==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):s==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=s=>this._onConnError(s),this.conn.onmessage=s=>this._onConnMessage(s),this.conn.onclose=s=>this._onConnClose(s),this.conn.readyState===tr.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===tr.open||this.conn.readyState===tr.connecting)try{this.conn.close()}catch(s){this.log("error","Error closing connection",s)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(s=>s.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(n=>{this.log("error","error waiting for auth on connect",n),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const s=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(s),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this._terminateWorker()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(s){var n;this._setConnectionState("disconnected"),this.log("transport","close",s),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",s)}_onConnError(s){this._setConnectionState("disconnected"),this.log("transport",`${s}`),this._triggerChanError(),this._triggerStateCallbacks("error",s)}_triggerChanError(){this.channels.forEach(s=>s._trigger(es.error))}_appendParams(s,n){if(Object.keys(n).length===0)return s;const o=s.match(/\?/)?"&":"?",d=new URLSearchParams(n);return`${s}${o}${d}`}_workerObjectUrl(s){let n;if(s)n=s;else{const o=new Blob([Sb],{type:"application/javascript"});n=URL.createObjectURL(o)}return n}_setConnectionState(s,n=!1){this._connectionState=s,s==="connecting"?this._wasManualDisconnect=!1:s==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(s=null){let n,o=!1;if(s)n=s,o=!0;else if(this.accessToken)try{n=await this.accessToken()}catch(d){this.log("error","Error fetching access token from callback",d),n=this.accessTokenValue}else n=this.accessTokenValue;o?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(d=>{const h={access_token:n,version:hb};n&&d.updateJoinPayload(h),d.joinedOnce&&d._isJoined()&&d._push(es.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(s="general"){this._isManualToken()||this.setAuth().catch(n=>{this.log("error",`Error setting auth in ${s}`,n)})}_triggerStateCallbacks(s,n){try{this.stateChangeCallbacks[s].forEach(o=>{try{o(n)}catch(d){this.log("error",`error in ${s} callback`,d)}})}catch(o){this.log("error",`error triggering ${s} callbacks`,o)}}_setupReconnectionTimer(){this.reconnectTimer=new fp(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Hl.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(s){var n,o,d,h,f,b,g,p,v,x,_,j;switch(this.transport=(n=s==null?void 0:s.transport)!==null&&n!==void 0?n:null,this.timeout=(o=s==null?void 0:s.timeout)!==null&&o!==void 0?o:ju,this.heartbeatIntervalMs=(d=s==null?void 0:s.heartbeatIntervalMs)!==null&&d!==void 0?d:Hl.HEARTBEAT_INTERVAL,this.worker=(h=s==null?void 0:s.worker)!==null&&h!==void 0?h:!1,this.accessToken=(f=s==null?void 0:s.accessToken)!==null&&f!==void 0?f:null,this.heartbeatCallback=(b=s==null?void 0:s.heartbeatCallback)!==null&&b!==void 0?b:hu,this.vsn=(g=s==null?void 0:s.vsn)!==null&&g!==void 0?g:Hm,s!=null&&s.params&&(this.params=s.params),s!=null&&s.logger&&(this.logger=s.logger),(s!=null&&s.logLevel||s!=null&&s.log_level)&&(this.logLevel=s.logLevel||s.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(p=s==null?void 0:s.reconnectAfterMs)!==null&&p!==void 0?p:(C=>_b[C-1]||Nb),this.vsn){case hp:this.encode=(v=s==null?void 0:s.encode)!==null&&v!==void 0?v:((C,z)=>z(JSON.stringify(C))),this.decode=(x=s==null?void 0:s.decode)!==null&&x!==void 0?x:((C,z)=>z(JSON.parse(C)));break;case fb:this.encode=(_=s==null?void 0:s.encode)!==null&&_!==void 0?_:this.serializer.encode.bind(this.serializer),this.decode=(j=s==null?void 0:s.decode)!==null&&j!==void 0?j:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=s==null?void 0:s.workerUrl}}}var bi=class extends Error{constructor(l,s){var n;super(l),this.name="IcebergError",this.status=s.status,this.icebergType=s.icebergType,this.icebergCode=s.icebergCode,this.details=s.details,this.isCommitStateUnknown=s.icebergType==="CommitStateUnknownException"||[500,502,504].includes(s.status)&&((n=s.icebergType)==null?void 0:n.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function Tb(l,s,n){const o=new URL(s,l);if(n)for(const[d,h]of Object.entries(n))h!==void 0&&o.searchParams.set(d,h);return o.toString()}async function Ab(l){return!l||l.type==="none"?{}:l.type==="bearer"?{Authorization:`Bearer ${l.token}`}:l.type==="header"?{[l.name]:l.value}:l.type==="custom"?await l.getHeaders():{}}function kb(l){const s=l.fetchImpl??globalThis.fetch;return{async request({method:n,path:o,query:d,body:h,headers:f}){const b=Tb(l.baseUrl,o,d),g=await Ab(l.auth),p=await s(b,{method:n,headers:{...h?{"Content-Type":"application/json"}:{},...g,...f},body:h?JSON.stringify(h):void 0}),v=await p.text(),x=(p.headers.get("content-type")||"").includes("application/json"),_=x&&v?JSON.parse(v):v;if(!p.ok){const j=x?_:void 0,C=j==null?void 0:j.error;throw new bi((C==null?void 0:C.message)??`Request failed with status ${p.status}`,{status:p.status,icebergType:C==null?void 0:C.type,icebergCode:C==null?void 0:C.code,details:j})}return{status:p.status,headers:p.headers,data:_}}}}function $l(l){return l.join("")}var Ob=class{constructor(l,s=""){this.client=l,this.prefix=s}async listNamespaces(l){const s=l?{parent:$l(l.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:s})).data.namespaces.map(o=>({namespace:o}))}async createNamespace(l,s){const n={namespace:l.namespace,properties:s==null?void 0:s.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:n})).data}async dropNamespace(l){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${$l(l.namespace)}`})}async loadNamespaceMetadata(l){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${$l(l.namespace)}`})).data.properties}}async namespaceExists(l){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${$l(l.namespace)}`}),!0}catch(s){if(s instanceof bi&&s.status===404)return!1;throw s}}async createNamespaceIfNotExists(l,s){try{return await this.createNamespace(l,s)}catch(n){if(n instanceof bi&&n.status===409)return;throw n}}};function un(l){return l.join("")}var Cb=class{constructor(l,s="",n){this.client=l,this.prefix=s,this.accessDelegation=n}async listTables(l){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${un(l.namespace)}/tables`})).data.identifiers}async createTable(l,s){const n={};return this.accessDelegation&&(n["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${un(l.namespace)}/tables`,body:s,headers:n})).data.metadata}async updateTable(l,s){const n=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${un(l.namespace)}/tables/${l.name}`,body:s});return{"metadata-location":n.data["metadata-location"],metadata:n.data.metadata}}async dropTable(l,s){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${un(l.namespace)}/tables/${l.name}`,query:{purgeRequested:String((s==null?void 0:s.purge)??!1)}})}async loadTable(l){const s={};return this.accessDelegation&&(s["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${un(l.namespace)}/tables/${l.name}`,headers:s})).data.metadata}async tableExists(l){const s={};this.accessDelegation&&(s["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${un(l.namespace)}/tables/${l.name}`,headers:s}),!0}catch(n){if(n instanceof bi&&n.status===404)return!1;throw n}}async createTableIfNotExists(l,s){try{return await this.createTable(l,s)}catch(n){if(n instanceof bi&&n.status===409)return await this.loadTable({namespace:l.namespace,name:s.name});throw n}}},Rb=class{constructor(l){var o;let s="v1";l.catalogName&&(s+=`/${l.catalogName}`);const n=l.baseUrl.endsWith("/")?l.baseUrl:`${l.baseUrl}/`;this.client=kb({baseUrl:n,auth:l.auth,fetchImpl:l.fetch}),this.accessDelegation=(o=l.accessDelegation)==null?void 0:o.join(","),this.namespaceOps=new Ob(this.client,s),this.tableOps=new Cb(this.client,s,this.accessDelegation)}async listNamespaces(l){return this.namespaceOps.listNamespaces(l)}async createNamespace(l,s){return this.namespaceOps.createNamespace(l,s)}async dropNamespace(l){await this.namespaceOps.dropNamespace(l)}async loadNamespaceMetadata(l){return this.namespaceOps.loadNamespaceMetadata(l)}async listTables(l){return this.tableOps.listTables(l)}async createTable(l,s){return this.tableOps.createTable(l,s)}async updateTable(l,s){return this.tableOps.updateTable(l,s)}async dropTable(l,s){await this.tableOps.dropTable(l,s)}async loadTable(l){return this.tableOps.loadTable(l)}async namespaceExists(l){return this.namespaceOps.namespaceExists(l)}async tableExists(l){return this.tableOps.tableExists(l)}async createNamespaceIfNotExists(l,s){return this.namespaceOps.createNamespaceIfNotExists(l,s)}async createTableIfNotExists(l,s){return this.tableOps.createTableIfNotExists(l,s)}},Ql=class extends Error{constructor(l){super(l),this.__isStorageError=!0,this.name="StorageError"}};function Ct(l){return typeof l=="object"&&l!==null&&"__isStorageError"in l}var zb=class extends Ql{constructor(l,s,n){super(l),this.name="StorageApiError",this.status=s,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Su=class extends Ql{constructor(l,s){super(l),this.name="StorageUnknownError",this.originalError=s}};const Mu=l=>l?(...s)=>l(...s):(...s)=>fetch(...s),Mb=()=>Response,Eu=l=>{if(Array.isArray(l))return l.map(n=>Eu(n));if(typeof l=="function"||l!==Object(l))return l;const s={};return Object.entries(l).forEach(([n,o])=>{const d=n.replace(/([-_][a-z])/gi,h=>h.toUpperCase().replace(/[-_]/g,""));s[d]=Eu(o)}),s},Db=l=>{if(typeof l!="object"||l===null)return!1;const s=Object.getPrototypeOf(l);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(Symbol.toStringTag in l)&&!(Symbol.iterator in l)},Ub=l=>!l||typeof l!="string"||l.length===0||l.length>100||l.trim()!==l||l.includes("/")||l.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(l);function xi(l){"@babel/helpers - typeof";return xi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},xi(l)}function Lb(l,s){if(xi(l)!="object"||!l)return l;var n=l[Symbol.toPrimitive];if(n!==void 0){var o=n.call(l,s);if(xi(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(l)}function Bb(l){var s=Lb(l,"string");return xi(s)=="symbol"?s:s+""}function Hb(l,s,n){return(s=Bb(s))in l?Object.defineProperty(l,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):l[s]=n,l}function Pm(l,s){var n=Object.keys(l);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(l);s&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(l,d).enumerable})),n.push.apply(n,o)}return n}function De(l){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?Pm(Object(n),!0).forEach(function(o){Hb(l,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(n)):Pm(Object(n)).forEach(function(o){Object.defineProperty(l,o,Object.getOwnPropertyDescriptor(n,o))})}return l}const fu=l=>{var s;return l.msg||l.message||l.error_description||(typeof l.error=="string"?l.error:(s=l.error)===null||s===void 0?void 0:s.message)||JSON.stringify(l)},$b=async(l,s,n)=>{l instanceof await Mb()&&!(n!=null&&n.noResolveJson)?l.json().then(o=>{const d=l.status||500,h=(o==null?void 0:o.statusCode)||d+"";s(new zb(fu(o),d,h))}).catch(o=>{s(new Su(fu(o),o))}):s(new Su(fu(l),l))},Ib=(l,s,n,o)=>{const d={method:l,headers:(s==null?void 0:s.headers)||{}};return l==="GET"||!o?d:(Db(o)?(d.headers=De({"Content-Type":"application/json"},s==null?void 0:s.headers),d.body=JSON.stringify(o)):d.body=o,s!=null&&s.duplex&&(d.duplex=s.duplex),De(De({},d),n))};async function Ni(l,s,n,o,d,h){return new Promise((f,b)=>{l(n,Ib(s,o,d,h)).then(g=>{if(!g.ok)throw g;return o!=null&&o.noResolveJson?g:g.json()}).then(g=>f(g)).catch(g=>$b(g,b,o))})}async function yi(l,s,n,o){return Ni(l,"GET",s,n,o)}async function Fa(l,s,n,o,d){return Ni(l,"POST",s,o,d,n)}async function Tu(l,s,n,o,d){return Ni(l,"PUT",s,o,d,n)}async function qb(l,s,n,o){return Ni(l,"HEAD",s,De(De({},n),{},{noResolveJson:!0}),o)}async function Du(l,s,n,o,d){return Ni(l,"DELETE",s,o,d,n)}var Pb=class{constructor(l,s){this.downloadFn=l,this.shouldThrowOnError=s}then(l,s){return this.execute().then(l,s)}async execute(){var l=this;try{return{data:(await l.downloadFn()).body,error:null}}catch(s){if(l.shouldThrowOnError)throw s;if(Ct(s))return{data:null,error:s};throw s}}};let gp;gp=Symbol.toStringTag;var Gb=class{constructor(l,s){this.downloadFn=l,this.shouldThrowOnError=s,this[gp]="BlobDownloadBuilder",this.promise=null}asStream(){return new Pb(this.downloadFn,this.shouldThrowOnError)}then(l,s){return this.getPromise().then(l,s)}catch(l){return this.getPromise().catch(l)}finally(l){return this.getPromise().finally(l)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var l=this;try{return{data:await(await l.downloadFn()).blob(),error:null}}catch(s){if(l.shouldThrowOnError)throw s;if(Ct(s))return{data:null,error:s};throw s}}};const Yb={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Gm={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var Kb=class{constructor(l,s={},n,o){this.shouldThrowOnError=!1,this.url=l,this.headers=s,this.bucketId=n,this.fetch=Mu(o)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(l,s,n,o){var d=this;try{let h;const f=De(De({},Gm),o);let b=De(De({},d.headers),l==="POST"&&{"x-upsert":String(f.upsert)});const g=f.metadata;typeof Blob<"u"&&n instanceof Blob?(h=new FormData,h.append("cacheControl",f.cacheControl),g&&h.append("metadata",d.encodeMetadata(g)),h.append("",n)):typeof FormData<"u"&&n instanceof FormData?(h=n,h.has("cacheControl")||h.append("cacheControl",f.cacheControl),g&&!h.has("metadata")&&h.append("metadata",d.encodeMetadata(g))):(h=n,b["cache-control"]=`max-age=${f.cacheControl}`,b["content-type"]=f.contentType,g&&(b["x-metadata"]=d.toBase64(d.encodeMetadata(g))),(typeof ReadableStream<"u"&&h instanceof ReadableStream||h&&typeof h=="object"&&"pipe"in h&&typeof h.pipe=="function")&&!f.duplex&&(f.duplex="half")),o!=null&&o.headers&&(b=De(De({},b),o.headers));const p=d._removeEmptyFolders(s),v=d._getFinalPath(p),x=await(l=="PUT"?Tu:Fa)(d.fetch,`${d.url}/object/${v}`,h,De({headers:b},f!=null&&f.duplex?{duplex:f.duplex}:{}));return{data:{path:p,id:x.Id,fullPath:x.Key},error:null}}catch(h){if(d.shouldThrowOnError)throw h;if(Ct(h))return{data:null,error:h};throw h}}async upload(l,s,n){return this.uploadOrUpdate("POST",l,s,n)}async uploadToSignedUrl(l,s,n,o){var d=this;const h=d._removeEmptyFolders(l),f=d._getFinalPath(h),b=new URL(d.url+`/object/upload/sign/${f}`);b.searchParams.set("token",s);try{let g;const p=De({upsert:Gm.upsert},o),v=De(De({},d.headers),{"x-upsert":String(p.upsert)});return typeof Blob<"u"&&n instanceof Blob?(g=new FormData,g.append("cacheControl",p.cacheControl),g.append("",n)):typeof FormData<"u"&&n instanceof FormData?(g=n,g.append("cacheControl",p.cacheControl)):(g=n,v["cache-control"]=`max-age=${p.cacheControl}`,v["content-type"]=p.contentType),{data:{path:h,fullPath:(await Tu(d.fetch,b.toString(),g,{headers:v})).Key},error:null}}catch(g){if(d.shouldThrowOnError)throw g;if(Ct(g))return{data:null,error:g};throw g}}async createSignedUploadUrl(l,s){var n=this;try{let o=n._getFinalPath(l);const d=De({},n.headers);s!=null&&s.upsert&&(d["x-upsert"]="true");const h=await Fa(n.fetch,`${n.url}/object/upload/sign/${o}`,{},{headers:d}),f=new URL(n.url+h.url),b=f.searchParams.get("token");if(!b)throw new Ql("No token returned by API");return{data:{signedUrl:f.toString(),path:l,token:b},error:null}}catch(o){if(n.shouldThrowOnError)throw o;if(Ct(o))return{data:null,error:o};throw o}}async update(l,s,n){return this.uploadOrUpdate("PUT",l,s,n)}async move(l,s,n){var o=this;try{return{data:await Fa(o.fetch,`${o.url}/object/move`,{bucketId:o.bucketId,sourceKey:l,destinationKey:s,destinationBucket:n==null?void 0:n.destinationBucket},{headers:o.headers}),error:null}}catch(d){if(o.shouldThrowOnError)throw d;if(Ct(d))return{data:null,error:d};throw d}}async copy(l,s,n){var o=this;try{return{data:{path:(await Fa(o.fetch,`${o.url}/object/copy`,{bucketId:o.bucketId,sourceKey:l,destinationKey:s,destinationBucket:n==null?void 0:n.destinationBucket},{headers:o.headers})).Key},error:null}}catch(d){if(o.shouldThrowOnError)throw d;if(Ct(d))return{data:null,error:d};throw d}}async createSignedUrl(l,s,n){var o=this;try{let d=o._getFinalPath(l),h=await Fa(o.fetch,`${o.url}/object/sign/${d}`,De({expiresIn:s},n!=null&&n.transform?{transform:n.transform}:{}),{headers:o.headers});const f=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return h={signedUrl:encodeURI(`${o.url}${h.signedURL}${f}`)},{data:h,error:null}}catch(d){if(o.shouldThrowOnError)throw d;if(Ct(d))return{data:null,error:d};throw d}}async createSignedUrls(l,s,n){var o=this;try{const d=await Fa(o.fetch,`${o.url}/object/sign/${o.bucketId}`,{expiresIn:s,paths:l},{headers:o.headers}),h=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:d.map(f=>De(De({},f),{},{signedUrl:f.signedURL?encodeURI(`${o.url}${f.signedURL}${h}`):null})),error:null}}catch(d){if(o.shouldThrowOnError)throw d;if(Ct(d))return{data:null,error:d};throw d}}download(l,s){const n=typeof(s==null?void 0:s.transform)<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString((s==null?void 0:s.transform)||{}),d=o?`?${o}`:"",h=this._getFinalPath(l),f=()=>yi(this.fetch,`${this.url}/${n}/${h}${d}`,{headers:this.headers,noResolveJson:!0});return new Gb(f,this.shouldThrowOnError)}async info(l){var s=this;const n=s._getFinalPath(l);try{return{data:Eu(await yi(s.fetch,`${s.url}/object/info/${n}`,{headers:s.headers})),error:null}}catch(o){if(s.shouldThrowOnError)throw o;if(Ct(o))return{data:null,error:o};throw o}}async exists(l){var s=this;const n=s._getFinalPath(l);try{return await qb(s.fetch,`${s.url}/object/${n}`,{headers:s.headers}),{data:!0,error:null}}catch(o){if(s.shouldThrowOnError)throw o;if(Ct(o)&&o instanceof Su){const d=o.originalError;if([400,404].includes(d==null?void 0:d.status))return{data:!1,error:o}}throw o}}getPublicUrl(l,s){const n=this._getFinalPath(l),o=[],d=s!=null&&s.download?`download=${s.download===!0?"":s.download}`:"";d!==""&&o.push(d);const h=typeof(s==null?void 0:s.transform)<"u"?"render/image":"object",f=this.transformOptsToQueryString((s==null?void 0:s.transform)||{});f!==""&&o.push(f);let b=o.join("&");return b!==""&&(b=`?${b}`),{data:{publicUrl:encodeURI(`${this.url}/${h}/public/${n}${b}`)}}}async remove(l){var s=this;try{return{data:await Du(s.fetch,`${s.url}/object/${s.bucketId}`,{prefixes:l},{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Ct(n))return{data:null,error:n};throw n}}async list(l,s,n){var o=this;try{const d=De(De(De({},Yb),s),{},{prefix:l||""});return{data:await Fa(o.fetch,`${o.url}/object/list/${o.bucketId}`,d,{headers:o.headers},n),error:null}}catch(d){if(o.shouldThrowOnError)throw d;if(Ct(d))return{data:null,error:d};throw d}}async listV2(l,s){var n=this;try{const o=De({},l);return{data:await Fa(n.fetch,`${n.url}/object/list-v2/${n.bucketId}`,o,{headers:n.headers},s),error:null}}catch(o){if(n.shouldThrowOnError)throw o;if(Ct(o))return{data:null,error:o};throw o}}encodeMetadata(l){return JSON.stringify(l)}toBase64(l){return typeof Buffer<"u"?Buffer.from(l).toString("base64"):btoa(l)}_getFinalPath(l){return`${this.bucketId}/${l.replace(/^\/+/,"")}`}_removeEmptyFolders(l){return l.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(l){const s=[];return l.width&&s.push(`width=${l.width}`),l.height&&s.push(`height=${l.height}`),l.resize&&s.push(`resize=${l.resize}`),l.format&&s.push(`format=${l.format}`),l.quality&&s.push(`quality=${l.quality}`),s.join("&")}};const bp="2.89.0",xp={"X-Client-Info":`storage-js/${bp}`};var Vb=class{constructor(l,s={},n,o){this.shouldThrowOnError=!1;const d=new URL(l);o!=null&&o.useNewHostname&&/supabase\.(co|in|red)$/.test(d.hostname)&&!d.hostname.includes("storage.supabase.")&&(d.hostname=d.hostname.replace("supabase.","storage.supabase.")),this.url=d.href.replace(/\/$/,""),this.headers=De(De({},xp),s),this.fetch=Mu(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(l){var s=this;try{const n=s.listBucketOptionsToQueryString(l);return{data:await yi(s.fetch,`${s.url}/bucket${n}`,{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Ct(n))return{data:null,error:n};throw n}}async getBucket(l){var s=this;try{return{data:await yi(s.fetch,`${s.url}/bucket/${l}`,{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Ct(n))return{data:null,error:n};throw n}}async createBucket(l,s={public:!1}){var n=this;try{return{data:await Fa(n.fetch,`${n.url}/bucket`,{id:l,name:l,type:s.type,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:n.headers}),error:null}}catch(o){if(n.shouldThrowOnError)throw o;if(Ct(o))return{data:null,error:o};throw o}}async updateBucket(l,s){var n=this;try{return{data:await Tu(n.fetch,`${n.url}/bucket/${l}`,{id:l,name:l,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:n.headers}),error:null}}catch(o){if(n.shouldThrowOnError)throw o;if(Ct(o))return{data:null,error:o};throw o}}async emptyBucket(l){var s=this;try{return{data:await Fa(s.fetch,`${s.url}/bucket/${l}/empty`,{},{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Ct(n))return{data:null,error:n};throw n}}async deleteBucket(l){var s=this;try{return{data:await Du(s.fetch,`${s.url}/bucket/${l}`,{},{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Ct(n))return{data:null,error:n};throw n}}listBucketOptionsToQueryString(l){const s={};return l&&("limit"in l&&(s.limit=String(l.limit)),"offset"in l&&(s.offset=String(l.offset)),l.search&&(s.search=l.search),l.sortColumn&&(s.sortColumn=l.sortColumn),l.sortOrder&&(s.sortOrder=l.sortOrder)),Object.keys(s).length>0?"?"+new URLSearchParams(s).toString():""}},Qb=class{constructor(l,s={},n){this.shouldThrowOnError=!1,this.url=l.replace(/\/$/,""),this.headers=De(De({},xp),s),this.fetch=Mu(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(l){var s=this;try{return{data:await Fa(s.fetch,`${s.url}/bucket`,{name:l},{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Ct(n))return{data:null,error:n};throw n}}async listBuckets(l){var s=this;try{const n=new URLSearchParams;(l==null?void 0:l.limit)!==void 0&&n.set("limit",l.limit.toString()),(l==null?void 0:l.offset)!==void 0&&n.set("offset",l.offset.toString()),l!=null&&l.sortColumn&&n.set("sortColumn",l.sortColumn),l!=null&&l.sortOrder&&n.set("sortOrder",l.sortOrder),l!=null&&l.search&&n.set("search",l.search);const o=n.toString(),d=o?`${s.url}/bucket?${o}`:`${s.url}/bucket`;return{data:await yi(s.fetch,d,{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Ct(n))return{data:null,error:n};throw n}}async deleteBucket(l){var s=this;try{return{data:await Du(s.fetch,`${s.url}/bucket/${l}`,{},{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Ct(n))return{data:null,error:n};throw n}}from(l){var s=this;if(!Ub(l))throw new Ql("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const n=new Rb({baseUrl:this.url,catalogName:l,auth:{type:"custom",getHeaders:async()=>s.headers},fetch:this.fetch}),o=this.shouldThrowOnError;return new Proxy(n,{get(d,h){const f=d[h];return typeof f!="function"?f:async(...b)=>{try{return{data:await f.apply(d,b),error:null}}catch(g){if(o)throw g;return{data:null,error:g}}}}})}};const Uu={"X-Client-Info":`storage-js/${bp}`,"Content-Type":"application/json"};var yp=class extends Error{constructor(l){super(l),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Oa(l){return typeof l=="object"&&l!==null&&"__isStorageVectorsError"in l}var mu=class extends yp{constructor(l,s,n){super(l),this.name="StorageVectorsApiError",this.status=s,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Zb=class extends yp{constructor(l,s){super(l),this.name="StorageVectorsUnknownError",this.originalError=s}};const Lu=l=>l?(...s)=>l(...s):(...s)=>fetch(...s),Jb=l=>{if(typeof l!="object"||l===null)return!1;const s=Object.getPrototypeOf(l);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(Symbol.toStringTag in l)&&!(Symbol.iterator in l)},Ym=l=>l.msg||l.message||l.error_description||l.error||JSON.stringify(l),Xb=async(l,s,n)=>{if(l&&typeof l=="object"&&"status"in l&&"ok"in l&&typeof l.status=="number"&&!(n!=null&&n.noResolveJson)){const o=l.status||500,d=l;if(typeof d.json=="function")d.json().then(h=>{const f=(h==null?void 0:h.statusCode)||(h==null?void 0:h.code)||o+"";s(new mu(Ym(h),o,f))}).catch(()=>{const h=o+"";s(new mu(d.statusText||`HTTP ${o} error`,o,h))});else{const h=o+"";s(new mu(d.statusText||`HTTP ${o} error`,o,h))}}else s(new Zb(Ym(l),l))},Wb=(l,s,n,o)=>{const d={method:l,headers:(s==null?void 0:s.headers)||{}};return o?(Jb(o)?(d.headers=De({"Content-Type":"application/json"},s==null?void 0:s.headers),d.body=JSON.stringify(o)):d.body=o,De(De({},d),n)):d};async function Fb(l,s,n,o,d,h){return new Promise((f,b)=>{l(n,Wb(s,o,d,h)).then(g=>{if(!g.ok)throw g;if(o!=null&&o.noResolveJson)return g;const p=g.headers.get("content-type");return!p||!p.includes("application/json")?{}:g.json()}).then(g=>f(g)).catch(g=>Xb(g,b,o))})}async function Ca(l,s,n,o,d){return Fb(l,"POST",s,o,d,n)}var ex=class{constructor(l,s={},n){this.shouldThrowOnError=!1,this.url=l.replace(/\/$/,""),this.headers=De(De({},Uu),s),this.fetch=Lu(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(l){var s=this;try{return{data:await Ca(s.fetch,`${s.url}/CreateIndex`,l,{headers:s.headers})||{},error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Oa(n))return{data:null,error:n};throw n}}async getIndex(l,s){var n=this;try{return{data:await Ca(n.fetch,`${n.url}/GetIndex`,{vectorBucketName:l,indexName:s},{headers:n.headers}),error:null}}catch(o){if(n.shouldThrowOnError)throw o;if(Oa(o))return{data:null,error:o};throw o}}async listIndexes(l){var s=this;try{return{data:await Ca(s.fetch,`${s.url}/ListIndexes`,l,{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Oa(n))return{data:null,error:n};throw n}}async deleteIndex(l,s){var n=this;try{return{data:await Ca(n.fetch,`${n.url}/DeleteIndex`,{vectorBucketName:l,indexName:s},{headers:n.headers})||{},error:null}}catch(o){if(n.shouldThrowOnError)throw o;if(Oa(o))return{data:null,error:o};throw o}}},tx=class{constructor(l,s={},n){this.shouldThrowOnError=!1,this.url=l.replace(/\/$/,""),this.headers=De(De({},Uu),s),this.fetch=Lu(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(l){var s=this;try{if(l.vectors.length<1||l.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Ca(s.fetch,`${s.url}/PutVectors`,l,{headers:s.headers})||{},error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Oa(n))return{data:null,error:n};throw n}}async getVectors(l){var s=this;try{return{data:await Ca(s.fetch,`${s.url}/GetVectors`,l,{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Oa(n))return{data:null,error:n};throw n}}async listVectors(l){var s=this;try{if(l.segmentCount!==void 0){if(l.segmentCount<1||l.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(l.segmentIndex!==void 0&&(l.segmentIndex<0||l.segmentIndex>=l.segmentCount))throw new Error(`segmentIndex must be between 0 and ${l.segmentCount-1}`)}return{data:await Ca(s.fetch,`${s.url}/ListVectors`,l,{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Oa(n))return{data:null,error:n};throw n}}async queryVectors(l){var s=this;try{return{data:await Ca(s.fetch,`${s.url}/QueryVectors`,l,{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Oa(n))return{data:null,error:n};throw n}}async deleteVectors(l){var s=this;try{if(l.keys.length<1||l.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Ca(s.fetch,`${s.url}/DeleteVectors`,l,{headers:s.headers})||{},error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Oa(n))return{data:null,error:n};throw n}}},ax=class{constructor(l,s={},n){this.shouldThrowOnError=!1,this.url=l.replace(/\/$/,""),this.headers=De(De({},Uu),s),this.fetch=Lu(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(l){var s=this;try{return{data:await Ca(s.fetch,`${s.url}/CreateVectorBucket`,{vectorBucketName:l},{headers:s.headers})||{},error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Oa(n))return{data:null,error:n};throw n}}async getBucket(l){var s=this;try{return{data:await Ca(s.fetch,`${s.url}/GetVectorBucket`,{vectorBucketName:l},{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Oa(n))return{data:null,error:n};throw n}}async listBuckets(l={}){var s=this;try{return{data:await Ca(s.fetch,`${s.url}/ListVectorBuckets`,l,{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Oa(n))return{data:null,error:n};throw n}}async deleteBucket(l){var s=this;try{return{data:await Ca(s.fetch,`${s.url}/DeleteVectorBucket`,{vectorBucketName:l},{headers:s.headers})||{},error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Oa(n))return{data:null,error:n};throw n}}},sx=class extends ax{constructor(l,s={}){super(l,s.headers||{},s.fetch)}from(l){return new rx(this.url,this.headers,l,this.fetch)}async createBucket(l){var s=()=>super.createBucket,n=this;return s().call(n,l)}async getBucket(l){var s=()=>super.getBucket,n=this;return s().call(n,l)}async listBuckets(l={}){var s=()=>super.listBuckets,n=this;return s().call(n,l)}async deleteBucket(l){var s=()=>super.deleteBucket,n=this;return s().call(n,l)}},rx=class extends ex{constructor(l,s,n,o){super(l,s,o),this.vectorBucketName=n}async createIndex(l){var s=()=>super.createIndex,n=this;return s().call(n,De(De({},l),{},{vectorBucketName:n.vectorBucketName}))}async listIndexes(l={}){var s=()=>super.listIndexes,n=this;return s().call(n,De(De({},l),{},{vectorBucketName:n.vectorBucketName}))}async getIndex(l){var s=()=>super.getIndex,n=this;return s().call(n,n.vectorBucketName,l)}async deleteIndex(l){var s=()=>super.deleteIndex,n=this;return s().call(n,n.vectorBucketName,l)}index(l){return new nx(this.url,this.headers,this.vectorBucketName,l,this.fetch)}},nx=class extends tx{constructor(l,s,n,o,d){super(l,s,d),this.vectorBucketName=n,this.indexName=o}async putVectors(l){var s=()=>super.putVectors,n=this;return s().call(n,De(De({},l),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async getVectors(l){var s=()=>super.getVectors,n=this;return s().call(n,De(De({},l),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async listVectors(l={}){var s=()=>super.listVectors,n=this;return s().call(n,De(De({},l),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async queryVectors(l){var s=()=>super.queryVectors,n=this;return s().call(n,De(De({},l),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async deleteVectors(l){var s=()=>super.deleteVectors,n=this;return s().call(n,De(De({},l),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}},ix=class extends Vb{constructor(l,s={},n,o){super(l,s,n,o)}from(l){return new Kb(this.url,this.headers,l,this.fetch)}get vectors(){return new sx(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Qb(this.url+"/iceberg",this.headers,this.fetch)}};const vp="2.89.0",xn=30*1e3,Au=3,pu=Au*xn,lx="http://localhost:9999",ox="supabase.auth.token",cx={"X-Client-Info":`gotrue-js/${vp}`},ku="X-Supabase-Api-Version",wp={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},ux=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,dx=600*1e3;class vi extends Error{constructor(s,n,o){super(s),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=o}}function ke(l){return typeof l=="object"&&l!==null&&"__isAuthError"in l}class hx extends vi{constructor(s,n,o){super(s,n,o),this.name="AuthApiError",this.status=n,this.code=o}}function fx(l){return ke(l)&&l.name==="AuthApiError"}class Nr extends vi{constructor(s,n){super(s),this.name="AuthUnknownError",this.originalError=n}}class ks extends vi{constructor(s,n,o,d){super(s,o,d),this.name=n,this.status=o}}class ka extends ks{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function mx(l){return ke(l)&&l.name==="AuthSessionMissingError"}class dn extends ks{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Il extends ks{constructor(s){super(s,"AuthInvalidCredentialsError",400,void 0)}}class ql extends ks{constructor(s,n=null){super(s,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function px(l){return ke(l)&&l.name==="AuthImplicitGrantRedirectError"}class Km extends ks{constructor(s,n=null){super(s,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class gx extends ks{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Ou extends ks{constructor(s,n){super(s,"AuthRetryableFetchError",n,void 0)}}function gu(l){return ke(l)&&l.name==="AuthRetryableFetchError"}class Vm extends ks{constructor(s,n,o){super(s,"AuthWeakPasswordError",n,"weak_password"),this.reasons=o}}class Cu extends ks{constructor(s){super(s,"AuthInvalidJwtError",400,"invalid_jwt")}}const Gl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Qm=` 	
\r=`.split(""),bx=(()=>{const l=new Array(128);for(let s=0;s<l.length;s+=1)l[s]=-1;for(let s=0;s<Qm.length;s+=1)l[Qm[s].charCodeAt(0)]=-2;for(let s=0;s<Gl.length;s+=1)l[Gl[s].charCodeAt(0)]=s;return l})();function Zm(l,s,n){if(l!==null)for(s.queue=s.queue<<8|l,s.queuedBits+=8;s.queuedBits>=6;){const o=s.queue>>s.queuedBits-6&63;n(Gl[o]),s.queuedBits-=6}else if(s.queuedBits>0)for(s.queue=s.queue<<6-s.queuedBits,s.queuedBits=6;s.queuedBits>=6;){const o=s.queue>>s.queuedBits-6&63;n(Gl[o]),s.queuedBits-=6}}function jp(l,s,n){const o=bx[l];if(o>-1)for(s.queue=s.queue<<6|o,s.queuedBits+=6;s.queuedBits>=8;)n(s.queue>>s.queuedBits-8&255),s.queuedBits-=8;else{if(o===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(l)}"`)}}function Jm(l){const s=[],n=f=>{s.push(String.fromCodePoint(f))},o={utf8seq:0,codepoint:0},d={queue:0,queuedBits:0},h=f=>{vx(f,o,n)};for(let f=0;f<l.length;f+=1)jp(l.charCodeAt(f),d,h);return s.join("")}function xx(l,s){if(l<=127){s(l);return}else if(l<=2047){s(192|l>>6),s(128|l&63);return}else if(l<=65535){s(224|l>>12),s(128|l>>6&63),s(128|l&63);return}else if(l<=1114111){s(240|l>>18),s(128|l>>12&63),s(128|l>>6&63),s(128|l&63);return}throw new Error(`Unrecognized Unicode codepoint: ${l.toString(16)}`)}function yx(l,s){for(let n=0;n<l.length;n+=1){let o=l.charCodeAt(n);if(o>55295&&o<=56319){const d=(o-55296)*1024&65535;o=(l.charCodeAt(n+1)-56320&65535|d)+65536,n+=1}xx(o,s)}}function vx(l,s,n){if(s.utf8seq===0){if(l<=127){n(l);return}for(let o=1;o<6;o+=1)if((l>>7-o&1)===0){s.utf8seq=o;break}if(s.utf8seq===2)s.codepoint=l&31;else if(s.utf8seq===3)s.codepoint=l&15;else if(s.utf8seq===4)s.codepoint=l&7;else throw new Error("Invalid UTF-8 sequence");s.utf8seq-=1}else if(s.utf8seq>0){if(l<=127)throw new Error("Invalid UTF-8 sequence");s.codepoint=s.codepoint<<6|l&63,s.utf8seq-=1,s.utf8seq===0&&n(s.codepoint)}}function wn(l){const s=[],n={queue:0,queuedBits:0},o=d=>{s.push(d)};for(let d=0;d<l.length;d+=1)jp(l.charCodeAt(d),n,o);return new Uint8Array(s)}function wx(l){const s=[];return yx(l,n=>s.push(n)),new Uint8Array(s)}function Sr(l){const s=[],n={queue:0,queuedBits:0},o=d=>{s.push(d)};return l.forEach(d=>Zm(d,n,o)),Zm(null,n,o),s.join("")}function jx(l){return Math.round(Date.now()/1e3)+l}function _x(){return Symbol("auth-callback")}const na=()=>typeof window<"u"&&typeof document<"u",vr={tested:!1,writable:!1},_p=()=>{if(!na())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(vr.tested)return vr.writable;const l=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(l,l),globalThis.localStorage.removeItem(l),vr.tested=!0,vr.writable=!0}catch{vr.tested=!0,vr.writable=!1}return vr.writable};function Nx(l){const s={},n=new URL(l);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((d,h)=>{s[h]=d})}catch{}return n.searchParams.forEach((o,d)=>{s[d]=o}),s}const Np=l=>l?(...s)=>l(...s):(...s)=>fetch(...s),Sx=l=>typeof l=="object"&&l!==null&&"status"in l&&"ok"in l&&"json"in l&&typeof l.json=="function",yn=async(l,s,n)=>{await l.setItem(s,JSON.stringify(n))},wr=async(l,s)=>{const n=await l.getItem(s);if(!n)return null;try{return JSON.parse(n)}catch{return n}},ra=async(l,s)=>{await l.removeItem(s)};class Zl{constructor(){this.promise=new Zl.promiseConstructor((s,n)=>{this.resolve=s,this.reject=n})}}Zl.promiseConstructor=Promise;function bu(l){const s=l.split(".");if(s.length!==3)throw new Cu("Invalid JWT structure");for(let o=0;o<s.length;o++)if(!ux.test(s[o]))throw new Cu("JWT not in base64url format");return{header:JSON.parse(Jm(s[0])),payload:JSON.parse(Jm(s[1])),signature:wn(s[2]),raw:{header:s[0],payload:s[1]}}}async function Ex(l){return await new Promise(s=>{setTimeout(()=>s(null),l)})}function Tx(l,s){return new Promise((o,d)=>{(async()=>{for(let h=0;h<1/0;h++)try{const f=await l(h);if(!s(h,null,f)){o(f);return}}catch(f){if(!s(h,f)){d(f);return}}})()})}function Ax(l){return("0"+l.toString(16)).substr(-2)}function kx(){const s=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",o=n.length;let d="";for(let h=0;h<56;h++)d+=n.charAt(Math.floor(Math.random()*o));return d}return crypto.getRandomValues(s),Array.from(s,Ax).join("")}async function Ox(l){const n=new TextEncoder().encode(l),o=await crypto.subtle.digest("SHA-256",n),d=new Uint8Array(o);return Array.from(d).map(h=>String.fromCharCode(h)).join("")}async function Cx(l){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),l;const n=await Ox(l);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function hn(l,s,n=!1){const o=kx();let d=o;n&&(d+="/PASSWORD_RECOVERY"),await yn(l,`${s}-code-verifier`,d);const h=await Cx(o);return[h,o===h?"plain":"s256"]}const Rx=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function zx(l){const s=l.headers.get(ku);if(!s||!s.match(Rx))return null;try{return new Date(`${s}T00:00:00.0Z`)}catch{return null}}function Mx(l){if(!l)throw new Error("Missing exp claim");const s=Math.floor(Date.now()/1e3);if(l<=s)throw new Error("JWT has expired")}function Dx(l){switch(l){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Ux=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function fn(l){if(!Ux.test(l))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function xu(){const l={};return new Proxy(l,{get:(s,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const o=n.toString();if(o==="Symbol(Symbol.toPrimitive)"||o==="Symbol(Symbol.toStringTag)"||o==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(s,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(s,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Lx(l,s){return new Proxy(l,{get:(n,o,d)=>{if(o==="__isInsecureUserWarningProxy")return!0;if(typeof o=="symbol"){const h=o.toString();if(h==="Symbol(Symbol.toPrimitive)"||h==="Symbol(Symbol.toStringTag)"||h==="Symbol(util.inspect.custom)"||h==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(n,o,d)}return!s.value&&typeof o=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),s.value=!0),Reflect.get(n,o,d)}})}function Xm(l){return JSON.parse(JSON.stringify(l))}const jr=l=>l.msg||l.message||l.error_description||l.error||JSON.stringify(l),Bx=[502,503,504];async function Wm(l){var s;if(!Sx(l))throw new Ou(jr(l),0);if(Bx.includes(l.status))throw new Ou(jr(l),l.status);let n;try{n=await l.json()}catch(h){throw new Nr(jr(h),h)}let o;const d=zx(l);if(d&&d.getTime()>=wp["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?o=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(o=n.error_code),o){if(o==="weak_password")throw new Vm(jr(n),l.status,((s=n.weak_password)===null||s===void 0?void 0:s.reasons)||[]);if(o==="session_not_found")throw new ka}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((h,f)=>h&&typeof f=="string",!0))throw new Vm(jr(n),l.status,n.weak_password.reasons);throw new hx(jr(n),l.status||500,o)}const Hx=(l,s,n,o)=>{const d={method:l,headers:(s==null?void 0:s.headers)||{}};return l==="GET"?d:(d.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},s==null?void 0:s.headers),d.body=JSON.stringify(o),Object.assign(Object.assign({},d),n))};async function Me(l,s,n,o){var d;const h=Object.assign({},o==null?void 0:o.headers);h[ku]||(h[ku]=wp["2024-01-01"].name),o!=null&&o.jwt&&(h.Authorization=`Bearer ${o.jwt}`);const f=(d=o==null?void 0:o.query)!==null&&d!==void 0?d:{};o!=null&&o.redirectTo&&(f.redirect_to=o.redirectTo);const b=Object.keys(f).length?"?"+new URLSearchParams(f).toString():"",g=await $x(l,s,n+b,{headers:h,noResolveJson:o==null?void 0:o.noResolveJson},{},o==null?void 0:o.body);return o!=null&&o.xform?o==null?void 0:o.xform(g):{data:Object.assign({},g),error:null}}async function $x(l,s,n,o,d,h){const f=Hx(s,o,d,h);let b;try{b=await l(n,Object.assign({},f))}catch(g){throw console.error(g),new Ou(jr(g),0)}if(b.ok||await Wm(b),o!=null&&o.noResolveJson)return b;try{return await b.json()}catch(g){await Wm(g)}}function Wa(l){var s;let n=null;Px(l)&&(n=Object.assign({},l),l.expires_at||(n.expires_at=jx(l.expires_in)));const o=(s=l.user)!==null&&s!==void 0?s:l;return{data:{session:n,user:o},error:null}}function Fm(l){const s=Wa(l);return!s.error&&l.weak_password&&typeof l.weak_password=="object"&&Array.isArray(l.weak_password.reasons)&&l.weak_password.reasons.length&&l.weak_password.message&&typeof l.weak_password.message=="string"&&l.weak_password.reasons.reduce((n,o)=>n&&typeof o=="string",!0)&&(s.data.weak_password=l.weak_password),s}function ar(l){var s;return{data:{user:(s=l.user)!==null&&s!==void 0?s:l},error:null}}function Ix(l){return{data:l,error:null}}function qx(l){const{action_link:s,email_otp:n,hashed_token:o,redirect_to:d,verification_type:h}=l,f=Vl(l,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),b={action_link:s,email_otp:n,hashed_token:o,redirect_to:d,verification_type:h},g=Object.assign({},f);return{data:{properties:b,user:g},error:null}}function ep(l){return l}function Px(l){return l.access_token&&l.refresh_token&&l.expires_in}const yu=["global","local","others"];class Gx{constructor({url:s="",headers:n={},fetch:o}){this.url=s,this.headers=n,this.fetch=Np(o),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(s,n=yu[0]){if(yu.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${yu.join(", ")}`);try{return await Me(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:s,noResolveJson:!0}),{data:null,error:null}}catch(o){if(ke(o))return{data:null,error:o};throw o}}async inviteUserByEmail(s,n={}){try{return await Me(this.fetch,"POST",`${this.url}/invite`,{body:{email:s,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:ar})}catch(o){if(ke(o))return{data:{user:null},error:o};throw o}}async generateLink(s){try{const{options:n}=s,o=Vl(s,["options"]),d=Object.assign(Object.assign({},o),n);return"newEmail"in o&&(d.new_email=o==null?void 0:o.newEmail,delete d.newEmail),await Me(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:d,headers:this.headers,xform:qx,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(ke(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(s){try{return await Me(this.fetch,"POST",`${this.url}/admin/users`,{body:s,headers:this.headers,xform:ar})}catch(n){if(ke(n))return{data:{user:null},error:n};throw n}}async listUsers(s){var n,o,d,h,f,b,g;try{const p={nextPage:null,lastPage:0,total:0},v=await Me(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(o=(n=s==null?void 0:s.page)===null||n===void 0?void 0:n.toString())!==null&&o!==void 0?o:"",per_page:(h=(d=s==null?void 0:s.perPage)===null||d===void 0?void 0:d.toString())!==null&&h!==void 0?h:""},xform:ep});if(v.error)throw v.error;const x=await v.json(),_=(f=v.headers.get("x-total-count"))!==null&&f!==void 0?f:0,j=(g=(b=v.headers.get("link"))===null||b===void 0?void 0:b.split(","))!==null&&g!==void 0?g:[];return j.length>0&&(j.forEach(C=>{const z=parseInt(C.split(";")[0].split("=")[1].substring(0,1)),M=JSON.parse(C.split(";")[1].split("=")[1]);p[`${M}Page`]=z}),p.total=parseInt(_)),{data:Object.assign(Object.assign({},x),p),error:null}}catch(p){if(ke(p))return{data:{users:[]},error:p};throw p}}async getUserById(s){fn(s);try{return await Me(this.fetch,"GET",`${this.url}/admin/users/${s}`,{headers:this.headers,xform:ar})}catch(n){if(ke(n))return{data:{user:null},error:n};throw n}}async updateUserById(s,n){fn(s);try{return await Me(this.fetch,"PUT",`${this.url}/admin/users/${s}`,{body:n,headers:this.headers,xform:ar})}catch(o){if(ke(o))return{data:{user:null},error:o};throw o}}async deleteUser(s,n=!1){fn(s);try{return await Me(this.fetch,"DELETE",`${this.url}/admin/users/${s}`,{headers:this.headers,body:{should_soft_delete:n},xform:ar})}catch(o){if(ke(o))return{data:{user:null},error:o};throw o}}async _listFactors(s){fn(s.userId);try{const{data:n,error:o}=await Me(this.fetch,"GET",`${this.url}/admin/users/${s.userId}/factors`,{headers:this.headers,xform:d=>({data:{factors:d},error:null})});return{data:n,error:o}}catch(n){if(ke(n))return{data:null,error:n};throw n}}async _deleteFactor(s){fn(s.userId),fn(s.id);try{return{data:await Me(this.fetch,"DELETE",`${this.url}/admin/users/${s.userId}/factors/${s.id}`,{headers:this.headers}),error:null}}catch(n){if(ke(n))return{data:null,error:n};throw n}}async _listOAuthClients(s){var n,o,d,h,f,b,g;try{const p={nextPage:null,lastPage:0,total:0},v=await Me(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(o=(n=s==null?void 0:s.page)===null||n===void 0?void 0:n.toString())!==null&&o!==void 0?o:"",per_page:(h=(d=s==null?void 0:s.perPage)===null||d===void 0?void 0:d.toString())!==null&&h!==void 0?h:""},xform:ep});if(v.error)throw v.error;const x=await v.json(),_=(f=v.headers.get("x-total-count"))!==null&&f!==void 0?f:0,j=(g=(b=v.headers.get("link"))===null||b===void 0?void 0:b.split(","))!==null&&g!==void 0?g:[];return j.length>0&&(j.forEach(C=>{const z=parseInt(C.split(";")[0].split("=")[1].substring(0,1)),M=JSON.parse(C.split(";")[1].split("=")[1]);p[`${M}Page`]=z}),p.total=parseInt(_)),{data:Object.assign(Object.assign({},x),p),error:null}}catch(p){if(ke(p))return{data:{clients:[]},error:p};throw p}}async _createOAuthClient(s){try{return await Me(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:s,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ke(n))return{data:null,error:n};throw n}}async _getOAuthClient(s){try{return await Me(this.fetch,"GET",`${this.url}/admin/oauth/clients/${s}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ke(n))return{data:null,error:n};throw n}}async _updateOAuthClient(s,n){try{return await Me(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${s}`,{body:n,headers:this.headers,xform:o=>({data:o,error:null})})}catch(o){if(ke(o))return{data:null,error:o};throw o}}async _deleteOAuthClient(s){try{return await Me(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${s}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(n){if(ke(n))return{data:null,error:n};throw n}}async _regenerateOAuthClientSecret(s){try{return await Me(this.fetch,"POST",`${this.url}/admin/oauth/clients/${s}/regenerate_secret`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ke(n))return{data:null,error:n};throw n}}}function tp(l={}){return{getItem:s=>l[s]||null,setItem:(s,n)=>{l[s]=n},removeItem:s=>{delete l[s]}}}const mn={debug:!!(globalThis&&_p()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Sp extends Error{constructor(s){super(s),this.isAcquireTimeout=!0}}class Yx extends Sp{}async function Kx(l,s,n){mn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",l,s);const o=new globalThis.AbortController;return s>0&&setTimeout(()=>{o.abort(),mn.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",l)},s),await Promise.resolve().then(()=>globalThis.navigator.locks.request(l,s===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:o.signal},async d=>{if(d){mn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",l,d.name);try{return await n()}finally{mn.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",l,d.name)}}else{if(s===0)throw mn.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",l),new Yx(`Acquiring an exclusive Navigator LockManager lock "${l}" immediately failed`);if(mn.debug)try{const h=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(h,null,"  "))}catch(h){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",h)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}function Vx(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Ep(l){if(!/^0x[a-fA-F0-9]{40}$/.test(l))throw new Error(`@supabase/auth-js: Address "${l}" is invalid.`);return l.toLowerCase()}function Qx(l){return parseInt(l,16)}function Zx(l){const s=new TextEncoder().encode(l);return"0x"+Array.from(s,o=>o.toString(16).padStart(2,"0")).join("")}function Jx(l){var s;const{chainId:n,domain:o,expirationTime:d,issuedAt:h=new Date,nonce:f,notBefore:b,requestId:g,resources:p,scheme:v,uri:x,version:_}=l;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!o)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(f&&f.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${f}`);if(!x)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(_!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${_}`);if(!((s=l.statement)===null||s===void 0)&&s.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${l.statement}`)}const j=Ep(l.address),C=v?`${v}://${o}`:o,z=l.statement?`${l.statement}
`:"",M=`${C} wants you to sign in with your Ethereum account:
${j}

${z}`;let E=`URI: ${x}
Version: ${_}
Chain ID: ${n}${f?`
Nonce: ${f}`:""}
Issued At: ${h.toISOString()}`;if(d&&(E+=`
Expiration Time: ${d.toISOString()}`),b&&(E+=`
Not Before: ${b.toISOString()}`),g&&(E+=`
Request ID: ${g}`),p){let O=`
Resources:`;for(const N of p){if(!N||typeof N!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${N}`);O+=`
- ${N}`}E+=O}return`${M}
${E}`}class Qt extends Error{constructor({message:s,code:n,cause:o,name:d}){var h;super(s,{cause:o}),this.__isWebAuthnError=!0,this.name=(h=d??(o instanceof Error?o.name:void 0))!==null&&h!==void 0?h:"Unknown Error",this.code=n}}class Yl extends Qt{constructor(s,n){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n,message:s}),this.name="WebAuthnUnknownError",this.originalError=n}}function Xx({error:l,options:s}){var n,o,d;const{publicKey:h}=s;if(!h)throw Error("options was missing required publicKey property");if(l.name==="AbortError"){if(s.signal instanceof AbortSignal)return new Qt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:l})}else if(l.name==="ConstraintError"){if(((n=h.authenticatorSelection)===null||n===void 0?void 0:n.requireResidentKey)===!0)return new Qt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:l});if(s.mediation==="conditional"&&((o=h.authenticatorSelection)===null||o===void 0?void 0:o.userVerification)==="required")return new Qt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:l});if(((d=h.authenticatorSelection)===null||d===void 0?void 0:d.userVerification)==="required")return new Qt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:l})}else{if(l.name==="InvalidStateError")return new Qt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:l});if(l.name==="NotAllowedError")return new Qt({message:l.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:l});if(l.name==="NotSupportedError")return h.pubKeyCredParams.filter(b=>b.type==="public-key").length===0?new Qt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:l}):new Qt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:l});if(l.name==="SecurityError"){const f=window.location.hostname;if(Tp(f)){if(h.rp.id!==f)return new Qt({message:`The RP ID "${h.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:l})}else return new Qt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:l})}else if(l.name==="TypeError"){if(h.user.id.byteLength<1||h.user.id.byteLength>64)return new Qt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:l})}else if(l.name==="UnknownError")return new Qt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:l})}return new Qt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:l})}function Wx({error:l,options:s}){const{publicKey:n}=s;if(!n)throw Error("options was missing required publicKey property");if(l.name==="AbortError"){if(s.signal instanceof AbortSignal)return new Qt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:l})}else{if(l.name==="NotAllowedError")return new Qt({message:l.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:l});if(l.name==="SecurityError"){const o=window.location.hostname;if(Tp(o)){if(n.rpId!==o)return new Qt({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:l})}else return new Qt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:l})}else if(l.name==="UnknownError")return new Qt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:l})}return new Qt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:l})}class Fx{createNewAbortSignal(){if(this.controller){const n=new Error("Cancelling existing WebAuthn API call for new one");n.name="AbortError",this.controller.abort(n)}const s=new AbortController;return this.controller=s,s.signal}cancelCeremony(){if(this.controller){const s=new Error("Manually cancelling existing WebAuthn API call");s.name="AbortError",this.controller.abort(s),this.controller=void 0}}}const ey=new Fx;function ty(l){if(!l)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(l);const{challenge:s,user:n,excludeCredentials:o}=l,d=Vl(l,["challenge","user","excludeCredentials"]),h=wn(s).buffer,f=Object.assign(Object.assign({},n),{id:wn(n.id).buffer}),b=Object.assign(Object.assign({},d),{challenge:h,user:f});if(o&&o.length>0){b.excludeCredentials=new Array(o.length);for(let g=0;g<o.length;g++){const p=o[g];b.excludeCredentials[g]=Object.assign(Object.assign({},p),{id:wn(p.id).buffer,type:p.type||"public-key",transports:p.transports})}}return b}function ay(l){if(!l)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(l);const{challenge:s,allowCredentials:n}=l,o=Vl(l,["challenge","allowCredentials"]),d=wn(s).buffer,h=Object.assign(Object.assign({},o),{challenge:d});if(n&&n.length>0){h.allowCredentials=new Array(n.length);for(let f=0;f<n.length;f++){const b=n[f];h.allowCredentials[f]=Object.assign(Object.assign({},b),{id:wn(b.id).buffer,type:b.type||"public-key",transports:b.transports})}}return h}function sy(l){var s;if("toJSON"in l&&typeof l.toJSON=="function")return l.toJSON();const n=l;return{id:l.id,rawId:l.id,response:{attestationObject:Sr(new Uint8Array(l.response.attestationObject)),clientDataJSON:Sr(new Uint8Array(l.response.clientDataJSON))},type:"public-key",clientExtensionResults:l.getClientExtensionResults(),authenticatorAttachment:(s=n.authenticatorAttachment)!==null&&s!==void 0?s:void 0}}function ry(l){var s;if("toJSON"in l&&typeof l.toJSON=="function")return l.toJSON();const n=l,o=l.getClientExtensionResults(),d=l.response;return{id:l.id,rawId:l.id,response:{authenticatorData:Sr(new Uint8Array(d.authenticatorData)),clientDataJSON:Sr(new Uint8Array(d.clientDataJSON)),signature:Sr(new Uint8Array(d.signature)),userHandle:d.userHandle?Sr(new Uint8Array(d.userHandle)):void 0},type:"public-key",clientExtensionResults:o,authenticatorAttachment:(s=n.authenticatorAttachment)!==null&&s!==void 0?s:void 0}}function Tp(l){return l==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(l)}function ap(){var l,s;return!!(na()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((l=navigator==null?void 0:navigator.credentials)===null||l===void 0?void 0:l.create)=="function"&&typeof((s=navigator==null?void 0:navigator.credentials)===null||s===void 0?void 0:s.get)=="function")}async function ny(l){try{const s=await navigator.credentials.create(l);return s?s instanceof PublicKeyCredential?{data:s,error:null}:{data:null,error:new Yl("Browser returned unexpected credential type",s)}:{data:null,error:new Yl("Empty credential response",s)}}catch(s){return{data:null,error:Xx({error:s,options:l})}}}async function iy(l){try{const s=await navigator.credentials.get(l);return s?s instanceof PublicKeyCredential?{data:s,error:null}:{data:null,error:new Yl("Browser returned unexpected credential type",s)}:{data:null,error:new Yl("Empty credential response",s)}}catch(s){return{data:null,error:Wx({error:s,options:l})}}}const ly={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},oy={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Kl(...l){const s=d=>d!==null&&typeof d=="object"&&!Array.isArray(d),n=d=>d instanceof ArrayBuffer||ArrayBuffer.isView(d),o={};for(const d of l)if(d)for(const h in d){const f=d[h];if(f!==void 0)if(Array.isArray(f))o[h]=f;else if(n(f))o[h]=f;else if(s(f)){const b=o[h];s(b)?o[h]=Kl(b,f):o[h]=Kl(f)}else o[h]=f}return o}function cy(l,s){return Kl(ly,l,s||{})}function uy(l,s){return Kl(oy,l,s||{})}class dy{constructor(s){this.client=s,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(s){return this.client.mfa.enroll(Object.assign(Object.assign({},s),{factorType:"webauthn"}))}async _challenge({factorId:s,webauthn:n,friendlyName:o,signal:d},h){try{const{data:f,error:b}=await this.client.mfa.challenge({factorId:s,webauthn:n});if(!f)return{data:null,error:b};const g=d??ey.createNewAbortSignal();if(f.webauthn.type==="create"){const{user:p}=f.webauthn.credential_options.publicKey;p.name||(p.name=`${p.id}:${o}`),p.displayName||(p.displayName=p.name)}switch(f.webauthn.type){case"create":{const p=cy(f.webauthn.credential_options.publicKey,h==null?void 0:h.create),{data:v,error:x}=await ny({publicKey:p,signal:g});return v?{data:{factorId:s,challengeId:f.id,webauthn:{type:f.webauthn.type,credential_response:v}},error:null}:{data:null,error:x}}case"request":{const p=uy(f.webauthn.credential_options.publicKey,h==null?void 0:h.request),{data:v,error:x}=await iy(Object.assign(Object.assign({},f.webauthn.credential_options),{publicKey:p,signal:g}));return v?{data:{factorId:s,challengeId:f.id,webauthn:{type:f.webauthn.type,credential_response:v}},error:null}:{data:null,error:x}}}}catch(f){return ke(f)?{data:null,error:f}:{data:null,error:new Nr("Unexpected error in challenge",f)}}}async _verify({challengeId:s,factorId:n,webauthn:o}){return this.client.mfa.verify({factorId:n,challengeId:s,webauthn:o})}async _authenticate({factorId:s,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:o=typeof window<"u"?[window.location.origin]:void 0,signal:d}={}},h){if(!n)return{data:null,error:new vi("rpId is required for WebAuthn authentication")};try{if(!ap())return{data:null,error:new Nr("Browser does not support WebAuthn",null)};const{data:f,error:b}=await this.challenge({factorId:s,webauthn:{rpId:n,rpOrigins:o},signal:d},{request:h});if(!f)return{data:null,error:b};const{webauthn:g}=f;return this._verify({factorId:s,challengeId:f.challengeId,webauthn:{type:g.type,rpId:n,rpOrigins:o,credential_response:g.credential_response}})}catch(f){return ke(f)?{data:null,error:f}:{data:null,error:new Nr("Unexpected error in authenticate",f)}}}async _register({friendlyName:s,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:o=typeof window<"u"?[window.location.origin]:void 0,signal:d}={}},h){if(!n)return{data:null,error:new vi("rpId is required for WebAuthn registration")};try{if(!ap())return{data:null,error:new Nr("Browser does not support WebAuthn",null)};const{data:f,error:b}=await this._enroll({friendlyName:s});if(!f)return await this.client.mfa.listFactors().then(v=>{var x;return(x=v.data)===null||x===void 0?void 0:x.all.find(_=>_.factor_type==="webauthn"&&_.friendly_name===s&&_.status!=="unverified")}).then(v=>v?this.client.mfa.unenroll({factorId:v==null?void 0:v.id}):void 0),{data:null,error:b};const{data:g,error:p}=await this._challenge({factorId:f.id,friendlyName:f.friendly_name,webauthn:{rpId:n,rpOrigins:o},signal:d},{create:h});return g?this._verify({factorId:f.id,challengeId:g.challengeId,webauthn:{rpId:n,rpOrigins:o,type:g.webauthn.type,credential_response:g.webauthn.credential_response}}):{data:null,error:p}}catch(f){return ke(f)?{data:null,error:f}:{data:null,error:new Nr("Unexpected error in register",f)}}}}Vx();const hy={url:lx,storageKey:ox,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:cx,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function sp(l,s,n){return await n()}const pn={};class wi{get jwks(){var s,n;return(n=(s=pn[this.storageKey])===null||s===void 0?void 0:s.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(s){pn[this.storageKey]=Object.assign(Object.assign({},pn[this.storageKey]),{jwks:s})}get jwks_cached_at(){var s,n;return(n=(s=pn[this.storageKey])===null||s===void 0?void 0:s.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(s){pn[this.storageKey]=Object.assign(Object.assign({},pn[this.storageKey]),{cachedAt:s})}constructor(s){var n,o,d;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const h=Object.assign(Object.assign({},hy),s);if(this.storageKey=h.storageKey,this.instanceID=(n=wi.nextInstanceID[this.storageKey])!==null&&n!==void 0?n:0,wi.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!h.debug,typeof h.debug=="function"&&(this.logger=h.debug),this.instanceID>0&&na()){const f=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(f),this.logDebugMessages&&console.trace(f)}if(this.persistSession=h.persistSession,this.autoRefreshToken=h.autoRefreshToken,this.admin=new Gx({url:h.url,headers:h.headers,fetch:h.fetch}),this.url=h.url,this.headers=h.headers,this.fetch=Np(h.fetch),this.lock=h.lock||sp,this.detectSessionInUrl=h.detectSessionInUrl,this.flowType=h.flowType,this.hasCustomAuthorizationHeader=h.hasCustomAuthorizationHeader,this.throwOnError=h.throwOnError,h.lock?this.lock=h.lock:this.persistSession&&na()&&(!((o=globalThis==null?void 0:globalThis.navigator)===null||o===void 0)&&o.locks)?this.lock=Kx:this.lock=sp,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new dy(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(h.storage?this.storage=h.storage:_p()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=tp(this.memoryStorage)),h.userStorage&&(this.userStorage=h.userStorage)):(this.memoryStorage={},this.storage=tp(this.memoryStorage)),na()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(f){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",f)}(d=this.broadcastChannel)===null||d===void 0||d.addEventListener("message",async f=>{this._debug("received broadcast notification from other tab or client",f),await this._notifyAllSubscribers(f.data.event,f.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(s){if(this.throwOnError&&s&&s.error)throw s.error;return s}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${vp}) ${new Date().toISOString()}`}_debug(...s){return this.logDebugMessages&&this.logger(this._logPrefix(),...s),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var s;try{let n={},o="none";if(na()&&(n=Nx(window.location.href),this._isImplicitGrantCallback(n)?o="implicit":await this._isPKCECallback(n)&&(o="pkce")),na()&&this.detectSessionInUrl&&o!=="none"){const{data:d,error:h}=await this._getSessionFromURL(n,o);if(h){if(this._debug("#_initialize()","error detecting session from URL",h),px(h)){const g=(s=h.details)===null||s===void 0?void 0:s.code;if(g==="identity_already_exists"||g==="identity_not_found"||g==="single_identity_not_deletable")return{error:h}}return await this._removeSession(),{error:h}}const{session:f,redirectType:b}=d;return this._debug("#_initialize()","detected session in URL",f,"redirect type",b),await this._saveSession(f),setTimeout(async()=>{b==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",f):await this._notifyAllSubscribers("SIGNED_IN",f)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return ke(n)?this._returnResult({error:n}):this._returnResult({error:new Nr("Unexpected error during initialization",n)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(s){var n,o,d;try{const h=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(o=(n=s==null?void 0:s.options)===null||n===void 0?void 0:n.data)!==null&&o!==void 0?o:{},gotrue_meta_security:{captcha_token:(d=s==null?void 0:s.options)===null||d===void 0?void 0:d.captchaToken}},xform:Wa}),{data:f,error:b}=h;if(b||!f)return this._returnResult({data:{user:null,session:null},error:b});const g=f.session,p=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",g)),this._returnResult({data:{user:p,session:g},error:null})}catch(h){if(ke(h))return this._returnResult({data:{user:null,session:null},error:h});throw h}}async signUp(s){var n,o,d;try{let h;if("email"in s){const{email:v,password:x,options:_}=s;let j=null,C=null;this.flowType==="pkce"&&([j,C]=await hn(this.storage,this.storageKey)),h=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:_==null?void 0:_.emailRedirectTo,body:{email:v,password:x,data:(n=_==null?void 0:_.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken},code_challenge:j,code_challenge_method:C},xform:Wa})}else if("phone"in s){const{phone:v,password:x,options:_}=s;h=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:v,password:x,data:(o=_==null?void 0:_.data)!==null&&o!==void 0?o:{},channel:(d=_==null?void 0:_.channel)!==null&&d!==void 0?d:"sms",gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken}},xform:Wa})}else throw new Il("You must provide either an email or phone number and a password");const{data:f,error:b}=h;if(b||!f)return await ra(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:b});const g=f.session,p=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",g)),this._returnResult({data:{user:p,session:g},error:null})}catch(h){if(await ra(this.storage,`${this.storageKey}-code-verifier`),ke(h))return this._returnResult({data:{user:null,session:null},error:h});throw h}}async signInWithPassword(s){try{let n;if("email"in s){const{email:h,password:f,options:b}=s;n=await Me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:h,password:f,gotrue_meta_security:{captcha_token:b==null?void 0:b.captchaToken}},xform:Fm})}else if("phone"in s){const{phone:h,password:f,options:b}=s;n=await Me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:h,password:f,gotrue_meta_security:{captcha_token:b==null?void 0:b.captchaToken}},xform:Fm})}else throw new Il("You must provide either an email or phone number and a password");const{data:o,error:d}=n;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!o||!o.session||!o.user){const h=new dn;return this._returnResult({data:{user:null,session:null},error:h})}return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),this._returnResult({data:Object.assign({user:o.user,session:o.session},o.weak_password?{weakPassword:o.weak_password}:null),error:d})}catch(n){if(ke(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOAuth(s){var n,o,d,h;return await this._handleProviderSignIn(s.provider,{redirectTo:(n=s.options)===null||n===void 0?void 0:n.redirectTo,scopes:(o=s.options)===null||o===void 0?void 0:o.scopes,queryParams:(d=s.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:(h=s.options)===null||h===void 0?void 0:h.skipBrowserRedirect})}async exchangeCodeForSession(s){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(s))}async signInWithWeb3(s){const{chain:n}=s;switch(n){case"ethereum":return await this.signInWithEthereum(s);case"solana":return await this.signInWithSolana(s);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(s){var n,o,d,h,f,b,g,p,v,x,_;let j,C;if("message"in s)j=s.message,C=s.signature;else{const{chain:z,wallet:M,statement:E,options:O}=s;let N;if(na())if(typeof M=="object")N=M;else{const we=window;if("ethereum"in we&&typeof we.ethereum=="object"&&"request"in we.ethereum&&typeof we.ethereum.request=="function")N=we.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof M!="object"||!(O!=null&&O.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");N=M}const G=new URL((n=O==null?void 0:O.url)!==null&&n!==void 0?n:window.location.href),fe=await N.request({method:"eth_requestAccounts"}).then(we=>we).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!fe||fe.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const J=Ep(fe[0]);let oe=(o=O==null?void 0:O.signInWithEthereum)===null||o===void 0?void 0:o.chainId;if(!oe){const we=await N.request({method:"eth_chainId"});oe=Qx(we)}const ge={domain:G.host,address:J,statement:E,uri:G.href,version:"1",chainId:oe,nonce:(d=O==null?void 0:O.signInWithEthereum)===null||d===void 0?void 0:d.nonce,issuedAt:(f=(h=O==null?void 0:O.signInWithEthereum)===null||h===void 0?void 0:h.issuedAt)!==null&&f!==void 0?f:new Date,expirationTime:(b=O==null?void 0:O.signInWithEthereum)===null||b===void 0?void 0:b.expirationTime,notBefore:(g=O==null?void 0:O.signInWithEthereum)===null||g===void 0?void 0:g.notBefore,requestId:(p=O==null?void 0:O.signInWithEthereum)===null||p===void 0?void 0:p.requestId,resources:(v=O==null?void 0:O.signInWithEthereum)===null||v===void 0?void 0:v.resources};j=Jx(ge),C=await N.request({method:"personal_sign",params:[Zx(j),J]})}try{const{data:z,error:M}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:j,signature:C},!((x=s.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(_=s.options)===null||_===void 0?void 0:_.captchaToken}}:null),xform:Wa});if(M)throw M;if(!z||!z.session||!z.user){const E=new dn;return this._returnResult({data:{user:null,session:null},error:E})}return z.session&&(await this._saveSession(z.session),await this._notifyAllSubscribers("SIGNED_IN",z.session)),this._returnResult({data:Object.assign({},z),error:M})}catch(z){if(ke(z))return this._returnResult({data:{user:null,session:null},error:z});throw z}}async signInWithSolana(s){var n,o,d,h,f,b,g,p,v,x,_,j;let C,z;if("message"in s)C=s.message,z=s.signature;else{const{chain:M,wallet:E,statement:O,options:N}=s;let G;if(na())if(typeof E=="object")G=E;else{const J=window;if("solana"in J&&typeof J.solana=="object"&&("signIn"in J.solana&&typeof J.solana.signIn=="function"||"signMessage"in J.solana&&typeof J.solana.signMessage=="function"))G=J.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof E!="object"||!(N!=null&&N.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");G=E}const fe=new URL((n=N==null?void 0:N.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in G&&G.signIn){const J=await G.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},N==null?void 0:N.signInWithSolana),{version:"1",domain:fe.host,uri:fe.href}),O?{statement:O}:null));let oe;if(Array.isArray(J)&&J[0]&&typeof J[0]=="object")oe=J[0];else if(J&&typeof J=="object"&&"signedMessage"in J&&"signature"in J)oe=J;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in oe&&"signature"in oe&&(typeof oe.signedMessage=="string"||oe.signedMessage instanceof Uint8Array)&&oe.signature instanceof Uint8Array)C=typeof oe.signedMessage=="string"?oe.signedMessage:new TextDecoder().decode(oe.signedMessage),z=oe.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in G)||typeof G.signMessage!="function"||!("publicKey"in G)||typeof G!="object"||!G.publicKey||!("toBase58"in G.publicKey)||typeof G.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");C=[`${fe.host} wants you to sign in with your Solana account:`,G.publicKey.toBase58(),...O?["",O,""]:[""],"Version: 1",`URI: ${fe.href}`,`Issued At: ${(d=(o=N==null?void 0:N.signInWithSolana)===null||o===void 0?void 0:o.issuedAt)!==null&&d!==void 0?d:new Date().toISOString()}`,...!((h=N==null?void 0:N.signInWithSolana)===null||h===void 0)&&h.notBefore?[`Not Before: ${N.signInWithSolana.notBefore}`]:[],...!((f=N==null?void 0:N.signInWithSolana)===null||f===void 0)&&f.expirationTime?[`Expiration Time: ${N.signInWithSolana.expirationTime}`]:[],...!((b=N==null?void 0:N.signInWithSolana)===null||b===void 0)&&b.chainId?[`Chain ID: ${N.signInWithSolana.chainId}`]:[],...!((g=N==null?void 0:N.signInWithSolana)===null||g===void 0)&&g.nonce?[`Nonce: ${N.signInWithSolana.nonce}`]:[],...!((p=N==null?void 0:N.signInWithSolana)===null||p===void 0)&&p.requestId?[`Request ID: ${N.signInWithSolana.requestId}`]:[],...!((x=(v=N==null?void 0:N.signInWithSolana)===null||v===void 0?void 0:v.resources)===null||x===void 0)&&x.length?["Resources",...N.signInWithSolana.resources.map(oe=>`- ${oe}`)]:[]].join(`
`);const J=await G.signMessage(new TextEncoder().encode(C),"utf8");if(!J||!(J instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");z=J}}try{const{data:M,error:E}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:C,signature:Sr(z)},!((_=s.options)===null||_===void 0)&&_.captchaToken?{gotrue_meta_security:{captcha_token:(j=s.options)===null||j===void 0?void 0:j.captchaToken}}:null),xform:Wa});if(E)throw E;if(!M||!M.session||!M.user){const O=new dn;return this._returnResult({data:{user:null,session:null},error:O})}return M.session&&(await this._saveSession(M.session),await this._notifyAllSubscribers("SIGNED_IN",M.session)),this._returnResult({data:Object.assign({},M),error:E})}catch(M){if(ke(M))return this._returnResult({data:{user:null,session:null},error:M});throw M}}async _exchangeCodeForSession(s){const n=await wr(this.storage,`${this.storageKey}-code-verifier`),[o,d]=(n??"").split("/");try{if(!o&&this.flowType==="pkce")throw new gx;const{data:h,error:f}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:s,code_verifier:o},xform:Wa});if(await ra(this.storage,`${this.storageKey}-code-verifier`),f)throw f;if(!h||!h.session||!h.user){const b=new dn;return this._returnResult({data:{user:null,session:null,redirectType:null},error:b})}return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),this._returnResult({data:Object.assign(Object.assign({},h),{redirectType:d??null}),error:f})}catch(h){if(await ra(this.storage,`${this.storageKey}-code-verifier`),ke(h))return this._returnResult({data:{user:null,session:null,redirectType:null},error:h});throw h}}async signInWithIdToken(s){try{const{options:n,provider:o,token:d,access_token:h,nonce:f}=s,b=await Me(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:o,id_token:d,access_token:h,nonce:f,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:Wa}),{data:g,error:p}=b;if(p)return this._returnResult({data:{user:null,session:null},error:p});if(!g||!g.session||!g.user){const v=new dn;return this._returnResult({data:{user:null,session:null},error:v})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:g,error:p})}catch(n){if(ke(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOtp(s){var n,o,d,h,f;try{if("email"in s){const{email:b,options:g}=s;let p=null,v=null;this.flowType==="pkce"&&([p,v]=await hn(this.storage,this.storageKey));const{error:x}=await Me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:b,data:(n=g==null?void 0:g.data)!==null&&n!==void 0?n:{},create_user:(o=g==null?void 0:g.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},code_challenge:p,code_challenge_method:v},redirectTo:g==null?void 0:g.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:x})}if("phone"in s){const{phone:b,options:g}=s,{data:p,error:v}=await Me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:b,data:(d=g==null?void 0:g.data)!==null&&d!==void 0?d:{},create_user:(h=g==null?void 0:g.shouldCreateUser)!==null&&h!==void 0?h:!0,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},channel:(f=g==null?void 0:g.channel)!==null&&f!==void 0?f:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:p==null?void 0:p.message_id},error:v})}throw new Il("You must provide either an email or phone number.")}catch(b){if(await ra(this.storage,`${this.storageKey}-code-verifier`),ke(b))return this._returnResult({data:{user:null,session:null},error:b});throw b}}async verifyOtp(s){var n,o;try{let d,h;"options"in s&&(d=(n=s.options)===null||n===void 0?void 0:n.redirectTo,h=(o=s.options)===null||o===void 0?void 0:o.captchaToken);const{data:f,error:b}=await Me(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},s),{gotrue_meta_security:{captcha_token:h}}),redirectTo:d,xform:Wa});if(b)throw b;if(!f)throw new Error("An error occurred on token verification.");const g=f.session,p=f.user;return g!=null&&g.access_token&&(await this._saveSession(g),await this._notifyAllSubscribers(s.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",g)),this._returnResult({data:{user:p,session:g},error:null})}catch(d){if(ke(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async signInWithSSO(s){var n,o,d,h,f;try{let b=null,g=null;this.flowType==="pkce"&&([b,g]=await hn(this.storage,this.storageKey));const p=await Me(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in s?{provider_id:s.providerId}:null),"domain"in s?{domain:s.domain}:null),{redirect_to:(o=(n=s.options)===null||n===void 0?void 0:n.redirectTo)!==null&&o!==void 0?o:void 0}),!((d=s==null?void 0:s.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:s.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:b,code_challenge_method:g}),headers:this.headers,xform:Ix});return!((h=p.data)===null||h===void 0)&&h.url&&na()&&!(!((f=s.options)===null||f===void 0)&&f.skipBrowserRedirect)&&window.location.assign(p.data.url),this._returnResult(p)}catch(b){if(await ra(this.storage,`${this.storageKey}-code-verifier`),ke(b))return this._returnResult({data:null,error:b});throw b}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async s=>{const{data:{session:n},error:o}=s;if(o)throw o;if(!n)throw new ka;const{error:d}=await Me(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return this._returnResult({data:{user:null,session:null},error:d})})}catch(s){if(ke(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async resend(s){try{const n=`${this.url}/resend`;if("email"in s){const{email:o,type:d,options:h}=s,{error:f}=await Me(this.fetch,"POST",n,{headers:this.headers,body:{email:o,type:d,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},redirectTo:h==null?void 0:h.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}else if("phone"in s){const{phone:o,type:d,options:h}=s,{data:f,error:b}=await Me(this.fetch,"POST",n,{headers:this.headers,body:{phone:o,type:d,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:f==null?void 0:f.message_id},error:b})}throw new Il("You must provide either an email or phone number and a type")}catch(n){if(ke(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(s,n){this._debug("#_acquireLock","begin",s);try{if(this.lockAcquired){const o=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),d=(async()=>(await o,await n()))();return this.pendingInLock.push((async()=>{try{await d}catch{}})()),d}return await this.lock(`lock:${this.storageKey}`,s,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const o=n();for(this.pendingInLock.push((async()=>{try{await o}catch{}})()),await o;this.pendingInLock.length;){const d=[...this.pendingInLock];await Promise.all(d),this.pendingInLock.splice(0,d.length)}return await o}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(s){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await s(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let s=null;const n=await wr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?s=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!s)return{data:{session:null},error:null};const o=s.expires_at?s.expires_at*1e3-Date.now()<pu:!1;if(this._debug("#__loadSession()",`session has${o?"":" not"} expired`,"expires_at",s.expires_at),!o){if(this.userStorage){const f=await wr(this.userStorage,this.storageKey+"-user");f!=null&&f.user?s.user=f.user:s.user=xu()}if(this.storage.isServer&&s.user&&!s.user.__isUserNotAvailableProxy){const f={value:this.suppressGetSessionWarning};s.user=Lx(s.user,f),f.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:s},error:null}}const{data:d,error:h}=await this._callRefreshToken(s.refresh_token);return h?this._returnResult({data:{session:null},error:h}):this._returnResult({data:{session:d},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(s){if(s)return await this._getUser(s);await this.initializePromise;const n=await this._acquireLock(-1,async()=>await this._getUser());return n.data.user&&(this.suppressGetSessionWarning=!0),n}async _getUser(s){try{return s?await Me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:s,xform:ar}):await this._useSession(async n=>{var o,d,h;const{data:f,error:b}=n;if(b)throw b;return!(!((o=f.session)===null||o===void 0)&&o.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ka}:await Me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(h=(d=f.session)===null||d===void 0?void 0:d.access_token)!==null&&h!==void 0?h:void 0,xform:ar})})}catch(n){if(ke(n))return mx(n)&&(await this._removeSession(),await ra(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:n});throw n}}async updateUser(s,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(s,n))}async _updateUser(s,n={}){try{return await this._useSession(async o=>{const{data:d,error:h}=o;if(h)throw h;if(!d.session)throw new ka;const f=d.session;let b=null,g=null;this.flowType==="pkce"&&s.email!=null&&([b,g]=await hn(this.storage,this.storageKey));const{data:p,error:v}=await Me(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},s),{code_challenge:b,code_challenge_method:g}),jwt:f.access_token,xform:ar});if(v)throw v;return f.user=p.user,await this._saveSession(f),await this._notifyAllSubscribers("USER_UPDATED",f),this._returnResult({data:{user:f.user},error:null})})}catch(o){if(await ra(this.storage,`${this.storageKey}-code-verifier`),ke(o))return this._returnResult({data:{user:null},error:o});throw o}}async setSession(s){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(s))}async _setSession(s){try{if(!s.access_token||!s.refresh_token)throw new ka;const n=Date.now()/1e3;let o=n,d=!0,h=null;const{payload:f}=bu(s.access_token);if(f.exp&&(o=f.exp,d=o<=n),d){const{data:b,error:g}=await this._callRefreshToken(s.refresh_token);if(g)return this._returnResult({data:{user:null,session:null},error:g});if(!b)return{data:{user:null,session:null},error:null};h=b}else{const{data:b,error:g}=await this._getUser(s.access_token);if(g)throw g;h={access_token:s.access_token,refresh_token:s.refresh_token,user:b.user,token_type:"bearer",expires_in:o-n,expires_at:o},await this._saveSession(h),await this._notifyAllSubscribers("SIGNED_IN",h)}return this._returnResult({data:{user:h.user,session:h},error:null})}catch(n){if(ke(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}}async refreshSession(s){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(s))}async _refreshSession(s){try{return await this._useSession(async n=>{var o;if(!s){const{data:f,error:b}=n;if(b)throw b;s=(o=f.session)!==null&&o!==void 0?o:void 0}if(!(s!=null&&s.refresh_token))throw new ka;const{data:d,error:h}=await this._callRefreshToken(s.refresh_token);return h?this._returnResult({data:{user:null,session:null},error:h}):d?this._returnResult({data:{user:d.user,session:d},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(n){if(ke(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async _getSessionFromURL(s,n){try{if(!na())throw new ql("No browser detected.");if(s.error||s.error_description||s.error_code)throw new ql(s.error_description||"Error in URL with unspecified error_description",{error:s.error||"unspecified_error",code:s.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new Km("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ql("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!s.code)throw new Km("No code detected.");const{data:O,error:N}=await this._exchangeCodeForSession(s.code);if(N)throw N;const G=new URL(window.location.href);return G.searchParams.delete("code"),window.history.replaceState(window.history.state,"",G.toString()),{data:{session:O.session,redirectType:null},error:null}}const{provider_token:o,provider_refresh_token:d,access_token:h,refresh_token:f,expires_in:b,expires_at:g,token_type:p}=s;if(!h||!b||!f||!p)throw new ql("No session defined in URL");const v=Math.round(Date.now()/1e3),x=parseInt(b);let _=v+x;g&&(_=parseInt(g));const j=_-v;j*1e3<=xn&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${j}s, should have been closer to ${x}s`);const C=_-x;v-C>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",C,_,v):v-C<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",C,_,v);const{data:z,error:M}=await this._getUser(h);if(M)throw M;const E={provider_token:o,provider_refresh_token:d,access_token:h,expires_in:x,expires_at:_,refresh_token:f,token_type:p,user:z.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:E,redirectType:s.type},error:null})}catch(o){if(ke(o))return this._returnResult({data:{session:null,redirectType:null},error:o});throw o}}_isImplicitGrantCallback(s){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),s):!!(s.access_token||s.error_description)}async _isPKCECallback(s){const n=await wr(this.storage,`${this.storageKey}-code-verifier`);return!!(s.code&&n)}async signOut(s={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(s))}async _signOut({scope:s}={scope:"global"}){return await this._useSession(async n=>{var o;const{data:d,error:h}=n;if(h)return this._returnResult({error:h});const f=(o=d.session)===null||o===void 0?void 0:o.access_token;if(f){const{error:b}=await this.admin.signOut(f,s);if(b&&!(fx(b)&&(b.status===404||b.status===401||b.status===403)))return this._returnResult({error:b})}return s!=="others"&&(await this._removeSession(),await ra(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(s){const n=_x(),o={id:n,callback:s,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,o),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:o}}}async _emitInitialSession(s){return await this._useSession(async n=>{var o,d;try{const{data:{session:h},error:f}=n;if(f)throw f;await((o=this.stateChangeEmitters.get(s))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",h)),this._debug("INITIAL_SESSION","callback id",s,"session",h)}catch(h){await((d=this.stateChangeEmitters.get(s))===null||d===void 0?void 0:d.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",s,"error",h),console.error(h)}})}async resetPasswordForEmail(s,n={}){let o=null,d=null;this.flowType==="pkce"&&([o,d]=await hn(this.storage,this.storageKey,!0));try{return await Me(this.fetch,"POST",`${this.url}/recover`,{body:{email:s,code_challenge:o,code_challenge_method:d,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(h){if(await ra(this.storage,`${this.storageKey}-code-verifier`),ke(h))return this._returnResult({data:null,error:h});throw h}}async getUserIdentities(){var s;try{const{data:n,error:o}=await this.getUser();if(o)throw o;return this._returnResult({data:{identities:(s=n.user.identities)!==null&&s!==void 0?s:[]},error:null})}catch(n){if(ke(n))return this._returnResult({data:null,error:n});throw n}}async linkIdentity(s){return"token"in s?this.linkIdentityIdToken(s):this.linkIdentityOAuth(s)}async linkIdentityOAuth(s){var n;try{const{data:o,error:d}=await this._useSession(async h=>{var f,b,g,p,v;const{data:x,error:_}=h;if(_)throw _;const j=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,s.provider,{redirectTo:(f=s.options)===null||f===void 0?void 0:f.redirectTo,scopes:(b=s.options)===null||b===void 0?void 0:b.scopes,queryParams:(g=s.options)===null||g===void 0?void 0:g.queryParams,skipBrowserRedirect:!0});return await Me(this.fetch,"GET",j,{headers:this.headers,jwt:(v=(p=x.session)===null||p===void 0?void 0:p.access_token)!==null&&v!==void 0?v:void 0})});if(d)throw d;return na()&&!(!((n=s.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(o==null?void 0:o.url),this._returnResult({data:{provider:s.provider,url:o==null?void 0:o.url},error:null})}catch(o){if(ke(o))return this._returnResult({data:{provider:s.provider,url:null},error:o});throw o}}async linkIdentityIdToken(s){return await this._useSession(async n=>{var o;try{const{error:d,data:{session:h}}=n;if(d)throw d;const{options:f,provider:b,token:g,access_token:p,nonce:v}=s,x=await Me(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(o=h==null?void 0:h.access_token)!==null&&o!==void 0?o:void 0,body:{provider:b,id_token:g,access_token:p,nonce:v,link_identity:!0,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Wa}),{data:_,error:j}=x;return j?this._returnResult({data:{user:null,session:null},error:j}):!_||!_.session||!_.user?this._returnResult({data:{user:null,session:null},error:new dn}):(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("USER_UPDATED",_.session)),this._returnResult({data:_,error:j}))}catch(d){if(await ra(this.storage,`${this.storageKey}-code-verifier`),ke(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}})}async unlinkIdentity(s){try{return await this._useSession(async n=>{var o,d;const{data:h,error:f}=n;if(f)throw f;return await Me(this.fetch,"DELETE",`${this.url}/user/identities/${s.identity_id}`,{headers:this.headers,jwt:(d=(o=h.session)===null||o===void 0?void 0:o.access_token)!==null&&d!==void 0?d:void 0})})}catch(n){if(ke(n))return this._returnResult({data:null,error:n});throw n}}async _refreshAccessToken(s){const n=`#_refreshAccessToken(${s.substring(0,5)}...)`;this._debug(n,"begin");try{const o=Date.now();return await Tx(async d=>(d>0&&await Ex(200*Math.pow(2,d-1)),this._debug(n,"refreshing attempt",d),await Me(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:s},headers:this.headers,xform:Wa})),(d,h)=>{const f=200*Math.pow(2,d);return h&&gu(h)&&Date.now()+f-o<xn})}catch(o){if(this._debug(n,"error",o),ke(o))return this._returnResult({data:{session:null,user:null},error:o});throw o}finally{this._debug(n,"end")}}_isValidSession(s){return typeof s=="object"&&s!==null&&"access_token"in s&&"refresh_token"in s&&"expires_at"in s}async _handleProviderSignIn(s,n){const o=await this._getUrlForProvider(`${this.url}/authorize`,s,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",s,"options",n,"url",o),na()&&!n.skipBrowserRedirect&&window.location.assign(o),{data:{provider:s,url:o},error:null}}async _recoverAndRefresh(){var s,n;const o="#_recoverAndRefresh()";this._debug(o,"begin");try{const d=await wr(this.storage,this.storageKey);if(d&&this.userStorage){let f=await wr(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!f&&(f={user:d.user},await yn(this.userStorage,this.storageKey+"-user",f)),d.user=(s=f==null?void 0:f.user)!==null&&s!==void 0?s:xu()}else if(d&&!d.user&&!d.user){const f=await wr(this.storage,this.storageKey+"-user");f&&(f!=null&&f.user)?(d.user=f.user,await ra(this.storage,this.storageKey+"-user"),await yn(this.storage,this.storageKey,d)):d.user=xu()}if(this._debug(o,"session from storage",d),!this._isValidSession(d)){this._debug(o,"session is not valid"),d!==null&&await this._removeSession();return}const h=((n=d.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<pu;if(this._debug(o,`session has${h?"":" not"} expired with margin of ${pu}s`),h){if(this.autoRefreshToken&&d.refresh_token){const{error:f}=await this._callRefreshToken(d.refresh_token);f&&(console.error(f),gu(f)||(this._debug(o,"refresh failed with a non-retryable error, removing the session",f),await this._removeSession()))}}else if(d.user&&d.user.__isUserNotAvailableProxy===!0)try{const{data:f,error:b}=await this._getUser(d.access_token);!b&&(f!=null&&f.user)?(d.user=f.user,await this._saveSession(d),await this._notifyAllSubscribers("SIGNED_IN",d)):this._debug(o,"could not get user data, skipping SIGNED_IN notification")}catch(f){console.error("Error getting user data:",f),this._debug(o,"error getting user data, skipping SIGNED_IN notification",f)}else await this._notifyAllSubscribers("SIGNED_IN",d)}catch(d){this._debug(o,"error",d),console.error(d);return}finally{this._debug(o,"end")}}async _callRefreshToken(s){var n,o;if(!s)throw new ka;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const d=`#_callRefreshToken(${s.substring(0,5)}...)`;this._debug(d,"begin");try{this.refreshingDeferred=new Zl;const{data:h,error:f}=await this._refreshAccessToken(s);if(f)throw f;if(!h.session)throw new ka;await this._saveSession(h.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",h.session);const b={data:h.session,error:null};return this.refreshingDeferred.resolve(b),b}catch(h){if(this._debug(d,"error",h),ke(h)){const f={data:null,error:h};return gu(h)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(f),f}throw(o=this.refreshingDeferred)===null||o===void 0||o.reject(h),h}finally{this.refreshingDeferred=null,this._debug(d,"end")}}async _notifyAllSubscribers(s,n,o=!0){const d=`#_notifyAllSubscribers(${s})`;this._debug(d,"begin",n,`broadcast = ${o}`);try{this.broadcastChannel&&o&&this.broadcastChannel.postMessage({event:s,session:n});const h=[],f=Array.from(this.stateChangeEmitters.values()).map(async b=>{try{await b.callback(s,n)}catch(g){h.push(g)}});if(await Promise.all(f),h.length>0){for(let b=0;b<h.length;b+=1)console.error(h[b]);throw h[0]}}finally{this._debug(d,"end")}}async _saveSession(s){this._debug("#_saveSession()",s),this.suppressGetSessionWarning=!0,await ra(this.storage,`${this.storageKey}-code-verifier`);const n=Object.assign({},s),o=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!o&&n.user&&await yn(this.userStorage,this.storageKey+"-user",{user:n.user});const d=Object.assign({},n);delete d.user;const h=Xm(d);await yn(this.storage,this.storageKey,h)}else{const d=Xm(n);await yn(this.storage,this.storageKey,d)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await ra(this.storage,this.storageKey),await ra(this.storage,this.storageKey+"-code-verifier"),await ra(this.storage,this.storageKey+"-user"),this.userStorage&&await ra(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const s=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{s&&na()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",s)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const s=setInterval(()=>this._autoRefreshTokenTick(),xn);this.autoRefreshTicker=s,s&&typeof s=="object"&&typeof s.unref=="function"?s.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(s),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const s=this.autoRefreshTicker;this.autoRefreshTicker=null,s&&clearInterval(s)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const s=Date.now();try{return await this._useSession(async n=>{const{data:{session:o}}=n;if(!o||!o.refresh_token||!o.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const d=Math.floor((o.expires_at*1e3-s)/xn);this._debug("#_autoRefreshTokenTick()",`access token expires in ${d} ticks, a tick lasts ${xn}ms, refresh threshold is ${Au} ticks`),d<=Au&&await this._callRefreshToken(o.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(s){if(s.isAcquireTimeout||s instanceof Sp)this._debug("auto refresh token tick lock not available");else throw s}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!na()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(s){console.error("_handleVisibilityChange",s)}}async _onVisibilityChanged(s){const n=`#_onVisibilityChanged(${s})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),s||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(s,n,o){const d=[`provider=${encodeURIComponent(n)}`];if(o!=null&&o.redirectTo&&d.push(`redirect_to=${encodeURIComponent(o.redirectTo)}`),o!=null&&o.scopes&&d.push(`scopes=${encodeURIComponent(o.scopes)}`),this.flowType==="pkce"){const[h,f]=await hn(this.storage,this.storageKey),b=new URLSearchParams({code_challenge:`${encodeURIComponent(h)}`,code_challenge_method:`${encodeURIComponent(f)}`});d.push(b.toString())}if(o!=null&&o.queryParams){const h=new URLSearchParams(o.queryParams);d.push(h.toString())}return o!=null&&o.skipBrowserRedirect&&d.push(`skip_http_redirect=${o.skipBrowserRedirect}`),`${s}?${d.join("&")}`}async _unenroll(s){try{return await this._useSession(async n=>{var o;const{data:d,error:h}=n;return h?this._returnResult({data:null,error:h}):await Me(this.fetch,"DELETE",`${this.url}/factors/${s.factorId}`,{headers:this.headers,jwt:(o=d==null?void 0:d.session)===null||o===void 0?void 0:o.access_token})})}catch(n){if(ke(n))return this._returnResult({data:null,error:n});throw n}}async _enroll(s){try{return await this._useSession(async n=>{var o,d;const{data:h,error:f}=n;if(f)return this._returnResult({data:null,error:f});const b=Object.assign({friendly_name:s.friendlyName,factor_type:s.factorType},s.factorType==="phone"?{phone:s.phone}:s.factorType==="totp"?{issuer:s.issuer}:{}),{data:g,error:p}=await Me(this.fetch,"POST",`${this.url}/factors`,{body:b,headers:this.headers,jwt:(o=h==null?void 0:h.session)===null||o===void 0?void 0:o.access_token});return p?this._returnResult({data:null,error:p}):(s.factorType==="totp"&&g.type==="totp"&&(!((d=g==null?void 0:g.totp)===null||d===void 0)&&d.qr_code)&&(g.totp.qr_code=`data:image/svg+xml;utf-8,${g.totp.qr_code}`),this._returnResult({data:g,error:null}))})}catch(n){if(ke(n))return this._returnResult({data:null,error:n});throw n}}async _verify(s){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var o;const{data:d,error:h}=n;if(h)return this._returnResult({data:null,error:h});const f=Object.assign({challenge_id:s.challengeId},"webauthn"in s?{webauthn:Object.assign(Object.assign({},s.webauthn),{credential_response:s.webauthn.type==="create"?sy(s.webauthn.credential_response):ry(s.webauthn.credential_response)})}:{code:s.code}),{data:b,error:g}=await Me(this.fetch,"POST",`${this.url}/factors/${s.factorId}/verify`,{body:f,headers:this.headers,jwt:(o=d==null?void 0:d.session)===null||o===void 0?void 0:o.access_token});return g?this._returnResult({data:null,error:g}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+b.expires_in},b)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",b),this._returnResult({data:b,error:g}))})}catch(n){if(ke(n))return this._returnResult({data:null,error:n});throw n}})}async _challenge(s){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var o;const{data:d,error:h}=n;if(h)return this._returnResult({data:null,error:h});const f=await Me(this.fetch,"POST",`${this.url}/factors/${s.factorId}/challenge`,{body:s,headers:this.headers,jwt:(o=d==null?void 0:d.session)===null||o===void 0?void 0:o.access_token});if(f.error)return f;const{data:b}=f;if(b.type!=="webauthn")return{data:b,error:null};switch(b.webauthn.type){case"create":return{data:Object.assign(Object.assign({},b),{webauthn:Object.assign(Object.assign({},b.webauthn),{credential_options:Object.assign(Object.assign({},b.webauthn.credential_options),{publicKey:ty(b.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},b),{webauthn:Object.assign(Object.assign({},b.webauthn),{credential_options:Object.assign(Object.assign({},b.webauthn.credential_options),{publicKey:ay(b.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(n){if(ke(n))return this._returnResult({data:null,error:n});throw n}})}async _challengeAndVerify(s){const{data:n,error:o}=await this._challenge({factorId:s.factorId});return o?this._returnResult({data:null,error:o}):await this._verify({factorId:s.factorId,challengeId:n.id,code:s.code})}async _listFactors(){var s;const{data:{user:n},error:o}=await this.getUser();if(o)return{data:null,error:o};const d={all:[],phone:[],totp:[],webauthn:[]};for(const h of(s=n==null?void 0:n.factors)!==null&&s!==void 0?s:[])d.all.push(h),h.status==="verified"&&d[h.factor_type].push(h);return{data:d,error:null}}async _getAuthenticatorAssuranceLevel(){var s,n;const{data:{session:o},error:d}=await this.getSession();if(d)return this._returnResult({data:null,error:d});if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:h}=bu(o.access_token);let f=null;h.aal&&(f=h.aal);let b=f;((n=(s=o.user.factors)===null||s===void 0?void 0:s.filter(v=>v.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(b="aal2");const p=h.amr||[];return{data:{currentLevel:f,nextLevel:b,currentAuthenticationMethods:p},error:null}}async _getAuthorizationDetails(s){try{return await this._useSession(async n=>{const{data:{session:o},error:d}=n;return d?this._returnResult({data:null,error:d}):o?await Me(this.fetch,"GET",`${this.url}/oauth/authorizations/${s}`,{headers:this.headers,jwt:o.access_token,xform:h=>({data:h,error:null})}):this._returnResult({data:null,error:new ka})})}catch(n){if(ke(n))return this._returnResult({data:null,error:n});throw n}}async _approveAuthorization(s,n){try{return await this._useSession(async o=>{const{data:{session:d},error:h}=o;if(h)return this._returnResult({data:null,error:h});if(!d)return this._returnResult({data:null,error:new ka});const f=await Me(this.fetch,"POST",`${this.url}/oauth/authorizations/${s}/consent`,{headers:this.headers,jwt:d.access_token,body:{action:"approve"},xform:b=>({data:b,error:null})});return f.data&&f.data.redirect_url&&na()&&!(n!=null&&n.skipBrowserRedirect)&&window.location.assign(f.data.redirect_url),f})}catch(o){if(ke(o))return this._returnResult({data:null,error:o});throw o}}async _denyAuthorization(s,n){try{return await this._useSession(async o=>{const{data:{session:d},error:h}=o;if(h)return this._returnResult({data:null,error:h});if(!d)return this._returnResult({data:null,error:new ka});const f=await Me(this.fetch,"POST",`${this.url}/oauth/authorizations/${s}/consent`,{headers:this.headers,jwt:d.access_token,body:{action:"deny"},xform:b=>({data:b,error:null})});return f.data&&f.data.redirect_url&&na()&&!(n!=null&&n.skipBrowserRedirect)&&window.location.assign(f.data.redirect_url),f})}catch(o){if(ke(o))return this._returnResult({data:null,error:o});throw o}}async _listOAuthGrants(){try{return await this._useSession(async s=>{const{data:{session:n},error:o}=s;return o?this._returnResult({data:null,error:o}):n?await Me(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,xform:d=>({data:d,error:null})}):this._returnResult({data:null,error:new ka})})}catch(s){if(ke(s))return this._returnResult({data:null,error:s});throw s}}async _revokeOAuthGrant(s){try{return await this._useSession(async n=>{const{data:{session:o},error:d}=n;return d?this._returnResult({data:null,error:d}):o?(await Me(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:o.access_token,query:{client_id:s.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new ka})})}catch(n){if(ke(n))return this._returnResult({data:null,error:n});throw n}}async fetchJwk(s,n={keys:[]}){let o=n.keys.find(b=>b.kid===s);if(o)return o;const d=Date.now();if(o=this.jwks.keys.find(b=>b.kid===s),o&&this.jwks_cached_at+dx>d)return o;const{data:h,error:f}=await Me(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(f)throw f;return!h.keys||h.keys.length===0||(this.jwks=h,this.jwks_cached_at=d,o=h.keys.find(b=>b.kid===s),!o)?null:o}async getClaims(s,n={}){try{let o=s;if(!o){const{data:j,error:C}=await this.getSession();if(C||!j.session)return this._returnResult({data:null,error:C});o=j.session.access_token}const{header:d,payload:h,signature:f,raw:{header:b,payload:g}}=bu(o);n!=null&&n.allowExpired||Mx(h.exp);const p=!d.alg||d.alg.startsWith("HS")||!d.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(d.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!p){const{error:j}=await this.getUser(o);if(j)throw j;return{data:{claims:h,header:d,signature:f},error:null}}const v=Dx(d.alg),x=await crypto.subtle.importKey("jwk",p,v,!0,["verify"]);if(!await crypto.subtle.verify(v,x,f,wx(`${b}.${g}`)))throw new Cu("Invalid JWT signature");return{data:{claims:h,header:d,signature:f},error:null}}catch(o){if(ke(o))return this._returnResult({data:null,error:o});throw o}}}wi.nextInstanceID={};const fy=wi,my="2.89.0";let mi="";typeof Deno<"u"?mi="deno":typeof document<"u"?mi="web":typeof navigator<"u"&&navigator.product==="ReactNative"?mi="react-native":mi="node";const py={"X-Client-Info":`supabase-js-${mi}/${my}`},gy={headers:py},by={schema:"public"},xy={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},yy={};function ji(l){"@babel/helpers - typeof";return ji=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},ji(l)}function vy(l,s){if(ji(l)!="object"||!l)return l;var n=l[Symbol.toPrimitive];if(n!==void 0){var o=n.call(l,s);if(ji(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(l)}function wy(l){var s=vy(l,"string");return ji(s)=="symbol"?s:s+""}function jy(l,s,n){return(s=wy(s))in l?Object.defineProperty(l,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):l[s]=n,l}function rp(l,s){var n=Object.keys(l);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(l);s&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(l,d).enumerable})),n.push.apply(n,o)}return n}function Lt(l){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?rp(Object(n),!0).forEach(function(o){jy(l,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(n)):rp(Object(n)).forEach(function(o){Object.defineProperty(l,o,Object.getOwnPropertyDescriptor(n,o))})}return l}const _y=l=>l?(...s)=>l(...s):(...s)=>fetch(...s),Ny=()=>Headers,Sy=(l,s,n)=>{const o=_y(n),d=Ny();return async(h,f)=>{var b;const g=(b=await s())!==null&&b!==void 0?b:l;let p=new d(f==null?void 0:f.headers);return p.has("apikey")||p.set("apikey",l),p.has("Authorization")||p.set("Authorization",`Bearer ${g}`),o(h,Lt(Lt({},f),{},{headers:p}))}};function Ey(l){return l.endsWith("/")?l:l+"/"}function Ty(l,s){var n,o;const{db:d,auth:h,realtime:f,global:b}=l,{db:g,auth:p,realtime:v,global:x}=s,_={db:Lt(Lt({},g),d),auth:Lt(Lt({},p),h),realtime:Lt(Lt({},v),f),storage:{},global:Lt(Lt(Lt({},x),b),{},{headers:Lt(Lt({},(n=x==null?void 0:x.headers)!==null&&n!==void 0?n:{}),(o=b==null?void 0:b.headers)!==null&&o!==void 0?o:{})}),accessToken:async()=>""};return l.accessToken?_.accessToken=l.accessToken:delete _.accessToken,_}function Ay(l){const s=l==null?void 0:l.trim();if(!s)throw new Error("supabaseUrl is required.");if(!s.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Ey(s))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var ky=class extends fy{constructor(l){super(l)}},Oy=class{constructor(l,s,n){var o,d;this.supabaseUrl=l,this.supabaseKey=s;const h=Ay(l);if(!s)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",h),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",h),this.storageUrl=new URL("storage/v1",h),this.functionsUrl=new URL("functions/v1",h);const f=`sb-${h.hostname.split(".")[0]}-auth-token`,b={db:by,realtime:yy,auth:Lt(Lt({},xy),{},{storageKey:f}),global:gy},g=Ty(n??{},b);if(this.storageKey=(o=g.auth.storageKey)!==null&&o!==void 0?o:"",this.headers=(d=g.global.headers)!==null&&d!==void 0?d:{},g.accessToken)this.accessToken=g.accessToken,this.auth=new Proxy({},{get:(v,x)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(x)} is not possible`)}});else{var p;this.auth=this._initSupabaseAuthClient((p=g.auth)!==null&&p!==void 0?p:{},this.headers,g.global.fetch)}this.fetch=Sy(s,this._getAccessToken.bind(this),g.global.fetch),this.realtime=this._initRealtimeClient(Lt({headers:this.headers,accessToken:this._getAccessToken.bind(this)},g.realtime)),this.accessToken&&this.accessToken().then(v=>this.realtime.setAuth(v)).catch(v=>console.warn("Failed to set initial Realtime auth token:",v)),this.rest=new cb(new URL("rest/v1",h).href,{headers:this.headers,schema:g.db.schema,fetch:this.fetch}),this.storage=new ix(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),g.accessToken||this._listenForAuthEvents()}get functions(){return new rb(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(l){return this.rest.from(l)}schema(l){return this.rest.schema(l)}rpc(l,s={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(l,s,n)}channel(l,s={config:{}}){return this.realtime.channel(l,s)}getChannels(){return this.realtime.getChannels()}removeChannel(l){return this.realtime.removeChannel(l)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var l=this,s,n;if(l.accessToken)return await l.accessToken();const{data:o}=await l.auth.getSession();return(s=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:l.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:l,persistSession:s,detectSessionInUrl:n,storage:o,userStorage:d,storageKey:h,flowType:f,lock:b,debug:g,throwOnError:p},v,x){const _={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new ky({url:this.authUrl.href,headers:Lt(Lt({},_),v),storageKey:h,autoRefreshToken:l,persistSession:s,detectSessionInUrl:n,storage:o,userStorage:d,flowType:f,lock:b,debug:g,throwOnError:p,fetch:x,hasCustomAuthorizationHeader:Object.keys(this.headers).some(j=>j.toLowerCase()==="authorization")})}_initRealtimeClient(l){return new Eb(this.realtimeUrl.href,Lt(Lt({},l),{},{params:Lt(Lt({},{apikey:this.supabaseKey}),l==null?void 0:l.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((l,s)=>{this._handleTokenChanged(l,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(l,s,n){(l==="TOKEN_REFRESHED"||l==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):l==="SIGNED_OUT"&&(this.realtime.setAuth(),s=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const Cy=(l,s,n)=>new Oy(l,s,n);function Ry(){if(typeof window<"u"||typeof process>"u")return!1;const l=process.version;if(l==null)return!1;const s=l.match(/^v(\d+)\./);return s?parseInt(s[1],10)<=18:!1}Ry()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const zy="https://roouxunjcwzrqwyusari.supabase.co",My="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJvb3V4dW5qY3d6cnF3eXVzYXJpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcwMTQxMzEsImV4cCI6MjA4MjU5MDEzMX0.wDnCr8Qhmwz-asqdY2gcC84KRqjpJIKxi5rlfL4H_Uo",ue=Cy(zy,My),Dy=async()=>"Notification"in window?Notification.permission==="granted"?!0:Notification.permission!=="denied"?await Notification.requestPermission()==="granted":!1:(console.log("This browser does not support desktop notification"),!1),np=(l,s,n)=>{if(Notification.permission==="granted")try{navigator.vibrate&&navigator.vibrate([200,100,200]);const o={body:s,icon:n||"/kosmo/icons/icon-192x192.png",vibrate:[200,100,200],tag:"kosmo-alert"};new Notification(l,o)}catch(o){console.error("Notification error:",o)}};var le=(l=>(l.METAL_MINE="metalMine",l.CRYSTAL_MINE="crystalMine",l.DEUTERIUM_SYNTH="deuteriumSynth",l.SOLAR_PLANT="solarPlant",l.FUSION_REACTOR="fusionReactor",l.ROBOT_FACTORY="robotFactory",l.SHIPYARD="shipyard",l.RESEARCH_LAB="researchLab",l.METAL_STORAGE="metalStorage",l.CRYSTAL_STORAGE="crystalStorage",l.DEUTERIUM_TANK="deuteriumTank",l))(le||{}),xe=(l=>(l.ENERGY_TECH="energyTech",l.LASER_TECH="laserTech",l.ION_TECH="ionTech",l.HYPERSPACE_TECH="hyperspaceTech",l.PLASMA_TECH="plasmaTech",l.COMBUSTION_DRIVE="combustionDrive",l.IMPULSE_DRIVE="impulseDrive",l.HYPERSPACE_DRIVE="hyperspaceDrive",l.ESPIONAGE_TECH="espionageTech",l.COMPUTER_TECH="computerTech",l.ASTROPHYSICS="astrophysics",l.WEAPON_TECH="weaponTech",l.SHIELDING_TECH="shieldingTech",l.ARMOUR_TECH="armourTech",l))(xe||{}),ce=(l=>(l.LIGHT_FIGHTER="lightFighter",l.HEAVY_FIGHTER="heavyFighter",l.CRUISER="cruiser",l.BATTLESHIP="battleship",l.DESTROYER="destroyer",l.DEATH_STAR="deathStar",l.SMALL_CARGO="smallCargo",l.MEDIUM_CARGO="mediumCargo",l.HUGE_CARGO="hugeCargo",l.COLONY_SHIP="colonyShip",l.ESPIONAGE_PROBE="espionageProbe",l.PIONEER="pioneer",l.RECYCLER="recycler",l))(ce||{}),Pt=(l=>(l.ROCKET_LAUNCHER="rocketLauncher",l.LIGHT_LASER="lightLaser",l.HEAVY_LASER="heavyLaser",l.GAUSS_CANNON="gaussCannon",l.ION_CANNON="ionCannon",l.PLASMA_TURRET="plasmaTurret",l.SMALL_SHIELD="smallShield",l.LARGE_SHIELD="largeShield",l))(Pt||{}),Ze=(l=>(l.EXPEDITION="expedition",l.ATTACK="attack",l.TRANSPORT="transport",l.SPY="spy",l.COLONIZE="colonize",l.RECYCLE="recycle",l))(Ze||{});const Ra=l=>{if(l<0)return"00:00";const s=Math.floor(l/3600),n=Math.floor(l%3600/60),o=Math.floor(l%60);return s>0?`${s}:${n.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`:`${n.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`},He={avatar:"/kosmo/avatars/avatar_default.png",planet:"https://lh3.googleusercontent.com/aida-public/AB6AXuBSLdQjiDuWVTAfBaEU-HCuYBah9ZQiEwQ-pDEofrc4cE_VxNy9QrAshJikmgoDRsSiufik3xpY-aK01ZyAD-oMT7oiGEoiGMpFWgFdZ7P3A8bg6_W71He4ede4ePe-0BNBFOYzd9apqH_IBj5ZXTOU7lbf7qfnmAK01iO7b2ckjVagWx4YlZdAbeOGA1_vJMuSCRVCtupT_RNvx19THDplwxx3PvEcIgc4g0ljwPyZlPI8DaYq7UaMbOiwXHxzgV-oCUQBi8YwaGc",metalMine:"/kosmo/budowle/kopalniametalu.png",crystalMine:"/kosmo/budowle/kopalnia krysztalu.png",deuteriumSynth:"/kosmo/budowle/synterzator deuter.png",solarPlant:"/kosmo/budowle/elektrownia sloneczna.png",fusionReactor:"/kosmo/budowle/Reaktor Fuzyjny.png",robotFactory:"/kosmo/budowle/Fabryka Robotw.png",shipyard:"/kosmo/budowle/stocznia.png",researchLab:"/kosmo/budowle/Laboratorium Badawcz.png",metalStorage:"/kosmo/budowle/Magazyn MetaluKrysztau.png",crystalStorage:"/kosmo/budowle/Magazyn MetaluKrysztau.png",deuteriumTank:"/kosmo/budowle/zbiornik deuter.png",techEnergy:"https://lh3.googleusercontent.com/aida-public/AB6AXuAUsk_veHUVdI7Xyyen3wE1Sor8I2WXguf2jjbakOFbdtRfW9EJruiDvsIgX5IEW3yt01vrIYq_I5G3cqefGk7O7w9BvvVsHpHioXTKjEfTwaHGv1fWwoc4_coc6yXGitNBGAa3URR7KjlKaomN_pmSPD9Jalb9rxdmt1NRlt2b98OZQVQqii0zOOVaBBsICIos_bTfcnyMBW_tecAFg3TP9zzNghDVuvahMe87fSHyj_9wuv1y3NXeDTDGk2w8iBPZsl8B6D58Jhg",techLaser:"https://lh3.googleusercontent.com/aida-public/AB6AXuCttLEph3WsOd3HRlZC0zxgyo5HtGQLhoc_Nr46u_bMbqY6nTEQYuIV_gyR_hpfVBS-J_jj5GGZynbPPZti1oj5iZ3eOY_YBYNi3q8nw6c4ebgmqCgJnaJhFtJwFfpNu4nYT65VMgmQkWQU-ek95Y5Ue6RnI9LCcYQpDhod0Y_eUiJYtnqiu9_aD-u_ukPsujkP5hgKqFchbR8vhUje3E-LrA80lMR4QTQEfNKXUDobsJRFGe11_CQSYumUsrXBnYunhGfRGvl2epw",techIon:"https://lh3.googleusercontent.com/aida-public/AB6AXuAUsk_veHUVdI7Xyyen3wE1Sor8I2WXguf2jjbakOFbdtRfW9EJruiDvsIgX5IEW3yt01vrIYq_I5G3cqefGk7O7w9BvvVsHpHioXTKjEfTwaHGv1fWwoc4_coc6yXGitNBGAa3URR7KjlKaomN_pmSPD9Jalb9rxdmt1NRlt2b98OZQVQqii0zOOVaBBsICIos_bTfcnyMBW_tecAFg3TP9zzNghDVuvahMe87fSHyj_9wuv1y3NXeDTDGk2w8iBPZsl8B6D58Jhg",techHyper:"https://lh3.googleusercontent.com/aida-public/AB6AXuC_5G35L8rN6N_8x173o5o3z6c0K8P5w2Z4s7Y8l9X0M2b5Q3v6R4t8J9L1K5N7P4Q2M6v8L3z9J0x5N2k8R7w9M4P1L6O3v8K5N7Q2M6v8L3z9J0x5N2k8R7w9M4P1L6O3v8K5N7Q2",techCombustion:"https://lh3.googleusercontent.com/aida-public/AB6AXuDbgGTOOmYRO8Cx2O9AikzppzN9zC4-i7_FrPEcct-2C21HpEJmdGGu5Za7crC8JzzPSg7_h9whOWZrcV1uaeGNi-PRI2xgDrhQfv1_Lby8fBTWyDZhQ06O3AM6n76j_-cHlHjJLahmP4ygvJ-iwGSSXwntVJtmV76vprhB_mPDHFsOxjwoWadVZ5tBOQifnLzeGQYMb6Q00oYkbFwAD8554XNTDT0nmK16jTdF17V-MgWnK8RmGNBFkySydK0sEWwjYVjCScUCM6I",techImpulse:"https://lh3.googleusercontent.com/aida-public/AB6AXuCd2dUTqjUsAcUPQOTk2ukYe3jO6XM4-sDHF10X83-XP8vidQdYFHgCjpeNNuxHLjWuIETBVc4-tF48QBg635FXHK3OHl3XJtyBIkYhbuNKjm1gi-w5E5JBsKMfFkYYudLiRVf917sQBCIkRdhPmSnjKNUpHDiqn1OUmKVHK1oFpUAXDHKoc7NOKDMZCKLxm4p1GZhpnvu-GP9sZFnbzedCWMEBtk7KlYd6EiN0uuYs9gi5y-_MDWTKKT4NE1bSe52hWWJuZidIru8",techHyperDrive:"https://lh3.googleusercontent.com/aida-public/AB6AXuDbgGTOOmYRO8Cx2O9AikzppzN9zC4-i7_FrPEcct-2C21HpEJmdGGu5Za7crC8JzzPSg7_h9whOWZrcV1uaeGNi-PRI2xgDrhQfv1_Lby8fBTWyDZhQ06O3AM6n76j_-cHlHjJLahmP4ygvJ-iwGSSXwntVJtmV76vprhB_mPDHFsOxjwoWadVZ5tBOQifnLzeGQYMb6Q00oYkbFwAD8554XNTDT0nmK16jTdF17V-MgWnK8RmGNBFkySydK0sEWwjYVjCScUCM6I",techPlasma:"https://lh3.googleusercontent.com/aida-public/AB6AXuA5zJhoBmc9B_7K3kdzmS0jRGQ4TxTF1sKrsA0-Zxnv4gQMVzgicY3JzPKK5mAwCC1iuh4xUjsQTCiOr1frnHwM2FNQ59ZbM8gyFwJvf5kgN1Np1dDGsQP7vua8fW77DzSNOmAX7frp_E13Rt22KjtAxy61zJl5Drp2C1v4LUF1HPLKJqcHTdEO6D_s3q5ujXDXOR8tV0yHYqfY4Gjc1egtpZyY1hbpRfwcedU-Fd728-EDyp_LSAz12VFwRRaLGqsOpgXayb0dFUU",techEspionage:"https://lh3.googleusercontent.com/aida-public/AB6AXuAuzcKCcqW_Uwb_MHjDE4UnIS9iufqeQRG-ox9HOxWuvVuHaPFUOrPzlXsVC7PfwZ7MI1K-xoYXSIRYGuCSJskYUnvKDvMxqvSe3Gia4Hb2MB3OLyt_tMwvU9qvxgjTrPmM6wQypgXYMFoiUUJMXWeDDfXxHDYHBm1mxGIFog5PovvrH7Zb2U4gFbh_HAslZUcihLWiSiQi2WAG8mGqDZzKh4eaLLLitm105RayEmmJXCGVObylA3o_oKyx4bVz44Os-zM8jsZ59ng",techComputer:"https://lh3.googleusercontent.com/aida-public/AB6AXuCWhn2HXSCm5RHKMuQUw21Hw6EWLXbJVTX6WMPGH0zSgbJ5FrOtwFl3GoA7TburBE1sfekcUVJknBOryC06NelUAT8HKLx_GxRk7p7zy_6yTCsUIteUJ1P-m68zJ-LqyQZ_hz53P1KnKtNVNIoJZvor1YyzW2ZN49ItxXjuLoIAl6Run1afN28jy6tc9scmfRtvAzO2Ixv0SIek4-r4SWglDDGR-aZYAweEP3K9zyWk8ez2EY6n6s7_UCU10S04j1dHEXCQ6GDjpDc",techAstro:"https://lh3.googleusercontent.com/aida-public/AB6AXuBSOTflDav4MFvu_Yvg-9qCDKqpS6BwAJDvSFmXbaK1M4mBatMw8wpRPT_bROfe2lelYtoxtN-ew041hcpd7KHjnZTbZ7Ov1q8gvcDdQ-zV7WCHlysly8ohvQJqhXRh1J3QUSfnu95xoFJX3O50BjiNefxhrFKws1eSBVnIPiB0iOWl_S8NDWo5mwLU-rA0pT6VOakhtRCgKUZrJmDumK6NIAyB0H60AK5EdDlixy4qsNd1SagA7z0AUEAqWHF43uun44RCqVq1hOY",techWeapon:"https://lh3.googleusercontent.com/aida-public/AB6AXuCd2dUTqjUsAcUPQOTk2ukYe3jO6XM4-sDHF10X83-XP8vidQdYFHgCjpeNNuxHLjWuIETBVc4-tF48QBg635FXHK3OHl3XJtyBIkYhbuNKjm1gi-w5E5JBsKMfFkYYudLiRVf917sQBCIkRdhPmSnjKNUpHDiqn1OUmKVHK1oFpUAXDHKoc7NOKDMZCKLxm4p1GZhpnvu-GP9sZFnbzedCWMEBtk7KlYd6EiN0uuYs9gi5y-_MDWTKKT4NE1bSe52hWWJuZidIru8",techShield:"https://lh3.googleusercontent.com/aida-public/AB6AXuAUSEKlHxUvCzxVOgj1Y6MtxX1VhQuac5X-CQBCwdETPQW0ynuAd-uEVEWMCGnx7FyX7vOxy4epq_CKJImgHYAUcz04j5B4DL1cjdUqVefFWq4dFoTwzLUivuBxpd4Q1i7dnsLEZAlkOwXPiYSMTau5dTr7XWhZMcXfDAG4bloSSPGJYItXueBQ_uivo-IdPPh5ad4npHg32fLsQj__8JNmEc7rzx0kjjz3wz_upv0MPt66tV9BzNqd29cwpdNqoUhnRVHjteACKYU",techArmour:"https://lh3.googleusercontent.com/aida-public/AB6AXuDKFYodx8aYkS3L0_aZKv8NQVKCFFLEp_aIojke7fVSBUGfftz5yRPvF1fuXX4vvvHwtId36V6DzP398lKo5i9fDlbC3dgYH7qP5VhLyKyyn_n9D4fSyvnoiPHulQLtl5Do1YYRpVvhVcfGOS4IyPuY7dVya1qor3vSjhE-KsxkO9Nr0rKccvd0lp1OQYWa4fOwAJKWnx24KLrcu70jfMTpcUW-Fb5dXiBJkD9UFjV4B07Jr5EhFLNsjASa8zQIzRaxg3XKdJnmvFs",lightFighter:"/kosmo/ships/light_fighter.png",heavyFighter:"/kosmo/ships/heavy_fighter.png",cruiser:"/kosmo/ships/cruiser.png",battleship:"/kosmo/ships/battleship.png",destroyer:"/kosmo/ships/destroyer.png",deathStar:"/kosmo/ships/death_star.png",smallCargo:"/kosmo/ships/small_cargo.png",mediumCargo:"/kosmo/ships/medium_cargo.png",hugeCargo:"/kosmo/ships/huge_cargo.png",colonyShip:"/kosmo/ships/colony_ship.png",espionageProbe:"/kosmo/ships/espionage_probe.png",recycler:"/kosmo/ships/recycler.png",pioneer:"/kosmo/ships/pioneer.png"},Er={terran:"https://lh3.googleusercontent.com/aida-public/AB6AXuBSLdQjiDuWVTAfBaEU-HCuYBah9ZQiEwQ-pDEofrc4cE_VxNy9QrAshJikmgoDRsSiufik3xpY-aK01ZyAD-oMT7oiGEoiGMpFWgFdZ7P3A8bg6_W71He4ede4ePe-0BNBFOYzd9apqH_IBj5ZXTOU7lbf7qfnmAK01iO7b2ckjVagWx4YlZdAbeOGA1_vJMuSCRVCtupT_RNvx19THDplwxx3PvEcIgc4g0ljwPyZlPI8DaYq7UaMbOiwXHxzgV-oCUQBi8YwaGc",desert:"https://lh3.googleusercontent.com/aida-public/AB6AXuBSLdQjiDuWVTAfBaEU-HCuYBah9ZQiEwQ-pDEofrc4cE_VxNy9QrAshJikmgoDRsSiufik3xpY-aK01ZyAD-oMT7oiGEoiGMpFWgFdZ7P3A8bg6_W71He4ede4ePe-0BNBFOYzd9apqH_IBj5ZXTOU7lbf7qfnmAK01iO7b2ckjVagWx4YlZdAbeOGA1_vJMuSCRVCtupT_RNvx19THDplwxx3PvEcIgc4g0ljwPyZlPI8DaYq7UaMbOiwXHxzgV-oCUQBi8YwaGc",ice:"https://lh3.googleusercontent.com/aida-public/AB6AXuBSLdQjiDuWVTAfBaEU-HCuYBah9ZQiEwQ-pDEofrc4cE_VxNy9QrAshJikmgoDRsSiufik3xpY-aK01ZyAD-oMT7oiGEoiGMpFWgFdZ7P3A8bg6_W71He4ede4ePe-0BNBFOYzd9apqH_IBj5ZXTOU7lbf7qfnmAK01iO7b2ckjVagWx4YlZdAbeOGA1_vJMuSCRVCtupT_RNvx19THDplwxx3PvEcIgc4g0ljwPyZlPI8DaYq7UaMbOiwXHxzgV-oCUQBi8YwaGc",default:He.planet},st={[ce.LIGHT_FIGHTER]:{id:ce.LIGHT_FIGHTER,name:"Myliwiec Przechwytujcy",description:"Szybki i zwrotny myliwiec przechwytujcy, podstawa kadej floty.",baseCost:{metal:1e3,crystal:300,deuterium:0},image:He.lightFighter,buildTime:5,attack:80,defense:10,capacity:50,requirements:[{type:"building",id:le.SHIPYARD,level:1},{type:"research",id:xe.COMBUSTION_DRIVE,level:1}],bonuses:{[ce.DEATH_STAR]:2,[ce.ESPIONAGE_PROBE]:.5}},[ce.HEAVY_FIGHTER]:{id:ce.HEAVY_FIGHTER,name:"Myliwiec Szturmowy",description:"Ciej opancerzona wersja myliwca z silniejszym uzbrojeniem.",baseCost:{metal:2e3,crystal:1500,deuterium:0},image:He.heavyFighter,buildTime:10,attack:150,defense:25,capacity:100,requirements:[{type:"building",id:le.SHIPYARD,level:3},{type:"research",id:xe.IMPULSE_DRIVE,level:2}],bonuses:{[ce.LIGHT_FIGHTER]:.5,[ce.SMALL_CARGO]:.5}},[ce.CRUISER]:{id:ce.CRUISER,name:"Kanonierka",description:"Szybki okrt bojowy skuteczny przeciwko lekkim myliwcom.",baseCost:{metal:6e3,crystal:2500,deuterium:500},image:He.cruiser,buildTime:30,attack:400,defense:50,capacity:800,requirements:[{type:"building",id:le.SHIPYARD,level:5},{type:"research",id:xe.ION_TECH,level:2},{type:"research",id:xe.IMPULSE_DRIVE,level:4}],bonuses:{[ce.LIGHT_FIGHTER]:1,[ce.HEAVY_FIGHTER]:.5,[ce.ESPIONAGE_PROBE]:1}},[ce.BATTLESHIP]:{id:ce.BATTLESHIP,name:"Niszczyciel Klasy A",description:"Potna jednostka bojowa o ogromnej sile ognia.",baseCost:{metal:15e3,crystal:5e3,deuterium:0},image:He.battleship,buildTime:60,attack:1e3,defense:200,capacity:1500,requirements:[{type:"building",id:le.SHIPYARD,level:7},{type:"research",id:xe.HYPERSPACE_DRIVE,level:4}],bonuses:{[ce.CRUISER]:.5,[ce.HEAVY_FIGHTER]:.3,[ce.SMALL_CARGO]:.5,[ce.MEDIUM_CARGO]:.5,[ce.HUGE_CARGO]:.5}},[ce.DESTROYER]:{id:ce.DESTROYER,name:"Drednot",description:"Krl pola bitwy. Niszczy lekkie statki w mgnieniu oka.",baseCost:{metal:2e4,crystal:17e3,deuterium:5e3},image:He.destroyer,buildTime:90,attack:2e3,defense:500,capacity:2e3,requirements:[{type:"building",id:le.SHIPYARD,level:9},{type:"research",id:xe.HYPERSPACE_DRIVE,level:6},{type:"research",id:xe.HYPERSPACE_TECH,level:5}],bonuses:{[ce.BATTLESHIP]:.5,[ce.CRUISER]:.5,[ce.LIGHT_FIGHTER]:.5,[Pt.LIGHT_LASER]:1,[Pt.ROCKET_LAUNCHER]:1}},[ce.DEATH_STAR]:{id:ce.DEATH_STAR,name:"Leviathan",description:"Mobilna stacja bojowa klasy Leviathan. Zdolna niszczy cae ksiyce.",baseCost:{metal:5e6,crystal:4e6,deuterium:1e6},image:He.deathStar,buildTime:1e3,attack:2e5,defense:1e5,capacity:1e6,requirements:[{type:"building",id:le.SHIPYARD,level:12},{type:"research",id:xe.HYPERSPACE_DRIVE,level:7},{type:"research",id:xe.ASTROPHYSICS,level:5}],bonuses:{[ce.DESTROYER]:1,[ce.BATTLESHIP]:1,[ce.HUGE_CARGO]:1,[ce.ESPIONAGE_PROBE]:10,[Pt.GAUSS_CANNON]:1,[Pt.ION_CANNON]:1,[Pt.PLASMA_TURRET]:1,[Pt.LARGE_SHIELD]:1,[Pt.SMALL_SHIELD]:1,[Pt.HEAVY_LASER]:1,[Pt.LIGHT_LASER]:1,[Pt.ROCKET_LAUNCHER]:1}},[ce.SMALL_CARGO]:{id:ce.SMALL_CARGO,name:"May Transporter",description:"Podstawowa jednostka do transportu surowcw na inne planety.",baseCost:{metal:500,crystal:500,deuterium:0},image:He.smallCargo,buildTime:5,attack:5,defense:10,capacity:5e3,requirements:[{type:"building",id:le.SHIPYARD,level:2},{type:"research",id:xe.COMBUSTION_DRIVE,level:2}]},[ce.MEDIUM_CARGO]:{id:ce.MEDIUM_CARGO,name:"redni Transporter",description:"Zbalansowany statek transportowy o wikszej pojemnoci.",baseCost:{metal:1500,crystal:1500,deuterium:0},image:He.mediumCargo,buildTime:10,attack:10,defense:25,capacity:12e3,requirements:[{type:"building",id:le.SHIPYARD,level:4},{type:"research",id:xe.COMBUSTION_DRIVE,level:4}]},[ce.HUGE_CARGO]:{id:ce.HUGE_CARGO,name:"Ogromny Transporter",description:"Kolos transportowy zdolny przewie zasoby caej kolonii.",baseCost:{metal:7e3,crystal:7e3,deuterium:500},image:He.hugeCargo,buildTime:25,attack:25,defense:100,capacity:5e4,requirements:[{type:"building",id:le.SHIPYARD,level:8},{type:"research",id:xe.IMPULSE_DRIVE,level:6}]},[ce.COLONY_SHIP]:{id:ce.COLONY_SHIP,name:"Statek Kolonizacyjny",description:"Umoliwia zasiedlanie nowych planet w niezbadanych ukadach.",baseCost:{metal:3e3,crystal:6e3,deuterium:3e3},image:He.colonyShip,buildTime:150,attack:50,defense:100,capacity:7500,requirements:[{type:"building",id:le.SHIPYARD,level:4},{type:"research",id:xe.IMPULSE_DRIVE,level:3}]},[ce.RECYCLER]:{id:ce.RECYCLER,name:"Statek Odzysku",description:"Specjalistyczna jednostka do zbierania szcztkw z pl bitew.",baseCost:{metal:3e4,crystal:15e3,deuterium:5e3},image:He.recycler,buildTime:60,attack:10,defense:30,capacity:2e4,requirements:[{type:"building",id:le.SHIPYARD,level:4},{type:"research",id:xe.COMBUSTION_DRIVE,level:6},{type:"research",id:xe.SHIELDING_TECH,level:2}]},[ce.ESPIONAGE_PROBE]:{id:ce.ESPIONAGE_PROBE,name:"Dron Zwiadowczy",description:"May dron do zdobywania informacji o innych planetach.",baseCost:{metal:0,crystal:1e3,deuterium:0},image:He.espionageProbe,buildTime:2,attack:0,defense:0,capacity:5,requirements:[{type:"building",id:le.SHIPYARD,level:3},{type:"research",id:xe.COMBUSTION_DRIVE,level:3}]},[ce.PIONEER]:{id:ce.PIONEER,name:"Pionier",description:"Zaawansowany statek ekspedycyjny. Zwiksza szans na sukces i chroni flot przed zagroeniami.",baseCost:{metal:3e3,crystal:1500,deuterium:500},image:He.pioneer,buildTime:45,attack:200,defense:200,capacity:2e3,requirements:[{type:"building",id:le.SHIPYARD,level:6},{type:"research",id:xe.ESPIONAGE_TECH,level:4},{type:"research",id:xe.IMPULSE_DRIVE,level:4}]}},ts={[le.METAL_MINE]:{id:le.METAL_MINE,name:"Wiertnia Tytanu",description:"Pozyskuje rud tytanu z gbi planety.",baseCost:{metal:60,crystal:15,deuterium:0},baseProduction:{metal:30,crystal:0,deuterium:0,energy:-20},image:He.metalMine,buildTimeBase:10},[le.CRYSTAL_MINE]:{id:le.CRYSTAL_MINE,name:"Ekstraktor Krzemu",description:"Wydobywa krzem niezbdny do elektroniki.",baseCost:{metal:48,crystal:24,deuterium:0},baseProduction:{metal:0,crystal:20,deuterium:0,energy:-15},image:He.crystalMine,buildTimeBase:15},[le.DEUTERIUM_SYNTH]:{id:le.DEUTERIUM_SYNTH,name:"Syntezator Plazmy",description:"Generuje stabiln plazm.",baseCost:{metal:225,crystal:75,deuterium:0},baseProduction:{metal:0,crystal:0,deuterium:10,energy:-30},image:He.deuteriumSynth,buildTimeBase:20},[le.SOLAR_PLANT]:{id:le.SOLAR_PLANT,name:"Elektrownia Soneczna",description:"Wytwarza energi z promieniowania gwiazdy.",baseCost:{metal:75,crystal:30,deuterium:0},baseProduction:{metal:0,crystal:0,deuterium:0,energy:30},image:He.solarPlant,buildTimeBase:12},[le.FUSION_REACTOR]:{id:le.FUSION_REACTOR,name:"Reaktor Plazmowy",description:"Wydajna elektrownia zuywajca plazm.",baseCost:{metal:900,crystal:360,deuterium:180},baseProduction:{metal:0,crystal:0,deuterium:-5,energy:60},image:He.fusionReactor,buildTimeBase:40,requirements:[{type:"research",id:xe.ENERGY_TECH,level:3}]},[le.METAL_STORAGE]:{id:le.METAL_STORAGE,name:"Magazyn Tytanu",description:"Zwiksza limit przechowywania tytanu.",baseCost:{metal:1e3,crystal:0,deuterium:0},image:He.metalStorage,buildTimeBase:25},[le.CRYSTAL_STORAGE]:{id:le.CRYSTAL_STORAGE,name:"Magazyn Krzemu",description:"Zwiksza limit przechowywania krzemu.",baseCost:{metal:1e3,crystal:500,deuterium:0},image:He.crystalStorage,buildTimeBase:25},[le.DEUTERIUM_TANK]:{id:le.DEUTERIUM_TANK,name:"Zbiornik Plazmy",description:"Zwiksza limit przechowywania plazmy.",baseCost:{metal:1e3,crystal:1e3,deuterium:0},image:He.deuteriumTank,buildTimeBase:25},[le.ROBOT_FACTORY]:{id:le.ROBOT_FACTORY,name:"Fabryka Robotw",description:"Skraca czas budowy budynkw.",baseCost:{metal:400,crystal:120,deuterium:200},image:He.robotFactory,buildTimeBase:30},[le.SHIPYARD]:{id:le.SHIPYARD,name:"Stocznia",description:"Umoliwia budow statkw.",baseCost:{metal:800,crystal:400,deuterium:200},image:He.shipyard,buildTimeBase:50,requirements:[{type:"building",id:le.ROBOT_FACTORY,level:2}]},[le.RESEARCH_LAB]:{id:le.RESEARCH_LAB,name:"Laboratorium Badawcze",description:"Niezbdne do odkrywania technologii.",baseCost:{metal:200,crystal:400,deuterium:200},image:He.researchLab,buildTimeBase:60}},Tr={[xe.ENERGY_TECH]:{id:xe.ENERGY_TECH,name:"Technologia Energetyczna",description:"Kluczowa do odblokowania zaawansowanych elektrowni i broni.",baseCost:{metal:0,crystal:800,deuterium:400},image:He.techEnergy,buildTimeBase:40,requirements:[{type:"building",id:le.RESEARCH_LAB,level:1}],maxLevel:20},[xe.LASER_TECH]:{id:xe.LASER_TECH,name:"Technologia Laserowa",description:"Podstawa dla systemw uzbrojenia.",baseCost:{metal:200,crystal:100,deuterium:0},image:He.techLaser,buildTimeBase:20,requirements:[{type:"building",id:le.RESEARCH_LAB,level:1},{type:"research",id:xe.ENERGY_TECH,level:2}],maxLevel:20},[xe.ION_TECH]:{id:xe.ION_TECH,name:"Technologia Jonowa",description:"Wymagana dla kanonierek i broni jonowej.",baseCost:{metal:1e3,crystal:300,deuterium:100},image:He.techIon,buildTimeBase:60,requirements:[{type:"building",id:le.RESEARCH_LAB,level:4},{type:"research",id:xe.LASER_TECH,level:5}],maxLevel:20},[xe.HYPERSPACE_TECH]:{id:xe.HYPERSPACE_TECH,name:"Technologia Nadprzestrzenna",description:"Wymagana dla drednotw i zaawansowanych napdw.",baseCost:{metal:0,crystal:4e3,deuterium:2e3},image:He.techHyper,buildTimeBase:120,requirements:[{type:"building",id:le.RESEARCH_LAB,level:7},{type:"research",id:xe.ENERGY_TECH,level:5}],maxLevel:20},[xe.COMBUSTION_DRIVE]:{id:xe.COMBUSTION_DRIVE,name:"Napd Rakietowy",description:"Podstawowy napd dla lekkich statkw.",baseCost:{metal:400,crystal:0,deuterium:600},image:He.techCombustion,buildTimeBase:30,requirements:[{type:"building",id:le.RESEARCH_LAB,level:1},{type:"research",id:xe.ENERGY_TECH,level:1}],maxLevel:20},[xe.IMPULSE_DRIVE]:{id:xe.IMPULSE_DRIVE,name:"Napd Jonowy",description:"Dla ciszych myliwcw i okrtw.",baseCost:{metal:2e3,crystal:4e3,deuterium:600},image:He.techImpulse,buildTimeBase:80,requirements:[{type:"building",id:le.RESEARCH_LAB,level:2},{type:"research",id:xe.ENERGY_TECH,level:1}],maxLevel:20},[xe.HYPERSPACE_DRIVE]:{id:xe.HYPERSPACE_DRIVE,name:"Napd Warp",description:"Umoliwia podre midzygalaktyczne drednotw.",baseCost:{metal:1e4,crystal:2e4,deuterium:6e3},image:He.techHyperDrive,buildTimeBase:200,requirements:[{type:"research",id:xe.HYPERSPACE_TECH,level:3}],maxLevel:20},[xe.PLASMA_TECH]:{id:xe.PLASMA_TECH,name:"Technologia Plazmowa",description:"",baseCost:{metal:2e3,crystal:4e3,deuterium:1e3},image:He.techPlasma,buildTimeBase:100,maxLevel:20},[xe.ESPIONAGE_TECH]:{id:xe.ESPIONAGE_TECH,name:"Sensoryka",description:"",baseCost:{metal:200,crystal:1e3,deuterium:200},image:He.techEspionage,buildTimeBase:40,maxLevel:20},[xe.COMPUTER_TECH]:{id:xe.COMPUTER_TECH,name:"Technologia Komputerowa",description:"",baseCost:{metal:0,crystal:400,deuterium:600},image:He.techComputer,buildTimeBase:50,maxLevel:25},[xe.ASTROPHYSICS]:{id:xe.ASTROPHYSICS,name:"Eksploracja Kosmosu",description:"",baseCost:{metal:4e3,crystal:8e3,deuterium:4e3},image:He.techAstro,buildTimeBase:100,maxLevel:30},[xe.WEAPON_TECH]:{id:xe.WEAPON_TECH,name:"Technologia Bojowa",description:"",baseCost:{metal:800,crystal:200,deuterium:0},image:He.techWeapon,buildTimeBase:60,maxLevel:50},[xe.SHIELDING_TECH]:{id:xe.SHIELDING_TECH,name:"Technologia Ochronna",description:"",baseCost:{metal:200,crystal:600,deuterium:0},image:He.techShield,buildTimeBase:60,maxLevel:50},[xe.ARMOUR_TECH]:{id:xe.ARMOUR_TECH,name:"Opancerzenie",description:"",baseCost:{metal:1e3,crystal:0,deuterium:0},image:He.techArmour,buildTimeBase:60,maxLevel:50}},Qa={rocketLauncher:{id:"rocketLauncher",name:"Bateria Rakietowa",desc:"Podstawowa obrona planetarna. Skuteczna przeciwko lekkim celom.",attack:40,defense:10,cost:{metal:500,crystal:0,deuterium:0},buildTime:20,icon:"rocket_launch",bonuses:{[ce.ESPIONAGE_PROBE]:2}},lightLaser:{id:"lightLaser",name:"Lekkie Dziako Laserowe",desc:"Szybkostrzelna wieyczka laserowa. Idealna do zwalczania myliwcw. Skuteczna przeciwko myliwcom przechwytujcym.",attack:50,defense:12,cost:{metal:400,crystal:100,deuterium:0},buildTime:30,icon:"electric_bolt",bonuses:{[ce.LIGHT_FIGHTER]:1.5,[ce.ESPIONAGE_PROBE]:2}},heavyLaser:{id:"heavyLaser",name:"Cikie Dziako Laserowe",desc:"Potny laser zdolny przebi pancerz rednich okrtw.",attack:125,defense:50,cost:{metal:1500,crystal:500,deuterium:0},buildTime:60,icon:"bolt",bonuses:{[ce.HEAVY_FIGHTER]:1.5,[ce.CRUISER]:1}},gaussCannon:{id:"gaussCannon",name:"Dziao Kinetyczne",desc:"Elektromagnetyczne dziao wystrzeliwujce pociski z ogromn prdkoci.",attack:550,defense:100,cost:{metal:5e3,crystal:3500,deuterium:500},buildTime:150,icon:"target",bonuses:{[ce.CRUISER]:2,[ce.BATTLESHIP]:1,[Pt.SMALL_SHIELD]:2}},ionCannon:{id:"ionCannon",name:"Emitery EMP",desc:"Zaawansowana technologia jonowa dezaktywujca systemy wroga.",attack:75,defense:250,cost:{metal:1200,crystal:700,deuterium:250},buildTime:120,icon:"storm",bonuses:{[ce.BATTLESHIP]:1.5,[ce.DESTROYER]:.5,[Pt.LARGE_SHIELD]:2}},plasmaTurret:{id:"plasmaTurret",name:"Wieyczka Plazmowa",desc:"Najpotniejsza bro obronna. Zdolna zniszczy drednoty jednym strzaem.",attack:1500,defense:150,cost:{metal:12e3,crystal:12e3,deuterium:7500},buildTime:300,icon:"whatshot",bonuses:{[ce.DESTROYER]:1.5,[ce.DEATH_STAR]:.1,[ce.BATTLESHIP]:1.5}},smallShield:{id:"smallShield",name:"Maa Osona Tarczowa",desc:"Kopua energetyczna chronica cz planety przed atakami.",attack:1,defense:500,cost:{metal:2500,crystal:2500,deuterium:0},buildTime:60,icon:"shield",bonuses:{}},largeShield:{id:"largeShield",name:"Dua Osona Tarczowa",desc:"Masywna tarcza energetyczna obejmujca ca planet.",attack:1,defense:2500,cost:{metal:12e3,crystal:12e3,deuterium:0},buildTime:300,icon:"security",bonuses:{}}},Uy=l=>{var p;const s=(l.ships[ce.PIONEER]||0)>0;(l.ships[ce.ESPIONAGE_PROBE]||0)>0;let n=0,o=0;Object.entries(l.ships).forEach(([v,x])=>{const _=st[v];_&&(n+=_.capacity*x,o+=_.attack*x+_.defense*x)});const d=Math.random(),h=s?.9:.65,f=Date.now(),b={id:`exp-${f}-${Math.random().toString(36).substr(2,9)}`,timestamp:f};if(d>h){const v=["Sensory nie wykryy adnych anomalii w sektorze.","Pusta przestrze. Zaoga spdzia czas na kalibracji systemw.","Wyprawa dotara do koordynatw, ale znaleziono jedynie kosmiczny py.","Sektor wydaje si opuszczony od tysicleci.","Brak znaczcych odkry. Morale zaogi stabilne."];return{log:{...b,title:"Pusta Przestrze",message:v[Math.floor(Math.random()*v.length)],outcome:"neutral"},rewards:{}}}const g=Math.random();if(g<.5){let v=Math.floor(Math.random()*5e4)+2e3,x=Math.floor(Math.random()*3e4)+1e3,_=Math.floor(Math.random()*1e4)+500;const j=Math.random();let C={},z="";j<.5?(_=0,z="Odkryto pole asteroid bogate w mineray."):j<.8?(v=0,z="Znaleziono obok gazowy zawierajcy deuter."):z="Trafiono na opuszczony magazyn piratw!";const M=v+x+_;if(M>n){const E=n/M;v=Math.floor(v*E),x=Math.floor(x*E),_=Math.floor(_*E),z+=` (adownie pene: ${n})`}return v>0&&(C.metal=v),x>0&&(C.crystal=x),_>0&&(C.deuterium=_),z+=" Pozyskano:",v>0&&(z+=` Metal: ${v}`),x>0&&(z+=` Kryszta: ${x}`),_>0&&(z+=` Deuter: ${_}.`),{log:{...b,title:"Pozyskano Zasoby",message:z,outcome:"success",rewards:C},rewards:C}}else if(g<.8){const v=Math.random();let x,_=1;v<.7?(x=[ce.LIGHT_FIGHTER,ce.HEAVY_FIGHTER,ce.SMALL_CARGO,ce.ESPIONAGE_PROBE],_=5):v<.95?(x=[ce.MEDIUM_CARGO,ce.PIONEER,ce.CRUISER],_=3):(x=[ce.BATTLESHIP,ce.DESTROYER,ce.HUGE_CARGO],_=1);const j=x[Math.floor(Math.random()*x.length)],C=Math.floor(Math.random()*_)+1,z=((p=st[j])==null?void 0:p.name)||j;return{log:{...b,title:"Odnaleziono Statki",message:`Flota napotkaa dryfujce wraki, ktre udao si przywrci do dziaania. Doczono do floty: ${C}x ${z}.`,outcome:"success"},rewards:{ships:{[j]:C}}}}else if(g<.98){const v=Math.floor(Math.random()*5e3)+500;return{log:{...b,title:"Antyczny Artefakt",message:`Znaleziono dziwny artefakt obcych. Po jego analizie uzyskano technologi wart ${v} Metalu.`,outcome:"success",rewards:{metal:v}},rewards:{metal:v}}}else{const v=Math.floor(Math.random()*50)+10;return{log:{...b,title:"Czarna Materia",message:`Eksperymentalne skanery chwyciy lad rzadkiej anomalii. Skondensowano ${v} jednostek Czarnej Materii!`,outcome:"success"},rewards:{darkMatter:v}}}},gn=l=>JSON.parse(JSON.stringify(l||{})),ip=(l,s,n,o,d,h,f=!1,b={})=>{const g=gn(l),p=gn(s||{}),v=gn(n||{}),x=1+(b[xe.WEAPON_TECH]||0)*.1,_=1+(b[xe.SHIELDING_TECH]||0)*.05+(b[xe.ARMOUR_TECH]||0)*.05,j=1+(d[xe.WEAPON_TECH]||0)*.1,C=1+(d[xe.SHIELDING_TECH]||0)*.05+(d[xe.ARMOUR_TECH]||0)*.05;let z=gn(l),M=gn(s||{}),E=gn(n||{});const O=6,N=[];for(let ie=1;ie<=O;ie++){let pe=0,Ae=0;if(Object.values(M).forEach($e=>Ae+=$e),Object.values(E).forEach($e=>Ae+=$e),Ae===0)break;Object.entries(z).forEach(([$e,zt])=>{const Xe=st[$e],de=zt;if(de<=0)return;let ae=Xe.attack*de*x;Xe.bonuses&&Object.entries(Xe.bonuses).forEach(([Ge,Ve])=>{let ct=(M[Ge]||0)+(E[Ge]||0);if(ct>0){const Bt=Math.min(1,ct/de),nt=Xe.attack*de*x*Ve*Bt;ae+=nt}}),pe+=ae});let k=0,Z=0;if(Object.values(z).forEach($e=>Z+=$e),Z===0)break;Object.entries(M).forEach(([$e,zt])=>{const Xe=st[$e],de=zt;if(de<=0)return;let ae=Xe.attack*de*j;Xe.bonuses&&Object.entries(Xe.bonuses).forEach(([Ge,Ve])=>{let ct=z[Ge]||0;if(ct>0){const Bt=Math.min(1,ct/de),nt=Xe.attack*de*j*Ve*Bt;ae+=nt}}),k+=ae}),Object.entries(E).forEach(([$e,zt])=>{const Xe=Qa[$e],de=zt;if(de<=0)return;let ae=Xe.attack*de*j;k+=ae});const me=($e,zt,Xe)=>Object.entries($e).reduce((de,[ae,Ge])=>{const Ve=zt&&Qa[ae]||st[ae];if(!Ve)return de;const ct=Ve.baseCost||Ve.cost||{metal:0,crystal:0},Bt=(ct.metal+ct.crystal)/10,nt=Ve.defense*Xe;return de+(Bt+nt)*Ge},0),be=me(l,!1,_),Ne=me(M,!0,C);N.push(`Runda ${ie}: Agresor atakuje si ${Math.floor(pe)}. Obroca atakuje si ${Math.floor(k)}.`);const Be=Math.min(1,k/be);be>0&&k>0&&Object.keys(z).forEach($e=>{const zt=z[$e],Xe=Math.floor(zt*Be);z[$e]-=Xe,z[$e]<0&&(z[$e]=0)});const Je=Math.min(1,pe/Ne);Ne>0&&pe>0&&(Object.keys(M).forEach($e=>{const zt=M[$e],Xe=Math.floor(zt*Je);M[$e]-=Xe,M[$e]<0&&(M[$e]=0)}),Object.keys(E).forEach($e=>{const zt=E[$e],Xe=Math.floor(zt*Je);E[$e]-=Xe,E[$e]<0&&(E[$e]=0)}));let Rt=0;Object.values(z).forEach($e=>Rt+=$e);let dt=0;if(Object.values(M).forEach($e=>dt+=$e),Object.values(E).forEach($e=>dt+=$e),Rt<=0||dt<=0)break}const G=Object.values(z).reduce((ie,pe)=>ie+pe,0),fe=Object.values(M).reduce((ie,pe)=>ie+pe,0)+Object.values(E).reduce((ie,pe)=>ie+pe,0),J=G>0&&fe<=0,oe={};let ge=0;Object.keys(g).forEach(ie=>{const pe=g[ie]-(z[ie]||0);oe[ie]=pe,ge+=pe});const we={};Object.keys(p).forEach(ie=>{we[ie]=p[ie]-(M[ie]||0)});const je={},Ue={};Object.keys(v).forEach(ie=>{const pe=v[ie]-(E[ie]||0),Ae=Math.floor(pe*.7),k=pe-Ae;je[ie]=k,Ue[ie]=(E[ie]||0)+Ae});let Re={metal:0,crystal:0,deuterium:0};J&&(Re.metal=Math.floor((h.metal||0)*.5),Re.crystal=Math.floor((h.crystal||0)*.5),Re.deuterium=Math.floor((h.deuterium||0)*.5));const Ke={};J&&o&&Object.entries(o).forEach(([ie,pe])=>{pe>0&&Math.random()<.1&&(Ke[ie]=1)});const Pe={rounds:6,initialAttackerShips:g,initialDefenderShips:p,initialDefenderDefenses:v,finalAttackerShips:z,finalDefenderShips:M,finalDefenderDefenses:Ue,attackerLosses:oe,defenderLosses:we,defenderDefensesLost:je,loot:Re,bonuses:{attacker:{weapon:x,shield:_,armour:1},defender:{weapon:j,shield:C,armour:1}},logMessages:N,result:J?"attacker_win":"defender_win"};let ye=0,S=0;const Q=(ie,pe)=>{if(st[ie]){const Ae=st[ie].baseCost;ye+=Ae.metal*pe*.3,S+=Ae.crystal*pe*.3}};return Object.entries(oe).forEach(([ie,pe])=>Q(ie,pe)),Object.entries(we).forEach(([ie,pe])=>Q(ie,pe)),{report:Pe,survivingAttackerShips:z,survivingDefenderShips:M,survivingDefenderDefenses:Ue,damagedBuildings:Ke,loot:Re,attackerWon:J,totalAttackerLost:ge,debris:{metal:Math.floor(ye),crystal:Math.floor(S)}}},Ly=1e3,hi=100,Ts="cosmos_conquest_save_v1",wa={avatarUrl:"/kosmo/avatars/avatar_default.png",planetType:"terran",planetName:"Nowa Kolonia",nickname:"Player",resources:{metal:500,crystal:300,deuterium:100,darkMatter:0,energy:0,maxEnergy:0,storage:{metal:1e4,crystal:1e4,deuterium:1e4}},productionSettings:{[le.METAL_MINE]:100,[le.CRYSTAL_MINE]:100,[le.DEUTERIUM_SYNTH]:100,[le.SOLAR_PLANT]:100,[le.FUSION_REACTOR]:100},productionRates:{metal:0,crystal:0,deuterium:0},buildings:{[le.METAL_MINE]:1,[le.CRYSTAL_MINE]:0,[le.DEUTERIUM_SYNTH]:0,[le.SOLAR_PLANT]:1,[le.FUSION_REACTOR]:0,[le.ROBOT_FACTORY]:0,[le.SHIPYARD]:0,[le.RESEARCH_LAB]:0,[le.METAL_STORAGE]:0,[le.CRYSTAL_STORAGE]:0,[le.DEUTERIUM_TANK]:0},research:{[xe.ENERGY_TECH]:0,[xe.LASER_TECH]:0,[xe.ION_TECH]:0,[xe.HYPERSPACE_TECH]:0,[xe.PLASMA_TECH]:0,[xe.COMBUSTION_DRIVE]:0,[xe.IMPULSE_DRIVE]:0,[xe.HYPERSPACE_DRIVE]:0,[xe.ESPIONAGE_TECH]:0,[xe.COMPUTER_TECH]:0,[xe.ASTROPHYSICS]:0,[xe.WEAPON_TECH]:0,[xe.SHIELDING_TECH]:0,[xe.ARMOUR_TECH]:0},ships:{[ce.LIGHT_FIGHTER]:0,[ce.HEAVY_FIGHTER]:0,[ce.CRUISER]:0,[ce.BATTLESHIP]:0,[ce.DESTROYER]:0,[ce.DEATH_STAR]:0,[ce.SMALL_CARGO]:0,[ce.MEDIUM_CARGO]:0,[ce.HUGE_CARGO]:0,[ce.COLONY_SHIP]:0,[ce.ESPIONAGE_PROBE]:0,[ce.PIONEER]:1,[ce.RECYCLER]:0},defenses:{[Pt.ROCKET_LAUNCHER]:0,[Pt.LIGHT_LASER]:0,[Pt.HEAVY_LASER]:0,[Pt.GAUSS_CANNON]:0,[Pt.ION_CANNON]:0,[Pt.PLASMA_TURRET]:0,[Pt.SMALL_SHIELD]:0,[Pt.LARGE_SHIELD]:0},constructionQueue:[],shipyardQueue:[],activeMissions:[],incomingMissions:[],missionLogs:[],lastTick:Date.now(),xp:0,level:1,version:1},ls=(l,s,n,o,d)=>{const h=x=>(x.metal||0)+(x.crystal||0)+(x.deuterium||0)*2;let f=0;Object.entries(s||{}).forEach(([x,_])=>{const j=ts[x];if(!j)return;let C=0,z=0,M=0;for(let E=1;E<=_;E++){const O=Math.pow(1.5,E-1);C+=Math.floor(j.baseCost.metal*O),z+=Math.floor(j.baseCost.crystal*O),M+=Math.floor(j.baseCost.deuterium*O)}f+=h({metal:C,crystal:z,deuterium:M})});let b=0;Object.entries(o||{}).forEach(([x,_])=>{const j=Tr[x];if(!j)return;let C=0,z=0,M=0;for(let E=1;E<=_;E++){const O=Math.pow(1.5,E-1);C+=Math.floor(j.baseCost.metal*O),z+=Math.floor(j.baseCost.crystal*O),M+=Math.floor(j.baseCost.deuterium*O)}b+=h({metal:C,crystal:z,deuterium:M})});let g=0;Object.entries(n||{}).forEach(([x,_])=>{const j=st[x];j&&(g+=h(j.baseCost)*_)});let p=0;Object.entries(d||{}).forEach(([x,_])=>{const j=Qa[x];j&&(p+=h(j.cost)*_)});const v=f+b+g+p;return Math.floor(v/1e3)},Ap=F.createContext(void 0),By=({children:l,session:s})=>{const[n,o]=F.useState({...wa,userId:s==null?void 0:s.user.id}),[d,h]=F.useState(!1),[f,b]=F.useState(!1),[g,p]=F.useState(navigator.onLine);F.useEffect(()=>{Dy()},[]);const v=F.useRef(new Set);F.useEffect(()=>{const w=()=>{console.log(" Status: ONLINE"),p(!0),b(!1)},A=()=>{console.log(" Status: OFFLINE"),p(!1)};return window.addEventListener("online",w),window.addEventListener("offline",A),()=>{window.removeEventListener("online",w),window.removeEventListener("offline",A)}},[]);const[x,_]=F.useState([]),[j,C]=F.useState(null),[z,M]=F.useState("Gwna"),[E,O]=F.useState(null),[N,G]=F.useState(null),fe=F.useRef(n),J=F.useRef(j),oe=F.useRef(N);F.useEffect(()=>{fe.current=n,J.current=j,oe.current=N},[n,j,N]),F.useEffect(()=>{},[]);const ge=F.useRef(null),we=F.useRef(new Set),je=async w=>{var X,K,ee,P;if(f)return console.warn(" [SAVE] Paused due to auth error"),!1;const A=fe.current,U=J.current,B=U&&U!=="main"&&U!==null;console.log(""),console.log(` [SAVE START] Reason: ${w}`),console.log(` [SAVE] Target: ${B?`Colony (${U})`:"Main Planet"}`),console.log(" [SAVE] Current State:"),console.log("   Resources:",JSON.stringify(A.resources)),console.log("   Buildings:",JSON.stringify(A.buildings)),console.log("   Research:",JSON.stringify(A.research)),console.log("   Ships:",JSON.stringify(A.ships)),console.log("   Defenses:",JSON.stringify(A.defenses)),console.log("   ConstructionQueue:",((X=A.constructionQueue)==null?void 0:X.length)||0,"items"),console.log("   ShipyardQueue:",((K=A.shipyardQueue)==null?void 0:K.length)||0,"items"),console.log("   GalaxyCoords:",JSON.stringify(A.galaxyCoords)),console.log("   Nickname:",A.nickname),console.log("   PlanetName:",A.planetName),localStorage.setItem(Ts,JSON.stringify(A));let D={},ne=null,re=null;if(B){ne={buildings:A.buildings,ships:A.ships,defenses:A.defenses,resources:A.resources,construction_queue:A.constructionQueue,shipyard_queue:A.shipyardQueue},re=U;const{data:I}=await ue.from("profiles").select("resources, debris").eq("id",s.user.id).single(),he={...(I==null?void 0:I.resources)||{},darkMatter:n.resources.darkMatter};D={research:A.research,production_settings:{...A.productionSettings,avatarUrl:A.avatarUrl,planetType:A.planetType,nickname:A.nickname},nickname:A.nickname,active_missions:A.activeMissions,resources:he,last_updated:Date.now(),level:A.level,xp:A.xp,points:(()=>{let Ee=0;return Ee+=ls(null,A.buildings,A.ships,A.research,A.defenses),Ee})()},ge.current={...A}}else D={planet_name:A.planetName,nickname:A.nickname,resources:A.resources,buildings:A.buildings,research:A.research,ships:A.ships,defenses:A.defenses,construction_queue:A.constructionQueue,shipyard_queue:A.shipyardQueue,production_settings:{...A.productionSettings,avatarUrl:A.avatarUrl,planetType:A.planetType,nickname:A.nickname},active_missions:A.activeMissions,mission_logs:A.missionLogs,galaxy_coords:A.galaxyCoords,points:(()=>{let I=0;return I+=ls(null,A.buildings,A.ships,A.research,A.defenses),x.forEach(V=>{V.id!==j&&(I+=ls(null,V.buildings,V.ships,{},V.defenses))}),I})(),last_updated:Date.now(),level:A.level,xp:A.xp};try{console.log(` [SAVE] Calling RPC save_game_atomic (Ver: ${A.version||1})`);const{data:I,error:V}=await ue.rpc("save_game_atomic",{p_user_id:s.user.id,p_profile_data:D,p_planet_id:re,p_planet_data:ne,p_expected_version:A.version||1});if(V){if(console.error(" [SAVE RPC ERROR]",V),V.message&&V.message.includes("VERSION_MISMATCH"))return console.warn(" Version mismatch, reloading..."),window.location.reload(),!1;throw V}if(I&&I.success){const he=I.new_version;return console.log(` [SAVE SUCCESS] Version bumped to ${he}`),o(Ee=>({...Ee,version:he})),fe.current.version=he,ge.current=JSON.parse(JSON.stringify(A)),!0}}catch(I){return console.error(" [SAVE EXCEPTION]",I),((ee=I==null?void 0:I.message)!=null&&ee.includes("Failed to fetch")||(P=I==null?void 0:I.message)!=null&&P.includes("NetworkError"))&&p(!1),(I.code==="401"||I.code==="403")&&b(!0),!1}return!1},Ue=(w,A)=>{const U=ge.current;if(!U){console.log(" [VALIDATE] No previous state to compare");return}console.log(" [VALIDATE] Comparing loaded state vs last saved...");const B=[],D=(ne,re,X,K=[])=>{if(!X||!re){if(ne==="research"){console.log(" [VALIDATE] Skipping research (global, not per-planet)");return}X!==re&&B.push(` [DESYNC] ${ne}: one is null/undefined`);return}const ee=new Set([...Object.keys(X),...Object.keys(re)]),P=[];ee.forEach(I=>{if(K.includes(I))return;const V=X[I],he=re[I];if(typeof V=="object"&&V!==null){const Ee=JSON.stringify(V),Oe=JSON.stringify(he);Ee!==Oe&&P.push(`  ${I}: SAVED=${Ee.substring(0,50)} LOADED=${Oe==null?void 0:Oe.substring(0,50)}`)}else if(typeof V=="number"&&typeof he=="number"){const Ee=Math.max(1,Math.abs(V)*.01);Math.abs(V-he)>Ee&&P.push(`  ${I}: SAVED=${V}  LOADED=${he}`)}else V!==he&&P.push(`  ${I}: SAVED=${V}  LOADED=${he}`)}),P.length>0&&(B.push(` [DESYNC] ${ne} has ${P.length} differences:`),P.forEach(I=>console.warn(I)))};D("buildings",w.buildings,U.buildings),D("research",w.research,U.research),D("ships",w.ships,U.ships),D("defenses",w.defenses,U.defenses),D("resources",w.resources,U.resources,["energy","maxEnergy"]),JSON.stringify(w.constructionQueue)!==JSON.stringify(U.constructionQueue)&&B.push(` [DESYNC] constructionQueue:
SAVED=${JSON.stringify(U.constructionQueue)}
LOADED=${JSON.stringify(w.constructionQueue)}`),JSON.stringify(w.shipyardQueue)!==JSON.stringify(U.shipyardQueue)&&B.push(` [DESYNC] shipyardQueue:
SAVED=${JSON.stringify(U.shipyardQueue)}
LOADED=${JSON.stringify(w.shipyardQueue)}`),B.length>0?(console.warn(""),console.warn(" [VALIDATION FAILED] Data desync detected:"),B.forEach(ne=>console.warn(ne)),console.warn("")):console.log(" [VALIDATE] State matches - no desync detected from",A)},Re=async w=>{const{data:A,error:U}=await ue.from("profiles").select("id, galaxy_coords").not("galaxy_coords","is",null);if(U)return console.error("Error finding target user:",U),null;const B=A==null?void 0:A.find(D=>{var ne,re,X;return((ne=D.galaxy_coords)==null?void 0:ne.galaxy)===w.galaxy&&((re=D.galaxy_coords)==null?void 0:re.system)===w.system&&((X=D.galaxy_coords)==null?void 0:X.position)===w.position});return(B==null?void 0:B.id)||null},Ke=async()=>{if(!(s!=null&&s.user)||f)return;const{data:w,error:A}=await ue.from("missions").select("*").or(`owner_id.eq.${s.user.id}, target_user_id.eq.${s.user.id}`);if(w&&!A){const U=w.map(K=>({id:K.id,ownerId:K.owner_id,targetUserId:K.target_user_id,type:K.mission_type,ships:K.ships,targetCoords:K.target_coords,originCoords:K.origin_coords,startTime:K.start_time,arrivalTime:K.arrival_time,returnTime:K.return_time,eventProcessed:K.status!=="flying",status:K.status,resources:K.resources,result:K.result})),D=Date.now()-1e4,ne=U.filter(K=>K.status==="flying"&&K.arrivalTime<D&&!we.current.has(K.id));ne.length>0&&(console.log(" [SILENT RESCUE] Zombies detected:",ne.length),ne.forEach(K=>{we.current.add(K.id),ue.from("missions").update({status:"completed",result:{id:`${K.id}-rescue`,timestamp:Date.now(),outcome:"neutral",title:"Zaginiona Flota",message:"Misja zakoczona awaryjnie (Silent Rescue)."}}).eq("id",K.id).then(({error:ee})=>{ee?console.error("Silent Rescue DB Error:",ee):console.log(" [SILENT RESCUE] DB Updated for",K.id)})}));const re=U.filter(K=>K.ownerId===s.user.id&&K.status!=="completed"&&!we.current.has(K.id));let X=U.filter(K=>K.targetUserId===s.user.id&&K.ownerId!==s.user.id&&K.status==="flying"&&K.arrivalTime>D&&!we.current.has(K.id));if(X.length>0){const K=X.map(P=>P.ownerId).filter(P=>!!P),ee=Array.from(new Set(K));if(ee.length>0){console.log(" Resolving Incoming Attackers:",ee);const{data:P,error:I}=await ue.from("profiles").select("id, nickname").in("id",ee);if(I&&console.error(" Error fetching incoming attackers:",I),P){const V=new Map(P.map(he=>[he.id,he.nickname]));X=X.map(he=>{var Ee;return{...he,attackerName:he.ownerId&&V.get(he.ownerId)||`Obcy [${((Ee=he.ownerId)==null?void 0:Ee.slice(0,4))||"???"}]`}})}}X.forEach(P=>{if(!v.current.has(P.id)){v.current.add(P.id);const I=P.originCoords?`[${P.originCoords.galaxy}:${P.originCoords.system}:${P.originCoords.position}]`:"[?:?:?]";np(" WYKRYTO ZAGROENIE!",`Gracz ${P.attackerName||"Nieznany"} ${I} zblia si do Twojej planety!`,"/kosmo/icons/warning.png")}}),console.log("Incoming Attacks Detected:",X)}o(K=>({...K,activeMissions:re,incomingMissions:X}))}else A&&(console.error("Error fetching missions:",A),(A.code==="401"||A.code==="403"||A.message.includes("JWT"))&&(console.error(" CRITICAL: Pausing Sync due to Auth Error. Please run SQL RLS script."),b(!0)))},Pe=async()=>{var U,B,D,ne,re,X;if(!(s!=null&&s.user))return;const{data:w,error:A}=await ue.from("profiles").select("*").eq("id",s.user.id).single();if(w&&!A){const K=w.last_updated||Date.now(),ee=Date.now(),P=Math.max(0,(ee-K)/1e3);let I={...w.resources};if(P>1){console.log(` Calculating offline production for ${P.toFixed(0)} seconds...`);const he={...wa.buildings,...w.buildings},Ee={...wa.productionSettings,...w.production_settings},Oe=he[le.METAL_MINE]||0,Tt=he[le.CRYSTAL_MINE]||0,ht=he[le.DEUTERIUM_SYNTH]||0,et=he[le.SOLAR_PLANT]||0,ft=he[le.FUSION_REACTOR]||0,Wt=20*et*Math.pow(1.1,et),ia=30*ft*Math.pow(1.05+.01*(he[xe.ENERGY_TECH]||0),ft),Se=Math.floor(Wt+ia),kt=10*Oe*Math.pow(1.1,Oe),mt=10*Tt*Math.pow(1.1,Tt),$t=20*ht*Math.pow(1.1,ht),ve=Math.ceil(kt+mt+$t),it=Se>=ve?1:Se/(ve||1),pt=30*Oe*Math.pow(1.1,Oe)*it*(Ee[le.METAL_MINE]??100)/100,Ie=20*Tt*Math.pow(1.1,Tt)*it*(Ee[le.CRYSTAL_MINE]??100)/100,Le=10*ht*Math.pow(1.1,ht)*1*it*(Ee[le.DEUTERIUM_SYNTH]??100)/100;I.storage||(I.storage=JSON.parse(JSON.stringify(wa.resources.storage))),I.metal=Math.min(I.storage.metal,I.metal+pt*P),I.crystal=Math.min(I.storage.crystal,I.crystal+Ie*P),I.deuterium=Math.min(I.storage.deuterium,I.deuterium+Le*P)}M(w.planet_name||"Gwna"),console.log(""),console.log(" [LOAD] Profile loaded from Supabase"),console.log(" [LOAD] Raw DB Data:"),console.log("   Resources:",JSON.stringify(w.resources)),console.log("   Buildings:",JSON.stringify(w.buildings)),console.log("   Research:",JSON.stringify(w.research)),console.log("   Ships:",JSON.stringify(w.ships)),console.log("   Defenses:",JSON.stringify(w.defenses)),console.log("   ConstructionQueue:",((U=w.construction_queue)==null?void 0:U.length)||0,"items"),console.log("   ShipyardQueue:",((B=w.shipyard_queue)==null?void 0:B.length)||0,"items"),console.log("   GalaxyCoords:",JSON.stringify(w.galaxy_coords)),console.log("   Nickname:",w.nickname),console.log("   PlanetName:",w.planet_name),console.log("");const V={planetName:w.planet_name||"Nowa Kolonia",nickname:w.nickname||((D=w.production_settings)==null?void 0:D.nickname)||"Player",resources:{...wa.resources,...I},buildings:{...wa.buildings,...w.buildings},research:{...wa.research,...w.research},ships:{...wa.ships,...w.ships},defenses:{...wa.defenses,...w.defenses},constructionQueue:w.construction_queue||[],shipyardQueue:w.shipyard_queue||[],productionSettings:{...wa.productionSettings,...w.production_settings},avatarUrl:((ne=w.production_settings)==null?void 0:ne.avatarUrl)||wa.avatarUrl,planetType:((re=w.production_settings)==null?void 0:re.planetType)||"terran",missionLogs:w.mission_logs||[],galaxyCoords:w.galaxy_coords,version:w.version||1,debris:w.debris||{metal:0,crystal:0}};w.galaxy_coords&&O(w.galaxy_coords),Ue(V,"refreshProfile (Main Planet)"),o(he=>({...he,...V,lastTick:Date.now()})),P>1&&ue.from("profiles").update({resources:I}).eq("id",s.user.id).then(({error:he})=>{he&&console.error("Failed to save offline production:",he)})}else{if(A){if(console.error("Profile Load Error:",A),A.code==="401"||A.code==="403"){console.error(" RLS Policy Missing"),b(!0);return}if(A.code!=="PGRST116"){alert("Bd poczenia z baz danych (Profile Load). Nie nadpisuj danych.");return}}const K=localStorage.getItem(Ts);if(K)try{const ee=JSON.parse(K);ee.userId&&ee.userId===s.user.id?((X=ee.production_settings)!=null&&X.nickname&&(ee.nickname=ee.production_settings.nickname),o(P=>({...P,...ee,userId:s.user.id,lastTick:Date.now()}))):(console.warn("Cleared mismatching local storage data"),localStorage.removeItem(Ts),o(P=>({...wa,userId:s.user.id})))}catch{localStorage.removeItem(Ts)}}h(!0)};F.useEffect(()=>{Pe(),Ke(),Xe();const w=setInterval(()=>{var A;document.visibilityState==="visible"&&!f&&(Ke(),ue.from("profiles").select("mission_logs, nickname").eq("id",(A=s==null?void 0:s.user)==null?void 0:A.id).single().then(({data:U})=>{U&&o(B=>({...B,missionLogs:U.mission_logs||B.missionLogs,nickname:U.nickname||B.nickname}))}))},6e4);return()=>clearInterval(w)},[s]),F.useEffect(()=>{if(!d||!(s!=null&&s.user)||f)return;const w=async()=>{await je("Auto-Save (60s interval)")},A=setInterval(w,6e4),U=B=>{const D=fe.current;localStorage.setItem(Ts,JSON.stringify(D)),localStorage.setItem(Ts+"_backup",JSON.stringify({...D,_savedAt:Date.now(),_savedBy:"beforeunload"})),console.log(" [BEFOREUNLOAD] Saved to localStorage"),w()};return window.addEventListener("beforeunload",U),()=>{clearInterval(A),window.removeEventListener("beforeunload",U),w()}},[d,s]);const ye=async w=>{var ne,re,X,K,ee,P,I,V,he,Ee,Oe,Tt,ht;if(w.eventProcessed)return;const{data:A,error:U}=await ue.from("missions").update({status:"processing"}).eq("id",w.id).eq("status","flying").select("id");if(U||!A||A.length===0){console.log(" Mission already being processed by another session:",w.id);return}let B=0;const D=5;for(;B<D;){let et={},ft={},Wt={...w.ships};try{if(console.log(`Przetwarzanie Przylotu (Prba ${B+1}):`,w.id,w.type),w.type===Ze.COLONIZE){const{data:Se}=await ue.from("planets").select("id").contains("galaxy_coords",w.targetCoords),{data:kt}=await ue.from("profiles").select("id").contains("galaxy_coords",w.targetCoords);if(Se&&Se.length>0||kt&&kt.length>0)et={id:`${w.id}-fail`,timestamp:Date.now(),title:"Kolonizacja Nieudana",message:`Pozycja [${w.targetCoords.galaxy}:${w.targetCoords.system}:${w.targetCoords.position}] zajta.`,outcome:"failure"};else{const{error:mt}=await ue.from("planets").insert({owner_id:w.ownerId,planet_name:`Kolonia ${x.length+1}`,planet_type:"terran",galaxy_coords:w.targetCoords,resources:{metal:500+(((ne=w.resources)==null?void 0:ne.metal)||0),crystal:300+(((re=w.resources)==null?void 0:re.crystal)||0),deuterium:100+(((X=w.resources)==null?void 0:X.deuterium)||0),darkMatter:0,energy:0,maxEnergy:0,storage:{metal:1e4,crystal:1e4,deuterium:1e4}},buildings:{},ships:{},defenses:{},is_main:!1});mt?et={id:`${w.id}-error`,timestamp:Date.now(),title:"Bd Kolonizacji",message:mt.message,outcome:"failure"}:(et={id:`${w.id}-success`,timestamp:Date.now(),title:"Kolonizacja Zakoczona",message:"Nowa kolonia zaoona.",outcome:"success"},Wt={},Xe())}B=D+1}else if(w.type===Ze.EXPEDITION){const Se=Uy(w);et=Se.log,Se.rewards&&(ft=Se.rewards),B=D+1}else if(w.type===Ze.RECYCLE){const{data:Se}=await ue.from("planets").select("*").contains("galaxy_coords",w.targetCoords),{data:kt}=await ue.from("profiles").select("*").contains("galaxy_coords",w.targetCoords);let mt=Se&&Se[0]||kt&&kt[0],$t=!!(Se&&Se[0]);if(!mt)et={id:`${w.id}-fail`,timestamp:Date.now(),title:"Recykling Nieudany",message:"Brak pola zniszcze na tych koordynatach.",outcome:"failure"};else{const ve=mt.debris||{metal:0,crystal:0};if((ve.metal||0)+(ve.crystal||0)<=0)et={id:`${w.id}-empty`,timestamp:Date.now(),title:"Raport Recyklingu",message:"Pole zniszcze jest puste.",outcome:"neutral"};else{let Le=(w.ships[ce.RECYCLER]||0)*2e4;const wt=Math.min(ve.metal||0,Le);Le-=wt;const Da=Math.min(ve.crystal||0,Le),jn={metal:-wt,crystal:-Da},{error:sr}=await ue.rpc("apply_mission_outcome",{p_mission_id:w.id,p_target_id:mt.id,p_is_planet:$t,p_log_entry:null,p_resources_diff:null,p_debris_diff:jn,p_ships_new:null,p_defenses_new:null,p_buildings_new:null});sr?(console.error("Recycle RPC Error:",sr),et={id:`${w.id}-err`,timestamp:Date.now(),title:"Bd Recyklingu",message:sr.message,outcome:"failure"}):(await ue.from("fleets").update({resources:{metal:wt,crystal:Da,deuterium:0}}).eq("id",w.id),et={id:`${w.id}-success`,timestamp:Date.now(),title:"Recykling Zakoczony",message:`Odzyskano: M:${wt} K:${Da}.`,outcome:"success",rewards:{metal:wt,crystal:Da}})}}B=D+1}else if(w.type===Ze.ATTACK||w.type===Ze.SPY||w.type===Ze.TRANSPORT)if(w.targetUserId){let Se=null,kt=!1,mt=w.targetUserId;const{data:$t,error:ve}=await ue.from("planets").select("*").eq("galaxy",w.targetCoords.galaxy).eq("system",w.targetCoords.system).eq("position",w.targetCoords.position).single();if($t)Se=$t,kt=!0,mt=$t.id;else{const{data:Mt,error:Ot}=await ue.from("profiles").select("*").eq("id",w.targetUserId).single();if(Ot)throw new Error("Target fetch error");Se=Mt,kt=!1,mt=Mt.id}let it={},pt=[...Se.mission_logs||[]],Ie=w.attackerName||"Nieznany";if(w.ownerId===s.user.id)Ie=fe.current.nickname||"Ty";else if(!w.attackerName||w.attackerName==="Nieznany"){console.log(` Fetching attacker name for ID: ${w.ownerId}`);const{data:Mt,error:Ot}=await ue.from("profiles").select("nickname, research").eq("id",w.ownerId).single();Ot&&console.error(" Error fetching attacker profile:",Ot),Mt&&Mt.nickname?(Ie=Mt.nickname,console.log(` Attacker identified: ${Ie}`)):console.warn(` Attacker profile not found or no nickname for ID: ${w.ownerId}`)}let Le=null;if(w.type===Ze.ATTACK){let Mt={};w.ownerId===s.user.id&&(Mt=fe.current.research);const Ot=ip(w.ships,Se.ships,Se.defenses||{},Se.buildings,Se.research,Se.resources,!1,Mt);Le=Ot;const Ua=`[${w.originCoords.galaxy}:${w.originCoords.system}:${w.originCoords.position}]`,La=`[${w.targetCoords.galaxy}:${w.targetCoords.system}:${w.targetCoords.position}]`;et={id:`${w.id}-result`,timestamp:Date.now(),title:Le.attackerWon?"Zwycistwo!":"Poraka",message:`Atak na ${Se.nickname||"Gracza"} ${La} zakoczony. Wynik: ${Le.attackerWon?"Wygrana":"Przegrana"}. Zrabowano: M:${Math.floor(Le.loot.metal)} C:${Math.floor(Le.loot.crystal)}.`,outcome:Le.attackerWon?"success":"failure",rewards:Le.loot,report:Le.report},ft=Le.loot,Wt=Le.survivingAttackerShips,Le.report.result==="attacker_win"&&Ma(50,"PvP Victory"),it.ships=Ot.survivingDefenderShips,it.defenses=Ot.survivingDefenderDefenses;const la={...Se.buildings};Object.entries(Ot.damagedBuildings||{}).forEach(([ma,as])=>{la[ma]&&(la[ma]=Math.max(0,la[ma]-as))}),it.buildings=la,it.resources={...Se.resources,metal:Math.max(0,Se.resources.metal-(ft.metal||0)),crystal:Math.max(0,Se.resources.crystal-(ft.crystal||0)),deuterium:Math.max(0,Se.resources.deuterium-(ft.deuterium||0))};const _t=Se.debris||{metal:0,crystal:0},Cs=Ot.debris||{metal:0,crystal:0};it.debris={metal:(_t.metal||0)+(Cs.metal||0),crystal:(_t.crystal||0)+(Cs.crystal||0)},pt.unshift({id:`${w.id}-def-log`,timestamp:Date.now(),title:"ZOSTAE ZAATAKOWANY!",message:`Gracz ${Ie} ${Ua} zaatakowa Twoj planet ${La}. Wynik: ${Ot.attackerWon?"PRZEGRANA":"OBRONA"}.`,outcome:"danger",report:Ot.report})}else if(w.type===Ze.TRANSPORT)it.resources={...Se.resources||{},metal:(((K=Se.resources)==null?void 0:K.metal)||0)+(((ee=w.resources)==null?void 0:ee.metal)||0),crystal:(((P=Se.resources)==null?void 0:P.crystal)||0)+(((I=w.resources)==null?void 0:I.crystal)||0),deuterium:(((V=Se.resources)==null?void 0:V.deuterium)||0)+(((he=w.resources)==null?void 0:he.deuterium)||0)},pt.unshift({id:Date.now().toString(),timestamp:Date.now(),title:"Dostawa Surowcw",message:`Otrzymano surowce od ${Ie}.`,outcome:"success"}),et={id:Date.now().toString(),timestamp:Date.now(),outcome:"success",title:"Transport",message:"Surowce dostarczone."};else if(w.type===Ze.SPY){let Mt={};if(w.ownerId===s.user.id)Mt=fe.current.research;else{const{data:ma,error:as}=await ue.from("profiles").select("nickname, research").eq("id",w.ownerId).single();Mt=(ma==null?void 0:ma.research)||{},(!Ie||Ie==="Nieznany")&&(ma!=null&&ma.nickname)&&(Ie=ma.nickname,console.log(` Spy Attacker identified (Fallback): ${Ie}`))}const Ot=(Mt==null?void 0:Mt.espionageTech)||0,Ua=((Ee=Se.research)==null?void 0:Ee.espionageTech)||0,La=Ot-Ua,la={targetName:Se.nickname||"Nieznany Cel",attackerSpyLevel:Ot,defenderSpyLevel:Ua,resources:Se.resources};let _t=[`Surowce: M:${Math.floor(Se.resources.metal)} K:${Math.floor(Se.resources.crystal)} D:${Math.floor(Se.resources.deuterium)}`];La>=2&&(la.ships=Se.ships,_t.push(`Flota: ${Object.keys(Se.ships||{}).length} typw.`)),La>=3&&(la.defenses=Se.defenses,_t.push(`Obrona: ${Object.keys(Se.defenses||{}).length} typw.`)),La>=5&&(la.buildings=Se.buildings,_t.push(`Budynki: ${Object.keys(Se.buildings||{}).length} typw.`));const Cs=w.originCoords?`[${w.originCoords.galaxy}:${w.originCoords.system}:${w.originCoords.position}]`:"[?:?:?]";np(" WYKRYTO SKANOWANIE",`Gracz ${Ie} ${Cs} przeskanowa Twoj planet.`,"/kosmo/icons/spy.png"),pt.unshift({id:`${w.id}-def-log`,timestamp:Date.now(),title:"Wykryto Skanowanie!",message:`Gracz ${Ie} ${Cs} przeskanowa Twoj planet.`,outcome:"danger"}),et={id:`${w.id}-result`,timestamp:Date.now(),title:"Raport Szpiegowski",message:`Skanowanie zakoczone. Poziomy: Ty:${Ot} vs Cel:${Ua}. 
${_t.join(`
`)}`,outcome:"success",report:la}}const wt={};w.type===Ze.ATTACK?(wt.metal=-(ft.metal||0),wt.crystal=-(ft.crystal||0),wt.deuterium=-(ft.deuterium||0)):w.type===Ze.TRANSPORT&&(wt.metal=((Oe=w.resources)==null?void 0:Oe.metal)||0,wt.crystal=((Tt=w.resources)==null?void 0:Tt.crystal)||0,wt.deuterium=((ht=w.resources)==null?void 0:ht.deuterium)||0);const Da={};if(w.type===Ze.ATTACK){const Mt=(Le==null?void 0:Le.debris)||{metal:0,crystal:0};Da.metal=Mt.metal,Da.crystal=Mt.crystal}const jn=w.type===Ze.ATTACK?Le==null?void 0:Le.survivingDefenderShips:void 0,sr=w.type===Ze.ATTACK?Le==null?void 0:Le.survivingDefenderDefenses:void 0,Ei=w.type===Ze.ATTACK?it.buildings:void 0,{error:os}=await ue.rpc("apply_mission_outcome",{p_mission_id:w.id,p_target_id:mt,p_is_planet:kt,p_log_entry:pt[0],p_resources_diff:wt,p_debris_diff:Da,p_ships_new:jn,p_defenses_new:sr,p_buildings_new:Ei});os&&(console.error("Mission Outcome RPC Error:",os),os.message.includes("UNAUTHORIZED")&&console.error("Critical Auth Error in Mission RPC")),B=D+1}else{if(w.type===Ze.ATTACK){const Se=ip(w.ships,{},{},{},{},{metal:5e3,crystal:3e3,deuterium:500},!0);et={id:`${w.id}-pve`,timestamp:Date.now(),title:"Bitwa z Piratami",message:`Wynik: ${Se.attackerWon?"Wygrana":"Przegrana"}.`,outcome:"success",rewards:Se.loot,report:Se.report},ft=Se.loot,Wt=Se.survivingAttackerShips,Ma(30,"Pirate Combat")}else et={id:Date.now().toString(),timestamp:Date.now(),outcome:"neutral",title:"Raport",message:"Cel nie istnieje (Pustka)."},w.type===Ze.TRANSPORT&&(ft=w.resources||{});B=D+1}const ia=(w.returnTime-w.startTime)/2;await ue.from("missions").update({status:"returning",resources:ft,ships:Wt,result:et,return_time:Date.now()+ia}).eq("id",w.id),Ke()}catch(ia){console.error("Critical Mission Arrival Error:",ia),await ue.from("missions").update({status:"returning",return_time:Date.now()+6e4,result:{id:Date.now().toString(),title:"Bd Systemowy",message:"Awaryjny powrt.",outcome:"neutral"}}).eq("id",w.id),B=D+1}}},S=async w=>{var B,D,ne,re,X;let A=0;const U=5;for(;A<U;)try{console.log(`Processing Return (Attempt ${A+1}):`,w.id);const{data:K}=await ue.from("missions").select("*").eq("id",w.id).single(),{data:ee,error:P}=await ue.from("profiles").select("*").eq("id",s.user.id).single();if(P||!ee)throw new Error("Profile fetch error");const I=K?{...w,resources:K.resources,result:K.result,ships:K.ships||w.ships,type:K.mission_type}:w,V=`${I.id}-return`;if((B=ee.mission_logs)==null?void 0:B.some(ve=>ve.id===V)){console.warn(" Powrt misji ju przetworzony (Dubel). Pomijam."),await ue.from("missions").update({status:"completed"}).eq("id",I.id),Ke();return}const Ee={...ee.ships};I.ships&&Object.entries(I.ships).forEach(([ve,it])=>{Ee[ve]=(Number(Ee[ve])||0)+(Number(it)||0)});const Oe={...wa.resources,...ee.resources||{}};I.resources&&(Oe.metal=(Number(Oe.metal)||0)+(Number(I.resources.metal)||0),Oe.crystal=(Number(Oe.crystal)||0)+(Number(I.resources.crystal)||0),Oe.deuterium=(Number(Oe.deuterium)||0)+(Number(I.resources.deuterium)||0),Oe.darkMatter=(Number(Oe.darkMatter)||0)+(Number(I.resources.darkMatter)||0),I.resources.ships&&Object.entries(I.resources.ships).forEach(([ve,it])=>{Ee[ve]=(Number(Ee[ve])||0)+(Number(it)||0)}));const Tt=((D=I.result)==null?void 0:D.title)||"Powrt Floty (Anulowana)";let ht="";Object.entries(I.ships||{}).forEach(([ve,it])=>{it>0&&(ht+=`${st[ve].name}: ${it}, `)}),ht&&(ht=ht.slice(0,-2));const et=I.resources,ft=et&&(et.metal||et.crystal||et.deuterium)?`Surowce: M:${Math.floor(et.metal||0)} K:${Math.floor(et.crystal||0)} D:${Math.floor(et.deuterium||0)}`:"",Wt=((ne=I.result)==null?void 0:ne.message)||`Flota wrcia z anulowanej misji ${I.type}. 
Flota: ${ht}. 
${ft}`,ia=((re=I.result)==null?void 0:re.outcome)||"neutral",Se=(X=I.result)==null?void 0:X.report,kt=[{id:V,timestamp:Date.now(),title:Tt,message:Wt,outcome:ia,rewards:I.resources,report:Se},...ee.mission_logs||[]].slice(0,50),{data:mt,error:$t}=await ue.rpc("save_game_atomic",{p_user_id:s.user.id,p_profile_data:{ships:Ee,resources:Oe,mission_logs:kt,points:ls(Oe,n.buildings,Ee,n.research,n.defenses),last_updated:Date.now()},p_expected_version:ee.version||1});if($t)if($t.message.includes("VERSION_MISMATCH")){console.warn(` Konflikt Wersji (Zmiana w tle). Ponawiam ${A+1}/${U}...`),A++,await new Promise(ve=>setTimeout(ve,Math.random()*500+200));continue}else throw $t;console.log(" Powrt Misji Zapisany (Atomowo)."),ge.current={...ge.current,ships:Ee,resources:Oe,missionLogs:kt,version:mt.new_version},o(ve=>({...ve,ships:Ee,resources:Oe,missionLogs:kt,version:mt.new_version})),await ue.from("missions").update({status:"completed"}).eq("id",I.id),Ke();return}catch(K){console.error("Critical Error in processMissionReturn:",K),alert(`BD MISJI: ${K.message||K} `);return}console.error(" Max Retries Exceeded for Mission Return"),alert("Nie udao si zapisa powrotu misji (Bd poczenia/Wersji). Sprbuj odwiey stron.")};F.useEffect(()=>{if(!(s!=null&&s.user))return;Ke();const w=ue.channel("missions-changes").on("postgres_changes",{event:"*",schema:"public",table:"missions",filter:`source_user=eq.${s.user.id}`},()=>Ke()).on("postgres_changes",{event:"*",schema:"public",table:"missions",filter:`target_user=eq.${s.user.id}`},()=>{console.log(" Incoming mission detected via Realtime"),Ke()}).subscribe(U=>{U==="SUBSCRIBED"&&console.log(" Connected to Missions stream (Filtered)")}),A=ue.channel("profile-changes").on("postgres_changes",{event:"UPDATE",schema:"public",table:"profiles",filter:`id=eq.${s.user.id}`},U=>{const B=U.new;B&&(console.log(" Profile update received via Realtime"),o(D=>({...D,missionLogs:B.mission_logs||D.missionLogs,nickname:B.nickname||D.nickname})))}).subscribe(U=>{U==="SUBSCRIBED"&&console.log(" Connected to Profile stream")});return()=>{ue.removeChannel(w),ue.removeChannel(A)}},[s]),F.useEffect(()=>{if(!d||!(s!=null&&s.user))return;let w=0;const A=async()=>{const B=Date.now(),D=[...fe.current.activeMissions||[],...fe.current.incomingMissions||[]];w++,w>=30&&(w=0,Ke());const ne=B-60*1e3,re=D.filter(P=>P.status==="flying"&&P.arrivalTime<ne),X=new Set;for(const P of re){console.warn(` AGGRESSIVE RESCUE: Force-completing stuck mission ${P.id}`),X.add(P.id),we.current.add(P.id),o(V=>({...V,activeMissions:V.activeMissions.filter(he=>he.id!==P.id),incomingMissions:V.incomingMissions.filter(he=>he.id!==P.id)}));const{error:I}=await ue.from("missions").update({status:"completed",result:{id:B.toString(),timestamp:B,title:"Misja Anulowana (System)",message:"Misja utkna i zostaa automatycznie zakoczona przez system.",outcome:"neutral"}}).eq("id",P.id);if(I?console.error(" AGGRESSIVE RESCUE DB ERROR:",I):console.log(" AGGRESSIVE RESCUE: Success"),P.ownerId===s.user.id){const{data:V}=await ue.from("profiles").select("ships").eq("id",s.user.id).single();if(V&&P.ships){const he={...V.ships};Object.entries(P.ships).forEach(([Ee,Oe])=>{he[Ee]=(Number(he[Ee])||0)+(Number(Oe)||0)}),await ue.from("profiles").update({ships:he}).eq("id",s.user.id)}}}const K=D.filter(P=>!X.has(P.id)&&P.status==="flying"&&B>=P.arrivalTime&&!P.eventProcessed&&(P.ownerId===s.user.id||P.targetUserId===s.user.id&&B>P.arrivalTime+1e4));for(const P of K)o(I=>({...I,activeMissions:I.activeMissions.map(V=>V.id===P.id?{...V,eventProcessed:!0}:V)})),await ye(P);const ee=D.filter(P=>P.status==="returning"&&B>=P.returnTime&&P.ownerId===s.user.id);for(const P of ee)o(I=>({...I,activeMissions:I.activeMissions.filter(V=>V.id!==P.id)})),await S(P);X.size>0&&Ke()};Ke();const U=setInterval(A,1e3);return()=>clearInterval(U)},[d,s]);const Q=(w,A,U)=>{const B=w==="building"?ts[A]:Tr[A],D=Math.pow(1.5,U);return{metal:Math.floor(B.baseCost.metal*D),crystal:Math.floor(B.baseCost.crystal*D),deuterium:Math.floor(B.baseCost.deuterium*D)}},ie=w=>{if(!w)return!0;for(const A of w)if(A.type==="building"){if(n.buildings[A.id]<A.level)return!1}else if(A.type==="research"&&n.research[A.id]<A.level)return!1;return!0},pe=w=>{const A=w.productionSettings,U=wt=>(A[wt]!==void 0?A[wt]:100)/100,B=w.buildings[le.METAL_MINE],D=U(le.METAL_MINE),ne=Math.floor(30*B*Math.pow(1.1,B))*hi*D,re=Math.floor(20*B*Math.pow(1.1,B))*D,X=w.buildings[le.CRYSTAL_MINE],K=U(le.CRYSTAL_MINE),ee=Math.floor(20*X*Math.pow(1.1,X))*hi*K,P=Math.floor(20*X*Math.pow(1.1,X))*K,I=w.buildings[le.DEUTERIUM_SYNTH],V=U(le.DEUTERIUM_SYNTH),he=Math.floor(10*I*Math.pow(1.1,I))*hi*V,Ee=Math.floor(40*I*Math.pow(1.1,I))*V,Oe=w.buildings[le.SOLAR_PLANT],Tt=U(le.SOLAR_PLANT),ht=w.buildings[le.FUSION_REACTOR],et=U(le.FUSION_REACTOR),ft=w.research[xe.ENERGY_TECH]||0;let Wt=Math.floor(20*Oe*Math.pow(1.1,Oe))*Tt;Wt+=Math.floor(30*ht*Math.pow(1.05+.01*ft,ht))*et;const ia=Math.floor(10*ht*Math.pow(1.1,ht))*et,Se=re+P+Ee,kt=Wt-Se,mt=kt>=0?1:Math.max(0,Wt/(Se||1)),$t=w.buildings[le.METAL_STORAGE],ve=w.buildings[le.CRYSTAL_STORAGE],it=w.buildings[le.DEUTERIUM_TANK],pt=1e4+5e3*Math.floor(Math.pow(2.5,$t)),Ie=1e4+5e3*Math.floor(Math.pow(2.5,ve)),Le=1e4+5e3*Math.floor(Math.pow(2.5,it));return{metal:ne*mt/3600,crystal:ee*mt/3600,deuterium:(he-ia)*mt/3600,energy:kt,maxEnergy:Wt,storage:{metal:pt,crystal:Ie,deuterium:Le}}},Ae=(w,A)=>{const U=Math.floor(w/1e3)+1;return A!=null&&A.reachedLevel16?Math.max(16,U):U},k=async(w,A)=>{if(n.resources.darkMatter<w)return"no_funds";if(A.metal&&n.resources.metal+A.metal>n.resources.storage.metal||A.crystal&&n.resources.crystal+A.crystal>n.resources.storage.crystal||A.deuterium&&n.resources.deuterium+A.deuterium>n.resources.storage.deuterium)return"storage_full";const U={...n.resources,darkMatter:n.resources.darkMatter-w,metal:Math.min(n.resources.storage.metal,n.resources.metal+(A.metal||0)),crystal:Math.min(n.resources.storage.crystal,n.resources.crystal+(A.crystal||0)),deuterium:Math.min(n.resources.storage.deuterium,n.resources.deuterium+(A.deuterium||0))};o(D=>({...D,resources:U}));const{error:B}=await ue.from("profiles").update({resources:U}).eq("id",s.user.id);return B?(console.error("buyPremium DB save failed:",B),o(D=>({...D,resources:n.resources})),"no_funds"):(ge.current={...ge.current,resources:U},ge.current={...ge.current,resources:U},"success")},Z=async(w,A)=>{const B=Date.now(),D=crypto.randomUUID(),ne={id:D,ownerId:s==null?void 0:s.user.id,type:Ze.EXPEDITION,ships:w,targetCoords:A,originCoords:n.galaxyCoords||{galaxy:1,system:1,position:1},startTime:B,arrivalTime:B+1e4/2,returnTime:B+1e4,eventProcessed:!1,status:"flying"};o(K=>{const ee={...K.ships};return Object.entries(w).forEach(([P,I])=>{ee[P]-=I}),{...K,ships:ee,activeMissions:[...K.activeMissions,ne]}});const{error:re}=await ue.from("missions").insert({id:D,owner_id:s.user.id,mission_type:Ze.EXPEDITION,ships:w,target_coords:A,origin_coords:n.galaxyCoords||{galaxy:1,system:1,position:1},start_time:B,arrival_time:B+1e4/2,return_time:B+1e4,status:"flying"});if(re){console.error("Failed to start expedition:",re),alert("Bd wysyania ekspedycji. Sprbuj ponownie."),o(K=>{const ee={...K.ships};return Object.entries(w).forEach(([P,I])=>{ee[P]=(ee[P]||0)+I}),{...K,ships:ee,activeMissions:K.activeMissions.filter(P=>P.id!==D)}});return}const X={...n.ships};Object.entries(w).forEach(([K,ee])=>{X[K]=(X[K]||0)-ee}),await ue.from("profiles").update({ships:X,points:ls(n.resources,n.buildings,X,n.research,n.defenses)}).eq("id",s.user.id)},me=async(w,A)=>{const U=n.galaxyCoords||{galaxy:1,system:1,position:1};let B;const D=300*1e3;if(U.galaxy!==A.galaxy)B=3600*1e3;else if(U.system!==A.system){const V=Math.abs(U.system-A.system);B=Math.min(900*1e3,D+V*30*1e3)}else{const V=Math.abs(U.position-A.position);B=D+V*10*1e3}const ne=Date.now(),re=crypto.randomUUID(),X=await Re(A);if(console.log(" ATTACK: Target at coords",A,"resolved to userId:",X),X){const{data:V,error:he}=await ue.from("profiles").select("points").eq("id",X).single();if(!he&&V){const Ee=Math.floor(Math.pow(V.points||0,.3333333333333333));if(Ee<7){alert(`Ten gracz znajduje si pod ochron pocztkujcych(Poziom ${Ee} < 7).Atak niemoliwy.`);return}}}const K={...n.ships};Object.entries(w).forEach(([V,he])=>{K[V]=(K[V]||0)-he});const{error:ee}=await ue.from("profiles").update({ships:K,points:ls(n.resources,n.buildings,K,n.research,n.defenses)}).eq("id",s.user.id);if(ee){console.error(" ATTACK PROFILE UPDATE ERROR:",ee),alert("Bd odejmowania statkw.");return}const P={id:re,ownerId:s==null?void 0:s.user.id,type:Ze.ATTACK,ships:w,targetCoords:A,targetUserId:X,originCoords:n.galaxyCoords||{galaxy:1,system:1,position:1},startTime:ne,arrivalTime:ne+B,returnTime:ne+B*2,eventProcessed:!1,status:"flying"};o(V=>({...V,ships:K,activeMissions:[...V.activeMissions,P]}));const{error:I}=await ue.from("missions").insert({id:re,owner_id:s.user.id,target_user_id:X,mission_type:Ze.ATTACK,ships:w,target_coords:A,origin_coords:n.galaxyCoords||{galaxy:1,system:1,position:1},start_time:ne,arrival_time:ne+B,return_time:ne+B*2,status:"flying"});I?console.error(" ATTACK INSERT ERROR:",I):console.log(" ATTACK INSERTED")},be=async(w,A)=>{if((n.ships[ce.ESPIONAGE_PROBE]||0)<w)return!1;const U=Date.now(),B=30*1e3,D=crypto.randomUUID(),ne=await Re(A),re={...n.ships};re[ce.ESPIONAGE_PROBE]=(re[ce.ESPIONAGE_PROBE]||0)-w;const{error:X}=await ue.from("profiles").update({ships:re,points:ls(n.resources,n.buildings,re,n.research,n.defenses)}).eq("id",s.user.id);if(X)return console.error(" SPY PROFILE UPDATE ERROR:",X),alert("Bd odejmowania sond."),!1;const K={id:D,ownerId:s==null?void 0:s.user.id,type:Ze.SPY,ships:{[ce.ESPIONAGE_PROBE]:w},targetCoords:A,targetUserId:ne,originCoords:n.galaxyCoords||{galaxy:1,system:1,position:1},startTime:U,arrivalTime:U+B/2,returnTime:U+B,eventProcessed:!1,status:"flying"};o(P=>({...P,ships:re,activeMissions:[...P.activeMissions,K]}));const{error:ee}=await ue.from("missions").insert({id:D,owner_id:s.user.id,target_user_id:ne,mission_type:Ze.SPY,ships:{[ce.ESPIONAGE_PROBE]:w},target_coords:A,origin_coords:n.galaxyCoords||{galaxy:1,system:1,position:1},start_time:U,arrival_time:U+B/2,return_time:U+B,status:"flying"});return ee&&console.error("Failed to send spy probe:",ee),!0},Ne=async(w,A,U)=>{const D=Date.now(),ne=crypto.randomUUID(),re=await Re(U),X={...n.ships};Object.entries(w).forEach(([V,he])=>{X[V]=(X[V]||0)-he});const K={...n.resources,metal:n.resources.metal-(A.metal||0),crystal:n.resources.crystal-(A.crystal||0),deuterium:n.resources.deuterium-(A.deuterium||0)},{error:ee}=await ue.from("profiles").update({ships:X,resources:K,points:ls(K,n.buildings,X,n.research,n.defenses)}).eq("id",s.user.id);if(ee){console.error("Error deducting resources:",ee),alert("Bd odejmowania surowcw.");return}const P={id:ne,ownerId:s==null?void 0:s.user.id,type:Ze.TRANSPORT,ships:w,resources:A,targetCoords:U,targetUserId:re,originCoords:n.galaxyCoords||{galaxy:1,system:1,position:1},startTime:D,arrivalTime:D+3e5/2,returnTime:D+3e5,eventProcessed:!1,status:"flying"};o(V=>({...V,ships:X,resources:K,activeMissions:[...V.activeMissions,P]}));const{error:I}=await ue.from("missions").insert({id:ne,owner_id:s.user.id,target_user_id:re,mission_type:Ze.TRANSPORT,ships:w,resources:A,target_coords:U,origin_coords:n.galaxyCoords||{galaxy:1,system:1,position:1},start_time:D,arrival_time:D+3e5/2,return_time:D+3e5,status:"flying"});I&&console.error("Error creating mission:",I)},Be=async w=>{const A=n.activeMissions.find(re=>re.id===w);if(!A||A.status!=="flying")return;const U=Date.now(),B=U-A.startTime,D=U+B;o(re=>({...re,activeMissions:re.activeMissions.map(X=>X.id===w?{...X,status:"returning",returnTime:D,arrivalTime:U}:X)}));const{error:ne}=await ue.from("missions").update({status:"returning",return_time:D,arrival_time:U}).eq("id",w);if(A.type==="attack"&&A.targetUserId){const{data:re}=await ue.from("profiles").select("mission_logs").eq("id",A.targetUserId).single();if(re){const K=[{id:Date.now().toString(),timestamp:Date.now(),title:"Atak Anulowany",message:`Gracz ${fe.current.nickname||"Nieznany"} [${A.originCoords.galaxy}: ${A.originCoords.system}: ${A.originCoords.position}] zawrci flot tu przed atakiem.
Skad floty: ${Object.entries(A.ships).map(([ee,P])=>{var I;return`${((I=st[ee])==null?void 0:I.name)||ee}: ${P}`}).join(", ")}.`,outcome:"info"},...re.mission_logs||[]].slice(0,50);await ue.from("profiles").update({mission_logs:K}).eq("id",A.targetUserId)}}ne&&(console.error("Failed to cancel mission:",ne),alert("Bd anulowania misji."),o(re=>({...re,activeMissions:re.activeMissions.map(X=>X.id===w?{...X,status:"flying",returnTime:A.returnTime,arrivalTime:A.arrivalTime}:X)})))},Je=async w=>{const A=n.buildings[w],U=Q("building",w,A);if(n.resources.metal<U.metal||n.resources.crystal<U.crystal||n.resources.deuterium<U.deuterium){console.log("Not enough resources");return}const B=n.constructionQueue.filter(Ee=>Ee.type==="building");if(B.length>=5){console.log("Queue full");return}const D=U.metal+U.crystal;let ne=D/2500*3600*1e3;ne=ne/(n.buildings[le.ROBOT_FACTORY]+1),ne=ne/hi;const re=Math.max(1e3,ne),X=B.sort((Ee,Oe)=>Oe.endTime-Ee.endTime)[0],K=X?X.endTime:Date.now(),ee=K+re,P={id:Date.now().toString(),type:"building",itemId:w,targetLevel:A+1,startTime:K,endTime:ee},I={...n.resources,metal:n.resources.metal-U.metal,crystal:n.resources.crystal-U.crystal,deuterium:n.resources.deuterium-U.deuterium},V=[...n.constructionQueue,P];o(Ee=>({...Ee,resources:{...Ee.resources,...I},constructionQueue:[...Ee.constructionQueue,P]})),Ma(Math.floor(D/100),"Building Construction");const{error:he}=await ue.from("profiles").update({resources:I,construction_queue:V}).eq("id",s.user.id);he&&(console.error("Building upgrade failed:",he),o(Ee=>{const Oe=Ee.constructionQueue.filter(Tt=>Tt.id!==P.id);return{...Ee,resources:{...Ee.resources,metal:Ee.resources.metal+U.metal,crystal:Ee.resources.crystal+U.crystal,deuterium:Ee.resources.deuterium+U.deuterium},constructionQueue:Oe}}))},Rt=async w=>{const A=n.constructionQueue.findIndex(P=>P.id===w);if(A===-1)return;const U=n.constructionQueue[A];if(U.type!=="building"&&U.type!=="research"){console.error("Cannot cancel item of type:",U.type);return}const B=(U.targetLevel||1)-1,D=Q(U.type,U.itemId,B),ne=Math.floor(D.metal||0),re=Math.floor(D.crystal||0),X=Math.floor(D.deuterium||0),K={...n.resources,metal:(n.resources.metal||0)+ne,crystal:(n.resources.crystal||0)+re,deuterium:(n.resources.deuterium||0)+X},ee=[...n.constructionQueue];ee.splice(A,1);for(let P=A;P<ee.length;P++){const I=P>0?ee[P-1]:null,V=I?I.endTime:Date.now(),he=ee[P].endTime-ee[P].startTime;ee[P]={...ee[P],startTime:V,endTime:V+he}}if(o(P=>({...P,resources:K,constructionQueue:ee})),U.type==="building"){const P=ne+re;Ma(-Math.floor(P/100),"Construction Cancelled")}try{const{error:P}=await ue.from("profiles").update({resources:K,construction_queue:ee}).eq("id",s.user.id);if(P)throw P}catch(P){console.error("Cancel constr sync failed:",P),o(I=>({...I,resources:n.resources,constructionQueue:n.constructionQueue}))}},dt=async w=>{const A=n.research[w],U=Q("research",w,A);if(n.resources.metal<U.metal||n.resources.crystal<U.crystal||n.resources.deuterium<U.deuterium||n.constructionQueue.some(I=>I.type==="research"))return;const B=Tr[w];if(B.maxLevel&&A>=B.maxLevel)return;const D=n.buildings[le.RESEARCH_LAB];if(D===0)return;let re=(U.metal+U.crystal)/1e3*3600*1e3;re=re/(D+1),re=re/hi;const X=Math.max(1e3,re),K=Date.now(),ee={id:K.toString(),type:"research",itemId:w,targetLevel:A+1,startTime:K,endTime:K+X};o(I=>({...I,resources:{...I.resources,metal:I.resources.metal-U.metal,crystal:I.resources.crystal-U.crystal,deuterium:I.resources.deuterium-U.deuterium},constructionQueue:[...I.constructionQueue,ee]}));const{error:P}=await ue.from("profiles").update({resources:{...n.resources,metal:n.resources.metal-U.metal,crystal:n.resources.crystal-U.crystal,deuterium:n.resources.deuterium-U.deuterium},construction_queue:[...n.constructionQueue,ee]}).eq("id",s.user.id);P&&(console.error("upgradeResearch DB save failed:",P),o(I=>({...I,resources:{...I.resources,metal:I.resources.metal+U.metal,crystal:I.resources.crystal+U.crystal,deuterium:I.resources.deuterium+U.deuterium},constructionQueue:I.constructionQueue.filter(V=>V.id!==ee.id)})))},$e=async(w,A)=>{const U=Math.max(1,Math.floor(A)),B=st[w],D={metal:B.baseCost.metal*U,crystal:B.baseCost.crystal*U,deuterium:B.baseCost.deuterium*U};if(n.resources.metal<D.metal||n.resources.crystal<D.crystal||n.resources.deuterium<D.deuterium)return;const ne=n.buildings[le.SHIPYARD];if(ne===0)return;const re=B.buildTime*1e3/(ne+1),X=Date.now();let K=X;n.shipyardQueue.length>0&&(K=n.shipyardQueue[n.shipyardQueue.length-1].endTime);const ee={id:X.toString()+Math.random(),type:"ship",itemId:w,quantity:U,startTime:K,endTime:K+re*U},P=[...n.shipyardQueue,ee];o(V=>({...V,resources:{...V.resources,metal:V.resources.metal-D.metal,crystal:V.resources.crystal-D.crystal,deuterium:V.resources.deuterium-D.deuterium},shipyardQueue:P})),Ma(Math.floor((D.metal+D.crystal)/200),"Fleet Production");const{error:I}=await ue.from("profiles").update({resources:{...n.resources,metal:n.resources.metal-D.metal,crystal:n.resources.crystal-D.crystal,deuterium:n.resources.deuterium-D.deuterium},shipyard_queue:P}).eq("id",s.user.id);I&&(console.error("buildShip DB save failed:",I),o(V=>({...V,resources:{...V.resources,metal:V.resources.metal+D.metal,crystal:V.resources.crystal+D.crystal,deuterium:V.resources.deuterium+D.deuterium},shipyardQueue:V.shipyardQueue.filter(he=>he.id!==ee.id)})))},zt=async(w,A)=>{const U=Math.max(1,Math.floor(A)),B=Qa[w];if(!B)return;const D={metal:B.cost.metal*U,crystal:B.cost.crystal*U,deuterium:B.cost.deuterium*U};if(n.resources.metal<D.metal||n.resources.crystal<D.crystal||n.resources.deuterium<D.deuterium)return;const ne=n.buildings[le.SHIPYARD];if(ne===0)return;const re=B.buildTime*1e3/(ne+1),X=Date.now();let K=X;n.shipyardQueue.length>0&&(K=n.shipyardQueue[n.shipyardQueue.length-1].endTime);const ee={id:`def - ${X} -${Math.random()} `,type:"defense",itemId:w,quantity:U,startTime:K,endTime:K+re*U},P=[...n.shipyardQueue,ee];o(V=>({...V,resources:{...V.resources,metal:V.resources.metal-D.metal,crystal:V.resources.crystal-D.crystal,deuterium:V.resources.deuterium-D.deuterium},shipyardQueue:P})),Ma(Math.floor((D.metal+D.crystal)/200),"Defense Production");const{error:I}=await ue.from("profiles").update({resources:{...n.resources,metal:n.resources.metal-D.metal,crystal:n.resources.crystal-D.crystal,deuterium:n.resources.deuterium-D.deuterium},shipyard_queue:P}).eq("id",s.user.id);I&&(console.error("buildDefense DB save failed:",I),o(V=>({...V,resources:{...V.resources,metal:V.resources.metal+D.metal,crystal:V.resources.crystal+D.crystal,deuterium:V.resources.deuterium+D.deuterium},shipyardQueue:V.shipyardQueue.filter(he=>he.id!==ee.id)})))},Xe=async()=>{var U;if(!((U=s==null?void 0:s.user)!=null&&U.id))return;const{data:w,error:A}=await ue.from("planets").select("*").eq("owner_id",s.user.id);w&&!A&&_(w)},de=async(w,A)=>{if((n.ships[ce.COLONY_SHIP]||0)<1)return alert("Potrzebujesz Statku Kolonizacyjnego!"),!1;if(x.length>=8)return alert("Osigne limit 8 planet!"),!1;const{data:U}=await ue.from("planets").select("id").contains("galaxy_coords",w),{data:B}=await ue.from("profiles").select("id").contains("galaxy_coords",w);if(U&&U.length>0||B&&B.length>0)return alert("Ta pozycja jest ju zajta!"),!1;const D={metal:Math.min(A.metal,15e3),crystal:Math.min(A.crystal,15e3),deuterium:Math.min(A.deuterium,15e3)};if(n.resources.metal<D.metal||n.resources.crystal<D.crystal||n.resources.deuterium<D.deuterium)return alert("Brak wystarczajcych zasobw!"),!1;const ne={...n.ships,[ce.COLONY_SHIP]:(n.ships[ce.COLONY_SHIP]||0)-1},re={...n.resources,metal:n.resources.metal-D.metal,crystal:n.resources.crystal-D.crystal,deuterium:n.resources.deuterium-D.deuterium},X=Date.now(),K=60*1e3,ee=n.galaxyCoords||{galaxy:1,system:1,position:1};let P=K;if(ee.galaxy!==w.galaxy)P=3600*1e3;else if(ee.system!==w.system){const Oe=Math.abs(ee.system-w.system);P=K+Oe*30*1e3}else{const Oe=Math.abs(ee.position-w.position);P=K+Oe*10*1e3}const I=crypto.randomUUID(),V={id:I,ownerId:s==null?void 0:s.user.id,type:Ze.COLONIZE,ships:{[ce.COLONY_SHIP]:1},targetCoords:w,targetUserId:s.user.id,originCoords:ee,startTime:X,arrivalTime:X+P,eventProcessed:!1,status:"flying",resources:D},{error:he}=await ue.from("profiles").update({ships:ne,resources:re}).eq("id",s.user.id);if(he)return console.error(" COLONIZE PROFILE UPDATE ERROR:",he),alert("Bd odejmowania surowcw."),!1;o(Oe=>({...Oe,ships:ne,resources:re,activeMissions:[...Oe.activeMissions,V]}));const{error:Ee}=await ue.from("missions").insert({id:I,owner_id:s.user.id,target_user_id:s.user.id,mission_type:Ze.COLONIZE,ships:{[ce.COLONY_SHIP]:1},target_coords:w,origin_coords:ee,start_time:X,arrival_time:X+P,status:"flying",resources:D});return Ee?(console.error(" COLONIZE MISSION ERROR:",Ee),alert("Bd tworzenia misji. Surowce zostay odjte."),!1):(Ma(500,"New Colony"),ge.current={...ge.current,ships:ne,resources:re},console.log(" Colonization mission sent!",V),alert(`Misja kolonizacyjna rozpoczta! Czas lotu: ${(P/1e3).toFixed(0)}s`),!0)},ae=async(w,A,U,B,D,ne,re)=>{const X={buildings:A,ships:U,defenses:B,resources:D,construction_queue:ne,shipyard_queue:re};console.log(""),console.log(` [COLONY SAVE] Planet: ${w}`),console.log(" [COLONY SAVE] Payload:"),console.log("   Buildings:",JSON.stringify(A)),console.log("   Ships:",JSON.stringify(U)),console.log("   Defenses:",JSON.stringify(B)),console.log("   Resources:",JSON.stringify(D)),console.log("   Queue:",(ne==null?void 0:ne.length)||0,"items"),console.log("   Shipyard:",(re==null?void 0:re.length)||0,"items");const{error:K,data:ee}=await ue.from("planets").update(X).eq("id",w).select();return K?(console.error(" [COLONY SAVE ERROR]:",K.message),console.warn(""),!1):(console.log(" [COLONY SAVE SUCCESS] Rows affected:",(ee==null?void 0:ee.length)||0),ee&&ee[0]&&console.log("   DB Response Buildings:",JSON.stringify(ee[0].buildings)),console.log(""),!0)},Ge=async w=>{var U,B,D,ne,re;console.log(" Switching to planet:",w);const A=fe.current;if(j&&j!=="main"){if(console.log(" Saving current colony before switch:",j),!await ae(j,A.buildings,A.ships,A.defenses,A.resources,A.constructionQueue,A.shipyardQueue)){alert("Bd zapisu stanu kolonii! Przeczanie przerwane, aby zapobiec utracie danych.");return}}else(!j||j==="main")&&(console.log(" Saving main planet before switch"),await ue.from("profiles").update({buildings:A.buildings,resources:A.resources,ships:A.ships,defenses:A.defenses,construction_queue:A.constructionQueue,shipyard_queue:A.shipyardQueue}).eq("id",s.user.id));if(w==="main")C("main"),N?(o(N),ge.current=JSON.parse(JSON.stringify(N)),G(null),console.log(" Restored main planet from cache (ref updated)")):(await Pe(),console.log(" Reloaded main planet from DB (no cache)"));else{console.log(" Fetching colony data from DB:",w);const{data:X,error:K}=await ue.from("planets").select("*").eq("id",w).single();if(X&&!K){(!j||j==="main")&&(G(A),console.log(" Cached main planet data")),C(w);const ee=X.resources||{},P={metal:ee.metal??500,crystal:ee.crystal??300,deuterium:ee.deuterium??100,darkMatter:ee.darkMatter??0,energy:0,maxEnergy:0,storage:{metal:((U=ee.storage)==null?void 0:U.metal)??1e4,crystal:((B=ee.storage)==null?void 0:B.crystal)??1e4,deuterium:((D=ee.storage)==null?void 0:D.deuterium)??1e4}},I=X.buildings||{},V={};Object.keys(wa.buildings).forEach(he=>{V[he]=I[he]??0}),console.log(""),console.log(" [LOAD] Colony loaded from Supabase:",w),console.log("   Resources:",JSON.stringify(P)),console.log("   Buildings:",JSON.stringify(V)),console.log("   Ships:",JSON.stringify(X.ships)),console.log("   Defenses:",JSON.stringify(X.defenses)),console.log("   ConstructionQueue:",((ne=X.construction_queue)==null?void 0:ne.length)||0,"items"),console.log("   ShipyardQueue:",((re=X.shipyard_queue)==null?void 0:re.length)||0,"items"),console.log(""),ge.current={...n,resources:P,buildings:V,ships:X.ships||{},defenses:X.defenses||{},constructionQueue:X.construction_queue||[],shipyardQueue:X.shipyard_queue||[]},o(he=>({...he,planetName:X.planet_name||`Kolonia ${x.indexOf(X)+1}`,planetType:X.planet_type||"terran",resources:P,buildings:V,ships:X.ships||{},defenses:X.defenses||{},constructionQueue:X.construction_queue||[],shipyardQueue:X.shipyard_queue||[],galaxyCoords:X.galaxy_coords,debris:X.debris||{metal:0,crystal:0}})),console.log(" Switched to colony (Fresh DB Load):",X.planet_name)}else console.error("Failed to load colony:",K),alert("Bd wczytywania kolonii.")}},Ve=(w,A)=>{o(U=>({...U,productionSettings:{...U.productionSettings,[w]:A}}))},ct=async(w,A)=>{if(!w.trim())return;const U=w.trim(),B=A||J.current,D=B==="main";if(console.log(` Renaming ${B} to ${U}`),B===J.current&&o(ne=>({...ne,planetName:U})),D&&M(U),D){const{error:ne}=await ue.from("profiles").update({planet_name:U}).eq("id",s.user.id);ne?console.error(" Main rename error:",ne):(console.log(" Main renamed"),await Xe())}else{const{error:ne}=await ue.from("planets").update({planet_name:U}).eq("id",B);ne?console.error(" Colony rename error:",ne):(console.log(" Colony renamed"),await Xe())}},Bt=async w=>{w.trim()&&(o(A=>({...A,nickname:w.trim(),productionSettings:{...A.productionSettings,nickname:w.trim()}})),await ue.from("profiles").update({nickname:w.trim(),production_settings:{...n.productionSettings,nickname:w.trim()}}).eq("id",s.user.id),console.log(" User renamed to:",w))},nt=()=>{localStorage.removeItem(Ts),window.location.reload()},ha=async()=>{o(w=>({...w,missionLogs:[]})),await ue.from("profiles").update({mission_logs:[]}).eq("id",s.user.id)},ua=async()=>{try{await je("Logout")}catch(w){console.error("Logout save failed:",w)}localStorage.removeItem(Ts),localStorage.removeItem(Ts+"_backup"),await ue.auth.signOut(),window.location.reload()},Ht=async(w,A)=>{if(!w||w==="main")return alert("Nie moesz porzuci Gwnej Planety!"),!1;if(A!=="DELETE")return!1;console.log(" Abandoning colony:",w);const{error:U}=await ue.from("planets").delete().eq("id",w);return U?(console.error("Failed to abandon colony:",U),alert(`Bd: ${U.message}`),!1):(j===w&&(C("main"),N&&(o(N),G(null))),Xe(),alert("Kolonia zostaa porzucona."),!0)},fa=async()=>{if(s!=null&&s.user&&confirm("Czy na pewno chcesz usun konto? Tej operacji nie mona cofn. Twoje imperium zostanie zniszczone."))try{await ue.from("missions").delete().eq("owner_id",s.user.id),await ue.from("profiles").delete().eq("id",s.user.id),await ua()}catch(w){console.error("Error deleting account:",w),alert("Bd podczas usuwania konta. Sprbuj ponownie.")}},Zt=async w=>{o(U=>({...U,avatarUrl:w}));const A=n.productionSettings||{};await ue.from("profiles").update({production_settings:{...A,avatarUrl:w}}).eq("id",s.user.id)},Ar=async w=>{o(U=>({...U,planetType:w}));const A=n.productionSettings||{};await ue.from("profiles").update({production_settings:{...A,planetType:w}}).eq("id",s.user.id)},Si=async(w,A)=>{try{const{data:U,error:B}=await ue.from("profiles").select("id, planet_name, galaxy_coords, points, production_settings, buildings, nickname, level, debris").contains("galaxy_coords",{galaxy:w,system:A});if(B)throw B;const{data:D,error:ne}=await ue.from("planets").select("id, owner_id, planet_name, planet_type, galaxy_coords, buildings, ships, defenses, debris").contains("galaxy_coords",{galaxy:w,system:A});if(ne)throw ne;let re=U||[];if(D&&D.length>0){const X=[...new Set(D.map(V=>V.owner_id))],{data:K,error:ee}=await ue.from("profiles").select("id, nickname, points, production_settings, level").in("id",X);ee&&console.error("Error fetching colony owners:",ee);const P=new Map((K==null?void 0:K.map(V=>[V.id,V]))||[]),I=D.map(V=>{const he=P.get(V.owner_id);return{id:V.owner_id,colony_id:V.id,planet_name:V.planet_name,galaxy_coords:V.galaxy_coords,points:(he==null?void 0:he.points)||0,level:(he==null?void 0:he.level)||1,production_settings:{...(he==null?void 0:he.production_settings)||{},planetType:V.planet_type},buildings:V.buildings,nickname:((he==null?void 0:he.nickname)||"Unknown")+" (Kolonia)",isColony:!0,debris:V.debris}});re=[...re,...I]}return re}catch(U){return console.error("Error fetching system users:",U),[]}};F.useEffect(()=>{if(!d)return;const A=setInterval(()=>{const U=Date.now(),B=fe.current,D=pe(B),ne=(U-B.lastTick)/1e3;if(ne<=0)return;const re=D.metal*ne,X=D.crystal*ne,K=D.deuterium*ne;let ee={...B.buildings},P={...B.research},I=[...B.constructionQueue],V=0;const he=I.filter(ve=>U>=ve.endTime),Ee=I.filter(ve=>U<ve.endTime);he.length>0&&(he.forEach(ve=>{if(ve.type==="building")ee[ve.itemId]=ve.targetLevel||1;else if(ve.type==="research"){const it=ve.targetLevel||1;P[ve.itemId]=it,V+=Math.pow(it,2)*10}}),I=Ee);let Oe={...B.ships},Tt={...B.defenses},ht=[...B.shipyardQueue];for(;ht.length>0&&U>=ht[0].endTime;){const ve=ht.shift();ve&&(ve.type==="defense"?Tt[ve.itemId]=(Tt[ve.itemId]||0)+(ve.quantity||0):Oe[ve.itemId]=(Oe[ve.itemId]||0)+(ve.quantity||0))}const et=(B.xp||0)+V,ft=Math.floor(Math.sqrt(et/500))+1,Wt=B.level||1;let ia=0;if(ft>Wt)for(let ve=Wt+1;ve<=ft;ve++)ia+=10+ve*2;const Se=ls(B.resources,ee,Oe,P,Tt),kt=Math.floor(Se/1e3)+1;let mt={...B.productionSettings},$t=!1;if(kt>=16&&!mt.reachedLevel16&&(mt.reachedLevel16=!0,$t=!0),he.length>0||B.shipyardQueue.length!==ht.length||$t||U-B.lastTick>3e4){const ve=J.current,it=he.length>0?"Queue Completed":U-B.lastTick>3e4?"Tick 30s":"Settings Changed";if(console.log(` [TICK SAVE] Reason: ${it}, Target: ${ve||"main"}`),!ve||ve==="main"){const pt={buildings:ee,research:P,ships:Oe,defenses:Tt,resources:{...B.resources,metal:Math.min(D.storage.metal,(B.resources.metal||0)+re),crystal:Math.min(D.storage.crystal,(B.resources.crystal||0)+X),deuterium:Math.min(D.storage.deuterium,(B.resources.deuterium||0)+K),darkMatter:(B.resources.darkMatter||0)+ia},xp:et,level:ft,shipyard_queue:ht,construction_queue:I,production_settings:mt,last_updated:Date.now()};console.log(" [TICK SAVE] Payload:",JSON.stringify(pt).substring(0,200)+"..."),ue.from("profiles").update(pt).eq("id",s.user.id).then(({error:Ie})=>{Ie?console.error(" [TICK SAVE ERROR] Main:",Ie):console.log(" [TICK SAVE] Main Success")})}else{console.log(` [TICK SAVE] Colony ${ve} - Buildings:`,JSON.stringify(ee));const pt={...B.resources,metal:Math.min(D.storage.metal,(B.resources.metal||0)+re),crystal:Math.min(D.storage.crystal,(B.resources.crystal||0)+X),deuterium:Math.min(D.storage.deuterium,(B.resources.deuterium||0)+K)};ae(ve,ee,Oe,Tt,pt,I,ht),ue.from("profiles").update({production_settings:mt,research:P,points:ls(pt,ee,Oe,P,Tt),xp:et,level:ft,last_updated:Date.now()}).eq("id",s.user.id).then(Ie=>{Ie.error&&console.error("Colony profile sync error:",Ie.error)})}ge.current={...B,buildings:ee,research:P,ships:Oe,defenses:Tt,resources:{...B.resources,metal:Math.min(D.storage.metal,(B.resources.metal||0)+re),crystal:Math.min(D.storage.crystal,(B.resources.crystal||0)+X),deuterium:Math.min(D.storage.deuterium,(B.resources.deuterium||0)+K),darkMatter:(B.resources.darkMatter||0)+ia},constructionQueue:I,shipyardQueue:ht}}o(ve=>{const it=(ve.xp||0)+V,pt=Math.floor(Math.sqrt(it/500))+1,Ie=ve.level||1;let Le=0;if(pt>Ie){for(let wt=Ie+1;wt<=pt;wt++)Le+=10+wt*2;Le>0&&console.log(` Level Up! ${Ie} -> ${pt}. Reward: ${Le} DM`)}return{...ve,productionSettings:$t?mt:ve.productionSettings,resources:{...ve.resources,metal:Math.min(D.storage.metal,(ve.resources.metal||0)+re),crystal:Math.min(D.storage.crystal,(ve.resources.crystal||0)+X),deuterium:Math.min(D.storage.deuterium,(ve.resources.deuterium||0)+K),energy:D.energy,maxEnergy:D.maxEnergy,storage:D.storage,darkMatter:(ve.resources.darkMatter||0)+Le},buildings:ee,research:P,ships:Oe,defenses:Tt,constructionQueue:I,shipyardQueue:ht,productionRates:{metal:D.metal,crystal:D.crystal,deuterium:D.deuterium},xp:it,level:pt,lastTick:U}})},Ly);return()=>clearInterval(A)},[d]);const Ma=(w,A)=>{w<=0||(o(U=>{const B=U.xp||0,D=U.level||1,ne=B+w,re=Math.floor(Math.sqrt(ne/500))+1;if(re>D){const X=10+re*2;return{...U,xp:ne,level:re,resources:{...U.resources,darkMatter:(U.resources.darkMatter||0)+X}}}return{...U,xp:ne,level:re}}),A&&console.log(` [XP] +${w} (${A})`))},Os=F.useRef(!1);F.useEffect(()=>{if(!d||Os.current)return;let w=0;const A=D=>{let ne=0;return Object.entries(D).forEach(([re,X])=>{const K=ts[re];if(!K)return;let ee=0;for(let P=1;P<=X;P++){const I=Math.pow(1.5,P-1);ee+=Math.floor(K.baseCost.metal*I)+Math.floor(K.baseCost.crystal*I)}ne+=Math.floor(ee/100)}),ne},U=D=>{let ne=0;return Object.entries(D).forEach(([re,X])=>{const K=st[re];if(!K)return;const ee=K.baseCost.metal+K.baseCost.crystal;ne+=Math.floor(ee*X/200)}),ne};w+=A(n.buildings),w+=U(n.ships),x.forEach(D=>{D.buildings&&(w+=A(D.buildings)),D.ships&&(w+=U(D.ships))}),Object.entries(n.research).forEach(([D,ne])=>{let re=0;for(let X=1;X<=ne;X++)re+=Math.pow(X,2)*10;w+=re});const B=n.xp||0;if(w>B+10){const D=w-B;console.log(` Retroactive XP Fix: Player has ${B}, Assets worth ${w}. Adding ${D}.`),Os.current=!0,Ma(D,"Retroactive Catch-Up")}else Os.current=!0},[d,x.length]);const Jl={...n,addXP:Ma,upgradeBuilding:Je,upgradeResearch:dt,buildShip:$e,buildDefense:zt,sendExpedition:Z,sendAttack:me,sendSpyProbe:be,sendTransport:Ne,cancelMission:Be,cancelConstruction:Rt,buyPremium:k,getCost:Q,checkRequirements:ie,renamePlanet:ct,updateProductionSetting:Ve,resetGame:nt,isOnline:g,clearLogs:ha,logout:ua,deleteAccount:fa,abandonColony:Ht,updateAvatar:Zt,updatePlanetType:Ar,getPlayersInSystem:Si,renameUser:Bt,getLevel:Ae,session:s,planets:x,currentPlanetId:j,mainPlanetName:z,mainPlanetCoords:E,sendColonize:de,switchPlanet:Ge,fetchPlanets:Xe};return r.jsx(Ap.Provider,{value:Jl,children:l})},ca=()=>{const l=F.useContext(Ap);if(l===void 0)throw new Error("useGame must be used within a GameProvider");return l},Hy=({activeView:l,onNavigate:s})=>{var g,p,v;const n=ca();n!=null&&n.resetGame;const o=(n==null?void 0:n.avatarUrl)||"/kosmo/avatars/avatar_default.png",d=(n==null?void 0:n.nickname)||(n!=null&&n.userId?`Kmdr. ${n.userId.split("-")[0]}`:"Kmdr. DareG"),h=[{id:"overview",label:"Podgld",icon:"dashboard"},{id:"buildings",label:"Budynki",icon:"domain"},{id:"shipyard",label:"Stocznia",icon:"rocket_launch"},{id:"research",label:"Badania",icon:"science"},{id:"galaxy",label:"Galaktyka",icon:"public"},{id:"fleet",label:"Flota",icon:"flight_takeoff"},{id:"shop",label:"Sklep",icon:"shopping_cart"},{id:"defense",label:"Obrona",icon:"shield"},{id:"clans",label:"Klany",icon:"groups"},{id:"ranking",label:"Ranking",icon:"leaderboard"},{id:"settings",label:"Opcje",icon:"settings"}],f=["admin@kosmo.pl","dareg@kosmo.pl","admin@kosmo.com"],b=(v=(p=(g=n.session)==null?void 0:g.user)==null?void 0:p.email)==null?void 0:v.toLowerCase();return b&&f.includes(b)&&h.push({id:"admin",label:"ADMIN",icon:"shield_person"}),r.jsxs("aside",{className:"w-64 flex-shrink-0 flex flex-col bg-[#111422] border-r border-white/5 z-20 hidden lg:flex h-full",children:[r.jsx("div",{className:"p-6 border-b border-white/5",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 flex-shrink-0 aspect-square bg-center bg-no-repeat bg-cover rounded-full border-2 border-primary",style:{backgroundImage:`url("${o}")`}}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("h1",{className:"text-white text-base font-bold tracking-tight uppercase",children:"Centrum Dowodzenia"}),r.jsx("p",{className:"text-[#929bc9] text-xs font-normal",children:d})]})]})}),n.planets&&n.planets.length>0&&r.jsxs("div",{className:"mx-4 mt-4 p-3 bg-[#1a1f35] border border-white/10 rounded-lg",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"text-xs text-[#929bc9] uppercase font-bold",children:"Twoje Planety"}),r.jsxs("span",{className:"text-xs text-primary",children:[n.planets.length+1,"/9"]})]}),r.jsx("button",{onClick:()=>n.switchPlanet("main"),className:`w-full text-left px-3 py-2 rounded mb-1 text-sm transition-colors ${!n.currentPlanetId||n.currentPlanetId==="main"?"bg-primary/20 text-white border border-primary/50":"bg-white/5 text-[#929bc9] hover:bg-white/10 border border-transparent"}`,children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"home"}),r.jsx("span",{className:"truncate",children:n.mainPlanetName||n.planetName}),n.galaxyCoords&&r.jsxs("span",{className:"text-xs text-gray-500 ml-auto",children:["[",n.galaxyCoords.galaxy,":",n.galaxyCoords.system,":",n.galaxyCoords.position,"]"]})]})}),n.planets.map(x=>{var _,j,C;return r.jsx("button",{onClick:()=>n.switchPlanet(x.id),className:`w-full text-left px-3 py-2 rounded mb-1 text-sm transition-colors ${n.currentPlanetId===x.id?"bg-primary/20 text-white border border-primary/50":"bg-white/5 text-[#929bc9] hover:bg-white/10 border border-transparent"}`,children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"public"}),r.jsx("span",{className:"truncate",children:x.planet_name}),r.jsxs("span",{className:"text-xs text-gray-500 ml-auto",children:["[",(_=x.galaxy_coords)==null?void 0:_.galaxy,":",(j=x.galaxy_coords)==null?void 0:j.system,":",(C=x.galaxy_coords)==null?void 0:C.position,"]"]})]})},x.id)})]}),n.incomingMissions&&n.incomingMissions.length>0&&r.jsxs("div",{className:"mx-4 mt-4 p-3 bg-red-900/50 border border-red-500 rounded-lg animate-pulse flex items-center gap-3 shadow-[0_0_15px_rgba(239,68,68,0.5)]",children:[r.jsx("span",{className:"material-symbols-outlined text-red-500 animate-bounce",children:"warning"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-red-400 text-xs font-bold uppercase tracking-wider",children:"Uwaga!"}),r.jsx("div",{className:"text-white text-xs font-medium",children:"Nadciga Wrg!"})]})]}),r.jsx("nav",{className:"flex-1 overflow-y-auto px-4 py-4 space-y-2",children:h.map(x=>{const _=l===x.id,j=x.id==="shop";return r.jsxs("button",{onClick:()=>s(x.id),className:`w-full flex items-center gap-3 px-3 py-3 rounded-lg transition-all group ${_?"bg-primary/20 text-white border border-primary/50 shadow-[0_0_15px_rgba(19,55,236,0.3)]":"text-[#929bc9] hover:bg-white/5 hover:text-white"} ${j?"text-yellow-400 hover:text-yellow-300":""}`,children:[r.jsx("span",{className:`material-symbols-outlined ${_?"text-primary":j?"text-yellow-500":"group-hover:text-primary transition-colors"}`,children:x.icon}),r.jsx("span",{className:"text-sm font-medium",children:x.label})]},x.id)})}),r.jsxs("div",{className:"p-4 border-t border-white/10",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx("div",{className:`w-2 h-2 rounded-full ${n.isOnline?"bg-green-500 animate-pulse":"bg-red-500"} `}),r.jsx("span",{className:`text-xs font-bold uppercase tracking-wider ${n.isOnline?"text-[#929bc9]":"text-red-500"}`,children:n.isOnline?"Status: Online":"Status: Offline"})]}),r.jsx("div",{className:"text-white text-sm font-medium mb-1",children:d}),r.jsx("div",{className:"text-[#555a7a] text-xs font-mono",children:"v1.2.8"})]})]})},fi=({name:l,value:s,icon:n,production:o,subValue:d,colorClass:h,bgClass:f})=>r.jsxs("div",{className:`flex items-center gap-2 md:gap-3 min-w-[90px] md:min-w-[150px] px-2 py-1 md:px-3 md:py-2 rounded-xl border border-white/5 ${f} backdrop-blur-md flex-shrink-0 shadow-sm transition-colors`,children:[r.jsx("div",{className:`size-6 md:size-10 rounded-full flex items-center justify-center shadow-lg ${h}`,children:r.jsx("span",{className:"material-symbols-outlined text-white text-xs md:text-lg",children:n})}),r.jsxs("div",{className:"flex flex-col justify-center",children:[r.jsx("span",{className:"text-[9px] md:text-[10px] text-[#929bc9] font-bold uppercase tracking-wider mb-0.5",children:l}),r.jsxs("div",{className:"flex flex-col md:flex-row md:items-baseline md:gap-2",children:[r.jsx("span",{className:`text-xs md:text-lg font-bold font-mono leading-none ${(s??0)<0?"text-red-500 animate-pulse":"text-white"}`,children:Math.floor(s??0).toLocaleString()}),o!==void 0&&r.jsxs("div",{className:"flex items-center gap-0.5 mt-0.5 md:mt-0",children:[r.jsx("span",{className:"material-symbols-outlined text-[10px] text-[#0bda65]",children:"trending_up"}),r.jsxs("span",{className:"text-[#0bda65] text-[10px] font-medium font-mono leading-none whitespace-nowrap",children:[Math.floor((o??0)*3600).toLocaleString(),"/h"]})]}),d!==void 0&&r.jsxs("span",{className:"text-[#929bc9] text-[10px] font-medium leading-none whitespace-nowrap mt-0.5 md:mt-0",children:["/ ",(d??0).toLocaleString()]})]})]})]}),$y=()=>{const{resources:l,productionRates:s,logout:n,planets:o,currentPlanetId:d,switchPlanet:h,planetName:f,mainPlanetName:b,galaxyCoords:g}=ca(),[p,v]=_i.useState(!1);return r.jsx("header",{className:"bg-[#111422]/90 backdrop-blur-md border-b border-white/5 p-3 flex-shrink-0 relative z-50",children:r.jsxs("div",{className:"flex flex-wrap gap-3 justify-between items-center w-full",children:[o&&o.length>0&&r.jsxs("div",{className:"relative lg:hidden",children:[r.jsx("button",{onClick:()=>v(!p),className:"flex items-center justify-center p-2 bg-[#1c2136] border border-white/10 rounded-lg hover:border-primary/50 transition-colors",children:r.jsx("span",{className:"material-symbols-outlined text-primary text-xl",children:"public"})}),p&&r.jsxs("div",{className:"absolute top-full left-0 mt-1 bg-[#1c2136] border border-white/10 rounded-lg shadow-xl z-50 min-w-[200px]",children:[r.jsxs("button",{onClick:()=>{h("main"),v(!1)},className:`w-full text-left px-4 py-3 text-sm hover:bg-white/5 transition-colors flex items-center gap-3 border-b border-white/5 ${!d||d==="main"?"text-primary bg-primary/10":"text-white"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-lg",children:"home"}),b||"Gwna"]}),o.map((x,_)=>r.jsxs("button",{onClick:()=>{h(x.id),v(!1)},className:`w-full text-left px-4 py-3 text-sm hover:bg-white/5 transition-colors flex items-center gap-3 border-b border-white/5 last:border-0 ${d===x.id?"text-primary bg-primary/10":"text-white"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-lg",children:"public"}),x.planet_name||`Kolonia ${_+1}`]},x.id))]})]}),r.jsxs("div",{className:"flex gap-2 md:gap-3 flex-1 overflow-x-auto pb-2 items-center",children:[r.jsx(fi,{name:"Tytan",value:l.metal,production:s==null?void 0:s.metal,icon:"handyman",colorClass:"bg-gradient-to-br from-gray-500 to-gray-700",bgClass:"bg-[#1c2136]"}),r.jsx(fi,{name:"Krzem",value:l.crystal,production:s==null?void 0:s.crystal,icon:"diamond",colorClass:"bg-gradient-to-br from-blue-400 to-blue-600",bgClass:"bg-[#1c2136]"}),r.jsx(fi,{name:"Plazma",value:l.deuterium,production:s==null?void 0:s.deuterium,icon:"propane",colorClass:"bg-gradient-to-br from-teal-400 to-teal-600",bgClass:"bg-[#1c2136]"}),r.jsx(fi,{name:"Energia",value:l.energy,subValue:l.maxEnergy,icon:"bolt",colorClass:"bg-gradient-to-br from-yellow-400 to-orange-500",bgClass:"bg-[#1c2136]"}),r.jsx(fi,{name:"Nanity",value:l.darkMatter||0,icon:"all_inclusive",colorClass:"bg-gradient-to-br from-purple-500 to-indigo-600",bgClass:"bg-[#1c2136] border-purple-500/20 shadow-purple-900/20"})]}),r.jsx("div",{className:"hidden lg:block",children:r.jsx("button",{onClick:n,className:"bg-center bg-no-repeat bg-cover rounded-full size-10 border-2 border-primary cursor-pointer hover:scale-105 transition-transform shadow-lg shadow-primary/20 flex items-center justify-center group bg-[#111422]",title:"Wyloguj",children:r.jsx("span",{className:"material-symbols-outlined text-white group-hover:text-red-400 transition-colors",children:"logout"})})})]})})},lp=100,kp="kosmo_error_logs";let za=[],Pl=[],Iy=null;const qy=()=>`${Date.now()}-${Math.random().toString(36).slice(2,9)}`,Py=()=>{try{const l=localStorage.getItem(kp);l&&(za=JSON.parse(l))}catch{za=[]}return za},Op=()=>{try{za.length>lp&&(za=za.slice(-lp)),localStorage.setItem(kp,JSON.stringify(za))}catch{}},Cp=()=>{Pl.forEach(l=>l([...za]))},Gy=async l=>{try{await ue.from("error_logs").insert({user_id:Iy,error_type:l.type,message:l.message,context:l.context,stack:l.stack,user_agent:navigator.userAgent,url:window.location.href})}catch(s){console.warn("Failed to send error to Supabase:",s)}},Rp=(l,s,n,o)=>{const d={id:qy(),timestamp:Date.now(),type:l,message:s,context:n,stack:o};return za.push(d),Op(),Cp(),d},vu=(l,s,n)=>{console.error(` [ERROR] ${l}`,s,n);const o=Rp("error",l,s,n==null?void 0:n.stack);return Gy(o),o},Yy=()=>{za=[],Op(),Cp()},Ky=()=>[...za],Vy=()=>za.filter(l=>l.type==="error").length,zp=l=>(Pl.push(l),()=>{Pl=Pl.filter(s=>s!==l)}),Qy=()=>{window.onerror=(s,n,o,d,h)=>(vu(String(s),`${n}:${o}:${d}`,h),!1),window.onunhandledrejection=s=>{var o;const n=((o=s.reason)==null?void 0:o.message)||String(s.reason);vu(n,"UnhandledPromiseRejection",s.reason instanceof Error?s.reason:void 0)},window.addEventListener("error",s=>{if(s.target&&s.target instanceof HTMLElement){const n=s.target,o=n.src||n.href||"unknown",d=n.tagName.toLowerCase();vu(`Failed to load resource: <${d} src="${o}">`,"ResourceLoader")}},!0);const l=console.error;console.error=(...s)=>{l.apply(console,s);const n=s.map(o=>typeof o=="object"?o.message||JSON.stringify(o):String(o)).join(" ");n.includes(" [ERROR]")||Rp("error",n,"Console")}};Py();console.log(" Error Logger initialized");const Zy=async()=>{try{const l=za.map(s=>`[${new Date(s.timestamp).toLocaleTimeString()}] ${s.type.toUpperCase()}: ${s.message}${s.context?` (${s.context})`:""}`).join(`
`);return await navigator.clipboard.writeText(l),!0}catch{return!1}},Jy=({visible:l,onClose:s})=>{const[n,o]=F.useState([]),[d,h]=F.useState("all"),[f,b]=F.useState(null),[g,p]=F.useState(!1),[v,x]=F.useState(!1);F.useEffect(()=>(o(Ky()),zp(o)),[]);const _=d==="all"?n:n.filter(M=>M.type===d),j=async()=>{await Zy()&&(p(!0),setTimeout(()=>p(!1),2e3))},C=()=>{Yy()},z=M=>new Date(M).toLocaleTimeString("pl-PL");return l?r.jsxs("div",{style:{position:"fixed",bottom:0,left:0,right:0,height:v?"40px":"50vh",maxHeight:v?"40px":"400px",background:"linear-gradient(180deg, #1a1a2e 0%, #16213e 100%)",borderTop:"2px solid #e94560",zIndex:9999,display:"flex",flexDirection:"column",fontFamily:"monospace",fontSize:"12px",transition:"height 0.2s, max-height 0.2s"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 12px",background:"rgba(0,0,0,0.3)",borderBottom:v?"none":"1px solid rgba(255,255,255,0.1)",cursor:"pointer"},onClick:()=>x(!v),children:[r.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[r.jsx("span",{style:{color:"#e94560",fontWeight:"bold"},children:" Debug Console"}),r.jsxs("span",{style:{color:"#666",fontSize:"10px"},children:["(",n.length," wpisw)"]}),v&&n.filter(M=>M.type==="error").length>0&&r.jsxs("span",{style:{color:"#ff4444",fontSize:"10px"},children:[" ",n.filter(M=>M.type==="error").length," bdw"]})]}),r.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[!v&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"hidden sm:flex",style:{gap:"8px"},children:[r.jsx("button",{onClick:M=>{M.stopPropagation(),h("all")},style:{padding:"4px 8px",background:d==="all"?"#e94560":"#333",border:"none",borderRadius:"4px",color:"white",cursor:"pointer",fontSize:"10px"},children:"Wszystkie"}),r.jsx("button",{onClick:M=>{M.stopPropagation(),h("error")},style:{padding:"4px 8px",background:d==="error"?"#ff4444":"#333",border:"none",borderRadius:"4px",color:"white",cursor:"pointer",fontSize:"10px"},children:" Bdy"}),r.jsx("button",{onClick:M=>{M.stopPropagation(),h("warning")},style:{padding:"4px 8px",background:d==="warning"?"#ffaa00":"#333",border:"none",borderRadius:"4px",color:"white",cursor:"pointer",fontSize:"10px"},children:" Ostrzeenia"})]}),r.jsx("button",{onClick:M=>{M.stopPropagation(),j()},style:{padding:"4px 12px",background:g?"#4CAF50":"#0f3460",border:"none",borderRadius:"4px",color:"white",cursor:"pointer",fontSize:"10px"},children:g?"":""}),r.jsx("button",{onClick:M=>{M.stopPropagation(),C()},style:{padding:"4px 12px",background:"#333",border:"none",borderRadius:"4px",color:"white",cursor:"pointer",fontSize:"10px"},children:""})]}),r.jsx("button",{onClick:M=>{M.stopPropagation(),x(!v)},style:{padding:"4px 8px",background:"#333",border:"none",borderRadius:"4px",color:"white",cursor:"pointer",fontSize:"14px"},children:v?"":""}),r.jsx("button",{onClick:M=>{M.stopPropagation(),s()},style:{padding:"4px 12px",background:"#e94560",border:"none",borderRadius:"4px",color:"white",cursor:"pointer",fontSize:"10px"},children:""})]})]}),!v&&r.jsx("div",{style:{flex:1,overflowY:"auto",padding:"8px"},children:_.length===0?r.jsx("div",{style:{color:"#666",textAlign:"center",padding:"20px"},children:"Brak logw do wywietlenia"}):[..._].reverse().map(M=>r.jsxs("div",{onClick:()=>b(f===M.id?null:M.id),style:{padding:"8px",marginBottom:"4px",background:M.type==="error"?"rgba(255,68,68,0.1)":M.type==="warning"?"rgba(255,170,0,0.1)":"rgba(68,136,255,0.1)",borderLeft:`3px solid ${M.type==="error"?"#ff4444":M.type==="warning"?"#ffaa00":"#4488ff"}`,borderRadius:"4px",cursor:"pointer"},children:[r.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"flex-start",flexWrap:"wrap"},children:[r.jsx("span",{style:{color:"#666",minWidth:"60px",fontSize:"10px"},children:z(M.timestamp)}),r.jsx("span",{style:{color:M.type==="error"?"#ff4444":M.type==="warning"?"#ffaa00":"#4488ff",fontWeight:"bold",fontSize:"10px"},children:M.type==="error"?"":M.type==="warning"?"":""}),r.jsx("span",{style:{color:"#eee",flex:1,fontSize:"11px",wordBreak:"break-word"},children:M.message})]}),M.context&&r.jsxs("div",{style:{color:"#888",marginTop:"4px",fontSize:"10px"},children:[" ",M.context]}),f===M.id&&M.stack&&r.jsx("pre",{style:{color:"#666",marginTop:"8px",fontSize:"9px",whiteSpace:"pre-wrap",wordBreak:"break-all",maxHeight:"150px",overflow:"auto"},children:M.stack})]},M.id))})]}):null},Xy=({onClick:l})=>{const[s,n]=F.useState(0);return F.useEffect(()=>{const o=()=>n(Vy());return o(),zp(o)},[]),r.jsxs("button",{onClick:l,style:{position:"fixed",bottom:"80px",right:"10px",width:"40px",height:"40px",borderRadius:"50%",background:s>0?"#e94560":"rgba(15, 52, 96, 0.8)",border:"2px solid rgba(255,255,255,0.2)",color:"white",fontSize:"16px",cursor:"pointer",zIndex:9998,display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 2px 10px rgba(0,0,0,0.3)",transition:"all 0.2s"},title:"Otwrz konsol debug",children:["",s>0&&r.jsx("span",{style:{position:"absolute",top:"-5px",right:"-5px",background:"#ff4444",color:"white",borderRadius:"50%",width:"18px",height:"18px",fontSize:"9px",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold"},children:s>9?"9+":s})]})},Wy=({onClose:l})=>r.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4",onClick:l,children:r.jsxs("div",{className:"bg-[#1c2136] w-full max-w-2xl max-h-[80vh] overflow-hidden rounded-2xl border border-white/10 shadow-2xl flex flex-col",onClick:s=>s.stopPropagation(),children:[r.jsxs("div",{className:"p-4 border-b border-white/10 flex justify-between items-center bg-[#15192b]",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"p-2 rounded-lg bg-blue-500/20 text-blue-400",children:r.jsx("span",{className:"material-symbols-outlined text-2xl",children:"info"})}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-bold text-white tracking-wide",children:"Aktualnoci i Zmiany"}),r.jsx("p",{className:"text-xs text-[#929bc9]",children:"Ostatnie aktualizacje (Od wczoraj)"})]})]}),r.jsx("button",{onClick:l,className:"text-[#929bc9] hover:text-white p-2 hover:bg-white/5 rounded-lg transition-colors",children:r.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto p-6 bg-[#0b0d17]/50 space-y-6",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsxs("h3",{className:"text-red-400 font-bold uppercase text-sm border-b border-red-500/20 pb-2 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-lg",children:"swords"}),"Nowy System Walki"]}),r.jsxs("div",{className:"text-sm text-[#cdd6f7] space-y-2",children:[r.jsx("p",{children:"Wprowadzono system kontr (Kamie-Papier-Noyce) dla statkw!"}),r.jsxs("ul",{className:"list-disc list-inside text-[#929bc9] pl-2 space-y-1",children:[r.jsx("li",{children:"Kady statek posiada teraz bonusy przeciwko konkretnym typom jednostek (np. Myliwiec Lekki jest skuteczny przeciwko Krownikom)."}),r.jsx("li",{children:'Informacje o bonusach ("Silny przeciwko") s widoczne w Stoczni oraz Sklepie.'}),r.jsx("li",{children:"Walki s teraz symulowane w rundach (max 6), co daje bardziej realistyczne wyniki star."})]})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"bg-[#111422]/50 p-4 rounded-lg border border-white/5",children:[r.jsxs("h3",{className:"font-bold text-yellow-400 mb-2 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"shopping_cart"}),"Sklep Premium Nowoci"]}),r.jsxs("ul",{className:"list-disc list-inside text-sm text-[#929bc9] space-y-1",children:[r.jsxs("li",{children:[r.jsx("strong",{children:"Nowe Pakiety:"})," Dostpne nowe pakiety surowcw i ulepsze."]}),r.jsxs("li",{children:[r.jsx("strong",{children:"Gwiazda mierci:"})," Teraz dostpna rwnie w ofercie specjalnej."]})]})]}),r.jsxs("div",{className:"bg-[#111422]/50 p-4 rounded-lg border border-white/5",children:[r.jsxs("h3",{className:"font-bold text-primary mb-2 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"new_releases"}),"System Poziomw i Ranking"]}),r.jsxs("ul",{className:"list-disc list-inside text-sm text-[#929bc9] space-y-1",children:[r.jsxs("li",{children:[r.jsx("strong",{children:"System Poziomw:"})," Zbieraj XP za budow i flot, aby awansowa!"]}),r.jsxs("li",{children:[r.jsx("strong",{children:"Korona Lidera:"})," Gracz #1 w rankingu otrzymuje zot koron przy nicku."]}),r.jsx("li",{children:"Ranking jest teraz bardziej dynamiczny i przejrzysty."})]})]}),r.jsxs("div",{className:"bg-[#111422]/50 p-4 rounded-lg border border-white/5",children:[r.jsxs("h3",{className:"font-bold text-blue-400 mb-2 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"shield"}),"System Obrony i Kontry"]}),r.jsxs("ul",{className:"list-disc list-inside text-sm text-[#929bc9] space-y-1",children:[r.jsxs("li",{children:["Dodano informacj ",r.jsx("strong",{children:'"Silny Przeciwko"'})," w widoku Obrony i Stoczni."]}),r.jsx("li",{children:"Teraz atwo sprawdzisz, co najlepiej kontruje dan jednostk."})]})]}),r.jsxs("div",{className:"bg-[#111422]/50 p-4 rounded-lg border border-white/5",children:[r.jsxs("h3",{className:"font-bold text-green-400 mb-2 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"pest_control"}),"Inne Zmiany"]}),r.jsxs("ul",{className:"list-disc list-inside text-sm text-[#929bc9] space-y-1",children:[r.jsxs("li",{children:[r.jsx("strong",{children:"Tryb Penoekranowy:"})," Dostpny w menu bocznym (dla lepszej immersji)."]}),r.jsx("li",{children:"Usunito przycisk debugowania (robaczka) na rzecz tego okna Info."}),r.jsx("li",{children:"Optymalizacja wydajnoci gry."})]})]})]})]}),r.jsxs("div",{className:"p-4 border-t border-white/10 bg-[#15192b] text-center text-xs text-[#555a7a]",children:["Kosmo v2.1.0 - Build ",new Date().toLocaleDateString()]})]})}),Fy=({children:l,activeView:s,onNavigate:n})=>{const[o,d]=F.useState(!1),[h,f]=F.useState(!1),[b,g]=F.useState(!1),[p,v]=F.useState(!1);F.useEffect(()=>{Qy()},[]);const x=ca(),_=(x==null?void 0:x.logout)||(()=>window.location.reload()),j=(x==null?void 0:x.incomingMissions)||[],C=[{id:"overview",icon:"dashboard",label:"Podgld"},{id:"buildings",icon:"domain",label:"Budynki"},{id:"fleet",icon:"flight_takeoff",label:"Flota"},{id:"galaxy",icon:"public",label:"Galaktyka"}],z=[{id:"overview",label:"Podgld",icon:"dashboard"},{id:"buildings",label:"Budynki",icon:"domain"},{id:"shipyard",label:"Stocznia",icon:"rocket_launch"},{id:"research",label:"Badania",icon:"science"},{id:"fleet",label:"Centrum Floty",icon:"flight_takeoff"},{id:"galaxy",label:"Galaktyka",icon:"public"},{id:"defense",label:"Obrona",icon:"shield"},{id:"clans",label:"Klany",icon:"groups"},{id:"shop",label:"Sklep Premium",icon:"shopping_cart"},{id:"ranking",label:"Ranking",icon:"leaderboard"},{id:"settings",label:"Opcje",icon:"settings"}],M=E=>{n(E),d(!1)};return r.jsxs("div",{className:"flex h-screen w-full bg-[#101322] text-white font-display overflow-hidden relative",children:[r.jsx("div",{className:"absolute inset-0 pointer-events-none z-0",style:{backgroundImage:`
            linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
            linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px)
          `,backgroundSize:"40px 40px"}}),r.jsx(Hy,{activeView:s,onNavigate:n}),r.jsxs("main",{className:"flex-1 flex flex-col h-full relative z-10 overflow-hidden mb-16 lg:mb-0",children:[r.jsx($y,{}),j&&j.length>0&&r.jsx("div",{className:`mx-2 md:mx-6 lg:mx-8 mt-2 transition-all duration-300 ${h?"bg-red-900/40 border-red-900/50":"bg-red-900/80 border-red-500 animate-pulse"} border-2 rounded-xl overflow-hidden shadow-[0_0_30px_rgba(239,68,68,0.2)]`,children:r.jsxs("div",{className:"p-2 px-4 flex items-center justify-between cursor-pointer hover:bg-white/5 transition-colors",onClick:()=>f(!h),children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:`material-symbols-outlined text-red-500 ${!h&&"animate-bounce"}`,children:"warning"}),r.jsxs("div",{children:[r.jsxs("h3",{className:"text-red-400 font-bold text-sm uppercase tracking-wider flex items-center gap-2",children:[" WYKRYTO ZAGROENIE!",r.jsxs("span",{className:"text-xs font-normal text-red-300 normal-case hidden sm:inline",children:["(",j.length," ",j.length===1?"flota":"floty",")"]})]}),!h&&r.jsx("div",{className:"mt-2 text-red-100/80 space-y-2",children:j.map(E=>r.jsxs("div",{className:"text-xs border-t border-red-500/30 pt-2",children:[r.jsx("p",{className:"font-bold text-red-200 mb-1",children:E.attackerName?`Atakuje: ${E.attackerName}`:"Nadciga wroga flota!"}),r.jsxs("p",{className:"opacity-80",children:["Flota: ",Object.entries(E.ships||{}).map(([O,N])=>{var G;return`${((G=st[O])==null?void 0:G.name)||O}: ${N}`}).join(", ")]})]},E.id))})]})]}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("div",{className:"text-right",children:[r.jsx("div",{className:"text-red-300 text-[10px] uppercase",children:"Kontakt za:"}),r.jsx("div",{className:"text-red-400 font-bold text-lg font-mono leading-none",children:Ra(Math.max(0,(j[0].arrivalTime-Date.now())/1e3))})]}),r.jsx("span",{className:"material-symbols-outlined text-red-400 transition-transform duration-300",style:{transform:h?"rotate(180deg)":"rotate(0deg)"},children:"expand_less"})]})]})}),r.jsx("div",{className:"flex-1 overflow-y-auto p-2 md:p-6 lg:p-8 scrollbar-thin scrollbar-thumb-primary scrollbar-track-background-dark",children:r.jsx("div",{className:"max-w-[1400px] mx-auto pb-20 lg:pb-0",children:l})})]}),o&&r.jsxs("div",{className:"lg:hidden fixed inset-0 z-40 bg-[#101322]/95 backdrop-blur-xl flex flex-col animate-in fade-in slide-in-from-bottom-10 duration-200",children:[r.jsxs("div",{className:"p-6 flex items-center justify-between border-b border-white/10",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"bg-center bg-no-repeat bg-cover rounded-full size-12 border-2 border-primary",style:{backgroundImage:`url("${(x==null?void 0:x.avatarUrl)||"/kosmo/avatars/avatar_default.png"}")`}}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("h1",{className:"text-white text-lg font-bold tracking-tight uppercase",children:"Centrum"}),r.jsxs("p",{className:"text-[#929bc9] text-sm font-normal",children:["Kmdr. ",(x==null?void 0:x.nickname)||"Gracz"]})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>{document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen().catch(E=>console.log(E))},className:"p-2 bg-white/5 rounded-full text-white hover:bg-white/10 transition-colors",title:"Peny ekran",children:r.jsx("span",{className:"material-symbols-outlined",children:"fullscreen"})}),r.jsx("button",{onClick:()=>d(!1),className:"p-2 bg-white/5 rounded-full text-white hover:bg-white/10 transition-colors",children:r.jsx("span",{className:"material-symbols-outlined",children:"close"})})]})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto p-4 grid grid-cols-2 gap-3 overscroll-y-contain touch-action-manipulation pb-24",children:[z.map(E=>r.jsxs("button",{onClick:()=>M(E.id),className:`flex flex-col items-center justify-center p-4 rounded-xl border transition-all ${s===E.id?"bg-primary/20 border-primary text-white":"bg-[#1c2136] border-white/5 text-[#929bc9] hover:bg-white/5"}`,children:[r.jsx("span",{className:`material-symbols-outlined text-3xl mb-2 ${E.id==="shop"?"text-yellow-500":""}`,children:E.icon}),r.jsx("span",{className:"text-sm font-bold",children:E.label})]},E.id)),r.jsxs("button",{onClick:()=>_(),className:"flex flex-col items-center justify-center p-4 rounded-xl border border-red-500/20 bg-red-500/10 text-red-400 hover:bg-red-500/20 col-span-2 mt-4",children:[r.jsx("span",{className:"material-symbols-outlined text-3xl mb-2",children:"logout"}),r.jsx("span",{className:"text-sm font-bold",children:"Wyloguj Si"})]})]})]}),r.jsx("nav",{className:"lg:hidden fixed bottom-0 left-0 right-0 bg-[#1c2136]/95 backdrop-blur-md border-t border-white/10 z-50 pb-safe",children:r.jsxs("div",{className:"flex justify-around items-center h-16 px-1",children:[C.map(E=>{const O=s===E.id;return r.jsxs("button",{onClick:()=>{n(E.id),d(!1)},className:`flex flex-col items-center justify-center w-full h-full gap-1 transition-colors ${O?"text-primary":"text-[#929bc9] hover:text-white"}`,children:[r.jsx("span",{className:`material-symbols-outlined transition-transform ${O?"scale-110":""} text-2xl`,children:E.icon}),r.jsx("span",{className:"text-[10px] font-medium leading-none",children:E.label})]},E.id)}),r.jsxs("button",{onClick:()=>d(!o),className:`flex flex-col items-center justify-center w-full h-full gap-1 transition-colors ${o?"text-white":"text-[#929bc9] hover:text-white"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-2xl",children:"menu"}),r.jsx("span",{className:"text-[10px] font-medium leading-none",children:"Menu"})]})]})}),r.jsx(Xy,{onClick:()=>g(!0)}),r.jsx(Jy,{visible:b,onClose:()=>g(!1)}),p&&r.jsx(Wy,{onClose:()=>v(!1)})]})},ev=()=>{const[l,s]=F.useState(!0),[n,o]=F.useState(""),[d,h]=F.useState(""),[f,b]=F.useState(!1),[g,p]=F.useState(null),v=async x=>{x.preventDefault(),b(!0),p(null);const _=`${n.trim()}@kosmo.com`;try{if(l){const{error:j}=await ue.auth.signInWithPassword({email:_,password:d});if(j)throw j}else{const{data:j,error:C}=await ue.auth.signUp({email:_,password:d,options:{data:{full_name:n.trim()}}});if(C)throw C;if(j.user&&!j.session){const{error:z}=await ue.auth.signInWithPassword({email:_,password:d});z&&(alert('Konto utworzone! Jeli nie zostae zalogowany automatycznie, sprawd czy wyczye "Confirm Email" w Supabase lub sprbuj si zalogowa.'),s(!0))}}}catch(j){p(j.message)}finally{b(!1)}};return r.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-[#101322] relative overflow-hidden",children:[r.jsxs("div",{className:"absolute inset-0 z-0",children:[r.jsx("div",{className:"absolute top-1/4 left-1/4 w-96 h-96 bg-primary/20 rounded-full blur-[100px] animate-pulse"}),r.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-96 h-96 bg-purple-600/20 rounded-full blur-[100px] animate-pulse",style:{animationDelay:"2s"}})]}),r.jsxs("div",{className:"relative z-10 w-full max-w-md p-6 md:p-8 bg-[#1c2136]/80 backdrop-blur-xl border border-white/10 rounded-2xl shadow-2xl mx-4 animate-in fade-in zoom-in-95 duration-500",children:[r.jsxs("div",{className:"flex flex-col items-center mb-8 group",children:[r.jsxs("div",{className:"rounded-full size-24 border-2 border-primary mb-4 shadow-lg shadow-primary/30 overflow-hidden bg-[#111422] transition-transform duration-500 group-hover:scale-110 group-hover:shadow-primary/50 relative",children:[r.jsx("div",{className:"absolute inset-0 bg-primary/20 animate-pulse z-10 pointer-events-none"}),r.jsx("img",{src:He.avatar,alt:"Logo",className:"w-full h-full object-cover relative z-0",onError:x=>{x.currentTarget.src="/kosmo/avatars/avatar_default.png"}})]}),r.jsx("h1",{className:"text-4xl font-bold text-white tracking-tight uppercase font-display text-transparent bg-clip-text bg-gradient-to-r from-white to-primary animate-in slide-in-from-top-4 duration-700 delay-150",children:"Kosmo 2.0"}),r.jsx("p",{className:"text-gray-500 mt-2 animate-in slide-in-from-top-2 duration-700 delay-200",children:"v1.2.5 (PvP & Commander Update)"}),r.jsx("p",{className:"text-[#929bc9] text-sm md:text-base text-center mt-2 animate-in slide-in-from-top-2 duration-700 delay-300",children:"Zaloguj si do terminala dowdcy"})]}),r.jsxs("form",{onSubmit:v,className:"flex flex-col gap-4 animate-in slide-in-from-bottom-4 duration-700 delay-300",children:[g&&r.jsx("div",{className:"bg-red-500/10 border border-red-500/20 text-red-400 p-3 rounded-lg text-sm text-center animate-pulse",children:g}),r.jsxs("div",{className:"group",children:[r.jsx("label",{className:"text-xs font-bold text-[#929bc9] uppercase mb-1 block group-focus-within:text-primary transition-colors",children:"Nick Dowdcy"}),r.jsx("input",{type:"text",required:!0,value:n,onChange:x=>o(x.target.value),className:"w-full bg-[#111422] border border-white/10 rounded-lg px-4 py-3 text-white focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary/50 transition-all shadow-inner",placeholder:"Wpisz swj nick..."})]}),r.jsxs("div",{className:"group",children:[r.jsx("label",{className:"text-xs font-bold text-[#929bc9] uppercase mb-1 block group-focus-within:text-primary transition-colors",children:"Haso"}),r.jsx("input",{type:"password",required:!0,value:d,onChange:x=>h(x.target.value),className:"w-full bg-[#111422] border border-white/10 rounded-lg px-4 py-3 text-white focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary/50 transition-all shadow-inner",placeholder:""})]}),r.jsxs("button",{type:"submit",disabled:f,className:`mt-4 py-3 rounded-lg font-bold uppercase tracking-wider transition-all shadow-lg relative overflow-hidden group
                            ${f?"bg-gray-600 cursor-not-allowed":"bg-primary hover:bg-blue-600 text-white shadow-primary/20 hover:shadow-primary/40 hover:-translate-y-0.5"}
                        `,children:[r.jsx("span",{className:"relative z-10",children:f?"Przetwarzanie...":l?"Zaloguj si":"Zarejestruj konto"}),!f&&r.jsx("div",{className:"absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300"})]})]}),r.jsx("div",{className:"mt-6 text-center animate-in fade-in duration-1000 delay-500",children:r.jsx("button",{onClick:()=>s(!l),className:"text-sm text-[#929bc9] hover:text-white transition-colors hover:underline underline-offset-4",children:l?"Nie masz konta? Zarejestruj si":"Masz ju konto? Zaloguj si"})})]}),r.jsx("div",{className:"absolute bottom-4 left-0 right-0 text-center text-xs text-[#929bc9]/50 font-mono",children:"Stworzone przez DareG TV"})]})},tv=({session:l,onComplete:s})=>{const[n,o]=F.useState({galaxy:1,system:1}),[d,h]=F.useState(new Map),[f,b]=F.useState(!0),[g,p]=F.useState(null),[v,x]=F.useState(null);F.useEffect(()=>{(async()=>{b(!0);const{data:N,error:G}=await ue.from("profiles").select("galaxy_coords, planet_name").not("galaxy_coords","is",null),{data:fe,error:J}=await ue.from("planets").select("*");if(!G&&!J){const oe=new Map;N==null||N.forEach(ge=>{if(ge.galaxy_coords){const we=ge.galaxy_coords;oe.set(`${we.galaxy}:${we.system}:${we.position}`,ge.planet_name||"Gwna Planeta")}}),fe==null||fe.forEach(ge=>{if(ge.galaxy_coords){const we=ge.galaxy_coords;oe.set(`${we.galaxy}:${we.system}:${we.position}`,ge.planet_name||"Kolonia")}}),oe.set("1:1:2","Piracka Baza"),h(oe)}b(!1)})()},[]);const _=O=>d.has(`${n.galaxy}:${n.system}:${O}`),j=O=>d.get(`${n.galaxy}:${n.system}:${O}`),C=async O=>{if(g||_(O))return;p(O),x(null);const N={galaxy:n.galaxy,system:n.system,position:O},G={metal:500,crystal:300,deuterium:100,darkMatter:0,energy:0,maxEnergy:0,storage:{metal:1e4,crystal:1e4,deuterium:1e4}},fe={metal_mine:1,crystal_mine:0,deuterium_synth:0,solar_plant:1,fusion_reactor:0,robot_factory:0,shipyard:0,research_lab:0,metal_storage:0,crystal_storage:0,deuterium_tank:0},J={light_fighter:0,heavy_fighter:0,cruiser:0,battleship:0,destroyer:0,death_star:0,small_cargo:0,medium_cargo:0,huge_cargo:0,colony_ship:0,espionage_probe:0,pioneer:1,recycler:0},{error:oe}=await ue.from("profiles").upsert({id:l.user.id,galaxy_coords:N,planet_name:`Kolonia [${N.galaxy}:${N.system}:${N.position}]`,last_updated:Date.now(),resources:G,buildings:fe,ships:J,research:{},defenses:{},debris:{metal:0,crystal:0},construction_queue:[],shipyard_queue:[],mission_logs:[],points:0,xp:0,level:1,version:1});if(oe){x("Bd przy zapisie pozycji: "+oe.message),p(null);return}s(N)},z=O=>{o(N=>{const G=N.system+O;return G<1||G>499?N:{...N,system:G}})},M=O=>{o(N=>{const G=N.galaxy+O;return G<1||G>9?N:{...N,galaxy:G}})},E=Array.from({length:15},(O,N)=>N+1);return f?r.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-[#101322] flex-col gap-4",children:[r.jsx("div",{className:"w-12 h-12 border-4 border-primary border-t-transparent rounded-full animate-spin"}),r.jsx("div",{className:"text-white text-xl",children:"Skanowanie Galaktyki..."})]}):r.jsxs("div",{className:"min-h-screen bg-[#101322] overflow-y-auto",children:[r.jsxs("div",{className:"max-w-4xl mx-auto p-4 flex flex-col gap-6 pb-20 relative min-h-full",children:[r.jsxs("div",{className:"text-center py-8",children:[r.jsx("h1",{className:"text-3xl font-bold text-white uppercase tracking-tight mb-2",children:"Wybierz miejsce pod koloni"}),r.jsx("p",{className:"text-[#929bc9]",children:'Znajd woln planet w dowolnym ukadzie i kliknij "Zasiedl".'}),v&&r.jsx("div",{className:"mt-4 p-3 bg-red-500/20 text-red-400 rounded-lg",children:v})]}),r.jsx("div",{className:"absolute top-40 left-1/2 -translate-x-1/2 pointer-events-none z-0 opacity-40 w-full flex justify-center overflow-hidden",children:r.jsx("div",{className:"w-[600px] h-[600px] rounded-full bg-blue-500/20 blur-[120px] -translate-y-1/2"})}),r.jsx("div",{className:"bg-[#1c2136] p-4 rounded-xl border border-white/10 shadow-lg sticky top-0 z-20 backdrop-blur-md bg-opacity-90",children:r.jsx("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:r.jsxs("div",{className:"flex gap-2 w-full justify-center",children:[r.jsxs("div",{className:"flex flex-col gap-1 w-32 md:w-40",children:[r.jsx("span",{className:"text-[10px] uppercase font-bold text-[#929bc9] tracking-wider text-center",children:"Galaktyka"}),r.jsxs("div",{className:"flex items-center h-10 md:h-12 bg-[#111422] rounded-lg border border-white/10 overflow-hidden",children:[r.jsx("button",{onClick:()=>M(-1),className:"w-8 md:w-10 h-full hover:bg-white/5 active:bg-white/10 flex items-center justify-center text-[#929bc9]",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"chevron_left"})}),r.jsx("div",{className:"flex-1 text-center font-mono font-bold text-lg text-white",children:n.galaxy}),r.jsx("button",{onClick:()=>M(1),className:"w-8 md:w-10 h-full hover:bg-white/5 active:bg-white/10 flex items-center justify-center text-[#929bc9]",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"chevron_right"})})]})]}),r.jsxs("div",{className:"flex flex-col gap-1 w-32 md:w-40",children:[r.jsx("span",{className:"text-[10px] uppercase font-bold text-[#929bc9] tracking-wider text-center",children:"Ukad"}),r.jsxs("div",{className:"flex items-center h-10 md:h-12 bg-[#111422] rounded-lg border border-white/10 overflow-hidden",children:[r.jsx("button",{onClick:()=>z(-1),className:"w-8 md:w-10 h-full hover:bg-white/5 active:bg-white/10 flex items-center justify-center text-[#929bc9]",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"chevron_left"})}),r.jsx("div",{className:"flex-1 text-center font-mono font-bold text-lg text-white",children:n.system}),r.jsx("button",{onClick:()=>z(1),className:"w-8 md:w-10 h-full hover:bg-white/5 active:bg-white/10 flex items-center justify-center text-[#929bc9]",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"chevron_right"})})]})]})]})})}),r.jsx("div",{className:"flex flex-col gap-3 relative z-10",children:E.map(O=>{const N=_(O),G=j(O),fe=n.galaxy===1&&n.system===1&&O===2;return r.jsxs("div",{className:`relative flex items-center gap-2 md:gap-3 p-2 md:p-3 rounded-xl border transition-all ${N?"bg-[#1a2342]/50 border-red-500/20":"bg-[#1c2136] border-white/5 hover:border-green-500/30 hover:bg-[#1c2136]/80"}`,children:[r.jsx("div",{className:"flex flex-col items-center justify-center w-6 md:w-8 text-[#929bc9] font-mono text-xs md:text-sm opacity-50",children:O}),r.jsx("div",{className:"shrink-0",children:N?r.jsxs("div",{className:"w-10 h-10 md:w-12 md:h-12 rounded-full shadow-lg relative overflow-hidden bg-black/20 opacity-80 grayscale-[0.5]",children:[r.jsx("img",{src:fe?"https://lh3.googleusercontent.com/aida-public/AB6AXuCttLEph3WsOd3HRlZC0zxgyo5HtGQLhoc_Nr46u_bMbqY6nTEQYuIV_gyR_hpfVBS-J_jj5GGZynbPPZti1oj5iZ3eOY_YBYNi3q8nw6c4ebgmqCgJnaJhFtJwFfpNu4nYT65VMgmQkWQU-ek95Y5Ue6RnI9LCcYQpDhod0Y_eUiJYtnqiu9_aD-u_ukPsujkP5hgKqFchbR8vhUje3E-LrA80lMR4QTQEfNKXUDobsJRFGe11_CQSYumUsrXBnYunhGfRGvl2epw":He.planet,alt:"Planet",className:"w-full h-full object-cover"}),r.jsx("div",{className:"absolute inset-0 rounded-full bg-red-500/10"})]}):r.jsx("div",{className:"w-10 h-10 md:w-12 md:h-12 rounded-full border-2 border-dashed border-white/10 flex items-center justify-center opacity-40 group-hover:opacity-100 transition-opacity",children:r.jsx("span",{className:"material-symbols-outlined text-white text-base",children:"add_location"})})}),r.jsx("div",{className:"flex-1 min-w-0",children:N?r.jsx("div",{className:"flex flex-col justify-center",children:r.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[r.jsx("span",{className:"font-bold text-sm md:text-base truncate text-white",children:G}),r.jsx("span",{className:"text-red-400 text-xs uppercase font-bold tracking-wider",children:"ZAJTE"})]})}):r.jsxs("div",{className:"flex flex-col justify-center",children:[r.jsx("span",{className:"text-green-400 text-sm font-bold",children:"Wolna przestrzen"}),r.jsx("span",{className:"text-[#929bc9] text-xs",children:"Planeta gotowa do kolonizacji"})]})}),r.jsxs("div",{className:"flex items-center gap-3",children:[!N&&r.jsx("button",{onClick:()=>C(O),disabled:g!==null,className:`px-4 py-2 rounded-lg font-bold text-sm uppercase tracking-wider shadow-lg transition-all ${g===O?"bg-white text-black animate-pulse":"bg-green-600 hover:bg-green-500 text-white"}`,children:g===O?"Zasiedlanie...":"Zasiedl"}),N&&r.jsx("span",{className:"material-symbols-outlined text-white/10",children:"lock"})]})]},O)})})]}),r.jsx("div",{className:"fixed bottom-4 right-4 text-xs text-[#929bc9]/50 font-mono z-50",children:"v1.1.2"})]})},op=({onNavigate:l})=>{const{constructionQueue:s,buildings:n,ships:o,resources:d,shipyardQueue:h,planetName:f,renamePlanet:b,planetType:g,galaxyCoords:p,incomingMissions:v,activeMissions:x,productionSettings:_,getLevel:j,cancelMission:C,cancelConstruction:z,level:M,xp:E}=ca(),O=g&&Er[g]?Er[g]:Er.default,N=h[0],[G,fe]=F.useState({}),[J,oe]=F.useState(""),[ge,we]=F.useState(!1),[je,Ue]=F.useState(f);F.useEffect(()=>{Ue(f)},[f]),F.useEffect(()=>{const ye=()=>{const Q=Date.now(),ie={};if(s.forEach(pe=>{const Ae=Math.max(0,Math.floor((pe.endTime-Q)/1e3));ie[pe.id]=Ra(Ae)}),fe(ie),N){const pe=Math.max(0,Math.floor((N.endTime-Q)/1e3));oe(Ra(pe))}else oe("")};ye();const S=setInterval(ye,1e3);return()=>clearInterval(S)},[s,N]);const Re=()=>{je.trim().length>0?b(je.trim()):Ue(f),we(!1)},Ke=ye=>{ye.key==="Enter"?Re():ye.key==="Escape"&&(Ue(f),we(!1))},Pe=Object.values(o).reduce((ye,S)=>ye+S,0);return r.jsxs("div",{className:"space-y-6",children:[v.length>0&&r.jsx("div",{className:"bg-red-900/50 border border-red-500 rounded-xl p-4 flex items-center justify-between animate-pulse shadow-[0_0_20px_rgba(239,68,68,0.4)]",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:"material-symbols-outlined text-red-500 text-3xl",children:"warning"}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-red-400 font-bold text-lg",children:"WYKRYTO ZAGROENIE!"}),r.jsxs("p",{className:"text-red-200 text-sm",children:["Nadciga wroga flota! Szacowany czas kontaktu: ",Ra(Math.max(0,(v[0].arrivalTime-Date.now())/1e3))]})]})]})}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[r.jsx("div",{className:"lg:col-span-5 xl:col-span-4",children:r.jsxs("div",{className:"bg-[#161b2e] rounded-2xl overflow-hidden border border-white/10 shadow-xl relative group",children:[r.jsxs("div",{className:"relative h-48 overflow-hidden",children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#161b2e] via-transparent to-transparent z-10"}),r.jsx("img",{src:O,alt:"Planet",className:"w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-700 opacity-80"}),r.jsx("div",{className:"absolute top-4 right-4 z-20 flex flex-col items-end",children:r.jsxs("div",{className:"flex items-center gap-2 text-[#929bc9] text-sm bg-black/40 px-2 py-1 rounded backdrop-blur-sm",children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"my_location"}),"[",(p==null?void 0:p.galaxy)||1,":",(p==null?void 0:p.system)||1,":",(p==null?void 0:p.position)||1,"]"]})}),r.jsx("div",{className:"absolute bottom-4 left-4 w-full pr-8 z-20",children:r.jsx("div",{className:"flex items-center gap-2 h-10",children:ge?r.jsxs("div",{className:"flex items-center gap-2 bg-black/60 rounded p-1 backdrop-blur-md",children:[r.jsx("input",{autoFocus:!0,value:je,onChange:ye=>Ue(ye.target.value),onBlur:Re,onKeyDown:Ke,className:"bg-transparent border-b border-primary text-white font-bold text-xl w-32 focus:outline-none"}),r.jsx("button",{onClick:Re,className:"text-green-400 hover:text-green-300",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"check"})})]}):r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-3xl font-bold text-white mb-1 truncate shadow-black drop-shadow-md",children:f}),r.jsx("button",{onClick:()=>we(!0),className:"w-8 h-8 flex items-center justify-center rounded-full bg-white/10 hover:bg-white/20 text-white border border-white/20 backdrop-blur-sm transition-colors",title:"Zmie nazw",children:r.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})})]})})})]}),r.jsxs("div",{className:"p-6 flex flex-col gap-4",children:[r.jsxs("div",{className:"flex justify-between items-center border-b border-white/5 pb-3",children:[r.jsx("span",{className:"text-[#929bc9] text-sm",children:"rednica"}),r.jsx("span",{className:"text-white font-medium",children:"12,800 km"})]}),r.jsxs("div",{className:"flex justify-between items-center border-b border-white/5 pb-3",children:[r.jsx("span",{className:"text-[#929bc9] text-sm",children:"Temperatura"}),r.jsx("span",{className:"text-white font-medium",children:"12C do 50C"})]}),r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"text-[#929bc9] text-sm",children:"Zajte Pola"}),r.jsx("div",{className:"flex items-center gap-2",children:r.jsxs("span",{className:"text-white font-medium",children:[Object.values(n).reduce((ye,S)=>ye+S,0)," / 163"]})})]})]}),r.jsxs("div",{className:"p-4 border-t border-white/10",children:[r.jsxs("h4",{className:"text-white font-bold text-sm uppercase tracking-wider mb-3 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-primary text-lg",children:"person"}),"Statystyki Dowdcy"]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{className:"bg-[#111422] rounded-lg p-3 text-center",children:[r.jsxs("div",{className:"text-yellow-400 font-bold text-2xl relative group cursor-help",children:[M||1,r.jsxs("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-max max-w-[200px] bg-black/90 border border-white/20 rounded p-2 text-xs text-gray-300 hidden group-hover:block z-50 pointer-events-none shadow-xl",children:[r.jsx("div",{className:"font-bold text-yellow-400 mb-1",children:"Dowiadczenie (XP)"}),r.jsxs("div",{children:["Aktualne: ",r.jsx("span",{className:"text-white",children:Math.floor(E||0).toLocaleString()})]}),r.jsxs("div",{children:["Nastpny poziom: ",r.jsx("span",{className:"text-white",children:Math.floor(500*Math.pow(M||1,2)).toLocaleString()})]})]})]}),r.jsx("div",{className:"text-[#929bc9] text-xs uppercase mb-2",children:"Poziom"}),r.jsx("div",{className:"w-full h-1.5 bg-black/40 rounded-full overflow-hidden border border-white/5",children:r.jsx("div",{className:"h-full bg-gradient-to-r from-yellow-600 to-yellow-400 transition-all duration-500",style:{width:`${Math.min(100,Math.max(0,((E||0)-500*Math.pow((M||1)-1,2))/(500*Math.pow(M||1,2)-500*Math.pow((M||1)-1,2))*100))}%`}})})]}),r.jsxs("div",{className:"bg-[#111422] rounded-lg p-3 text-center",children:[r.jsx("div",{className:"text-primary font-bold text-2xl",children:Pe}),r.jsx("div",{className:"text-[#929bc9] text-xs uppercase",children:"Flota"})]}),r.jsxs("div",{className:"bg-[#111422] rounded-lg p-3 text-center",children:[r.jsx("div",{className:"text-green-400 font-bold text-lg",children:"~2-5k"}),r.jsx("div",{className:"text-[#929bc9] text-xs uppercase",children:"Zysk/Exp."})]}),r.jsxs("div",{className:"bg-[#111422] rounded-lg p-3 text-center",children:[r.jsx("div",{className:"text-purple-400 font-bold text-lg",children:x.length}),r.jsx("div",{className:"text-[#929bc9] text-xs uppercase",children:"Aktywne Misje"})]})]})]})]})}),r.jsxs("div",{className:"lg:col-span-7 xl:col-span-8 flex flex-col gap-6",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsx("h3",{className:"text-2xl font-bold tracking-tight",children:"Status Operacyjny"})}),s.length>0?r.jsx("div",{className:"space-y-4",children:s.map((ye,S)=>{const Q=S===0;return r.jsxs("div",{className:`bg-[#232948] border ${Q?"border-primary/50":"border-white/10"} rounded-xl p-4 flex flex-col md:flex-row items-center gap-6 relative overflow-hidden group shadow-[0_0_15px_rgba(19,55,236,0.1)]`,children:[Q&&r.jsx("div",{className:"absolute top-0 left-0 bottom-0 w-1 bg-primary animate-pulse"}),r.jsx("div",{className:"size-16 rounded-xl bg-[#111422] shrink-0 flex items-center justify-center border border-white/10",children:r.jsx("span",{className:`material-symbols-outlined text-3xl ${Q?"text-primary animate-spin-slow":"text-[#929bc9]"}`,style:{animationDuration:"3s"},children:"construction"})}),r.jsxs("div",{className:"flex-1 min-w-0 w-full text-center md:text-left",children:[r.jsxs("div",{className:"flex items-center justify-center md:justify-start gap-3 mb-2",children:[r.jsxs("h4",{className:"text-white font-bold text-lg truncate flex items-center gap-2",children:[Q?"Rozbudowa w toku":"W kolejce",!Q&&r.jsxs("span",{className:"text-xs bg-white/10 px-2 py-0.5 rounded text-[#929bc9]",children:["#",S+1]})]}),r.jsxs("span",{className:"px-2 py-0.5 rounded text-xs bg-primary/20 text-primary border border-primary/20 font-bold",children:["Lvl ",ye.targetLevel]})]}),r.jsxs("div",{className:"flex items-center gap-4 justify-center md:justify-start text-sm text-[#929bc9]",children:[r.jsx("span",{className:Q?"text-primary font-medium animate-pulse":"",children:Q?"Pozostay czas:":"Start za:"}),r.jsx("span",{className:`text-2xl font-mono ${Q?"text-white font-bold":"text-[#929bc9]"}`,children:G[ye.id]||"..."})]})]}),r.jsxs("button",{onClick:()=>z(ye.id),className:"px-3 py-1.5 bg-red-500/10 hover:bg-red-500/20 text-red-500 border border-red-500/20 rounded-lg text-xs font-bold uppercase transition-colors flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"cancel"}),"Anuluj"]})]},ye.id)})}):r.jsxs("div",{className:"bg-[#1c2136] border border-white/5 rounded-xl p-6 flex flex-col items-center justify-center gap-2 text-center h-28",children:[r.jsx("p",{className:"text-[#929bc9] text-sm",children:"Brak aktywnych procesw budowy."}),r.jsx("button",{onClick:()=>l("buildings"),className:"text-primary hover:text-white text-xs font-bold uppercase tracking-wider transition-colors",children:"Rozpocznij budow "})]}),N?(()=>{const ye=N.type==="defense",S=ye?Qa[N.itemId]:st[N.itemId],Q=(S==null?void 0:S.name)||N.itemId,ie=(S==null?void 0:S.icon)||(ye?"shield":"rocket");return r.jsxs("div",{className:"bg-[#2a2d40] border border-white/10 rounded-xl p-6 flex flex-col md:flex-row items-center gap-6 relative overflow-hidden",children:[r.jsx("div",{className:`absolute top-0 left-0 bottom-0 w-1 ${ye?"bg-blue-500":"bg-orange-500"} animate-pulse`}),r.jsx("div",{className:"size-20 rounded-xl bg-[#111422] shrink-0 flex items-center justify-center border border-white/10",children:r.jsx("span",{className:`material-symbols-outlined text-4xl ${ye?"text-blue-500":"text-orange-500"} animate-pulse`,children:ie})}),r.jsxs("div",{className:"flex-1 min-w-0 w-full text-center md:text-left",children:[r.jsxs("div",{className:"flex items-center justify-center md:justify-start gap-3 mb-2",children:[r.jsx("h4",{className:"text-white font-bold text-xl truncate",children:ye?"Budowa Obrony":"Produkcja Floty"}),r.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${ye?"bg-blue-500/20 text-blue-500 border-blue-500/20":"bg-orange-500/20 text-orange-500 border-orange-500/20"} border font-bold`,children:Q})]}),r.jsxs("div",{className:"flex items-center gap-4 justify-center md:justify-start text-sm text-[#929bc9]",children:[r.jsxs("span",{className:`${ye?"text-blue-500":"text-orange-500"} font-medium`,children:["x",N.quantity]}),r.jsx("span",{className:"text-2xl font-mono text-white font-bold",children:J})]})]})]})})():null]})]}),r.jsxs("div",{className:"bg-[#1c2136] rounded-xl border border-white/10 p-6",children:[r.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined",children:"rocket_launch"}),"Status Floty"]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("div",{className:"bg-[#111422] p-4 rounded-lg border border-white/5",children:[r.jsx("div",{className:"text-[#929bc9] text-xs uppercase font-bold mb-1",children:"Jednostki Bojowe"}),r.jsx("div",{className:"text-2xl text-white font-mono",children:Pe})]}),r.jsxs("div",{className:"bg-[#111422] p-4 rounded-lg border border-white/5",children:[r.jsx("div",{className:"text-[#929bc9] text-xs uppercase font-bold mb-1",children:"Gotowo Bojowa"}),r.jsx("div",{className:"text-2xl text-green-400 font-mono",children:"100%"})]}),r.jsxs("div",{className:"bg-[#111422] p-4 rounded-lg border border-white/5",children:[r.jsx("div",{className:"text-[#929bc9] text-xs uppercase font-bold mb-1",children:"Misje w toku"}),r.jsx("div",{className:"text-2xl text-white font-mono",children:"0 / 2"})]})]}),r.jsx("div",{className:"mt-4 flex justify-end",children:r.jsx("button",{onClick:()=>l("shipyard"),className:"text-primary text-sm font-bold hover:text-white transition-colors",children:"Do Stoczni "})})]}),r.jsxs("div",{className:"bg-[#1c2136] rounded-xl border border-white/10 p-6",children:[r.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined",children:"radar"}),"Aktywne Misje"]}),x.length===0?r.jsx("p",{className:"text-[#929bc9] text-sm text-center py-4",children:"Brak aktywnych misji."}):r.jsx("div",{className:"flex flex-col gap-3",children:x.map(ye=>{const S=ye.status==="returning",Q=ye.targetCoords,ie=ye.type==="attack"?"Atak":ye.type==="spy"?"Szpiegowanie":ye.type==="expedition"?"Ekspedycja":"Misja";return r.jsxs("div",{className:"bg-[#111422] p-4 rounded-lg border border-white/5 flex flex-col md:flex-row items-center justify-between gap-4",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${S?"bg-blue-500/20 text-blue-400":ye.type==="attack"?"bg-red-500/20 text-red-400":"bg-purple-500/20 text-purple-400"}`,children:r.jsx("span",{className:"material-symbols-outlined",children:S?"keyboard_return":ye.type==="attack"?"swords":"visibility"})}),r.jsxs("div",{children:[r.jsx("div",{className:"font-bold text-white",children:S?`Powrt z ${ie}`:ie}),r.jsxs("div",{className:"text-xs text-[#929bc9]",children:["Cel: [",Q.galaxy,":",Q.system,":",Q.position,"]"]})]})]}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("div",{className:"text-right",children:[r.jsx("div",{className:"text-xs text-[#929bc9]",children:"Czas do celu"}),r.jsx("div",{className:"font-mono text-white font-bold",children:Ra(Math.max(0,((S?ye.returnTime:ye.arrivalTime)-Date.now())/1e3))})]}),ye.status==="flying"&&r.jsx("button",{onClick:()=>C(ye.id),className:"px-3 py-1 bg-red-900/40 hover:bg-red-900/60 text-red-400 border border-red-500/30 rounded text-sm transition-colors uppercase font-bold tracking-wider",children:"Odwoaj"})]})]},ye.id)})})]})]})},av=()=>{const{buildings:l,research:s,resources:n,upgradeBuilding:o,getCost:d,constructionQueue:h,checkRequirements:f,productionSettings:b,updateProductionSetting:g}=ca(),[p,v]=F.useState(""),x=Object.values(ts),_=h.find(E=>E.type==="building"),j=l[le.ROBOT_FACTORY]||0,C=100;F.useEffect(()=>{if(!_){v("");return}const E=()=>{const N=Date.now(),G=Math.max(0,Math.floor((_.endTime-N)/1e3));v(Ra(G))};E();const O=setInterval(E,1e3);return()=>clearInterval(O)},[_]);const z=(E,O)=>{if(E===le.METAL_MINE){const N=Math.floor(30*O*Math.pow(1.1,O))*100,G=Math.floor(30*(O+1)*Math.pow(1.1,O+1))*100,fe=Math.floor(20*O*Math.pow(1.1,O)),J=Math.floor(20*(O+1)*Math.pow(1.1,O+1));return{text:`Produkcja: +${(G-N).toLocaleString()}/h`,energyText:`Energia: -${(J-fe).toLocaleString()}`,type:"gain"}}if(E===le.CRYSTAL_MINE){const N=Math.floor(20*O*Math.pow(1.1,O))*100,G=Math.floor(20*(O+1)*Math.pow(1.1,O+1))*100,fe=Math.floor(20*O*Math.pow(1.1,O)),J=Math.floor(20*(O+1)*Math.pow(1.1,O+1));return{text:`Produkcja: +${(G-N).toLocaleString()}/h`,energyText:`Energia: -${(J-fe).toLocaleString()}`,type:"gain"}}if(E===le.DEUTERIUM_SYNTH){const N=Math.floor(10*O*Math.pow(1.1,O))*100,G=Math.floor(10*(O+1)*Math.pow(1.1,O+1))*100,fe=Math.floor(40*O*Math.pow(1.1,O)),J=Math.floor(40*(O+1)*Math.pow(1.1,O+1));return{text:`Produkcja: +${(G-N).toLocaleString()}/h`,energyText:`Energia: -${(J-fe).toLocaleString()}`,type:"gain"}}if(E===le.SOLAR_PLANT){const N=Math.floor(20*O*Math.pow(1.1,O));return{text:`Energia: +${(Math.floor(20*(O+1)*Math.pow(1.1,O+1))-N).toLocaleString()}`,type:"energy"}}if(E===le.FUSION_REACTOR){const N=Math.floor(30*O*Math.pow(1.05,O));return{text:`Energia: +${(Math.floor(30*(O+1)*Math.pow(1.05,O+1))-N).toLocaleString()}`,type:"energy"}}if(E===le.METAL_STORAGE){const N=1e4+5e3*Math.floor(Math.pow(2.5,O)),G=1e4+5e3*Math.floor(Math.pow(2.5,O+1));return{text:`Pojemno: ${(N/1e3).toFixed(0)}k -> ${(G/1e3).toFixed(0)}k`,type:"capacity"}}if(E===le.CRYSTAL_STORAGE){const N=1e4+5e3*Math.floor(Math.pow(2.5,O)),G=1e4+5e3*Math.floor(Math.pow(2.5,O+1));return{text:`Pojemno: ${(N/1e3).toFixed(0)}k -> ${(G/1e3).toFixed(0)}k`,type:"capacity"}}if(E===le.DEUTERIUM_TANK){const N=1e4+5e3*Math.floor(Math.pow(2.5,O)),G=1e4+5e3*Math.floor(Math.pow(2.5,O+1));return{text:`Pojemno: ${(N/1e3).toFixed(0)}k -> ${(G/1e3).toFixed(0)}k`,type:"capacity"}}return null},M=[le.METAL_MINE,le.CRYSTAL_MINE,le.DEUTERIUM_SYNTH,le.SOLAR_PLANT,le.FUSION_REACTOR];return r.jsxs("div",{className:"flex flex-col gap-6",children:[r.jsxs("div",{className:"flex items-center justify-between border-b border-white/10 pb-4",children:[r.jsxs("h2",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[r.jsx("span",{className:"material-symbols-outlined text-3xl text-primary",children:"domain"}),"Infrastruktura"]}),r.jsx("div",{className:"flex gap-2",children:r.jsxs("span",{className:"text-sm text-[#929bc9]",children:["Kolejka: ",h.filter(E=>E.type==="building").length," / 2"]})})]}),r.jsxs("div",{className:"bg-[#1c2136] rounded-xl border border-white/10 p-4",children:[r.jsxs("h3",{className:"text-sm font-bold text-white uppercase mb-3 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-sm text-yellow-400",children:"bolt"}),"Zarzdzanie Energi"]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:M.map(E=>{if(l[E]===0)return null;const N=b[E]??100;return r.jsxs("div",{className:"flex flex-col gap-1 bg-[#111422] p-2 rounded border border-white/5",children:[r.jsxs("div",{className:"flex justify-between text-xs text-[#929bc9]",children:[r.jsx("span",{className:"truncate",children:ts[E].name}),r.jsxs("span",{className:"font-bold text-white",children:[N,"%"]})]}),r.jsx("input",{type:"range",min:"0",max:"100",step:"10",value:N,onChange:G=>g(E,parseInt(G.target.value)),className:"w-full h-1 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-primary"})]},E)})})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-2",children:[r.jsxs("div",{className:"bg-[#1c2136] p-3 rounded-lg border border-white/5 flex items-center justify-between",children:[r.jsx("span",{className:"text-[#929bc9] text-xs uppercase font-bold",children:ts[le.METAL_STORAGE].name}),r.jsxs("span",{className:`text-sm font-mono ${n.metal>=n.storage.metal?"text-red-400 font-bold":"text-white"}`,children:[Math.floor(n.metal).toLocaleString()," / ",(n.storage.metal/1e3).toFixed(0),"k"]})]}),r.jsxs("div",{className:"bg-[#1c2136] p-3 rounded-lg border border-white/5 flex items-center justify-between",children:[r.jsx("span",{className:"text-[#929bc9] text-xs uppercase font-bold",children:ts[le.CRYSTAL_STORAGE].name}),r.jsxs("span",{className:`text-sm font-mono ${n.crystal>=n.storage.crystal?"text-red-400 font-bold":"text-white"}`,children:[Math.floor(n.crystal).toLocaleString()," / ",(n.storage.crystal/1e3).toFixed(0),"k"]})]}),r.jsxs("div",{className:"bg-[#1c2136] p-3 rounded-lg border border-white/5 flex items-center justify-between",children:[r.jsx("span",{className:"text-[#929bc9] text-xs uppercase font-bold",children:ts[le.DEUTERIUM_TANK].name}),r.jsxs("span",{className:`text-sm font-mono ${n.deuterium>=n.storage.deuterium?"text-red-400 font-bold":"text-white"}`,children:[Math.floor(n.deuterium).toLocaleString()," / ",(n.storage.deuterium/1e3).toFixed(0),"k"]})]})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:x.map(E=>{var Ke;const O=l[E.id],N=d("building",E.id,O),G=n.metal>=N.metal&&n.crystal>=N.crystal&&n.deuterium>=N.deuterium,fe=(_==null?void 0:_.itemId)===E.id,oe=h.filter(Pe=>Pe.type==="building").length>=2,ge=f(E.requirements),je=(N.metal+N.crystal)/2500*3600*1e3/(j+1)/C,Ue=Math.max(1,Math.floor(je/1e3)),Re=z(E.id,O);return r.jsxs("div",{className:`bg-[#1c2136] rounded-xl border border-white/10 overflow-hidden hover:border-primary/50 transition-all group flex flex-col h-full ${ge?"":"opacity-60 grayscale"}`,children:[r.jsxs("div",{className:"h-40 bg-cover bg-center relative",style:{backgroundImage:`url("${E.image}")`},children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#1c2136] to-transparent"}),r.jsxs("div",{className:"absolute top-2 right-2 bg-black/60 backdrop-blur px-2 py-1 rounded text-xs text-white border border-white/10 font-mono",children:["Lvl ",O]}),fe&&r.jsxs("div",{className:"absolute inset-0 bg-black/70 flex flex-col items-center justify-center backdrop-blur-sm p-4 text-center",children:[r.jsx("div",{className:"bg-primary text-white px-3 py-1 rounded-full text-xs font-bold animate-pulse shadow-lg mb-2",children:"W Budowie"}),r.jsx("div",{className:"text-2xl font-mono font-bold text-white",children:p})]})]}),r.jsxs("div",{className:"p-4 flex flex-col flex-1",children:[r.jsx("h4",{className:"text-lg font-bold text-white mb-1 group-hover:text-primary transition-colors",children:E.name}),r.jsx("p",{className:"text-xs text-[#929bc9] mb-4 line-clamp-2 min-h-[32px]",children:E.description}),Re&&r.jsxs("div",{className:"mb-3 flex flex-col gap-0.5",children:[r.jsx("div",{className:`text-xs font-bold ${Re.type==="energy"?"text-yellow-400":"text-green-400"}`,children:Re.text}),Re.energyText&&r.jsx("div",{className:"text-xs font-bold text-red-400",children:Re.energyText})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs mb-4",children:[r.jsxs("div",{className:`flex items-center gap-1 ${n.metal<N.metal?"text-red-400":"text-[#929bc9]"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"handyman"}),N.metal>=1e3?`${(N.metal/1e3).toFixed(1)}k`:N.metal]}),r.jsxs("div",{className:`flex items-center gap-1 ${n.crystal<N.crystal?"text-red-400":"text-[#929bc9]"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"diamond"}),N.crystal>=1e3?`${(N.crystal/1e3).toFixed(1)}k`:N.crystal]}),r.jsxs("div",{className:`flex items-center gap-1 ${n.deuterium<N.deuterium?"text-red-400":"text-[#929bc9]"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"propane"}),N.deuterium>=1e3?`${(N.deuterium/1e3).toFixed(1)}k`:N.deuterium]})]}),ge?r.jsxs("div",{className:"mt-auto pt-3 border-t border-white/5 flex items-center justify-between",children:[r.jsxs("span",{className:"text-xs text-[#929bc9] flex items-center gap-1",children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"schedule"}),Ra(Ue)]}),r.jsx("button",{onClick:()=>o(E.id),disabled:!G||oe,className:`px-4 py-2 rounded text-xs font-bold uppercase transition-all shadow-lg
                                                ${!G||oe?"bg-[#232948] text-[#929bc9]/50 cursor-not-allowed":"bg-primary hover:bg-blue-600 text-white hover:shadow-primary/30"}
                                            `,children:fe?"Czekaj...":G?"Rozbuduj":"Braki"})]}):r.jsxs("div",{className:"mt-auto pt-3 border-t border-red-500/20",children:[r.jsx("p",{className:"text-red-400 text-xs font-bold mb-1",children:"Wymagania:"}),r.jsx("div",{className:"flex flex-col gap-1",children:(Ke=E.requirements)==null?void 0:Ke.map((Pe,ye)=>{const S=Pe.type==="building"?ts[Pe.id].name:Tr[Pe.id].name,Q=Pe.type==="building"?l[Pe.id]:s[Pe.id];return r.jsxs("div",{className:`text-xs ${Q>=Pe.level?"text-green-400":"text-red-400/70"}`,children:["- ",S," (Lvl ",Pe.level,")"]},ye)})})]})]})]},E.id)})})]})},sv=()=>{var M;const{ships:l,resources:s,buildShip:n,checkRequirements:o,buildings:d,research:h,shipyardQueue:f}=ca(),b=Object.values(st).sort((E,O)=>{const N=E.baseCost.metal+E.baseCost.crystal+E.baseCost.deuterium,G=O.baseCost.metal+O.baseCost.crystal+O.baseCost.deuterium;return N-G}),g=d[le.SHIPYARD],[p,v]=F.useState({}),[x,_]=F.useState(""),j=f[0];F.useEffect(()=>{if(!j){_("");return}const E=()=>{const N=Date.now(),G=Math.max(0,Math.floor((j.endTime-N)/1e3));_(Ra(G))};E();const O=setInterval(E,1e3);return()=>clearInterval(O)},[j]);const C=(E,O)=>{const N=parseInt(O,10);!isNaN(N)&&N>=0?v(G=>({...G,[E]:N})):O===""&&v(G=>({...G,[E]:0}))},z=E=>{const O=p[E.id]||0;O>0&&(n(E.id,O),v(N=>({...N,[E.id]:0})))};return g===0?r.jsxs("div",{className:"bg-[#1c2136] border border-red-500/20 rounded-xl p-8 flex flex-col items-center justify-center text-center gap-4 mt-8",children:[r.jsx("span",{className:"material-symbols-outlined text-5xl text-red-500/50",children:"rocket_launch"}),r.jsx("h3",{className:"text-xl font-bold text-white",children:"Stocznia Wymagana"}),r.jsx("p",{className:"text-[#929bc9]",children:"Musisz wybudowa Stoczni w menu Budynki, aby rozpocz budow floty."})]}):r.jsxs("div",{className:"flex flex-col gap-6",children:[r.jsxs("div",{className:"flex items-center justify-between border-b border-white/10 pb-4",children:[r.jsxs("h2",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[r.jsx("span",{className:"material-symbols-outlined text-3xl text-primary",children:"rocket_launch"}),"Stocznia"]}),r.jsxs("div",{className:"flex items-center gap-4",children:[j?r.jsxs("div",{className:"bg-primary/20 border border-primary/30 px-3 py-1 rounded text-xs text-primary flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-sm animate-spin",children:"settings"}),"Budowa: ",((M=st[j.itemId])==null?void 0:M.name)||j.itemId," (",j.quantity,") - ",x]}):r.jsx("span",{className:"text-sm text-[#929bc9]",children:"Oczekuj na rozkazy"}),r.jsxs("span",{className:"text-sm text-[#929bc9] border-l border-white/10 pl-4",children:["Lvl ",g]})]})]}),f.length>0&&r.jsxs("div",{className:"bg-[#1c2136] border border-white/10 rounded-xl p-4 mb-4",children:[r.jsx("h3",{className:"text-sm font-bold text-[#929bc9] uppercase mb-3",children:"Kolejka Produkcyjna"}),r.jsx("div",{className:"flex flex-col gap-2",children:f.map((E,O)=>{var N;return r.jsxs("div",{className:`flex items-center justify-between p-2 rounded ${O===0?"bg-primary/10 border border-primary/20":"bg-[#111422] border border-white/5"}`,children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("div",{className:"text-xs font-mono text-[#929bc9] w-4",children:[O+1,"."]}),r.jsx("div",{className:"font-bold text-sm text-white",children:((N=st[E.itemId])==null?void 0:N.name)||E.itemId}),r.jsxs("div",{className:"text-xs text-[#929bc9]",children:["x",E.quantity]})]}),r.jsx("div",{className:"text-xs font-mono text-white",children:O===0?x:Ra(Math.floor((E.endTime-E.startTime)/1e3))})]},E.id)})})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:b.map(E=>{var we;const O=l[E.id],N=p[E.id]||0,G=o(E.requirements),fe={metal:E.baseCost.metal*(N||1),crystal:E.baseCost.crystal*(N||1),deuterium:E.baseCost.deuterium*(N||1)},J=s.metal>=fe.metal&&s.crystal>=fe.crystal&&s.deuterium>=fe.deuterium,oe=E.buildTime*1e3/(g+1),ge=Math.max(1,Math.floor(oe*(N||1)/1e3));return r.jsxs("div",{className:`bg-[#1c2136] border border-white/10 rounded-xl overflow-hidden group hover:border-primary/50 transition-all duration-300 relative ${G?"":"opacity-50"}`,children:[r.jsxs("div",{className:"absolute top-3 right-3 z-10 bg-black/60 backdrop-blur px-2 py-0.5 rounded text-xs text-[#929bc9] border border-white/10",children:["Posiadasz: ",r.jsx("span",{className:"text-white font-bold",children:O})]}),r.jsxs("div",{className:"h-40 lg:h-32 bg-cover bg-center relative",style:{backgroundImage:`url("${E.image}")`},children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#1c2136] to-transparent"}),!G&&r.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-grayscale"})]}),r.jsxs("div",{className:"p-5 lg:p-3 relative",children:[r.jsxs("div",{className:"flex justify-between items-start mb-2",children:[r.jsx("h4",{className:"text-white text-xl font-bold",children:E.name}),r.jsxs("div",{className:"flex flex-col gap-1 text-[10px] items-end",children:[r.jsxs("span",{className:"bg-red-500/10 text-red-400 px-1.5 py-0.5 rounded border border-red-500/20 whitespace-nowrap min-w-[80px] text-center",children:["Atak ",E.attack]}),r.jsxs("span",{className:"bg-blue-500/10 text-blue-400 px-1.5 py-0.5 rounded border border-blue-500/20 whitespace-nowrap min-w-[80px] text-center",children:["Obrona ",E.defense]}),r.jsxs("span",{className:"bg-green-500/10 text-green-400 px-1.5 py-0.5 rounded border border-green-500/20 whitespace-nowrap min-w-[80px] text-center",children:["adowno ",E.capacity]})]})]}),r.jsx("p",{className:"text-[#929bc9] text-xs mb-4 line-clamp-2 h-8",children:E.description}),E.bonuses&&Object.keys(E.bonuses).length>0&&r.jsxs("div",{className:"mb-3 text-[10px] text-[#929bc9]",children:[r.jsx("span",{className:"font-bold text-white uppercase block mb-1",children:"Silny przeciwko:"}),r.jsx("div",{className:"flex flex-wrap gap-1",children:Object.keys(E.bonuses).map(je=>{var Ue,Re;return r.jsx("span",{className:"bg-primary/10 text-primary border border-primary/20 px-1.5 py-0.5 rounded flex items-center gap-1",children:((Ue=st[je])==null?void 0:Ue.name)||((Re=Qa[je])==null?void 0:Re.name)||je},je)})})]}),G?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-4 p-3 bg-[#111422] rounded-lg border border-white/5",children:[r.jsxs("div",{className:`flex flex-col text-xs ${s.metal<E.baseCost.metal?"text-red-400":"text-[#929bc9]"}`,children:[r.jsx("span",{className:"uppercase text-[10px] tracking-wider",children:"Metal"}),r.jsx("span",{className:"font-mono text-white",children:E.baseCost.metal.toLocaleString()})]}),r.jsxs("div",{className:`flex flex-col text-xs ${s.crystal<E.baseCost.crystal?"text-red-400":"text-[#929bc9]"}`,children:[r.jsx("span",{className:"uppercase text-[10px] tracking-wider",children:"Kryszta"}),r.jsx("span",{className:"font-mono text-white",children:E.baseCost.crystal.toLocaleString()})]}),r.jsxs("div",{className:`flex flex-col text-xs ${s.deuterium<E.baseCost.deuterium?"text-red-400":"text-[#929bc9]"}`,children:[r.jsx("span",{className:"uppercase text-[10px] tracking-wider",children:"Deuter"}),r.jsx("span",{className:"font-mono text-white",children:E.baseCost.deuterium.toLocaleString()})]})]}),r.jsx("div",{className:"flex items-center justify-between mb-3 text-xs text-[#929bc9]",children:r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"schedule"})," ",Ra(ge)," (x",N||1,")"]})}),r.jsxs("div",{className:"flex items-center gap-2 mt-4",children:[r.jsxs("div",{className:"flex items-center bg-[#111422] rounded-lg border border-white/10 overflow-hidden shadow-sm",children:[r.jsx("button",{onClick:()=>C(E.id,Math.max(0,N-1).toString()),className:"w-10 h-10 flex items-center justify-center text-[#929bc9] hover:text-white hover:bg-white/5 active:bg-white/10 transition-colors border-r border-white/5",children:r.jsx("span",{className:"material-symbols-outlined text-base",children:"remove"})}),r.jsx("input",{type:"number",min:"0",placeholder:"0",value:p[E.id]>0?p[E.id]:"",onChange:je=>C(E.id,je.target.value),className:"w-16 bg-transparent text-white text-sm text-center focus:outline-none appearance-none font-mono font-bold"}),r.jsx("button",{onClick:()=>C(E.id,(N+1).toString()),className:"w-10 h-10 flex items-center justify-center text-[#929bc9] hover:text-white hover:bg-white/5 active:bg-white/10 transition-colors border-l border-white/5",children:r.jsx("span",{className:"material-symbols-outlined text-base",children:"add"})})]}),r.jsx("button",{onClick:()=>{const je=Math.floor(s.metal/E.baseCost.metal),Ue=E.baseCost.crystal>0?Math.floor(s.crystal/E.baseCost.crystal):1/0,Re=E.baseCost.deuterium>0?Math.floor(s.deuterium/E.baseCost.deuterium):1/0,Ke=Math.min(je,Ue,Re);C(E.id,Ke.toString())},className:"h-10 px-3 rounded-lg bg-[#232948] text-[#929bc9] text-xs font-bold uppercase border border-white/5 hover:bg-primary/20 hover:text-primary hover:border-primary/30 transition-all active:scale-95",children:"Max"}),r.jsxs("button",{onClick:()=>z(E),disabled:N<=0||!J,className:`flex-1 h-10 rounded-lg text-sm font-bold uppercase transition-all shadow-lg flex items-center justify-center gap-2 active:scale-95
                                                ${N>0&&J?"bg-primary hover:bg-blue-600 text-white shadow-primary/20":"bg-[#232948] text-[#929bc9] cursor-not-allowed opacity-50"}
                                            `,children:[r.jsx("span",{className:"material-symbols-outlined text-lg",children:"precision_manufacturing"}),r.jsx("span",{children:"Produkuj"})]})]})]}):r.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg",children:[r.jsx("p",{className:"text-red-400 text-xs font-bold mb-1",children:"Wymagane technologie:"}),r.jsx("div",{className:"flex flex-col gap-1",children:(we=E.requirements)==null?void 0:we.map((je,Ue)=>{const Re=je.type==="building"?ts[je.id].name:Tr[je.id].name,Ke=je.type==="building"?d[je.id]:h[je.id];return r.jsxs("div",{className:`text-xs ${Ke>=je.level?"text-green-400":"text-red-400/70"}`,children:["- ",Re," (Lvl ",je.level,")"]},Ue)})})]})]})]},E.id)})})]})},rv=()=>{const{planetName:l,ships:s,sendSpyProbe:n,sendAttack:o,sendTransport:d,sendColonize:h,planets:f,resources:b,galaxyCoords:g,mainPlanetCoords:p,planetType:v,getPlayersInSystem:x,userId:_,buildings:j,currentPlanetId:C,mainPlanetName:z,level:M,debris:E}=ca(),[O,N]=F.useState({galaxy:(g==null?void 0:g.galaxy)||1,system:(g==null?void 0:g.system)||1}),[G,fe]=F.useState([]),[J,oe]=F.useState(null),[ge,we]=F.useState(null),[je,Ue]=F.useState(null),[Re,Ke]=F.useState(null),[Pe,ye]=F.useState({}),[S,Q]=F.useState({metal:0,crystal:0,deuterium:0}),[ie,pe]=F.useState(1),[Ae,k]=F.useState(null),[Z,me]=F.useState({metal:0,crystal:0,deuterium:0}),[be,Ne]=F.useState(null);_i.useEffect(()=>{x(O.galaxy,O.system).then(fe)},[O.galaxy,O.system,x]);const Be=de=>{var ct,Bt,nt,ha,ua;const ae=p||g;if(ae&&O.galaxy===ae.galaxy&&O.system===ae.system&&ae.position===de){const Ht=v==="ice"?"Lodowa":v==="desert"?"Pustynna":"Ziemiopodobna";return{name:C?z||"Gwna":l,player:"Ty",rank:M||1,img:Er[v]||He.planet,type:Ht,isPlayer:!0,activity:"",isSelected:!C,debris:E||{metal:0,crystal:0}}}const Ge=f.find(Ht=>{var fa,Zt,Ar;return((fa=Ht.galaxy_coords)==null?void 0:fa.galaxy)===O.galaxy&&((Zt=Ht.galaxy_coords)==null?void 0:Zt.system)===O.system&&((Ar=Ht.galaxy_coords)==null?void 0:Ar.position)===de});if(Ge){const Ht=Ge.planet_type==="ice"?"Lodowa":Ge.planet_type==="desert"?"Pustynna":"Ziemiopodobna";return{name:Ge.planet_name||"Kolonia",player:"Ty (Kolonia)",rank:M||1,img:Er[Ge.planet_type]||He.planet,type:Ht,isPlayer:!0,isColony:!0,colonyId:Ge.id,activity:"",debris:Ge.debris||{metal:0,crystal:0}}}const Ve=G.find(Ht=>{var fa;return((fa=Ht.galaxy_coords)==null?void 0:fa.position)===de&&Ht.id!==_});if(Ve){const Ht=((ct=Ve.production_settings)==null?void 0:ct.planetType)==="ice"?"Lodowa":((Bt=Ve.production_settings)==null?void 0:Bt.planetType)==="desert"?"Pustynna":"Ziemiopodobna";(nt=Ve.production_settings)!=null&&nt.avatarUrl;const fa=Ve.level||1;return{name:Ve.planet_name||"Nieznana Kolonia",player:((ha=Ve.production_settings)==null?void 0:ha.nickname)||"Gracz",rank:fa,img:Er[(ua=Ve.production_settings)==null?void 0:ua.planetType]||He.planet,type:Ht,isPlayer:!1,isBot:!1,activity:"",debris:Ve.debris||{metal:0,crystal:0}}}return null},Je=de=>{const ae=Be(de);ae&&(we({galaxy:O.galaxy,system:O.system,pos:de,name:ae.name}),pe(1),Ne(null))},Rt=async()=>{if(!ge)return;await n(ie,{galaxy:O.galaxy,system:O.system,position:ge.pos})!==!1?(Ne("Wysyanie sond..."),setTimeout(()=>{O.galaxy===1&&O.system===1&&ge.pos===2&&oe({metal:Math.floor(Math.random()*5e4)+1e4,crystal:Math.floor(Math.random()*3e4)+5e3,deuterium:Math.floor(Math.random()*1e4)+2e3,energy:4e3,ships:Math.floor(Math.random()*50),defense:Math.floor(Math.random()*20)}),we(null)},1500)):Ne("Brak wystarczajcej iloci sond!")},dt=de=>{N(ae=>{const Ge=ae.system+de;return Ge<1||Ge>499?ae:{...ae,system:Ge}})},$e=de=>{N(ae=>{const Ge=ae.galaxy+de;return Ge<1||Ge>9?ae:{...ae,galaxy:Ge}})},zt=Array.from({length:15},(de,ae)=>ae+1),Xe=s[ce.ESPIONAGE_PROBE]||0;return r.jsxs("div",{className:"flex flex-col gap-6 pb-20 relative min-h-full",children:[r.jsxs("div",{className:"absolute top-20 left-1/2 -translate-x-1/2 pointer-events-none z-0 opacity-40 w-full flex justify-center overflow-hidden",children:[r.jsx("div",{className:"w-[600px] h-[600px] rounded-full bg-yellow-500/20 blur-[120px] -translate-y-1/2"}),r.jsx("div",{className:"absolute top-0 w-[300px] h-[300px] rounded-full bg-orange-500/10 blur-[60px] animate-pulse -translate-y-1/2"})]}),r.jsx("div",{className:"bg-[#1c2136] p-4 rounded-xl border border-white/10 shadow-lg sticky top-0 z-20 backdrop-blur-md bg-opacity-90",children:r.jsx("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:r.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[r.jsxs("div",{className:"flex-1 flex flex-col gap-1",children:[r.jsx("span",{className:"text-[10px] uppercase font-bold text-[#929bc9] tracking-wider text-center",children:"Galaktyka"}),r.jsxs("div",{className:"flex items-center h-10 md:h-12 bg-[#111422] rounded-lg border border-white/10 overflow-hidden",children:[r.jsx("button",{onClick:()=>$e(-1),className:"w-8 md:w-12 h-full hover:bg-white/5 active:bg-white/10 flex items-center justify-center text-[#929bc9]",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"chevron_left"})}),r.jsx("div",{className:"flex-1 text-center font-mono font-bold text-lg md:text-xl text-white",children:O.galaxy}),r.jsx("button",{onClick:()=>$e(1),className:"w-8 md:w-12 h-full hover:bg-white/5 active:bg-white/10 flex items-center justify-center text-[#929bc9]",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"chevron_right"})})]})]}),r.jsxs("div",{className:"flex-1 flex flex-col gap-1",children:[r.jsx("span",{className:"text-[10px] uppercase font-bold text-[#929bc9] tracking-wider text-center",children:"Ukad"}),r.jsxs("div",{className:"flex items-center h-10 md:h-12 bg-[#111422] rounded-lg border border-white/10 overflow-hidden",children:[r.jsx("button",{onClick:()=>dt(-1),className:"w-8 md:w-12 h-full hover:bg-white/5 active:bg-white/10 flex items-center justify-center text-[#929bc9]",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"chevron_left"})}),r.jsx("div",{className:"flex-1 text-center font-mono font-bold text-lg md:text-xl text-white",children:O.system}),r.jsx("button",{onClick:()=>dt(1),className:"w-8 md:w-12 h-full hover:bg-white/5 active:bg-white/10 flex items-center justify-center text-[#929bc9]",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"chevron_right"})})]})]})]})})}),r.jsx("div",{className:"flex flex-col gap-3 relative z-10",children:zt.map(de=>{const ae=Be(de);return r.jsxs("div",{className:`relative flex items-center gap-2 md:gap-3 p-2 md:p-3 rounded-xl border transition-all ${ae!=null&&ae.isPlayer?"bg-[#1a2342] border-primary/40 shadow-[0_0_15px_rgba(59,130,246,0.15)]":"bg-[#1c2136] border-white/5 hover:border-white/20"}`,children:[r.jsx("div",{className:"flex flex-col items-center justify-center w-6 md:w-8 text-[#929bc9] font-mono text-xs md:text-sm opacity-50",children:de}),r.jsx("div",{className:"shrink-0",children:ae?r.jsxs("div",{className:"w-10 h-10 md:w-12 md:h-12 rounded-full shadow-lg relative overflow-hidden bg-black/20",children:[r.jsx("img",{src:ae.img,alt:"Planet",className:"w-full h-full object-cover"}),r.jsx("div",{className:"absolute inset-0 rounded-full bg-black/10"}),r.jsx("div",{className:"absolute -inset-1 rounded-full border border-white/10 opacity-50"})]}):r.jsx("div",{className:"w-10 h-10 md:w-12 md:h-12 rounded-full border-2 border-dashed border-white/10 flex items-center justify-center opacity-20",children:r.jsx("span",{className:"material-symbols-outlined text-white text-base",children:"add"})})}),r.jsx("div",{className:"flex-1 min-w-0",children:ae?r.jsxs("div",{className:"flex flex-col justify-center",children:[r.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[r.jsx("span",{className:`font-bold text-sm md:text-base truncate ${ae.isPlayer?"text-primary":ae.isBot?"text-red-400":"text-white"}`,children:ae.name}),r.jsxs("span",{className:"text-[#929bc9] text-sm",children:["(",ae.player,")"]}),ae.activity&&r.jsx("span",{className:"text-[9px] text-red-400",children:"(*)"})]}),ae.rank&&r.jsxs("div",{className:"text-xs text-green-400 font-mono",children:["Level ",ae.rank]}),ae.debris&&((ae.debris.metal||0)>0||(ae.debris.crystal||0)>0)&&r.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-orange-400 mt-1",title:`Pole Zniszcze: Metal ${ae.debris.metal||0}, Kryszta ${ae.debris.crystal||0}`,children:[r.jsx("span",{className:"material-symbols-outlined text-[10px]",children:"recycling"}),r.jsxs("span",{children:["M:",((ae.debris.metal||0)/1e3).toFixed(1),"k C:",((ae.debris.crystal||0)/1e3).toFixed(1),"k"]})]})]}):r.jsx("span",{className:"text-white/20 text-xs md:text-sm italic",children:"Pusta przestrze"})}),r.jsx("div",{className:"flex items-center gap-1",children:ae?r.jsxs("div",{className:"flex gap-1",children:[ae.debris&&((ae.debris.metal||0)>0||(ae.debris.crystal||0)>0)&&r.jsx("button",{onClick:()=>{console.log("Open Recycle Modal")},className:"w-8 h-8 rounded bg-white/5 hover:bg-orange-500/20 hover:text-orange-400 text-[#929bc9] flex items-center justify-center border border-white/5 transition-colors",title:"Recykling (Wymaga Recyklera)",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"recycling"})}),ae.isPlayer&&!ae.isSelected?r.jsx("button",{onClick:()=>{Ke({galaxy:O.galaxy,system:O.system,pos:de,name:ae.name}),ye({}),Q({metal:0,crystal:0,deuterium:0}),Ne(null)},className:"w-8 h-8 rounded bg-white/5 hover:bg-blue-500/20 hover:text-blue-400 text-[#929bc9] flex items-center justify-center border border-white/5 transition-colors",title:"Transportuj Surowce",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"local_shipping"})}):!ae.isPlayer&&!ae.isBot?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>Je(de),className:"w-8 h-8 rounded bg-white/5 hover:bg-purple-500/20 hover:text-purple-400 text-[#929bc9] flex items-center justify-center border border-white/5 transition-colors",title:"Szpieguj",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"visibility"})}),r.jsx("button",{onClick:()=>{Ue({galaxy:O.galaxy,system:O.system,pos:de,name:ae.name}),ye({}),Ne(null)},className:"w-8 h-8 rounded bg-white/5 hover:bg-red-500/20 hover:text-red-400 text-[#929bc9] flex items-center justify-center border border-white/5 transition-colors",title:"Atakuj",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"swords"})}),r.jsx("button",{onClick:()=>{Ke({galaxy:O.galaxy,system:O.system,pos:de,name:ae.name}),ye({}),Q({metal:0,crystal:0,deuterium:0}),Ne(null)},className:"w-8 h-8 rounded bg-white/5 hover:bg-blue-500/20 hover:text-blue-400 text-[#929bc9] flex items-center justify-center border border-white/5 transition-colors",title:"Transportuj",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"local_shipping"})})]}):ae.isBot&&r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>Je(de),className:"w-8 h-8 rounded bg-white/5 hover:bg-purple-500/20 hover:text-purple-400 text-[#929bc9] flex items-center justify-center border border-white/5 transition-colors",title:"Szpieguj",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"visibility"})}),r.jsx("button",{onClick:()=>{Ue({galaxy:O.galaxy,system:O.system,pos:de,name:ae.name}),ye({}),Ne(null)},className:"w-8 h-8 rounded bg-white/5 hover:bg-red-500/20 hover:text-red-400 text-[#929bc9] flex items-center justify-center border border-white/5 transition-colors",title:"Atakuj",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"swords"})})]})]}):r.jsx("button",{onClick:()=>{if((s[ce.COLONY_SHIP]||0)<1){alert("Potrzebujesz Statku Kolonizacyjnego!");return}if(f.length>=8){alert("Osigne limit 8 planet!");return}k({galaxy:O.galaxy,system:O.system,pos:de}),me({metal:0,crystal:0,deuterium:0})},className:"w-8 h-8 rounded bg-white/5 hover:bg-green-500/20 hover:text-green-400 text-[#929bc9] flex items-center justify-center border border-white/5 transition-colors",title:`Kolonizuj (Masz: ${s[ce.COLONY_SHIP]||0} statkw kolonizacyjnych)`,children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"flag"})})})]},de)})}),ge&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",children:r.jsxs("div",{className:"bg-[#1c2136] w-full max-w-sm rounded-xl border border-purple-500/50 shadow-2xl p-6 relative",children:[r.jsx("button",{onClick:()=>we(null),className:"absolute top-4 right-4 text-[#929bc9] hover:text-white",children:r.jsx("span",{className:"material-symbols-outlined",children:"close"})}),r.jsxs("div",{className:"flex items-center gap-3 mb-6 border-b border-white/10 pb-4",children:[r.jsx("span",{className:"material-symbols-outlined text-purple-400 text-3xl",children:"visibility"}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-bold text-white",children:"Wylij Sondy"}),r.jsxs("p",{className:"text-xs text-[#929bc9]",children:["Cel: ",ge.name," [",ge.galaxy,":",ge.system,":",ge.pos,"]"]})]})]}),be?r.jsx("div",{className:"text-center py-4",children:r.jsx("p",{className:`text-lg font-bold ${be.includes("Wysyanie")?"text-green-400":"text-red-400"}`,children:be})}):r.jsxs("div",{className:"flex flex-col gap-4",children:[r.jsxs("div",{className:"bg-[#111422] p-4 rounded-lg border border-white/5 text-center",children:[r.jsx("p",{className:"text-sm text-[#929bc9] mb-2",children:"Dostpne sondy"}),r.jsx("p",{className:"text-2xl font-mono text-white font-bold",children:Xe})]}),r.jsxs("div",{className:"flex items-center bg-[#111422] rounded-lg border border-white/10 overflow-hidden",children:[r.jsx("button",{onClick:()=>pe(Math.max(1,ie-1)),className:"w-12 h-12 flex items-center justify-center text-[#929bc9] hover:bg-white/5",children:r.jsx("span",{className:"material-symbols-outlined",children:"remove"})}),r.jsx("input",{type:"number",className:"flex-1 bg-transparent text-center text-white font-bold text-lg focus:outline-none",value:ie,onFocus:de=>de.target.select(),onChange:de=>pe(Math.min(Xe,Math.max(1,parseInt(de.target.value)||1))),max:Xe}),r.jsx("button",{onClick:()=>pe(Math.min(Xe,ie+1)),className:"w-12 h-12 flex items-center justify-center text-[#929bc9] hover:bg-white/5",children:r.jsx("span",{className:"material-symbols-outlined",children:"add"})})]}),r.jsx("button",{onClick:Rt,disabled:Xe<1,className:`w-full py-3 rounded-lg font-bold uppercase tracking-widest transition-colors ${Xe>0?"bg-purple-600 hover:bg-purple-500 text-white":"bg-[#232948] text-white/20 cursor-not-allowed"}`,children:"Wylij Flot"})]})]})}),je&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",children:r.jsxs("div",{className:"bg-[#1c2136] w-full max-w-lg rounded-xl border border-red-500/50 shadow-2xl p-6 relative max-h-[90vh] overflow-y-auto",children:[r.jsx("button",{onClick:()=>Ue(null),className:"absolute top-4 right-4 text-[#929bc9] hover:text-white",children:r.jsx("span",{className:"material-symbols-outlined",children:"close"})}),r.jsxs("div",{className:"flex items-center gap-3 mb-6 border-b border-white/10 pb-4",children:[r.jsx("span",{className:"material-symbols-outlined text-red-500 text-3xl",children:"swords"}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-bold text-white",children:"Rozpocznij Atak"}),r.jsxs("p",{className:"text-xs text-[#929bc9]",children:["Cel: ",je.name," [",je.galaxy,":",je.system,":",je.pos,"]"]})]})]}),be?r.jsxs("div",{className:"text-center py-8",children:[r.jsx("p",{className:`text-xl font-bold ${be.includes("Wysyanie")?"text-green-400":"text-red-400"}`,children:be}),be.includes("Wysyanie")&&r.jsx("p",{className:"text-sm text-[#929bc9] mt-2",children:"Flota dotrze do celu za 5 minut."})]}):r.jsxs("div",{className:"flex flex-col gap-4",children:[r.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[Object.entries(s).map(([de,ae])=>{var Ve;if(ae<=0||de==="solarSatellite"||de==="crawlers")return null;const Ge=Pe[de]||0;return r.jsxs("div",{className:"flex items-center justify-between bg-[#111422] p-3 rounded-lg border border-white/5",children:[r.jsx("span",{className:"text-sm text-[#929bc9] font-bold capitalize",children:(Ve=st[de])==null?void 0:Ve.name}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"text-xs text-[#555a7a] mr-2",children:["Dostpne: ",ae]}),r.jsx("input",{type:"number",max:ae,min:0,value:Ge,onFocus:ct=>ct.target.select(),onChange:ct=>{const Bt=Math.min(ae,Math.max(0,parseInt(ct.target.value)||0));ye(nt=>({...nt,[de]:Bt}))},className:"w-20 bg-black/20 border border-white/10 rounded px-2 py-1 text-right text-white focus:outline-none focus:border-red-500"}),r.jsx("button",{onClick:()=>ye(ct=>({...ct,[de]:ae})),className:"text-xs text-red-400 hover:text-white px-2 uppercase font-bold",children:"Max"})]})]},de)}),Object.values(s).every(de=>!de)&&r.jsx("p",{className:"text-center text-white/20 italic",children:"Brak dostpnych statkw bojowych."})]}),r.jsx("button",{onClick:()=>{if(!Object.values(Pe).some(ae=>ae>0)){Ne("Wybierz przynajmniej jeden statek!");return}o(Pe,{galaxy:O.galaxy,system:O.system,position:je.pos}),Ne("Wysyanie floty..."),setTimeout(()=>Ue(null),2e3)},className:"w-full py-4 mt-2 bg-gradient-to-r from-red-600 to-red-800 hover:from-red-500 hover:to-red-700 text-white font-bold uppercase tracking-widest rounded-lg shadow-lg shadow-red-900/20 transition-all active:scale-95",children:"Wylij Atak"})]})]})}),Re&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",children:r.jsxs("div",{className:"bg-[#1c2136] w-full max-w-lg rounded-xl border border-blue-500/50 shadow-2xl p-6 relative max-h-[90vh] overflow-y-auto",children:[r.jsx("button",{onClick:()=>Ke(null),className:"absolute top-4 right-4 text-[#929bc9] hover:text-white",children:r.jsx("span",{className:"material-symbols-outlined",children:"close"})}),r.jsxs("div",{className:"flex items-center gap-3 mb-6 border-b border-white/10 pb-4",children:[r.jsx("span",{className:"material-symbols-outlined text-blue-500 text-3xl",children:"local_shipping"}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-bold text-white",children:"Transportuj Surowce"}),r.jsxs("p",{className:"text-xs text-[#929bc9]",children:["Cel: ",Re.name," [",Re.galaxy,":",Re.system,":",Re.pos,"]"]})]})]}),be?r.jsxs("div",{className:"text-center py-8",children:[r.jsx("p",{className:`text-xl font-bold ${be.includes("Wysyanie")?"text-green-400":"text-blue-400"}`,children:be}),be.includes("Wysyanie")&&r.jsx("p",{className:"text-sm text-[#929bc9] mt-2",children:"Dostawa dotrze za 5 minut."})]}):r.jsxs("div",{className:"flex flex-col gap-6",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-bold text-white mb-2",children:"Wybierz Statki"}),r.jsxs("div",{className:"grid grid-cols-1 gap-2 bg-[#111422] p-2 rounded-lg border border-white/5",children:[Object.entries(s).map(([de,ae])=>{var Ve;if(ae<=0||de==="solarSatellite"||de==="crawlers"||de==="espionageProbe")return null;const Ge=Pe[de]||0;return r.jsxs("div",{className:"flex items-center justify-between p-2 rounded hover:bg-white/5",children:[r.jsx("span",{className:"text-xs text-[#929bc9] font-bold capitalize",children:(Ve=st[de])==null?void 0:Ve.name}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"text-[10px] text-[#555a7a] mr-1",children:["Max: ",ae]}),r.jsx("input",{type:"number",max:ae,min:0,value:Ge,onFocus:ct=>ct.target.select(),onChange:ct=>{const Bt=Math.min(ae,Math.max(0,parseInt(ct.target.value)||0));ye(nt=>({...nt,[de]:Bt}))},className:"w-16 bg-black/20 border border-white/10 rounded px-1 py-1 text-right text-xs text-white focus:outline-none focus:border-blue-500"}),r.jsx("button",{onClick:()=>ye(ct=>({...ct,[de]:ae})),className:"text-[10px] text-blue-400 hover:text-white px-1 font-bold",children:"ALL"})]})]},de)}),Object.values(s).every(de=>!de)&&r.jsx("p",{className:"text-center text-white/20 italic text-xs",children:"Brak dostpnych transporterw."})]})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between items-end mb-2",children:[r.jsx("h4",{className:"text-sm font-bold text-white",children:"Zaaduj Surowce"}),r.jsxs("span",{className:`text-xs font-mono ${S.metal+S.crystal+S.deuterium>Object.entries(Pe).reduce((de,[ae,Ge])=>{var Ve;return de+Ge*(((Ve=st[ae])==null?void 0:Ve.capacity)||0)},0)?"text-red-400":"text-blue-400"}`,children:["adowno: ",(S.metal+S.crystal+S.deuterium).toLocaleString()," / ",Object.entries(Pe).reduce((de,[ae,Ge])=>{var Ve;return de+Ge*(((Ve=st[ae])==null?void 0:Ve.capacity)||0)},0).toLocaleString()]})]}),r.jsx("div",{className:"flex flex-col gap-2",children:["metal","crystal","deuterium"].map(de=>{const ae=de,Ge=Object.entries(Pe).reduce((nt,[ha,ua])=>{var Ht;return nt+ua*(((Ht=st[ha])==null?void 0:Ht.capacity)||0)},0),ct=S.metal+S.crystal+S.deuterium-(S[ae]||0),Bt=Math.max(0,Ge-ct);return Math.min(b[ae]||0,Bt),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-20 text-xs uppercase font-bold text-[#929bc9]",children:de==="metal"?"Metal":de==="crystal"?"Kryszta":"Deuter"}),r.jsxs("div",{className:"flex-1 relative",children:[r.jsx("input",{type:"number",value:S[ae]||0,onFocus:nt=>nt.target.select(),onChange:nt=>{const ha=Math.max(0,parseInt(nt.target.value)||0);Q(ua=>({...ua,[ae]:ha}))},className:`w-full bg-[#111422] border rounded px-3 py-2 text-white font-mono text-sm focus:border-blue-500 outline-none ${S[ae]>(b[ae]||0)?"border-red-500 text-red-400":"border-white/10"}`,placeholder:"0"}),r.jsx("button",{onClick:()=>Q(nt=>{const ha=nt[ae],ua=nt.metal+nt.crystal+nt.deuterium-ha,Ht=Math.max(0,Ge-ua),fa=Math.min(b[ae]||0,Ht);return{...nt,[ae]:fa}}),className:"absolute right-2 top-1/2 -translate-y-1/2 text-[10px] text-blue-400 hover:text-white font-bold uppercase",children:"MAX"})]}),r.jsxs("div",{className:"text-[10px] text-[#929bc9] w-16 text-right",children:["/ ",(b[ae]||0).toLocaleString()]})]},de)})})]}),r.jsx("button",{onClick:()=>{if(!Object.values(Pe).some(Ve=>Ve>0)){Ne("Wybierz statki transportowe!");return}const ae=S.metal+S.crystal+S.deuterium,Ge=Object.entries(Pe).reduce((Ve,[ct,Bt])=>{var nt;return Ve+Bt*(((nt=st[ct])==null?void 0:nt.capacity)||0)},0);if(ae>Ge){Ne(`Przeadowanie! (Limit: ${Ge.toLocaleString()})`);return}d(Pe,S,{galaxy:O.galaxy,system:O.system,position:Re.pos}),Ne("Wysyanie floty transportowej..."),setTimeout(()=>Ke(null),2e3)},className:"w-full py-4 bg-gradient-to-r from-blue-600 to-blue-800 hover:from-blue-500 hover:to-blue-700 text-white font-bold uppercase tracking-widest rounded-lg shadow-lg shadow-blue-900/20 transition-all active:scale-95",children:"Wylij Transport"})]})]})}),J&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",children:r.jsxs("div",{className:"bg-[#1c2136] w-full max-w-md rounded-xl border border-purple-500/50 shadow-2xl p-6 relative",children:[r.jsx("button",{onClick:()=>oe(null),className:"absolute top-4 right-4 text-[#929bc9] hover:text-white",children:r.jsx("span",{className:"material-symbols-outlined",children:"close"})}),r.jsxs("div",{className:"flex items-center gap-3 mb-6 border-b border-white/10 pb-4",children:[r.jsx("span",{className:"material-symbols-outlined text-purple-400 text-3xl",children:"description"}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-bold text-white",children:"Raport Szpiegowski"}),r.jsx("p",{className:"text-xs text-[#929bc9]",children:"Baza Piracka [1:1:2]"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[r.jsxs("div",{className:"bg-[#111422] p-3 rounded-lg border border-white/5",children:[r.jsx("span",{className:"text-[10px] uppercase font-bold text-[#929bc9]",children:"Surowce"}),r.jsxs("div",{className:"flex flex-col gap-1 mt-2 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-[#929bc9]",children:"Metal"})," ",r.jsx("span",{className:"text-white font-mono",children:J.metal.toLocaleString()})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-[#929bc9]",children:"Kryszta"})," ",r.jsx("span",{className:"text-white font-mono",children:J.crystal.toLocaleString()})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-[#929bc9]",children:"Deuter"})," ",r.jsx("span",{className:"text-white font-mono",children:J.deuterium.toLocaleString()})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-[#929bc9]",children:"Energia"})," ",r.jsx("span",{className:"text-white font-mono",children:J.energy.toLocaleString()})]})]})]}),r.jsxs("div",{className:"bg-[#111422] p-3 rounded-lg border border-white/5",children:[r.jsx("span",{className:"text-[10px] uppercase font-bold text-[#929bc9]",children:"Flota i Obrona"}),r.jsxs("div",{className:"flex flex-col gap-1 mt-2 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-[#929bc9]",children:"Statki"})," ",r.jsx("span",{className:"text-red-400 font-mono font-bold",children:J.ships})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-[#929bc9]",children:"Obrona"})," ",r.jsx("span",{className:"text-blue-400 font-mono font-bold",children:J.defense})]})]})]})]}),r.jsx("button",{onClick:()=>oe(null),className:"w-full py-3 bg-purple-600 hover:bg-purple-500 text-white font-bold rounded-lg transition-colors",children:"Zamknij Raport"})]})}),Ae&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",children:r.jsxs("div",{className:"bg-[#1c2136] w-full max-w-md rounded-xl border border-green-500/50 shadow-2xl p-6 relative",children:[r.jsx("button",{onClick:()=>k(null),className:"absolute top-4 right-4 text-[#929bc9] hover:text-white",children:r.jsx("span",{className:"material-symbols-outlined",children:"close"})}),r.jsxs("div",{className:"flex items-center gap-3 mb-6 border-b border-white/10 pb-4",children:[r.jsx("span",{className:"material-symbols-outlined text-green-400 text-3xl",children:"flag"}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-bold text-white",children:"Kolonizuj Planet"}),r.jsxs("p",{className:"text-xs text-[#929bc9]",children:["[",Ae.galaxy,":",Ae.system,":",Ae.pos,"]"]})]})]}),r.jsxs("div",{className:"bg-[#111422] p-4 rounded-lg border border-white/5 mb-4",children:[r.jsx("p",{className:"text-sm text-[#929bc9] mb-2",children:"Statek Kolonizacyjny zostanie zuyty."}),r.jsxs("p",{className:"text-xs text-green-400",children:["Posiadasz: ",s[ce.COLONY_SHIP]||0," statkw kolonizacyjnych"]}),r.jsxs("p",{className:"text-xs text-yellow-400 mt-1",children:["Planety: ",f.length,"/8"]})]}),r.jsxs("div",{className:"mb-4",children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsx("p",{className:"text-sm font-bold text-white",children:"Wylij surowce z now koloni:"}),r.jsx("button",{onClick:()=>me({metal:Math.min(b.metal,15e3),crystal:Math.min(b.crystal,15e3),deuterium:Math.min(b.deuterium,15e3)}),className:"px-2 py-1 bg-green-600/20 hover:bg-green-600/40 text-green-400 text-xs font-bold rounded border border-green-500/30",children:"MAX (15k)"})]}),r.jsx("p",{className:"text-xs text-yellow-400 mb-3",children:"Limit: 15,000 kadego surowca"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-[#929bc9] text-xs w-16",children:"Metal:"}),r.jsx("input",{type:"number",min:"0",max:"15000",value:Z.metal,onFocus:de=>de.target.select(),onChange:de=>me(ae=>({...ae,metal:Math.min(15e3,Math.max(0,parseInt(de.target.value)||0))})),className:"flex-1 bg-[#111422] border border-white/10 rounded px-2 py-1 text-white text-sm"}),r.jsx("span",{className:"text-gray-500 text-xs",children:"/ 15k"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-[#929bc9] text-xs w-16",children:"Kryszta:"}),r.jsx("input",{type:"number",min:"0",max:"15000",value:Z.crystal,onFocus:de=>de.target.select(),onChange:de=>me(ae=>({...ae,crystal:Math.min(15e3,Math.max(0,parseInt(de.target.value)||0))})),className:"flex-1 bg-[#111422] border border-white/10 rounded px-2 py-1 text-white text-sm"}),r.jsx("span",{className:"text-gray-500 text-xs",children:"/ 15k"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-[#929bc9] text-xs w-16",children:"Deuter:"}),r.jsx("input",{type:"number",min:"0",max:"15000",value:Z.deuterium,onFocus:de=>de.target.select(),onChange:de=>me(ae=>({...ae,deuterium:Math.min(15e3,Math.max(0,parseInt(de.target.value)||0))})),className:"flex-1 bg-[#111422] border border-white/10 rounded px-2 py-1 text-white text-sm"}),r.jsx("span",{className:"text-gray-500 text-xs",children:"/ 15k"})]})]})]}),r.jsxs("button",{onClick:async()=>{const de={galaxy:Ae.galaxy,system:Ae.system,position:Ae.pos};console.log(" [COLONIZE] Sending to coords:",de),await h(de,Z)&&(k(null),Ne(" Nowa kolonia zaoona!"))},className:"w-full py-3 bg-green-600 hover:bg-green-500 text-white font-bold rounded-lg transition-colors flex items-center justify-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined",children:"rocket_launch"}),"Kolonizuj!"]})]})})]})},nv=()=>{const{research:l,buildings:s,resources:n,upgradeResearch:o,getCost:d,constructionQueue:h,checkRequirements:f}=ca(),[b,g]=F.useState(""),p=Object.values(Tr),v=s[le.RESEARCH_LAB],x=h.find(j=>j.type==="research"),_=100;return F.useEffect(()=>{if(!x){g("");return}const j=()=>{const z=Date.now(),M=Math.max(0,Math.floor((x.endTime-z)/1e3));g(Ra(M))};j();const C=setInterval(j,1e3);return()=>clearInterval(C)},[x]),r.jsxs("div",{className:"flex flex-col gap-6",children:[r.jsxs("div",{className:"flex items-center justify-between border-b border-white/10 pb-4",children:[r.jsxs("h2",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[r.jsx("span",{className:"material-symbols-outlined text-3xl text-purple-400",children:"science"}),"Badania"]}),r.jsx("div",{className:"flex gap-2",children:x?r.jsxs("div",{className:"bg-purple-900/30 border border-purple-500/30 px-3 py-1 rounded text-xs text-purple-300 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-sm animate-spin",children:"sync"}),"Badanie w toku: ",b]}):r.jsxs("span",{className:"text-sm text-[#929bc9]",children:["Laboratorium: Lvl ",v]})})]}),v===0?r.jsxs("div",{className:"bg-[#1c2136] border border-red-500/20 rounded-xl p-8 flex flex-col items-center justify-center text-center gap-4",children:[r.jsx("span",{className:"material-symbols-outlined text-5xl text-red-500/50",children:"block"}),r.jsx("h3",{className:"text-xl font-bold text-white",children:"Laboratorium Badawcze Wymagane"}),r.jsx("p",{className:"text-[#929bc9]",children:"Musisz wybudowa Laboratorium Badawcze w menu Budynki, aby rozpocz badania nad nowymi technologiami."})]}):r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:p.map(j=>{var we;const C=l[j.id],z=d("research",j.id,C),M=n.metal>=z.metal&&n.crystal>=z.crystal&&n.deuterium>=z.deuterium,E=(x==null?void 0:x.itemId)===j.id,O=!!x,N=f(j.requirements),fe=(z.metal+z.crystal)/1e3*3600*1e3/(v+1)/_,J=Math.max(1,Math.floor(fe/1e3)),ge=((je,Ue)=>je===xe.WEAPON_TECH?{text:`Atak: +${Ue*10}% -> +${(Ue+1)*10}%`,type:"combat",color:"text-red-400"}:je===xe.SHIELDING_TECH?{text:`Tarcza: +${Ue*5}% -> +${(Ue+1)*5}%`,type:"combat",color:"text-blue-400"}:je===xe.ARMOUR_TECH?{text:`Pancerz: +${Ue*5}% -> +${(Ue+1)*5}%`,type:"combat",color:"text-emerald-400"}:je===xe.ENERGY_TECH?{text:`Reaktor: +${Ue*1}% efektywnoci`,type:"eco",color:"text-yellow-400"}:je===xe.ASTROPHYSICS?{text:`Ekspedycje: +${Ue}`,type:"eco",color:"text-purple-400"}:null)(j.id,C);return r.jsxs("div",{className:`bg-[#1c2136] rounded-xl border border-white/10 overflow-hidden hover:border-purple-500/50 transition-all group flex flex-col h-full ${N?"":"opacity-60 grayscale"}`,children:[r.jsxs("div",{className:"h-40 bg-cover bg-center relative",style:{backgroundImage:`url("${j.image}")`},children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#1c2136] to-transparent mix-blend-multiply"}),r.jsx("div",{className:"absolute inset-0 bg-purple-900/10"}),r.jsxs("div",{className:"absolute top-2 right-2 bg-black/60 backdrop-blur px-2 py-1 rounded text-xs text-purple-300 border border-purple-500/30 font-mono",children:["Lvl ",C]}),E&&r.jsxs("div",{className:"absolute inset-0 bg-black/70 flex flex-col items-center justify-center backdrop-blur-sm p-4 text-center",children:[r.jsx("div",{className:"bg-purple-600 text-white px-3 py-1 rounded-full text-xs font-bold animate-pulse shadow-lg mb-2",children:"Badanie..."}),r.jsx("div",{className:"text-2xl font-mono font-bold text-white",children:b})]})]}),r.jsxs("div",{className:"p-4 flex flex-col flex-1",children:[r.jsx("h4",{className:"text-lg font-bold text-white mb-1 group-hover:text-purple-400 transition-colors",children:j.name}),r.jsx("p",{className:"text-xs text-[#929bc9] mb-4 line-clamp-2 min-h-[32px]",children:j.description}),ge&&r.jsx("div",{className:`mb-3 text-[10px] font-bold uppercase tracking-wider ${ge.color}`,children:ge.text}),r.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs mb-4",children:[r.jsxs("div",{className:`flex items-center gap-1 ${n.metal<z.metal?"text-red-400":"text-[#929bc9]"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"handyman"}),z.metal>=1e3?`${(z.metal/1e3).toFixed(1)}k`:z.metal]}),r.jsxs("div",{className:`flex items-center gap-1 ${n.crystal<z.crystal?"text-red-400":"text-[#929bc9]"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"diamond"}),z.crystal>=1e3?`${(z.crystal/1e3).toFixed(1)}k`:z.crystal]}),r.jsxs("div",{className:`flex items-center gap-1 ${n.deuterium<z.deuterium?"text-red-400":"text-[#929bc9]"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"propane"}),z.deuterium>=1e3?`${(z.deuterium/1e3).toFixed(1)}k`:z.deuterium]})]}),N?r.jsxs("div",{className:"mt-auto pt-3 border-t border-white/5 flex items-center justify-between",children:[r.jsxs("span",{className:"text-xs text-[#929bc9] flex items-center gap-1",children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"schedule"}),Ra(J)]}),r.jsx("button",{onClick:()=>o(j.id),disabled:!M||O,className:`px-4 py-2 rounded text-xs font-bold uppercase transition-all shadow-lg
                                                    ${!M||O?"bg-[#232948] text-[#929bc9]/50 cursor-not-allowed":"bg-purple-600 hover:bg-purple-500 text-white hover:shadow-purple-500/30"}
                                                `,children:E?"Badanie...":M?"Badaj":"Braki"})]}):r.jsxs("div",{className:"mt-auto pt-3 border-t border-red-500/20",children:[r.jsx("p",{className:"text-red-400 text-xs font-bold mb-1",children:"Wymagania:"}),r.jsx("div",{className:"flex flex-col gap-1",children:(we=j.requirements)==null?void 0:we.map((je,Ue)=>{const Re=je.type==="building"?ts[je.id].name:Tr[je.id].name,Ke=je.type==="building"?s[je.id]:l[je.id];return r.jsxs("div",{className:`text-xs ${Ke>=je.level?"text-green-400":"text-red-400/70"}`,children:["- ",Re," (Lvl ",je.level,")"]},Ue)})})]})]})]},j.id)})})]})},iv=({report:l,onClose:s})=>{const[n,o]=F.useState("summary"),d=l.result==="attacker_win";return(l.loot.metal||0)+(l.loot.crystal||0)+(l.loot.deuterium||0),r.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4",onClick:s,children:r.jsxs("div",{className:"bg-[#1c2136] w-full max-w-4xl max-h-[90vh] overflow-hidden rounded-2xl border border-white/10 shadow-2xl flex flex-col",onClick:h=>h.stopPropagation(),children:[r.jsxs("div",{className:`p-4 border-b border-white/10 flex justify-between items-center ${d?"bg-green-900/20":"bg-red-900/20"}`,children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`p-2 rounded-lg ${d?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:r.jsx("span",{className:"material-symbols-outlined text-2xl",children:d?"emoji_events":"sentiment_very_dissatisfied"})}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-bold text-white uppercase tracking-wider",children:d?"Zwycistwo Agresora":"Zwycistwo Obrocy"}),r.jsx("p",{className:"text-xs text-[#929bc9]",children:"Raport Bojowy"})]})]}),r.jsx("button",{onClick:s,className:"text-[#929bc9] hover:text-white p-2 hover:bg-white/5 rounded-lg transition-colors",children:r.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),r.jsxs("div",{className:"flex border-b border-white/10 bg-[#15192b]",children:[r.jsx("button",{onClick:()=>o("summary"),className:`flex-1 py-3 text-sm font-bold uppercase tracking-wide transition-colors border-b-2 ${n==="summary"?"border-primary text-primary bg-primary/5":"border-transparent text-[#929bc9] hover:bg-white/5"}`,children:"Podsumowanie"}),r.jsx("button",{onClick:()=>o("fleets"),className:`flex-1 py-3 text-sm font-bold uppercase tracking-wide transition-colors border-b-2 ${n==="fleets"?"border-primary text-primary bg-primary/5":"border-transparent text-[#929bc9] hover:bg-white/5"}`,children:"Floty i Straty"}),r.jsx("button",{onClick:()=>o("log"),className:`flex-1 py-3 text-sm font-bold uppercase tracking-wide transition-colors border-b-2 ${n==="log"?"border-primary text-primary bg-primary/5":"border-transparent text-[#929bc9] hover:bg-white/5"}`,children:"Przebieg Walki"})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto p-6 bg-[#0b0d17]/50",children:[n==="summary"&&r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("div",{className:"bg-[#111422] rounded-xl p-4 border border-white/5 flex flex-col items-center",children:[r.jsx("span",{className:"text-xs uppercase text-[#555a7a] font-bold mb-2",children:"Zrabowany Tytan"}),r.jsx("span",{className:"text-2xl font-mono text-blue-400",children:Math.floor(l.loot.metal).toLocaleString()})]}),r.jsxs("div",{className:"bg-[#111422] rounded-xl p-4 border border-white/5 flex flex-col items-center",children:[r.jsx("span",{className:"text-xs uppercase text-[#555a7a] font-bold mb-2",children:"Zrabowany Krzem"}),r.jsx("span",{className:"text-2xl font-mono text-purple-400",children:Math.floor(l.loot.crystal).toLocaleString()})]}),r.jsxs("div",{className:"bg-[#111422] rounded-xl p-4 border border-white/5 flex flex-col items-center",children:[r.jsx("span",{className:"text-xs uppercase text-[#555a7a] font-bold mb-2",children:"Zrabowana Plazma"}),r.jsx("span",{className:"text-2xl font-mono text-green-400",children:Math.floor(l.loot.deuterium).toLocaleString()})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-8",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsx("h4",{className:"text-red-400 font-bold uppercase text-sm border-b border-red-500/20 pb-2",children:"Technologia Agresora"}),r.jsxs("div",{className:"flex justify-between text-sm text-[#929bc9]",children:[r.jsx("span",{children:"Bro:"}),r.jsxs("span",{className:"text-white font-mono",children:["+",Math.round((l.bonuses.attacker.weapon-1)*100),"%"]})]}),r.jsxs("div",{className:"flex justify-between text-sm text-[#929bc9]",children:[r.jsx("span",{children:"Osony:"}),r.jsxs("span",{className:"text-white font-mono",children:["+",Math.round((l.bonuses.attacker.shield-1)*100),"%"]})]}),r.jsxs("div",{className:"flex justify-between text-sm text-[#929bc9]",children:[r.jsx("span",{children:"Pancerz:"}),r.jsxs("span",{className:"text-white font-mono",children:["+",Math.round((l.bonuses.attacker.armour-1)*100),"%"]})]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsx("h4",{className:"text-blue-400 font-bold uppercase text-sm border-b border-blue-500/20 pb-2",children:"Technologia Obrocy"}),r.jsxs("div",{className:"flex justify-between text-sm text-[#929bc9]",children:[r.jsx("span",{children:"Bro:"}),r.jsxs("span",{className:"text-white font-mono",children:["+",Math.round((l.bonuses.defender.weapon-1)*100),"%"]})]}),r.jsxs("div",{className:"flex justify-between text-sm text-[#929bc9]",children:[r.jsx("span",{children:"Osony:"}),r.jsxs("span",{className:"text-white font-mono",children:["+",Math.round((l.bonuses.defender.shield-1)*100),"%"]})]}),r.jsxs("div",{className:"flex justify-between text-sm text-[#929bc9]",children:[r.jsx("span",{children:"Pancerz:"}),r.jsxs("span",{className:"text-white font-mono",children:["+",Math.round((l.bonuses.defender.armour-1)*100),"%"]})]})]})]})]}),n==="fleets"&&r.jsxs("div",{className:"space-y-8",children:[r.jsxs("div",{children:[r.jsxs("h3",{className:"text-red-400 font-bold text-lg mb-4 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined",children:"rocket_launch"}),"Flota Agresora"]}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full text-sm text-left",children:[r.jsx("thead",{className:"bg-[#111422] text-[#555a7a] uppercase font-bold text-xs",children:r.jsxs("tr",{children:[r.jsx("th",{className:"p-3 rounded-tl-lg",children:"Jednostka"}),r.jsx("th",{className:"p-3 text-right",children:"Start"}),r.jsx("th",{className:"p-3 text-right text-red-400",children:"Straty"}),r.jsx("th",{className:"p-3 text-right rounded-tr-lg",children:"Koniec"})]})}),r.jsx("tbody",{className:"divide-y divide-white/5",children:Object.keys(l.initialAttackerShips).map(h=>{var p;const f=l.initialAttackerShips[h]||0,b=l.finalAttackerShips[h]||0,g=l.attackerLosses[h]||0;return f===0?null:r.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[r.jsx("td",{className:"p-3 font-medium text-white",children:((p=st[h])==null?void 0:p.name)||h}),r.jsx("td",{className:"p-3 text-right font-mono text-[#929bc9]",children:f}),r.jsx("td",{className:"p-3 text-right font-mono text-red-400",children:g>0?`-${g}`:"-"}),r.jsx("td",{className:"p-3 text-right font-mono text-white",children:b})]},h)})})]})})]}),r.jsxs("div",{children:[r.jsxs("h3",{className:"text-blue-400 font-bold text-lg mb-4 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined",children:"shield"}),"Flota i Obrona Obrocy"]}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full text-sm text-left",children:[r.jsx("thead",{className:"bg-[#111422] text-[#555a7a] uppercase font-bold text-xs",children:r.jsxs("tr",{children:[r.jsx("th",{className:"p-3 rounded-tl-lg",children:"Jednostka"}),r.jsx("th",{className:"p-3 text-right",children:"Start"}),r.jsx("th",{className:"p-3 text-right text-red-400",children:"Straty"}),r.jsx("th",{className:"p-3 text-right rounded-tr-lg",children:"Koniec"})]})}),r.jsxs("tbody",{className:"divide-y divide-white/5",children:[Object.keys(l.initialDefenderShips).map(h=>{var p;const f=l.initialDefenderShips[h]||0,b=l.finalDefenderShips[h]||0,g=l.defenderLosses[h]||0;return f===0?null:r.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[r.jsx("td",{className:"p-3 font-medium text-white",children:((p=st[h])==null?void 0:p.name)||h}),r.jsx("td",{className:"p-3 text-right font-mono text-[#929bc9]",children:f}),r.jsx("td",{className:"p-3 text-right font-mono text-red-400",children:g>0?`-${g}`:"-"}),r.jsx("td",{className:"p-3 text-right font-mono text-white",children:b})]},`ship-${h}`)}),Object.keys(l.initialDefenderDefenses).map(h=>{var p;const f=l.initialDefenderDefenses[h]||0,b=l.finalDefenderDefenses[h]||0,g=l.defenderDefensesLost[h]||0;return f===0&&b===0?null:r.jsxs("tr",{className:"hover:bg-white/5 transition-colors bg-blue-900/5",children:[r.jsx("td",{className:"p-3 font-medium text-blue-200",children:((p=Qa[h])==null?void 0:p.name)||h}),r.jsx("td",{className:"p-3 text-right font-mono text-[#929bc9]",children:f}),r.jsx("td",{className:"p-3 text-right font-mono text-red-400",children:g>0?`-${g}`:"-"}),r.jsx("td",{className:"p-3 text-right font-mono text-white",children:b})]},`def-${h}`)})]})]})})]})]}),n==="log"&&r.jsxs("div",{className:"space-y-2 font-mono text-sm",children:[l.logMessages.map((h,f)=>r.jsx("div",{className:"p-3 bg-[#111422] rounded border border-white/5 text-[#cdd6f7]",children:h},f)),l.logMessages.length===0&&r.jsx("div",{className:"text-center text-[#555a7a] py-8 italic",children:"Brak szczegowego logu walki."})]})]})]})})},lv=({report:l,onClose:s})=>{const n=l.attackerSpyLevel||0,o=l.defenderSpyLevel||0;return r.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4",onClick:s,children:r.jsxs("div",{className:"bg-[#1c2136] w-full max-w-2xl max-h-[90vh] overflow-hidden rounded-2xl border border-white/10 shadow-2xl flex flex-col",onClick:d=>d.stopPropagation(),children:[r.jsxs("div",{className:"p-4 border-b border-white/10 flex justify-between items-center bg-blue-900/20",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"p-2 rounded-lg bg-blue-500/20 text-blue-400",children:r.jsx("span",{className:"material-symbols-outlined text-2xl",children:"visibility"})}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-bold text-white uppercase tracking-wider",children:"Raport Szpiegowski"}),r.jsxs("p",{className:"text-sm text-[#929bc9]",children:["Cel: ",r.jsx("span",{className:"text-white font-bold",children:l.targetName})]})]})]}),r.jsx("button",{onClick:s,className:"text-[#929bc9] hover:text-white p-2 hover:bg-white/5 rounded-lg transition-colors",children:r.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),r.jsxs("div",{className:"bg-[#15192b] px-6 py-3 border-b border-white/5 flex justify-between items-center text-sm",children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[#555a7a] text-xs font-bold uppercase",children:"Twoja Technologia"}),r.jsxs("span",{className:"text-blue-400 font-mono font-bold text-lg",children:["Poziom ",n]})]}),r.jsxs("div",{className:"flex flex-col items-end",children:[r.jsx("span",{className:"text-[#555a7a] text-xs font-bold uppercase",children:"Technologia Celu"}),r.jsxs("span",{className:"text-red-400 font-mono font-bold text-lg",children:["Poziom ",o]})]})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto p-6 bg-[#0b0d17]/50 space-y-6",children:[l.resources&&r.jsxs("div",{children:[r.jsx("h3",{className:"text-[#929bc9] font-bold uppercase text-xs mb-3 border-b border-white/5 pb-1",children:"Zasoby"}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{className:"bg-[#111422] rounded p-3 text-center border border-white/5",children:[r.jsx("div",{className:"text-xs text-[#555a7a] font-bold mb-1",children:"Tytan"}),r.jsx("div",{className:"font-mono text-blue-400",children:Math.floor(l.resources.metal).toLocaleString()})]}),r.jsxs("div",{className:"bg-[#111422] rounded p-3 text-center border border-white/5",children:[r.jsx("div",{className:"text-xs text-[#555a7a] font-bold mb-1",children:"Krzem"}),r.jsx("div",{className:"font-mono text-purple-400",children:Math.floor(l.resources.crystal).toLocaleString()})]}),r.jsxs("div",{className:"bg-[#111422] rounded p-3 text-center border border-white/5",children:[r.jsx("div",{className:"text-xs text-[#555a7a] font-bold mb-1",children:"Plazma"}),r.jsx("div",{className:"font-mono text-green-400",children:Math.floor(l.resources.deuterium).toLocaleString()})]})]})]}),r.jsxs("div",{children:[r.jsxs("h3",{className:"text-[#929bc9] font-bold uppercase text-xs mb-3 border-b border-white/5 pb-1 flex justify-between",children:["Flota",!l.ships&&r.jsx("span",{className:"text-red-500 text-[10px]",children:"Wymagana rnica poziomw: +2"})]}),l.ships?r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[Object.entries(l.ships).map(([d,h])=>{var f;return r.jsxs("div",{className:"flex justify-between p-2 bg-[#111422] rounded border border-white/5 text-sm",children:[r.jsx("span",{className:"text-white",children:((f=st[d])==null?void 0:f.name)||d}),r.jsx("span",{className:"font-mono text-[#929bc9]",children:h})]},d)}),Object.keys(l.ships).length===0&&r.jsx("span",{className:"text-white/30 italic text-sm",children:"Brak stacjonujcej floty."})]}):r.jsx("div",{className:"p-4 bg-red-900/10 border border-red-500/20 rounded text-center text-red-400 text-sm",children:" Dane niedostpne. Zbadaj wyszy poziom Technologii Szpiegowskiej."})]}),r.jsxs("div",{children:[r.jsxs("h3",{className:"text-[#929bc9] font-bold uppercase text-xs mb-3 border-b border-white/5 pb-1 flex justify-between",children:["Obrona",!l.defenses&&r.jsx("span",{className:"text-red-500 text-[10px]",children:"Wymagana rnica poziomw: +3"})]}),l.defenses?r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[Object.entries(l.defenses).map(([d,h])=>{var f;return r.jsxs("div",{className:"flex justify-between p-2 bg-[#111422] rounded border border-white/5 text-sm",children:[r.jsx("span",{className:"text-white",children:((f=Qa[d])==null?void 0:f.name)||d}),r.jsx("span",{className:"font-mono text-[#929bc9]",children:h})]},d)}),Object.keys(l.defenses).length===0&&r.jsx("span",{className:"text-white/30 italic text-sm",children:"Brak systemw obronnych."})]}):r.jsx("div",{className:"p-4 bg-red-900/10 border border-red-500/20 rounded text-center text-red-400 text-sm",children:" Dane niedostpne."})]}),r.jsxs("div",{children:[r.jsxs("h3",{className:"text-[#929bc9] font-bold uppercase text-xs mb-3 border-b border-white/5 pb-1 flex justify-between",children:["Budynki",!l.buildings&&r.jsx("span",{className:"text-red-500 text-[10px]",children:"Wymagana rnica poziomw: +5"})]}),l.buildings?r.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(l.buildings).map(([d,h])=>r.jsxs("div",{className:"flex justify-between p-2 bg-[#111422] rounded border border-white/5 text-sm",children:[r.jsx("span",{className:"text-white capitalize",children:d.replace(/_/g," ")}),r.jsxs("span",{className:"font-mono text-[#929bc9]",children:["Poz. ",h]})]},d))}):r.jsx("div",{className:"p-4 bg-red-900/10 border border-red-500/20 rounded text-center text-red-400 text-sm",children:" Dane niedostpne."})]})]})]})})},ov=()=>{const{missionLogs:l,clearLogs:s}=ca(),[n,o]=F.useState("all"),[d,h]=F.useState(null),f=p=>{var _;const v=((_=p.title)==null?void 0:_.toLowerCase())||"",x=String(p.outcome||"").toLowerCase();return x==="danger"||x==="info"||v.includes("anulowany")||v.includes("wykryto")?"threats":v.includes("bojowy")||v.includes("atak")?"attack":v.includes("ekspedycja")||v.includes("przestrze")||v.includes("pus")||v.includes("zasoby")||v.includes("pirat")||v.includes("obok")||v.includes("znalez")||v.includes("statki")||v.includes("artefakt")||v.includes("materia")||v.includes("pozyskano")?"expedition":v.includes("szpieg")||v.includes("skan")?"spy":v.includes("transport")||v.includes("dostarcz")||v.includes("surow")?"transport":"other"},b=F.useMemo(()=>n==="all"?l:l.filter(p=>f(p)===n),[l,n]),g=[{id:"all",label:"Wszystkie",icon:"history"},{id:"threats",label:"Zagroenia",icon:"crisis_alert"},{id:"attack",label:"Ataki",icon:"swords"},{id:"spy",label:"Szpiegowskie",icon:"visibility"},{id:"expedition",label:"Ekspedycje",icon:"rocket_launch"},{id:"transport",label:"Transport",icon:"local_shipping"}];return r.jsxs("div",{className:"bg-[#1c2136] rounded-xl border border-white/10 shadow-lg flex flex-col h-[600px]",children:[r.jsxs("div",{className:"flex flex-col border-b border-white/10 bg-[#15192b]",children:[r.jsxs("div",{className:"p-4 flex items-center justify-between",children:[r.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-primary",children:"menu_book"}),"Dziennik Pokadowy"]}),l.length>0&&r.jsx("button",{onClick:s,className:"text-xs text-red-400 hover:text-white px-3 py-1 rounded border border-white/5 hover:bg-red-500/20 transition-colors",children:"Wyczy"})]}),r.jsx("div",{className:"flex overflow-x-auto no-scrollbar px-2 md:px-4 gap-2 pb-3",children:g.map(p=>r.jsxs("button",{onClick:()=>o(p.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold whitespace-nowrap transition-colors border ${n===p.id?"bg-primary/20 border-primary text-white":"bg-[#1c2136] border-white/5 text-[#929bc9] hover:bg-white/5"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-lg",children:p.icon}),p.label]},p.id))})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 bg-[#0b0d17]/50",children:[b.length===0&&r.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-[#555a7a] gap-4",children:[r.jsx("span",{className:"material-symbols-outlined text-6xl opacity-20",children:"inbox"}),r.jsx("p",{children:"Brak raportw w tej kategorii."})]}),b.map(p=>r.jsx(cv,{log:p,type:f(p),onDetail:()=>h(p)},p.id))]}),d&&(d.report?d.title&&d.title.includes("Szpieg")?r.jsx(lv,{report:d.report,onClose:()=>h(null)}):r.jsx(iv,{report:d.report,onClose:()=>h(null)}):r.jsx(uv,{log:d,onClose:()=>h(null)}))]})},cv=({log:l,type:s,onDetail:n})=>{const o=l.outcome==="success",d=l.outcome==="danger";return s==="spy"||s==="threats"&&l.title.toLowerCase().includes("skan")?r.jsxs("div",{className:`${d?"bg-red-900/20 border-red-500/30":"bg-[#1c2136] border-white/10"} border rounded-lg overflow-hidden group hover:border-primary/50 transition-colors`,children:[r.jsxs("div",{className:`${d?"bg-red-900/30 border-red-500/20":"bg-[#111422] border-white/5"} p-3 border-b flex justify-between items-center`,children:[r.jsxs("span",{className:`${d?"text-red-400":"text-orange-400"} font-bold text-sm flex items-center gap-2`,children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"visibility"}),l.title]}),r.jsx("span",{className:"text-[10px] text-[#555a7a] font-mono",children:new Date(l.timestamp).toLocaleTimeString()})]}),r.jsxs("div",{className:"p-3",children:[r.jsx("p",{className:"text-sm text-[#cdd6f7] mb-2",children:l.message}),r.jsx("button",{onClick:n,className:"w-full mt-2 py-2 bg-orange-500/10 hover:bg-orange-500/20 text-orange-300 text-xs font-bold rounded border border-orange-500/20 transition-colors flex items-center justify-center gap-1",children:"Peny Raport"})]})]}):s==="attack"?r.jsxs("div",{className:`rounded-lg border overflow-hidden ${o?"bg-green-900/10 border-green-500/30":"bg-red-900/10 border-red-500/30"}`,children:[r.jsxs("div",{className:"p-3 flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("div",{className:`font-bold text-sm mb-1 ${o?"text-green-400":"text-red-400"}`,children:l.title}),r.jsx("div",{className:"text-xs text-[#929bc9]",children:new Date(l.timestamp).toLocaleString()})]}),l.report&&r.jsxs("div",{className:"text-right",children:[r.jsx("div",{className:"text-[10px] uppercase text-[#555a7a] font-bold",children:"Zrabowano"}),r.jsxs("div",{className:"text-xs text-white font-mono",children:[Math.floor((l.report.loot.metal+l.report.loot.crystal+l.report.loot.deuterium)/1e3),"k"]})]})]}),l.report&&r.jsxs("button",{onClick:n,className:"w-full py-2 bg-black/20 hover:bg-black/40 text-xs text-white/70 hover:text-white border-t border-white/5 transition-colors flex items-center justify-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"sticky_note_2"}),"Zobacz Szczegy"]})]}):r.jsxs("div",{className:`p-4 rounded-lg border ${o?"bg-green-500/5 border-green-500/20":d?"bg-red-500/5 border-red-500/20":"bg-[#1c2136] border-white/5"}`,children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsx("span",{className:`text-sm font-bold ${o?"text-green-400":d?"text-red-400":"text-blue-300"}`,children:l.title}),r.jsx("span",{className:"text-[10px] text-[#555a7a]",children:new Date(l.timestamp).toLocaleTimeString()})]}),r.jsx("p",{className:"text-sm text-[#929bc9] leading-relaxed",children:l.message}),l.rewards&&r.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[Object.entries(l.rewards).map(([h,f])=>!f||h==="items"||h==="ships"?null:r.jsxs("span",{className:"text-[10px] bg-[#111422] border border-white/10 px-2 py-1 rounded text-white font-mono",children:["+",f," ",h.charAt(0).toUpperCase()]},h)),l.rewards.ships&&Object.entries(l.rewards.ships).map(([h,f])=>{var b;return r.jsxs("span",{className:"text-[10px] bg-[#111422] border border-white/10 px-2 py-1 rounded text-white font-mono flex items-center gap-1",children:[r.jsx("span",{className:"material-symbols-outlined text-[10px]",children:"rocket"})," ",f," ",(b=st[h])==null?void 0:b.name]},h)})]}),l.report&&r.jsxs("button",{onClick:n,className:"w-full mt-3 py-2 bg-white/5 hover:bg-white/10 text-xs text-blue-200 border-t border-white/10 transition-colors flex items-center justify-center gap-2 rounded",children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"assignment"}),"Zobacz Raport Bitewny"]})]})},uv=({log:l,onClose:s})=>{var o,d,h,f,b,g,p,v,x,_;const n=l.report;return r.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4",onClick:s,children:r.jsxs("div",{className:"bg-[#1c2136] w-full max-w-lg max-h-[80vh] overflow-y-auto rounded-2xl border border-white/10 shadow-2xl",onClick:j=>j.stopPropagation(),children:[r.jsxs("div",{className:"sticky top-0 bg-[#1c2136] border-b border-white/10 p-4 flex justify-between items-center z-10",children:[r.jsxs("h3",{className:"text-white font-bold flex items-center gap-2",children:[r.jsx("span",{className:`material-symbols-outlined ${(o=l.title)!=null&&o.toLowerCase().includes("szpieg")?"text-blue-400":(d=l.title)!=null&&d.toLowerCase().includes("transport")||(h=l.title)!=null&&h.toLowerCase().includes("dostawa")?"text-green-400":(f=l.title)!=null&&f.toLowerCase().includes("bojowy")||(b=l.title)!=null&&b.toLowerCase().includes("pirat")?"text-red-500":"text-purple-400"}`,children:(g=l.title)!=null&&g.toLowerCase().includes("szpieg")?"visibility":(p=l.title)!=null&&p.toLowerCase().includes("transport")||(v=l.title)!=null&&v.toLowerCase().includes("dostawa")?"local_shipping":(x=l.title)!=null&&x.toLowerCase().includes("bojowy")||(_=l.title)!=null&&_.toLowerCase().includes("pirat")?"swords":"public"}),l.title]}),r.jsx("button",{onClick:s,className:"text-[#929bc9] hover:text-white",children:r.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),r.jsx("div",{className:"p-4 space-y-6",children:n?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"bg-[#111422] rounded-xl p-4 border border-white/5",children:[r.jsx("div",{className:"text-xs text-[#555a7a] uppercase font-bold mb-3 text-center",children:"Zrabowane Surowce"}),r.jsxs("div",{className:"flex justify-around",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-blue-400 font-bold font-mono",children:Math.floor(n.loot.metal)}),r.jsx("div",{className:"text-[10px] text-[#929bc9]",children:"Metal"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-purple-400 font-bold font-mono",children:Math.floor(n.loot.crystal)}),r.jsx("div",{className:"text-[10px] text-[#929bc9]",children:"Kryszta"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-green-400 font-bold font-mono",children:Math.floor(n.loot.deuterium)}),r.jsx("div",{className:"text-[10px] text-[#929bc9]",children:"Deutery"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx("div",{className:"text-red-400 font-bold text-xs uppercase border-b border-red-500/20 pb-1",children:"Agresor (Ty)"}),Object.entries(n.attackerLosses).length===0?r.jsx("div",{className:"text-green-500 text-xs",children:"Brak strat"}):Object.entries(n.attackerLosses).map(([j,C])=>{var z;return r.jsxs("div",{className:"flex justify-between text-xs text-[#929bc9]",children:[r.jsx("span",{children:(z=st[j])==null?void 0:z.name}),r.jsxs("span",{className:"text-red-400",children:["-",C]})]},j)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("div",{className:"text-blue-400 font-bold text-xs uppercase border-b border-blue-500/20 pb-1",children:"Obroca"}),Object.entries(n.defenderLosses).length===0&&Object.entries(n.defenderDefensesLost||{}).length===0?r.jsx("div",{className:"text-green-500 text-xs",children:"Brak strat"}):r.jsxs(r.Fragment,{children:[Object.entries(n.defenderLosses).map(([j,C])=>{var z;return r.jsxs("div",{className:"flex justify-between text-xs text-[#929bc9]",children:[r.jsx("span",{children:(z=st[j])==null?void 0:z.name}),r.jsxs("span",{className:"text-red-400",children:["-",C]})]},j)}),Object.entries(n.defenderDefensesLost||{}).map(([j,C])=>{var z;return r.jsxs("div",{className:"flex justify-between text-xs text-[#929bc9]",children:[r.jsx("span",{children:(z=Qa[j])==null?void 0:z.name}),r.jsxs("span",{className:"text-red-400",children:["-",C]})]},j)})]})]})]})]}):r.jsx("div",{className:"text-[#cdd6f7] text-sm whitespace-pre-wrap leading-relaxed bg-[#111422] p-4 rounded-lg border border-white/5",children:l.message})})]})})},dv=()=>{const{ships:l,sendExpedition:s,sendAttack:n,activeMissions:o,missionLogs:d,clearLogs:h,cancelMission:f,galaxyCoords:b}=ca(),[g,p]=F.useState({}),[v,x]=F.useState({galaxy:1,system:1,position:2}),[_,j]=F.useState(Ze.ATTACK);F.useEffect(()=>{b&&x({galaxy:b.galaxy||1,system:b.system||1,position:b.position||1})},[b]);const C=(N,G)=>{const fe=l[N]||0;let J=parseInt(G,10);isNaN(J)&&(J=0),J=Math.min(Math.max(0,J),fe),p(oe=>({...oe,[N]:J}))},z=()=>{const N={};Object.entries(l).forEach(([G,fe])=>{const J=fe;J>0&&(N[G]=J)}),p(N)},M=()=>{const N={};let G=0;Object.entries(g).forEach(([fe,J])=>{const oe=J;oe>0&&(N[fe]=oe,G+=oe)}),G!==0&&(_===Ze.EXPEDITION?s(N,v):_===Ze.ATTACK&&n(N,v),p({}))},E=Object.values(g).reduce((N,G)=>N+G,0),O=Object.entries(g).reduce((N,[G,fe])=>N+st[G].capacity*fe,0);return r.jsxs("div",{className:"flex flex-col gap-6",children:[r.jsxs("div",{className:"flex items-center justify-between border-b border-white/10 pb-4",children:[r.jsxs("h2",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[r.jsx("span",{className:"material-symbols-outlined text-3xl text-primary",children:"flight_takeoff"}),"Centrum Floty"]}),r.jsx("div",{className:"flex gap-4 text-sm text-[#929bc9]",children:r.jsxs("span",{children:["Misje: ",o.length," / 2"]})})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[r.jsxs("div",{className:"lg:col-span-7 space-y-6",children:[r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:(()=>{let N=0,G=0,fe=0,J=0;return Object.entries(l).forEach(([oe,ge])=>{const we=st[oe];ge>0&&we&&(N+=ge,G+=ge*we.attack,fe+=ge*we.defense,J+=ge*we.capacity)}),r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"bg-[#1c2136] p-4 rounded-xl border border-white/10 shadow-lg",children:[r.jsx("div",{className:"text-[#929bc9] text-[10px] uppercase font-bold mb-1",children:"Liczebno Floty"}),r.jsx("div",{className:"text-white text-xl font-mono font-bold",children:N})]}),r.jsxs("div",{className:"bg-[#1c2136] p-4 rounded-xl border border-white/10 shadow-lg",children:[r.jsx("div",{className:"text-[#929bc9] text-[10px] uppercase font-bold mb-1",children:"Sia Ognia"}),r.jsx("div",{className:"text-red-400 text-xl font-mono font-bold",children:G.toLocaleString()})]}),r.jsxs("div",{className:"bg-[#1c2136] p-4 rounded-xl border border-white/10 shadow-lg",children:[r.jsx("div",{className:"text-[#929bc9] text-[10px] uppercase font-bold mb-1",children:"Wytrzymao"}),r.jsx("div",{className:"text-green-400 text-xl font-mono font-bold",children:fe.toLocaleString()})]}),r.jsxs("div",{className:"bg-[#1c2136] p-4 rounded-xl border border-white/10 shadow-lg",children:[r.jsx("div",{className:"text-[#929bc9] text-[10px] uppercase font-bold mb-1",children:"adowno (Cak.)"}),r.jsx("div",{className:"text-blue-400 text-xl font-mono font-bold",children:J.toLocaleString()})]})]})})()}),r.jsxs("div",{className:"bg-[#1c2136] rounded-xl border border-white/10 p-6 shadow-lg",children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-primary",children:"rocket_launch"}),"Dostpna Flota"]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:z,className:"text-xs bg-primary/20 text-primary hover:bg-primary hover:text-white px-3 py-1 rounded font-bold transition-colors",children:"Wybierz wszystkie"}),r.jsx("button",{onClick:()=>p({}),className:"text-xs text-[#929bc9] hover:text-white underline",children:"Zeruj wybr"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[Object.entries(l).map(([N,G])=>{const fe=st[N];if(G<=0)return null;const J=g[N]>0;return r.jsxs("div",{className:`p-4 rounded-xl border transition-all ${J?"bg-primary/5 border-primary/30 shadow-lg shadow-primary/5":"bg-[#1c2136] border-white/5 hover:border-white/10"}`,children:[r.jsxs("div",{className:"flex justify-between items-start mb-6",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"size-12 rounded-lg bg-[#111422] flex items-center justify-center border border-white/10 bg-cover bg-center",style:{backgroundImage:`url(${fe.image})`},children:!fe.image&&r.jsx("span",{className:"material-symbols-outlined text-primary text-2xl",children:"rocket"})}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-white font-bold",children:fe.name}),r.jsxs("div",{className:"flex gap-2 text-[10px] mt-1",children:[r.jsxs("span",{className:"text-[#929bc9] bg-white/5 px-1.5 py-0.5 rounded",children:["Dostpne: ",r.jsx("span",{className:"text-white font-mono",children:G})]}),r.jsxs("span",{className:"text-blue-400 bg-blue-500/10 px-1.5 py-0.5 rounded",children:["ad.: ",(fe.capacity||0).toLocaleString()]})]})]})]}),r.jsxs("div",{className:"flex flex-col items-end gap-1",children:[r.jsx("div",{className:"text-[10px] text-[#555a7a] uppercase font-bold",children:"Wybierz"}),r.jsx("input",{type:"number",min:"0",max:G,value:g[N]||"",onChange:oe=>C(N,oe.target.value),className:"w-20 bg-[#111422] border border-white/10 rounded px-2 py-1 text-right text-white font-mono text-sm focus:border-primary focus:outline-none",placeholder:"0"})]})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[r.jsx("button",{onClick:()=>C(N,"0"),className:"h-8 text-[10px] uppercase font-bold text-[#555a7a] hover:text-white border border-white/5 hover:bg-white/5 rounded transition-colors",children:"0"}),r.jsx("button",{onClick:()=>C(N,Math.max(0,Math.floor(G/2)).toString()),className:"h-8 text-[10px] uppercase font-bold text-[#929bc9] hover:text-white border border-white/5 hover:bg-white/5 rounded transition-colors",children:"50%"}),r.jsxs("button",{onClick:()=>C(N,G.toString()),className:"col-span-2 h-8 text-[10px] uppercase font-bold text-primary hover:text-white border border-primary/20 hover:bg-primary/20 rounded transition-colors",children:["MAX (",G,")"]})]})]},N)}),Object.values(l).every(N=>N===0)&&r.jsxs("div",{className:"text-center py-8 text-[#929bc9]",children:[r.jsx("span",{className:"material-symbols-outlined text-4xl mb-2 opacity-50",children:"sailing"}),r.jsx("p",{children:"Brak statkw w dokach. Wybuduj flot w Stoczni."})]})]})]})]}),r.jsx("div",{className:"lg:col-span-5 flex flex-col gap-6",children:r.jsxs("div",{className:"bg-[#1c2136] rounded-xl border border-white/10 p-6 shadow-lg",children:[r.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Cel i Misja"}),r.jsxs("div",{className:"flex flex-col gap-4",children:[r.jsxs("div",{className:"p-4 bg-[#111422] rounded-lg border border-white/5",children:[r.jsx("label",{className:"text-xs text-[#929bc9] uppercase font-bold mb-3 block",children:"Wsprzdne Celu"}),r.jsxs("div",{className:"flex items-center justify-center gap-2",children:[r.jsxs("div",{className:"flex flex-col items-center gap-1 w-20",children:[r.jsx("span",{className:"text-[10px] text-[#555a7a] uppercase",children:"Gal"}),r.jsx("input",{type:"number",value:v.galaxy,onChange:N=>x({...v,galaxy:parseInt(N.target.value)||1}),className:"w-full bg-[#232948] text-center py-3 rounded-lg text-white font-mono font-bold border border-white/10 focus:border-primary focus:ring-1 focus:ring-primary outline-none"})]}),r.jsx("span",{className:"text-white/20 text-xl font-light mt-4",children:":"}),r.jsxs("div",{className:"flex flex-col items-center gap-1 w-20",children:[r.jsx("span",{className:"text-[10px] text-[#555a7a] uppercase",children:"Uk"}),r.jsx("input",{type:"number",value:v.system,onChange:N=>x({...v,system:parseInt(N.target.value)||1}),className:"w-full bg-[#232948] text-center py-3 rounded-lg text-white font-mono font-bold border border-white/10 focus:border-primary focus:ring-1 focus:ring-primary outline-none"})]}),r.jsx("span",{className:"text-white/20 text-xl font-light mt-4",children:":"}),r.jsxs("div",{className:"flex flex-col items-center gap-1 w-20",children:[r.jsx("span",{className:"text-[10px] text-[#555a7a] uppercase",children:"Poz"}),r.jsx("input",{type:"number",value:v.position,onChange:N=>x({...v,position:parseInt(N.target.value)||1}),className:"w-full bg-[#232948] text-center py-3 rounded-lg text-white font-mono font-bold border border-white/10 focus:border-primary focus:ring-1 focus:ring-primary outline-none"})]})]}),r.jsxs("div",{className:"flex justify-center mt-3 gap-2",children:[r.jsx("button",{onClick:()=>{x({...v,position:16}),j(Ze.EXPEDITION)},className:`text-xs px-2 py-1 rounded border border-transparent hover:border-white/10 transition-colors ${v.position===16?"text-primary font-bold bg-primary/10":"text-[#929bc9] hover:text-white"}`,children:"[16] Gboka Przestrze"}),r.jsx("button",{onClick:()=>{x({...v,position:2}),j(Ze.ATTACK)},className:`text-xs px-2 py-1 rounded border border-transparent hover:border-white/10 transition-colors ${v.position===2?"text-red-400 font-bold bg-red-500/10":"text-[#929bc9] hover:text-white"}`,children:"[2] Baza Piratw"})]})]}),E>0&&r.jsxs("div",{className:"p-4 bg-[#111422] rounded-lg border border-white/5 flex flex-col gap-2",children:[r.jsxs("div",{className:"flex justify-between items-center text-sm",children:[r.jsx("span",{className:"text-[#929bc9]",children:"Ilo Statkw:"}),r.jsx("span",{className:"text-white font-mono",children:E})]}),r.jsxs("div",{className:"flex justify-between items-center text-sm",children:[r.jsx("span",{className:"text-[#929bc9]",children:"Cakowita adowno:"}),r.jsx("span",{className:"text-green-400 font-mono font-bold",children:O.toLocaleString()})]})]}),r.jsxs("div",{className:"p-4 bg-[#111422] rounded-lg border border-white/5",children:[r.jsx("label",{className:"text-xs text-[#929bc9] uppercase font-bold mb-2 block",children:"Typ Misji"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>j(Ze.EXPEDITION),className:`flex-1 py-3 rounded-lg font-bold text-sm border transition-colors ${_===Ze.EXPEDITION?"bg-primary text-white border-primary/50 shadow-lg shadow-primary/20":"bg-[#232948] text-[#929bc9] border-white/5"}`,children:"Ekspedycja"}),r.jsx("button",{onClick:()=>j(Ze.ATTACK),className:`flex-1 py-3 rounded-lg font-bold text-sm border transition-colors ${_===Ze.ATTACK?"bg-red-500 text-white border-red-500/50 shadow-lg shadow-red-500/20":"bg-[#232948] text-[#929bc9] border-white/5"}`,children:"Atak"})]})]}),r.jsx("button",{onClick:M,disabled:E===0,className:`w-full py-4 rounded-xl font-bold text-lg uppercase tracking-widest transition-all shadow-xl
                                    ${E>0?_===Ze.ATTACK?"bg-gradient-to-r from-red-600 to-orange-600 hover:from-red-500 hover:to-orange-500 text-white transform hover:scale-[1.02] shadow-red-900/30":"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-500 hover:to-indigo-500 text-white transform hover:scale-[1.02] shadow-blue-900/30":"bg-[#232948] text-white/20 cursor-not-allowed"}
                                `,children:r.jsxs("div",{className:"flex flex-col leading-none gap-1",children:[r.jsx("span",{children:_===Ze.ATTACK?"ROZPOCZNIJ ATAK":"WYLIJ FLOT"}),E>0&&r.jsxs("span",{className:"text-[10px] font-normal opacity-70",children:["Statkw: ",E]})]})})]})]})})]}),o.length>0&&r.jsxs("div",{className:"bg-[#1c2136] rounded-xl border border-white/10 p-6 shadow-lg",children:[r.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Aktywne Misje"}),r.jsx("div",{className:"space-y-4",children:o.map(N=>r.jsx(hv,{mission:N,onCancel:f},N.id))})]}),r.jsx(ov,{})]})},hv=({mission:l,onCancel:s})=>{const[n,o]=F.useState("outbound"),[d,h]=F.useState(0),[f,b]=F.useState(""),[g,p]=F.useState(!1);F.useEffect(()=>{const x=()=>{const j=Date.now();let C=0,z=0;if(j<l.arrivalTime){o("outbound");const M=l.arrivalTime-l.startTime||6e4,E=j-l.startTime;C=Math.min(100,Math.max(0,E/M*100)),z=Math.max(0,(l.arrivalTime-j)/1e3)}else{o("inbound");const M=l.returnTime-l.arrivalTime||6e4,E=j-l.arrivalTime;C=Math.min(100,Math.max(0,E/M*100)),z=Math.max(0,(l.returnTime-j)/1e3)}(isNaN(C)||!isFinite(C))&&(C=0),(isNaN(z)||!isFinite(z))&&(z=0),h(C),b(Ra(z))};x();const _=setInterval(x,100);return()=>clearInterval(_)},[l]);const v=l.type===Ze.ATTACK;return r.jsxs("div",{className:`rounded-lg p-4 border relative overflow-hidden ${v?"bg-red-900/10 border-red-500/20":"bg-[#111422] border-white/5"}`,children:[r.jsxs("div",{className:"flex items-center justify-between mb-4 relative px-4 py-2",children:[r.jsxs("div",{className:"flex flex-col items-center z-10",children:[r.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-500/20 border border-blue-500 flex items-center justify-center",children:r.jsx("span",{className:"material-symbols-outlined text-sm text-blue-400",children:"home"})}),r.jsx("span",{className:"text-[10px] text-[#929bc9] mt-1",children:"Baza"})]}),r.jsx("div",{className:"flex-1 h-1 bg-white/10 mx-2 relative rounded-full overflow-hidden",children:r.jsx("div",{className:`h-full transition-all duration-100 ease-linear ${n==="outbound"?v?"bg-red-500 origin-left":"bg-primary origin-left":"bg-green-500 origin-right ml-auto"}`,style:{width:`${d}%`}})}),r.jsx("div",{className:"absolute top-1/2 -translate-y-[calc(50%+12px)] transition-all duration-100 ease-linear z-20",style:{left:`calc(10% + ${n==="outbound"?d*.8:(100-d)*.8}%)`},children:r.jsx("span",{className:`material-symbols-outlined text-white text-xl drop-shadow-lg transform ${n==="inbound"?"rotate-180 text-green-400":v?"text-red-500":"text-primary"}`,children:"rocket"})}),r.jsxs("div",{className:"flex flex-col items-center z-10",children:[r.jsx("div",{className:`w-8 h-8 rounded-full border flex items-center justify-center ${n==="inbound"?"bg-green-500/20 border-green-500":v?"bg-red-500/20 border-red-500":l.type==="transport"?"bg-blue-500/20 border-blue-500":"bg-white/5 border-white/20"}`,children:r.jsx("span",{className:`material-symbols-outlined text-sm ${n==="inbound"?"text-green-400":v?"text-red-400":l.type==="transport"?"text-blue-400":"text-[#929bc9]"}`,children:v?"swords":l.type==="transport"?"local_shipping":l.type==="spy"?"visibility":"public"})}),r.jsx("span",{className:"text-[10px] text-[#929bc9] mt-1",children:v?"Bitwa":l.type==="transport"?"Transport":l.type==="spy"?"Szpieg":"Ekspedycja"})]})]}),r.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4 border-t border-white/5 pt-3",children:[r.jsxs("div",{className:"flex flex-col gap-1 w-full md:w-auto",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("div",{className:"text-white font-bold text-sm",children:["Cel: [",l.targetCoords.galaxy,":",l.targetCoords.system,":",l.targetCoords.position,"]"]}),r.jsxs("div",{className:"text-[#929bc9] text-xs",children:["Flota: ",Object.values(l.ships).reduce((x,_)=>x+Number(_),0)," jedn."]})]}),r.jsxs("div",{className:"text-[10px] text-[#555a7a] flex flex-wrap gap-2 mt-1",children:[l.type==="transport"&&l.resources&&r.jsxs("div",{className:"flex gap-2 bg-[#0b0d17] px-2 py-1 rounded border border-white/5",children:[l.resources.metal>0&&r.jsxs("span",{className:"text-blue-400",children:["M: ",Math.floor(l.resources.metal).toLocaleString()]}),l.resources.crystal>0&&r.jsxs("span",{className:"text-purple-400",children:["C: ",Math.floor(l.resources.crystal).toLocaleString()]}),l.resources.deuterium>0&&r.jsxs("span",{className:"text-green-400",children:["D: ",Math.floor(l.resources.deuterium).toLocaleString()]})]}),r.jsx("div",{className:"flex gap-2 bg-[#0b0d17] px-2 py-1 rounded border border-white/5 overflow-x-auto max-w-[300px] scrollbar-hide",children:Object.entries(l.ships).map(([x,_])=>{var j;return _>0&&r.jsxs("span",{className:"text-white whitespace-nowrap",children:[(j=st[x])==null?void 0:j.name,": ",_]},x)})})]})]}),r.jsxs("div",{className:"text-right flex items-center gap-3 md:shrink-0",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-white font-mono font-bold",children:f}),r.jsx("div",{className:`text-xs animate-pulse ${n==="outbound"?v?"text-red-400":"text-primary":"text-green-400"}`,children:n==="outbound"?v?"Atak w toku!":"Dolot do celu...":"Powrt do bazy..."})]}),n==="outbound"&&r.jsx("button",{onClick:async()=>{p(!0),await s(l.id),p(!1)},disabled:g,className:"px-3 py-2 text-xs font-bold uppercase rounded-lg border border-red-500/30 text-red-400 hover:bg-red-500/20 hover:text-white transition-colors disabled:opacity-50",children:g?"Anulowanie...":"Odwoaj"})]})]})]})},fv=()=>{const{resources:l,buyPremium:s}=ca(),[n,o]=_i.useState("resources"),d=[{id:"metal_small",name:"Maa Paczka Metalu",description:"Dostarcza 50,000 Metalu natychmiast.",cost:100,reward:{metal:5e4},icon:"handyman",color:"from-gray-500 to-gray-700"},{id:"crystal_small",name:"Maa Paczka Krysztau",description:"Dostarcza 25,000 Krysztau natychmiast.",cost:100,reward:{crystal:25e3},icon:"diamond",color:"from-blue-400 to-blue-600"},{id:"deuterium_small",name:"Maa Paczka Deuteru",description:"Dostarcza 10,000 Deuteru natychmiast.",cost:100,reward:{deuterium:1e4},icon:"propane",color:"from-teal-400 to-teal-600"},{id:"metal_large",name:"Wielka Skrzynia Metalu",description:"Ogromny zasb 250,000 Metalu.",cost:400,reward:{metal:25e4},icon:"inventory_2",color:"from-yellow-600 to-yellow-800"},{id:"crystal_large",name:"Wielka Skrzynia Krysztau",description:"Ogromny zasb 125,000 Krysztau.",cost:400,reward:{crystal:125e3},icon:"diamond",color:"from-blue-600 to-blue-800"},{id:"deuterium_large",name:"Wielka Skrzynia Deuteru",description:"Ogromny zasb 50,000 Deuteru.",cost:400,reward:{deuterium:5e4},icon:"science",color:"from-teal-600 to-teal-800"}],h=[{id:"build_speed_1h",name:"Przyspieszenie Budowy (1h)",description:"Skraca czas budowy wszystkich budynkw o 1 godzin.",cost:500,reward:{custom:"build_speed_1h"},icon:"speed",color:"from-green-500 to-green-700"},{id:"research_speed_1h",name:"Przyspieszenie Bada (1h)",description:"Skraca czas trwania bada o 1 godzin.",cost:500,reward:{custom:"research_speed_1h"},icon:"science",color:"from-purple-500 to-purple-700"},{id:"fleet_speed_24h",name:"Dopalacz Napdu (24h)",description:"Zwiksza prdko wszystkich flot o 20% na 24 godziny.",cost:1e3,reward:{custom:"fleet_speed_24h"},icon:"rocket_launch",color:"from-orange-500 to-orange-700"}],f=[{id:"death_star",name:"Projekt Leviathan",description:"Schematy mobilnej stacji bojowej zdolnej do niszczenia planet. (Prototyp)",cost:1e7,reward:{custom:"death_star"},icon:"public_off",color:"from-red-900 to-black",special:!0,unavailable:!0,image:"/kosmo/ships/Death.png"}],b=async p=>{if(p.unavailable)return;if(p.reward.custom){alert("Ten przedmiot jest obecnie niedostpny w sklepie (Wkrtce!).");return}const v=await s(p.cost,p.reward);v==="success"?alert(`Pomylnie zakupiono: ${p.name}`):v==="no_funds"?alert("Niewystarczajca ilo Antymaterii!"):v==="storage_full"&&alert("Magazyny s przepenione! Powiksz magazyny, aby kupi ten pakiet.")},g=()=>{switch(n){case"resources":return d;case"bonuses":return h;case"ships":return f;default:return[]}};return r.jsxs("div",{className:"flex flex-col gap-6",children:[r.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between border-b border-white/10 pb-4",children:[r.jsxs("h2",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[r.jsx("span",{className:"material-symbols-outlined text-3xl text-yellow-500",children:"shopping_cart"}),"Sklep Premium"]}),r.jsxs("div",{className:"bg-purple-900/30 border border-purple-500/50 px-4 py-2 rounded-lg flex items-center gap-2 shadow-lg shadow-purple-900/20",children:[r.jsx("span",{className:"text-[#929bc9] text-sm font-bold uppercase",children:"Twoja Antymateria:"}),r.jsx("span",{className:"text-purple-300 font-mono font-bold text-xl",children:l.darkMatter}),r.jsx("span",{className:"material-symbols-outlined text-purple-400 text-sm",children:"all_inclusive"})]})]}),r.jsxs("div",{className:"flex gap-2 border-b border-white/10 pb-1",children:[r.jsxs("button",{onClick:()=>o("resources"),className:`px-4 py-2 rounded-t-lg font-bold text-sm transition-colors flex items-center gap-2 ${n==="resources"?"bg-yellow-600/20 text-yellow-500 border-b-2 border-yellow-500":"text-[#929bc9] hover:text-white hover:bg-white/5"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-lg",children:"inventory_2"}),"Surowce"]}),r.jsxs("button",{onClick:()=>o("bonuses"),className:`px-4 py-2 rounded-t-lg font-bold text-sm transition-colors flex items-center gap-2 ${n==="bonuses"?"bg-blue-600/20 text-blue-500 border-b-2 border-blue-500":"text-[#929bc9] hover:text-white hover:bg-white/5"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-lg",children:"stars"}),"Bonusy"]}),r.jsxs("button",{onClick:()=>o("ships"),className:`px-4 py-2 rounded-t-lg font-bold text-sm transition-colors flex items-center gap-2 ${n==="ships"?"bg-red-600/20 text-red-500 border-b-2 border-red-500":"text-[#929bc9] hover:text-white hover:bg-white/5"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-lg",children:"rocket"}),"Statki"]})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:g().map(p=>r.jsxs("div",{className:`bg-[#1c2136] rounded-xl border overflow-hidden group transition-all flex flex-col ${p.special?"border-red-500/50 shadow-[0_0_30px_rgba(220,38,38,0.2)]":"border-white/10 hover:border-yellow-500/50"}`,children:[r.jsxs("div",{className:`h-48 bg-gradient-to-br ${p.color} relative flex items-center justify-center overflow-hidden`,children:[p.image?r.jsx("div",{className:"absolute inset-0 bg-cover bg-center transition-transform duration-700 group-hover:scale-110",style:{backgroundImage:`url("${p.image}")`},children:r.jsx("div",{className:"absolute inset-0 bg-black/10"})}):r.jsx("div",{className:"absolute inset-0 bg-black/30"}),p.special&&r.jsx("div",{className:"absolute inset-0 opacity-30 animate-pulse pointer-events-none",style:{background:"radial-gradient(circle at center, rgba(255,0,0,0.4) 0%, transparent 70%)"}}),!p.image&&r.jsx("span",{className:`material-symbols-outlined text-5xl text-white drop-shadow-lg relative z-10 ${p.special?"animate-[pulse_4s_ease-in-out_infinite] opacity-80":""}`,children:p.icon}),r.jsxs("div",{className:"absolute bottom-2 right-2 bg-black/60 backdrop-blur px-2 py-1 rounded text-xs font-mono text-white border border-white/10 z-20",children:[p.cost.toLocaleString()," DM"]})]}),r.jsxs("div",{className:"p-4 flex flex-col flex-1",children:[r.jsx("h4",{className:`text-base font-bold mb-2 truncate ${p.special?"text-red-400":"text-white"}`,children:p.name}),r.jsx("p",{className:"text-xs text-[#929bc9] mb-4 flex-1",children:p.description}),r.jsx("button",{onClick:()=>b(p),disabled:p.unavailable,className:`w-full py-2.5 rounded-lg font-bold uppercase tracking-wider text-xs transition-colors shadow-lg flex items-center justify-center gap-1 ${p.unavailable?"bg-gray-700 text-gray-400 cursor-not-allowed border border-white/5":"bg-yellow-600 hover:bg-yellow-500 text-white shadow-yellow-900/20"}`,children:p.unavailable?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"lock"}),"Niedostpne"]}):r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"payments"}),"Kup"]})})]})]},p.id))}),r.jsxs("div",{className:"bg-[#111422] rounded-xl p-6 border border-white/5 text-center",children:[r.jsx("h3",{className:"text-white font-bold mb-2",children:"Potrzebujesz wicej Antymaterii?"}),r.jsx("p",{className:"text-[#929bc9] text-sm mb-4",children:"Wysyaj ekspedycje w gbok przestrze, aby znale cenne zasoby Antymaterii!"})]})]})},mv=()=>{const{userId:l}=ca(),[s,n]=F.useState([]),[o,d]=F.useState(!0);return F.useEffect(()=>{(async()=>{try{const{data:f,error:b}=await ue.from("profiles").select("id, points, production_settings, planet_name, galaxy_coords, nickname, last_updated, level, xp").order("points",{ascending:!1}).limit(50);if(f&&!b){const g=f.map(p=>{var v,x;return{id:p.id,points:p.points||0,avatar_url:((v=p.production_settings)==null?void 0:v.avatarUrl)||He.avatar,planet_name:p.planet_name||"Nieznana Planeta",nickname:p.nickname||((x=p.production_settings)==null?void 0:x.nickname)||`Dowdca ${p.id.substring(0,6)}`,galaxy_coords:p.galaxy_coords,last_updated:p.last_updated,level:p.level||1,xp:p.xp||0}});n(g)}else b&&console.error("Error fetching ranking:",b)}catch(f){console.error("Ranking fetch error:",f)}d(!1)})()},[]),o?r.jsx("div",{className:"p-8 text-center text-[#929bc9]",children:"adowanie danych wywiadu..."}):s.length===0?r.jsxs("div",{className:"animate-in fade-in duration-500",children:[r.jsxs("h2",{className:"text-2xl font-bold mb-6 text-white tracking-widest uppercase border-b border-white/10 pb-4",children:[r.jsx("span",{className:"text-primary",children:"System"})," Rankingowy"]}),r.jsxs("div",{className:"bg-[#1c2136] rounded-xl border border-white/10 p-8 text-center",children:[r.jsx("span",{className:"material-symbols-outlined text-[#929bc9] text-5xl mb-4",children:"leaderboard"}),r.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Brak graczy w rankingu"}),r.jsx("p",{className:"text-[#929bc9]",children:"Ranking jest pusty. Rozwijaj swoj koloni, aby pojawi si na licie!"})]})]}):r.jsxs("div",{className:"animate-in fade-in duration-500",children:[r.jsxs("h2",{className:"text-2xl font-bold mb-6 text-white tracking-widest uppercase border-b border-white/10 pb-4",children:[r.jsx("span",{className:"text-primary",children:"System"})," Rankingowy",r.jsx("span",{className:"text-xs text-[#929bc9] normal-case ml-4 font-normal tracking-normal",children:"(Dane odwieane co ok. 60s)"})]}),r.jsx("div",{className:"bg-[#1c2136]/50 backdrop-blur-md rounded-2xl border border-white/5 overflow-hidden shadow-xl",children:r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full text-left border-collapse",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-[#111422]/80 text-[#929bc9] text-xs uppercase tracking-wider border-b border-white/5",children:[r.jsx("th",{className:"p-4 font-bold text-center w-16",children:"#"}),r.jsx("th",{className:"p-4 font-bold",children:"Dowdca"}),r.jsx("th",{className:"p-4 font-bold text-center",children:"Poziom"}),r.jsx("th",{className:"p-4 font-bold hidden md:table-cell",children:"Planeta"}),r.jsx("th",{className:"p-4 font-bold text-right",children:"Punkty"})]})}),r.jsx("tbody",{className:"divide-y divide-white/5",children:s.map((h,f)=>{const b=f===0?"text-yellow-400":f===1?"text-gray-300":f===2?"text-amber-600":"text-[#929bc9]",g=h.level||1,p=l===h.id,v=Date.now(),x=h.last_updated&&v-h.last_updated<300*1e3;return r.jsxs("tr",{className:`border-b border-white/5 hover:bg-white/5 transition-colors ${p?"bg-primary/10 border-primary/30":""}`,children:[r.jsxs("td",{className:`p-4 font-bold text-center w-16 ${b} relative`,children:[f===0&&r.jsx("span",{className:"material-symbols-outlined text-yellow-400 absolute top-2 left-1/2 -translate-x-1/2 -mt-1 text-sm animate-bounce",title:"Lider Galaktyki",children:"crown"}),r.jsx("span",{className:f===0?"relative top-1":"",children:f+1})]}),r.jsx("td",{className:"p-4",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"size-10 rounded-full border border-white/10 overflow-hidden bg-[#111422]",children:r.jsx("img",{src:h.avatar_url,alt:"Avatar",className:"w-full h-full object-cover",onError:_=>{_.currentTarget.src="/kosmo/avatars/avatar_default.png"}})}),r.jsx("div",{className:`absolute bottom-0 right-0 size-3 rounded-full border-2 border-[#1c2136] ${x?"bg-green-500 shadow-[0_0_8px_rgba(34,197,94,0.6)]":"bg-gray-500"}`,title:x?"Online":"Offline"})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsxs("span",{className:"font-bold text-white group-hover:text-primary transition-colors flex items-center gap-2",children:[f===0&&r.jsx("span",{className:"material-symbols-outlined text-yellow-400 text-sm animate-pulse",children:"check_circle"}),h.nickname]}),r.jsx("span",{className:"text-xs text-[#929bc9] md:hidden",children:h.planet_name})]})]})}),r.jsx("td",{className:"p-4 text-center font-mono text-green-400 font-bold",children:r.jsx("span",{title:`XP: ${(h.xp||0).toLocaleString()}`,className:"cursor-help border-b border-dashed border-white/20",children:g})}),r.jsx("td",{className:"p-4 text-[#929bc9] font-mono text-sm hidden md:table-cell",children:h.planet_name}),r.jsx("td",{className:"p-4 text-right font-bold font-mono text-white text-lg",children:h.points.toLocaleString()})]},h.id)})})]})})})]})},pv=()=>{const{planetName:l,renamePlanet:s,avatarUrl:n,updateAvatar:o,planetType:d,updatePlanetType:h,nickname:f,renameUser:b,resetGame:g,logout:p,deleteAccount:v,abandonColony:x,session:_,currentPlanetId:j,planets:C,mainPlanetName:z,mainPlanetCoords:M}=ca(),[E,O]=F.useState(f||""),[N,G]=F.useState(n||""),fe=(J,oe)=>{const ge=prompt("Podaj now nazw planety:",J);ge&&ge.trim()&&s(ge.trim(),oe)};return r.jsxs("div",{className:"flex flex-col gap-6 max-w-3xl mx-auto",children:[r.jsx("div",{className:"flex items-center justify-between border-b border-white/10 pb-4",children:r.jsxs("h2",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[r.jsx("span",{className:"material-symbols-outlined text-3xl text-[#929bc9]",children:"settings"}),"Opcje Gry"]})}),r.jsxs("div",{className:"bg-[#1c2136] p-6 rounded-xl border border-white/5 relative overflow-hidden",children:[r.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 opacity-30"}),r.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-primary",children:"badge"}),"Nazwa Dowdcy"]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("input",{type:"text",className:"flex-1 bg-[#111422] border border-white/10 rounded-lg px-4 py-3 text-white focus:border-primary focus:outline-none",placeholder:"Zmie nazw dowdcy",value:E,onChange:J=>O(J.target.value)}),r.jsx("button",{onClick:()=>b(E),className:"bg-primary hover:bg-blue-600 text-white px-6 py-3 rounded-lg font-bold transition-colors",children:"Zmie"})]})]}),r.jsxs("div",{className:"bg-[#1c2136] rounded-xl border border-white/10 p-6 shadow-lg",children:[r.jsxs("h3",{className:"text-xl font-bold text-white mb-6 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-blue-400",children:"public"}),"Wygld Planety"]}),r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[{name:"Ziemiopodobna",type:"terran"},{name:"Pustynna",type:"desert"},{name:"Lodowa",type:"ice"}].map(J=>r.jsxs("div",{className:"flex flex-col gap-2",children:[r.jsx("button",{onClick:()=>h(J.type),className:`relative w-full aspect-square rounded-xl overflow-hidden border-4 transition-all ${d===J.type?"border-green-500 shadow-[0_0_20px_rgba(34,197,94,0.4)] scale-95":"border-transparent hover:border-white/20 hover:scale-105"} `,children:r.jsx("img",{src:Er[J.type]||He.planet,alt:J.name,className:"w-full h-full object-cover"})}),r.jsx("span",{className:"text-xs text-center text-[#929bc9] font-medium",children:J.name})]},J.type))})]}),r.jsxs("div",{className:"bg-[#1c2136] rounded-xl border border-white/10 p-6 shadow-lg",children:[r.jsxs("h3",{className:"text-xl font-bold text-white mb-6 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-purple-400",children:"face"}),"Personalizacja Dowdcy"]}),r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[{name:"Pomocnik",url:"/kosmo/avatars/avatar_default.png"},{name:"Major (M)",url:"/kosmo/avatars/avatar_major.png"},{name:"Major (K)",url:"/kosmo/avatars/avatar_female.png"},{name:"Cyborg",url:"/kosmo/avatars/avatar_cyber.png"}].map(J=>r.jsxs("div",{className:"flex flex-col gap-2",children:[r.jsx("button",{onClick:()=>o(J.url),className:`relative w-full aspect-square rounded-xl overflow-hidden border-4 transition-all ${n===J.url?"border-green-500 shadow-[0_0_20px_rgba(34,197,94,0.4)] scale-95":"border-transparent hover:border-white/20 hover:scale-105"} `,children:r.jsx("img",{src:J.url,alt:J.name,className:"w-full h-full object-cover"})}),r.jsx("span",{className:"text-xs text-center text-[#929bc9] font-medium",children:J.name})]},J.name))})]}),r.jsxs("div",{className:"bg-[#1c2136] rounded-xl border border-white/10 p-6 shadow-lg overflow-hidden",children:[r.jsxs("h3",{className:"text-xl font-bold text-white mb-6 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-indigo-400",children:"language"}),"Zarzdzanie Imperium"]}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full text-left border-collapse",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b border-white/10 text-[#929bc9] text-xs uppercase tracking-wider",children:[r.jsx("th",{className:"p-3",children:"Nazwa"}),r.jsx("th",{className:"p-3",children:"Wsprzdne"}),r.jsx("th",{className:"p-3",children:"Typ"}),r.jsx("th",{className:"p-3 text-right",children:"Akcje"})]})}),r.jsxs("tbody",{className:"text-sm",children:[r.jsxs("tr",{className:"border-b border-white/5 bg-white/5 hover:bg-white/10 transition-colors",children:[r.jsxs("td",{className:"p-3 font-bold text-white flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-yellow-400 text-sm",children:"star"}),z||"Gwna Planeta"]}),r.jsxs("td",{className:"p-3 text-[#929bc9] font-mono",children:["[",(M==null?void 0:M.galaxy)||1,":",(M==null?void 0:M.system)||1,":",(M==null?void 0:M.position)||1,"]"]}),r.jsx("td",{className:"p-3 text-[#929bc9]",children:"Gwna"}),r.jsx("td",{className:"p-3 text-right",children:r.jsxs("div",{className:"flex items-center justify-end gap-2",children:[r.jsxs("button",{onClick:()=>fe(z||"Gwna Planeta","main"),className:"text-blue-400 hover:text-white bg-blue-500/10 hover:bg-blue-500/30 border border-blue-500/20 px-3 py-1.5 rounded text-xs font-bold uppercase transition-colors flex items-center gap-1",children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"}),"Zmie nazw"]}),r.jsx("span",{className:"text-white/20 italic text-xs px-2",children:"Nieusuwalna"})]})})]}),C.map(J=>{var oe,ge,we;return r.jsxs("tr",{className:"border-b border-white/5 hover:bg-white/[0.02] transition-colors",children:[r.jsxs("td",{className:"p-3 text-white font-medium pl-8 relative",children:[r.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-1.5 h-1.5 rounded-full bg-blue-500"}),J.planet_name||"Kolonia"]}),r.jsxs("td",{className:"p-3 text-[#929bc9] font-mono",children:["[",((oe=J.galaxy_coords)==null?void 0:oe.galaxy)||"?",":",((ge=J.galaxy_coords)==null?void 0:ge.system)||"?",":",((we=J.galaxy_coords)==null?void 0:we.position)||"?","]"]}),r.jsx("td",{className:"p-3 text-[#929bc9] capitalize",children:"Kolonia"}),r.jsx("td",{className:"p-3 text-right",children:r.jsxs("div",{className:"flex items-center justify-end gap-2",children:[r.jsxs("button",{onClick:()=>fe(J.planet_name||"Kolonia",J.id),className:"text-blue-400 hover:text-white bg-blue-500/10 hover:bg-blue-500/30 border border-blue-500/20 px-3 py-1.5 rounded text-xs font-bold uppercase transition-colors flex items-center gap-1",children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"}),"Zmie nazw"]}),r.jsxs("button",{onClick:async()=>{if(!confirm(` Czy na pewno chcesz porzuci koloni: ${J.planet_name||"Bez nazwy"} [${J.galaxy}:${J.system}:${J.position}]?`)||!confirm(" Wszystkie budynki, flota i surowce na tej planecie zostan UTRACONE. Czy na pewno kontynuowa?"))return;const je=prompt(" Aby potwierdzi usunicie kolonii, wpisz sowo: DELETE");je==="DELETE"?await x(J.id,je):je&&alert("Bdne haso potwierdzajce. Anulowano.")},className:"text-red-400 hover:text-red-200 bg-red-900/20 hover:bg-red-900/40 border border-red-900/30 px-3 py-1.5 rounded text-xs font-bold uppercase transition-colors flex items-center gap-1",children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"}),"Usu"]})]})})]},J.id)}),C.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:4,className:"p-8 text-center text-[#555a7a] italic",children:"Nie posiadasz jeszcze adnych kolonii."})})]})]})}),r.jsx("p",{className:"text-xs text-[#555a7a] mt-4 text-center",children:"Gwna planeta nie moe zosta usunita. Kolonie mona porzuci, co jest procesem nieodwracalnym."})]}),r.jsxs("div",{className:"bg-[#1c2136] rounded-xl border border-red-500/20 p-6 shadow-lg",children:[r.jsxs("h3",{className:"text-xl font-bold text-red-400 mb-4 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined",children:"warning"}),"Strefa Niebezpieczna"]}),r.jsx("p",{className:"text-[#929bc9] text-sm mb-6",children:"Te operacje s nieodwracalne. Zresetowanie gry spowoduje utrat wszystkich postpw, budynkw, floty i surowcw."}),r.jsxs("div",{className:"flex flex-col gap-4",children:[r.jsx("button",{onClick:()=>{confirm("Czy na pewno chcesz si wylogowa?")&&p()},className:"bg-yellow-500/10 hover:bg-yellow-500 text-yellow-400 hover:text-white border border-yellow-500/20 px-6 py-3 rounded-lg font-bold uppercase tracking-wider transition-all",children:"Wyloguj si"}),r.jsxs("button",{onClick:v,className:"bg-red-900/50 hover:bg-red-700 text-white border border-red-500/50 px-6 py-3 rounded-lg font-bold uppercase tracking-wider transition-all flex items-center justify-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined",children:"delete_forever"}),"Usu Konto Trwale"]}),r.jsx("p",{className:"text-xs text-red-400 text-center mt-2",children:"Uwaga: Usunicie konta trwale wykasuje Twj profil i misje z bazy danych. Tej akcji nie da si cofn!"})]})]})]})},cp=Object.values(Qa),gv=()=>{const{resources:l,buildings:s,buildDefense:n,defenses:o,shipyardQueue:d}=ca(),h=(s==null?void 0:s.shipyard)||0,[f,b]=F.useState({}),g=(x,_)=>{const j=parseInt(_,10);!isNaN(j)&&j>=0?b(C=>({...C,[x]:j})):_===""&&b(C=>({...C,[x]:0}))},p=x=>{if(x<60)return`${x}s`;const _=Math.floor(x/60),j=Math.floor(x%60);return`${_}m ${j}s`},v=d.filter(x=>x.type==="defense");return r.jsxs("div",{className:"animate-in fade-in duration-500",children:[r.jsxs("h2",{className:"text-2xl font-bold mb-6 text-white tracking-widest uppercase border-b border-white/10 pb-4",children:[r.jsx("span",{className:"text-primary",children:"System"})," Obrony Planetarnej"]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:(()=>{let x=0,_=0,j=0;return cp.forEach(C=>{const z=o[C.id]||0;z>0&&(x+=z,_+=z*C.attack,j+=z*C.defense)}),r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"bg-[#1c2136] p-4 rounded-xl border border-white/10 flex items-center gap-4 shadow-lg",children:[r.jsx("div",{className:"size-12 rounded-lg bg-blue-500/20 text-blue-400 flex items-center justify-center",children:r.jsx("span",{className:"material-symbols-outlined text-2xl",children:"shield"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[#929bc9] text-xs uppercase font-bold",children:"Jednostki Obronne"}),r.jsx("div",{className:"text-white text-2xl font-mono font-bold",children:x})]})]}),r.jsxs("div",{className:"bg-[#1c2136] p-4 rounded-xl border border-white/10 flex items-center gap-4 shadow-lg",children:[r.jsx("div",{className:"size-12 rounded-lg bg-red-500/20 text-red-400 flex items-center justify-center",children:r.jsx("span",{className:"material-symbols-outlined text-2xl",children:"swords"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[#929bc9] text-xs uppercase font-bold",children:"Sia Ognia"}),r.jsx("div",{className:"text-white text-2xl font-mono font-bold",children:_.toLocaleString()})]})]}),r.jsxs("div",{className:"bg-[#1c2136] p-4 rounded-xl border border-white/10 flex items-center gap-4 shadow-lg",children:[r.jsx("div",{className:"size-12 rounded-lg bg-green-500/20 text-green-400 flex items-center justify-center",children:r.jsx("span",{className:"material-symbols-outlined text-2xl",children:"security"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[#929bc9] text-xs uppercase font-bold",children:"Wytrzymao Tarcz"}),r.jsx("div",{className:"text-white text-2xl font-mono font-bold",children:j.toLocaleString()})]})]})]})})()}),h<1?r.jsxs("div",{className:"bg-[#1c2136] rounded-xl border border-yellow-500/30 p-8 text-center",children:[r.jsx("span",{className:"material-symbols-outlined text-yellow-500 text-5xl mb-4",children:"construction"}),r.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Wymagana Stocznia"}),r.jsx("p",{className:"text-[#929bc9]",children:"Zbuduj Stoczni (poziom 1), aby odblokowa systemy obronne."})]}):r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[r.jsx("div",{className:"lg:col-span-3 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:cp.map(x=>{l.metal>=x.cost.metal&&l.crystal>=x.cost.crystal&&l.deuterium>=x.cost.deuterium;const _=o[x.id]||0,j=Math.floor(x.buildTime*1e3/(h+1)/100/1e3);return r.jsxs("div",{className:"bg-[#1c2136] rounded-xl border border-white/5 p-4 hover:border-primary/30 transition-all group relative overflow-hidden",children:[r.jsxs("div",{className:"absolute top-2 right-2 bg-[#111422]/80 backdrop-blur-sm border border-white/10 px-2 py-1 rounded text-xs text-white font-mono z-10",children:["Ilo: ",r.jsx("span",{className:"text-primary font-bold",children:_})]}),r.jsxs("div",{className:"flex items-start gap-4",children:[r.jsx("div",{className:"size-16 rounded-xl bg-[#111422] flex items-center justify-center border border-white/10 group-hover:border-primary/50 transition-colors shrink-0",children:r.jsx("span",{className:"material-symbols-outlined text-primary text-3xl",children:x.icon})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("h3",{className:"text-white font-bold mb-1 truncate",children:x.name}),r.jsx("p",{className:"text-[#929bc9] text-[10px] mb-2 leading-tight h-8 overflow-hidden",children:x.desc}),r.jsxs("div",{className:"flex gap-2 text-[10px] mb-2",children:[r.jsxs("div",{className:"flex items-center gap-1 bg-red-500/10 px-1.5 py-0.5 rounded text-red-400",children:[r.jsx("span",{className:"material-symbols-outlined text-[10px]",children:"swords"}),r.jsx("span",{children:x.attack})]}),r.jsxs("div",{className:"flex items-center gap-1 bg-blue-500/10 px-1.5 py-0.5 rounded text-blue-400",children:[r.jsx("span",{className:"material-symbols-outlined text-[10px]",children:"shield"}),r.jsx("span",{children:x.defense})]}),r.jsxs("div",{className:"flex items-center gap-1 bg-gray-500/10 px-1.5 py-0.5 rounded text-gray-400",children:[r.jsx("span",{className:"material-symbols-outlined text-[10px]",children:"timer"}),r.jsx("span",{children:p(j)})]})]}),x.bonuses&&Object.keys(x.bonuses).length>0&&r.jsxs("div",{className:"mb-2 text-[10px] text-[#929bc9]",children:[r.jsx("span",{className:"font-bold text-white uppercase block mb-1 text-[9px]",children:"Silny przeciwko:"}),r.jsx("div",{className:"flex flex-wrap gap-1",children:Object.keys(x.bonuses).map(C=>{var z,M;return r.jsx("span",{className:"bg-primary/10 text-primary border border-primary/20 px-1.5 py-0.5 rounded flex items-center gap-1",children:((z=st[C])==null?void 0:z.name)||((M=Qa[C])==null?void 0:M.name)||C},C)})})]}),r.jsxs("div",{className:"flex flex-wrap gap-1 text-[10px] mb-3",children:[r.jsxs("span",{className:`px-1.5 py-0.5 rounded ${l.metal>=x.cost.metal?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:["M: ",x.cost.metal.toLocaleString()]}),r.jsxs("span",{className:`px-1.5 py-0.5 rounded ${l.crystal>=x.cost.crystal?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:["C: ",x.cost.crystal.toLocaleString()]}),x.cost.deuterium>0&&r.jsxs("span",{className:`px-1.5 py-0.5 rounded ${l.deuterium>=x.cost.deuterium?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:["D: ",x.cost.deuterium.toLocaleString()]})]}),(()=>{const C=f[x.id]||0,z={metal:x.cost.metal*(C||1),crystal:x.cost.crystal*(C||1),deuterium:x.cost.deuterium*(C||1)},M=l.metal>=z.metal&&l.crystal>=z.crystal&&l.deuterium>=z.deuterium;return r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsxs("div",{className:"flex items-center bg-[#111422] rounded border border-white/10 overflow-hidden",children:[r.jsx("button",{onClick:()=>g(x.id,Math.max(0,C-1).toString()),className:"w-7 h-7 flex items-center justify-center text-[#929bc9] hover:text-white hover:bg-white/5",children:r.jsx("span",{className:"material-symbols-outlined text-xs",children:"remove"})}),r.jsx("input",{type:"number",min:"0",placeholder:"0",value:f[x.id]>0?f[x.id]:"",onChange:E=>g(x.id,E.target.value),onFocus:E=>E.target.select(),className:"w-10 bg-transparent text-white text-xs text-center focus:outline-none font-mono font-bold"}),r.jsx("button",{onClick:()=>g(x.id,(C+1).toString()),className:"w-7 h-7 flex items-center justify-center text-[#929bc9] hover:text-white hover:bg-white/5",children:r.jsx("span",{className:"material-symbols-outlined text-xs",children:"add"})})]}),r.jsx("button",{onClick:()=>{const E=Math.floor(l.metal/x.cost.metal),O=x.cost.crystal>0?Math.floor(l.crystal/x.cost.crystal):1/0,N=x.cost.deuterium>0?Math.floor(l.deuterium/x.cost.deuterium):1/0,G=Math.min(E,O,N);g(x.id,G.toString())},className:"h-7 px-2 rounded bg-[#232948] text-[#929bc9] text-[10px] font-bold uppercase border border-white/5 hover:bg-primary/20 hover:text-primary",children:"Max"}),r.jsxs("button",{onClick:()=>{C>0&&(n(x.id,C),b(E=>({...E,[x.id]:0})))},disabled:C<=0||!M,className:`flex-1 h-7 rounded font-bold text-[10px] uppercase transition-all flex items-center justify-center gap-1 ${C>0&&M?"bg-primary hover:bg-blue-600 text-white":"bg-[#111422] text-[#555a7a] cursor-not-allowed"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-xs",children:"build"}),"Buduj"]})]})})()]})]})]},x.id)})}),r.jsxs("div",{className:"lg:col-span-1 space-y-4",children:[r.jsxs("div",{className:"bg-[#1c2136] rounded-xl border border-white/5 p-4 flex flex-col h-fit",children:[r.jsxs("h3",{className:"text-white font-bold mb-3 flex items-center gap-2 text-sm uppercase tracking-wider",children:[r.jsx("span",{className:"material-symbols-outlined text-yellow-500 text-sm",children:"pending_actions"}),"Kolejka Budowy (",v.length,")"]}),v.length===0?r.jsx("div",{className:"text-[#555a7a] text-xs text-center py-4 italic",children:"Brak zada w kolejce."}):r.jsx("div",{className:"space-y-2 max-h-[300px] overflow-y-auto pr-1 scrollbar-thin scrollbar-thumb-white/10 scrollbar-track-transparent",children:v.map((x,_)=>{const j=Qa[x.itemId];return j?r.jsxs("div",{className:"bg-[#111422] p-2 rounded border border-white/5 flex items-center gap-2 relative overflow-hidden",children:[_===0&&r.jsx("div",{className:"absolute bottom-0 left-0 h-0.5 bg-green-500 animate-pulse w-full"}),r.jsx("div",{className:"size-8 rounded bg-[#1c2136] flex items-center justify-center text-primary",children:r.jsx("span",{className:"material-symbols-outlined text-sm",children:(j==null?void 0:j.icon)||"help"})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"text-white text-xs font-bold truncate",children:(j==null?void 0:j.name)||x.itemId}),r.jsxs("span",{className:"text-xs text-yellow-500",children:["x",x.quantity]})]}),r.jsx("div",{className:"text-[10px] text-[#555a7a]",children:_===0?"W trakcie...":"Oczekuje"})]})]},x.id):null})})]}),r.jsxs("div",{className:"bg-[#1c2136]/50 rounded-xl border border-white/5 p-4",children:[r.jsxs("h3",{className:"text-sm font-bold text-white mb-2 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-blue-400 text-sm",children:"info"}),"Info"]}),r.jsxs("ul",{className:"text-[#929bc9] text-[11px] space-y-1.5 list-disc pl-3",children:[r.jsxs("li",{children:[r.jsx("strong",{children:"Obrona"})," jest kluczowa, by chroni surowce przed grabie."]}),r.jsxs("li",{children:["Zniszczone jednostki maj ",r.jsx("strong",{children:"70% szans"})," na napraw."]}),r.jsxs("li",{children:["Czas budowy zaley od poziomu ",r.jsx("strong",{children:"Stoczni"}),"."]}),r.jsx("li",{children:"Obrona nie zuywa deuteru do utrzymania."})]})]})]})]})]})},bv=()=>{const{userId:l,nickname:s}=ca(),[n,o]=F.useState([]),[d,h]=F.useState(!0),[f,b]=F.useState(!1),[g,p]=F.useState(""),[v,x]=F.useState("");return F.useEffect(()=>{o([{id:"1",name:"Kosmiczni owcy",tag:"K",leader_id:"demo",member_count:12,total_points:45e3,description:"Elite hunters of the galaxy",created_at:new Date().toISOString()},{id:"2",name:"Gwiezdna Flota",tag:"GF",leader_id:"demo2",member_count:8,total_points:32e3,description:"United we stand",created_at:new Date().toISOString()},{id:"3",name:"Ciemna Materia",tag:"CM",leader_id:"demo3",member_count:15,total_points:67e3,description:"Power beyond measure",created_at:new Date().toISOString()}]),h(!1)},[]),d?r.jsx("div",{className:"p-8 text-center text-[#929bc9]",children:"adowanie klanw..."}):r.jsxs("div",{className:"animate-in fade-in duration-500",children:[r.jsxs("div",{className:"flex items-center justify-between border-b border-white/10 pb-4 mb-6",children:[r.jsxs("h2",{className:"text-2xl font-bold text-white tracking-widest uppercase",children:[r.jsx("span",{className:"text-primary",children:"System"})," Klanw"]}),r.jsxs("button",{onClick:()=>b(!f),className:"bg-primary hover:bg-blue-600 text-white px-4 py-2 rounded-lg font-bold transition-colors flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined",children:"add"}),"Stwrz Klan"]})]}),f&&r.jsxs("div",{className:"bg-[#1c2136] rounded-xl border border-primary/30 p-6 mb-6 animate-in slide-in-from-top duration-200",children:[r.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-primary",children:"groups"}),"Nowy Klan"]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-sm text-[#929bc9] font-bold uppercase block mb-2",children:"Nazwa Klanu"}),r.jsx("input",{type:"text",value:g,onChange:_=>p(_.target.value),className:"w-full bg-[#111422] border border-white/10 rounded-lg px-4 py-3 text-white focus:border-primary outline-none",placeholder:"np. Kosmiczni Wojownicy",maxLength:24})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm text-[#929bc9] font-bold uppercase block mb-2",children:"Tag (2-4 znaki)"}),r.jsx("input",{type:"text",value:v,onChange:_=>x(_.target.value.toUpperCase()),className:"w-full bg-[#111422] border border-white/10 rounded-lg px-4 py-3 text-white focus:border-primary outline-none uppercase",placeholder:"np. KW",maxLength:4})]})]}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{className:"flex-1 bg-primary hover:bg-blue-600 text-white py-3 rounded-lg font-bold transition-colors",children:"Za Klan (Koszt: 1000 Ciemnej Materii)"}),r.jsx("button",{onClick:()=>b(!1),className:"px-6 py-3 bg-[#111422] text-[#929bc9] rounded-lg hover:text-white transition-colors",children:"Anuluj"})]})]}),r.jsx("div",{className:"grid grid-cols-1 gap-4",children:n.sort((_,j)=>j.total_points-_.total_points).map((_,j)=>r.jsx("div",{className:"bg-[#1c2136] rounded-xl border border-white/5 p-5 hover:border-primary/30 transition-all group",children:r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:`size-12 rounded-xl flex items-center justify-center font-bold text-lg ${j===0?"bg-yellow-500/20 text-yellow-400 border border-yellow-500/30":j===1?"bg-gray-400/20 text-gray-300 border border-gray-400/30":j===2?"bg-amber-600/20 text-amber-500 border border-amber-600/30":"bg-[#111422] text-[#929bc9] border border-white/10"}`,children:j<3?["","",""][j]:j+1}),r.jsx("div",{className:"size-12 rounded-xl bg-primary/20 border border-primary/30 flex items-center justify-center",children:r.jsxs("span",{className:"text-primary font-bold text-sm",children:["[",_.tag,"]"]})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("h3",{className:"text-white font-bold group-hover:text-primary transition-colors",children:_.name}),r.jsx("p",{className:"text-[#929bc9] text-xs",children:_.description||"Brak opisu"})]}),r.jsxs("div",{className:"hidden md:flex items-center gap-6 text-sm",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-[#929bc9] text-xs uppercase",children:"Czonkowie"}),r.jsx("div",{className:"text-white font-bold",children:_.member_count})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-[#929bc9] text-xs uppercase",children:"Punkty"}),r.jsx("div",{className:"text-white font-bold font-mono",children:_.total_points.toLocaleString()})]})]}),r.jsx("button",{className:"bg-[#111422] hover:bg-primary text-[#929bc9] hover:text-white px-4 py-2 rounded-lg font-bold text-sm transition-all border border-white/10 hover:border-primary",children:"Docz"})]})},_.id))}),r.jsxs("div",{className:"mt-8 bg-[#1c2136]/50 rounded-xl border border-white/5 p-6",children:[r.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-yellow-500",children:"info"}),"System Klanw"]}),r.jsxs("ul",{className:"text-[#929bc9] text-sm space-y-2",children:[r.jsx("li",{children:" Klany cz graczy w potne sojusze kosmiczne."}),r.jsx("li",{children:" Czonkowie klanu mog dzieli si zasobami i wsplnie atakowa wrogie planety."}),r.jsx("li",{children:" Zaoenie klanu wymaga 1000 Ciemnej Materii."}),r.jsx("li",{children:" Ranking klanw opiera si na sumie punktw wszystkich czonkw."})]})]})]})},xv=()=>{var Re,Ke,Pe,ye;const{session:l}=ca(),[s,n]=F.useState([]),[o,d]=F.useState([]),[h,f]=F.useState(!1),[b,g]=F.useState(""),[p,v]=F.useState(!1),[x,_]=F.useState(new Set),j=S=>{const Q=new Set(x);Q.has(S)?Q.delete(S):Q.add(S),_(Q)},C=async()=>{f(!0);const{data:S,error:Q}=await ue.from("profiles").select("*").order("last_updated",{ascending:!1}),{data:ie,error:pe}=await ue.from("planets").select("*");if(Q)console.error("Admin fetch error",Q),g(`Bd pobierania: ${Q.message}`);else{const Ae=ie||[],k=(S==null?void 0:S.map(Z=>({...Z,colonies:Ae.filter(me=>me.owner_id===Z.id)})))||[];n(k)}f(!1)},z=async()=>{const{data:S,error:Q}=await ue.from("error_logs").select("*").order("created_at",{ascending:!1}).limit(100);Q||d(S||[])};F.useEffect(()=>{C(),z()},[]);const M=async(S,Q)=>{var Ne;if(!confirm(`CZY NA PEWNO CHCESZ USUN GRACZA ${Q||S}?
Tej operacji nie mona cofn!`))return;f(!0);const{count:ie,error:pe}=await ue.from("missions").select("*",{count:"exact",head:!0}).eq("owner_id",S);console.log(`[DEBUG] Found ${ie} missions (Error: ${pe==null?void 0:pe.message})`);const Ae=await ue.from("missions").delete().eq("owner_id",S).select(),k=await ue.from("missions").delete().eq("target_user_id",S).select();console.log(`[DEBUG] Deleted ${Ae.count} outgoing, ${k.count} incoming.`);const Z=await ue.from("profiles").delete().eq("id",S).select(),me=Z.error,be=Z.count;if(me)if(console.error("Profile Delete error:",me),(Ne=me.message)!=null&&Ne.includes("foreign key constraint")||me.code==="23503"){const Be=`
ALTER TABLE missions
DROP CONSTRAINT missions_owner_id_fkey,
ADD CONSTRAINT missions_owner_id_fkey
FOREIGN KEY (owner_id)
REFERENCES profiles(id)
ON DELETE CASCADE;
`;alert(`BLOKADA BAZY DANYCH (Foreign Key):
Nie mona usun gracza, bo trzymaj go misje (ktrych admin nie widzi przez RLS).

NAJLEPSZE ROZWIZANIE:
Wklej ten SQL w Supabase, aby misje usuway si SAME automatycznie:

${Be}`),console.log("SQL TO FIX:",Be)}else alert(`Bd usuwania (DB Error): ${me.message} (Code: ${me.code})`);else be===0?alert(`BD: Nie usunito wiersza (Count: 0).
Zablokowane przez RLS tabeli 'profiles'.
Potrzebna polityka: CREATE POLICY "Admin All Access" ...`):(g(`Uytkownik ${Q||"Nieznany"} (ID: ${S}) zosta pomylnie usunity.`),C());f(!1)},E=["admin@kosmo.pl","dareg@kosmo.pl","admin@kosmo.com"],O=(Re=l==null?void 0:l.user)==null?void 0:Re.email;if(!O||!E.includes(O))return r.jsxs("div",{className:"p-8 text-center text-red-500",children:[r.jsx("h2",{className:"text-2xl font-bold",children:" Brak Uprawnie"}),r.jsx("p",{children:"Tylko administratorzy maj dostp do tego panelu."})]});const[N,G]=F.useState(null),[fe,J]=F.useState(""),[oe,ge]=F.useState("colonyShip"),[we,je]=F.useState(1),Ue=async()=>{if(!fe){alert("Wybierz gracza z listy!");return}const S=s.find(k=>k.id===fe);if(!S)return;console.log(" Nadawanie statku dla:",S.nickname||S.id);const Q=S.ships||{},ie={...Q,[oe]:(Q[oe]||0)+we};console.log(" Aktualizacja:",{currentShips:Q,newShips:ie,targetId:S.id});const{data:pe,error:Ae}=await ue.from("profiles").update({ships:ie}).eq("id",S.id).select();console.log(" Wynik aktualizacji:",{updateResult:pe,updateError:Ae}),Ae?alert(`Bd aktualizacji: ${Ae.message}

Moe brakowa RLS policy pozwalajcej adminowi edytowa inne profile.`):!pe||pe.length===0?alert(` Update nie zmieni adnych rekordw!

Prawdopodobnie RLS blokuje edycj innych graczy.

Dodaj w Supabase SQL:
CREATE POLICY "admin_all_access" ON profiles FOR ALL USING (auth.jwt() ->> 'email' IN ('admin@kosmo.pl', 'dareg@kosmo.pl'));`):(alert(` Dodano ${we}x ${oe} graczowi ${S.nickname||"ID:"+S.id}`),je(1),await C())};return r.jsxs("div",{className:"p-4 md:p-8 text-gray-100 max-w-6xl mx-auto pb-24",children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsx("h1",{className:"text-3xl font-bold text-red-500 flex items-center gap-2",children:" PANEL ADMINISTRATORA"}),r.jsx("button",{onClick:C,className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded transition-colors",children:h?"Odwieanie...":"Odwie"})]}),b&&r.jsx("div",{className:"mb-4 p-3 bg-green-900 border border-green-700 rounded text-green-200",children:b}),r.jsxs("div",{className:"mb-6 p-4 bg-gray-800 border border-gray-700 rounded-lg",children:[r.jsx("h3",{className:"text-lg font-bold text-yellow-500 mb-4",children:" Dodaj Statek Graczowi"}),r.jsxs("div",{className:"flex flex-wrap gap-3 items-end",children:[r.jsxs("div",{className:"flex flex-col flex-1 min-w-[200px]",children:[r.jsx("label",{className:"text-xs text-gray-400 mb-1",children:"Gracz"}),r.jsxs("select",{value:fe,onChange:S=>J(S.target.value),className:"px-3 py-2 bg-gray-900 border border-gray-600 rounded text-white focus:border-yellow-500 focus:outline-none w-full",children:[r.jsx("option",{value:"",children:"-- Wybierz Gracza --"}),s.map(S=>r.jsxs("option",{value:S.id,children:[S.nickname," ",S.galaxy_coords?`[${S.galaxy_coords.galaxy}:${S.galaxy_coords.system}:${S.galaxy_coords.position}]`:"[-]"," (ID: ",S.id.slice(0,4),"...)"]},S.id))]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("label",{className:"text-xs text-gray-400 mb-1",children:"Typ Statku"}),r.jsxs("select",{value:oe,onChange:S=>ge(S.target.value),className:"px-3 py-2 bg-gray-900 border border-gray-600 rounded text-white focus:border-yellow-500 focus:outline-none",children:[r.jsx("option",{value:"colonyShip",children:"Statek Kolonizacyjny"}),r.jsx("option",{value:"lightFighter",children:"Myliwiec Lekki"}),r.jsx("option",{value:"heavyFighter",children:"Myliwiec Ciki"}),r.jsx("option",{value:"cruiser",children:"Krownik"}),r.jsx("option",{value:"battleship",children:"Okrt Wojenny"}),r.jsx("option",{value:"destroyer",children:"Niszczyciel"}),r.jsx("option",{value:"deathStar",children:"Pogromca Planet"}),r.jsx("option",{value:"smallCargo",children:"May Transporter"}),r.jsx("option",{value:"mediumCargo",children:"redni Transporter"}),r.jsx("option",{value:"hugeCargo",children:"Ogromny Transporter"}),r.jsx("option",{value:"espionageProbe",children:"Sonda Szpiegowska"}),r.jsx("option",{value:"pioneer",children:"Pionier"})]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("label",{className:"text-xs text-gray-400 mb-1",children:"Ilo"}),r.jsx("input",{type:"number",value:we,onChange:S=>je(Math.max(1,parseInt(S.target.value)||1)),min:1,className:"w-20 px-3 py-2 bg-gray-900 border border-gray-600 rounded text-white focus:border-yellow-500 focus:outline-none"})]}),r.jsx("button",{onClick:Ue,className:"px-4 py-2 bg-yellow-600 hover:bg-yellow-500 text-black font-bold rounded transition-colors",children:"Dodaj"})]})]}),r.jsxs("div",{className:"mb-6 p-4 bg-red-900/20 border border-red-700/50 rounded-lg",children:[r.jsxs("div",{className:"flex justify-between items-center cursor-pointer",onClick:()=>v(!p),children:[r.jsxs("h3",{className:"text-lg font-bold text-red-400 flex items-center gap-2",children:[" Bdy Uytkownikw",r.jsx("span",{className:"text-xs bg-red-600 px-2 py-0.5 rounded",children:o.length})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("button",{onClick:S=>{S.stopPropagation(),z()},className:"text-xs bg-red-600/30 hover:bg-red-600 px-2 py-1 rounded transition-colors",children:"Odwie"}),r.jsx("span",{className:"text-red-400",children:p?"":""})]})]}),p&&r.jsx("div",{className:"mt-4 max-h-[400px] overflow-y-auto",children:o.length===0?r.jsx("p",{className:"text-gray-500 text-sm",children:"Brak zgoszonych bdw. Upewnij si, e tabela error_logs istnieje w Supabase."}):r.jsx("div",{className:"space-y-2",children:o.map((S,Q)=>{var ie;return r.jsxs("div",{className:"bg-black/30 p-3 rounded border border-red-500/20 text-xs",children:[r.jsxs("div",{className:"flex justify-between items-start mb-1",children:[r.jsx("span",{className:`font-bold ${S.error_type==="error"?"text-red-400":"text-yellow-400"}`,children:S.error_type==="error"?" ERROR":" WARNING"}),r.jsx("span",{className:"text-gray-500",children:new Date(S.created_at).toLocaleString("pl-PL")})]}),r.jsx("p",{className:"text-white mb-1",children:S.message}),S.context&&r.jsxs("p",{className:"text-gray-400 text-[10px]",children:[" ",S.context]}),S.user_id&&r.jsxs("p",{className:"text-gray-600 text-[10px] font-mono mt-1",children:["User: ",S.user_id.slice(0,8),"... | ",(ie=S.user_agent)==null?void 0:ie.slice(0,50),"..."]}),S.stack&&r.jsxs("details",{className:"mt-2",children:[r.jsx("summary",{className:"text-gray-500 cursor-pointer hover:text-gray-300",children:"Stack trace"}),r.jsx("pre",{className:"text-[9px] text-gray-600 mt-1 whitespace-pre-wrap",children:S.stack})]})]},Q)})})})]}),r.jsx("div",{className:"overflow-x-auto bg-gray-900/80 rounded-lg border border-gray-700",children:r.jsxs("table",{className:"w-full text-left border-collapse",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-800 text-gray-400 uppercase text-xs",children:[r.jsx("th",{className:"p-4 border-b border-gray-700",children:"Nick"}),r.jsx("th",{className:"p-4 border-b border-gray-700",children:"Punkty"}),r.jsx("th",{className:"p-4 border-b border-gray-700",children:"Koordynaty"}),r.jsx("th",{className:"p-4 border-b border-gray-700",children:"Ostatnia Akt."}),r.jsx("th",{className:"p-4 border-b border-gray-700 text-right",children:"Akcje"})]})}),r.jsxs("tbody",{children:[s.map(S=>{var Q,ie;return r.jsxs(_i.Fragment,{children:[r.jsxs("tr",{className:`hover:bg-gray-800/50 transition-colors border-b border-gray-800 ${x.has(S.id)?"bg-gray-800/30":""}`,children:[r.jsx("td",{className:"p-4",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("button",{onClick:()=>j(S.id),className:`text-gray-400 hover:text-white transition-colors w-6 h-6 flex items-center justify-center rounded border border-gray-700 ${x.has(S.id)?"bg-blue-600 border-blue-500 text-white":""}`,children:x.has(S.id)?"":""}),r.jsxs("div",{children:[r.jsx("div",{className:"font-bold text-blue-300",children:S.nickname||"Nieznany"}),r.jsx("div",{className:"text-xs text-gray-500",children:S.planet_name}),r.jsx("div",{className:"text-[10px] text-gray-600 font-mono",children:S.id})]})]})}),r.jsx("td",{className:"p-4 font-mono text-yellow-400",children:(S.points||0).toLocaleString()}),r.jsx("td",{className:"p-4 font-mono text-gray-300",children:S.galaxy_coords?`[${S.galaxy_coords.galaxy}:${S.galaxy_coords.system}:${S.galaxy_coords.position}]`:"BRAK"}),r.jsxs("td",{className:"p-4 text-sm text-gray-500",children:[S.last_updated?new Date(S.last_updated).toLocaleString():"-",r.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Kolonie: ",((Q=S.colonies)==null?void 0:Q.length)||0]})]}),r.jsxs("td",{className:"p-4 text-right space-x-2",children:[r.jsx("button",{onClick:()=>G(S),className:"bg-blue-600/20 hover:bg-blue-600 text-blue-500 hover:text-white px-3 py-1 rounded transition-colors font-bold text-xs",children:"INFO"}),r.jsx("button",{onClick:()=>M(S.id,S.nickname),className:"bg-red-600/20 hover:bg-red-600 text-red-500 hover:text-white px-3 py-1 rounded transition-colors font-bold text-xs",title:"Usu Gracza i Planet",children:"USU"})]})]}),x.has(S.id)&&r.jsx("tr",{className:"bg-black/20 animate-in fade-in zoom-in-95 duration-200",children:r.jsx("td",{colSpan:5,className:"p-0",children:r.jsxs("div",{className:"p-4 pl-14 bg-black/40 border-b border-gray-800 shadow-inner",children:[r.jsxs("h4",{className:"text-xs font-bold text-gray-500 uppercase mb-3 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-sm",children:"public"}),"Kolonie gracza (",((ie=S.colonies)==null?void 0:ie.length)||0,")"]}),!S.colonies||S.colonies.length===0?r.jsx("div",{className:"text-gray-600 text-sm italic",children:"Brak kolonii"}):r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:S.colonies.map(pe=>{var Ae,k,Z;return r.jsxs("div",{className:"bg-[#111422] p-3 rounded border border-white/5 hover:border-blue-500/30 transition-colors",children:[r.jsxs("div",{className:"flex justify-between items-start mb-2",children:[r.jsx("span",{className:"font-bold text-white text-sm",children:pe.planet_name||"Bez nazwy"}),r.jsxs("span",{className:"font-mono text-xs text-blue-400 bg-blue-900/20 px-1.5 py-0.5 rounded",children:["[",pe.galaxy,":",pe.system,":",pe.position,"]"]})]}),r.jsx("div",{className:"text-[10px] text-gray-500 font-mono mb-2",children:pe.id}),r.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-yellow-600",children:"M:"})," ",Math.floor(((Ae=pe.resources)==null?void 0:Ae.metal)||0)]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-blue-600",children:"K:"})," ",Math.floor(((k=pe.resources)==null?void 0:k.crystal)||0)]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-green-600",children:"D:"})," ",Math.floor(((Z=pe.resources)==null?void 0:Z.deuterium)||0)]})]})]},pe.id)})})]})})})]},S.id)}),s.length===0&&!h&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"p-8 text-center text-gray-500",children:"Brak uytkownikw"})})]})]})}),N&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4",children:r.jsxs("div",{className:"bg-[#1c2136] border border-blue-500/30 rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto flex flex-col",children:[r.jsxs("div",{className:"p-4 border-b border-white/10 flex justify-between items-center bg-[#111422]",children:[r.jsxs("h2",{className:"text-xl font-bold text-blue-400",children:["Szczegy: ",N.nickname]}),r.jsx("button",{onClick:()=>G(null),className:"text-gray-400 hover:text-white text-2xl",children:""})]}),r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{className:"bg-[#111422] p-3 rounded border border-white/5",children:[r.jsx("div",{className:"text-xs text-gray-500 uppercase",children:"Metal"}),r.jsx("div",{className:"text-yellow-400 font-mono",children:Math.floor(((Ke=N.resources)==null?void 0:Ke.metal)||0).toLocaleString()})]}),r.jsxs("div",{className:"bg-[#111422] p-3 rounded border border-white/5",children:[r.jsx("div",{className:"text-xs text-gray-500 uppercase",children:"Kryszta"}),r.jsx("div",{className:"text-blue-400 font-mono",children:Math.floor(((Pe=N.resources)==null?void 0:Pe.crystal)||0).toLocaleString()})]}),r.jsxs("div",{className:"bg-[#111422] p-3 rounded border border-white/5",children:[r.jsx("div",{className:"text-xs text-gray-500 uppercase",children:"Deuter"}),r.jsx("div",{className:"text-green-400 font-mono",children:Math.floor(((ye=N.resources)==null?void 0:ye.deuterium)||0).toLocaleString()})]})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-bold text-gray-400 mb-2 uppercase border-b border-white/10 pb-1",children:"Budynki"}),r.jsx("pre",{className:"text-xs font-mono bg-black/30 p-2 rounded text-gray-300 overflow-x-auto",children:JSON.stringify(N.buildings,null,2)})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-bold text-gray-400 mb-2 uppercase border-b border-white/10 pb-1",children:"Flota"}),r.jsx("pre",{className:"text-xs font-mono bg-black/30 p-2 rounded text-gray-300 overflow-x-auto",children:JSON.stringify(N.ships,null,2)})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-bold text-gray-400 mb-2 uppercase border-b border-white/10 pb-1",children:"Obrona"}),r.jsx("pre",{className:"text-xs font-mono bg-black/30 p-2 rounded text-gray-300 overflow-x-auto",children:JSON.stringify(N.defenses,null,2)})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-bold text-gray-400 mb-2 uppercase border-b border-white/10 pb-1",children:"Badania"}),r.jsx("pre",{className:"text-xs font-mono bg-black/30 p-2 rounded text-gray-300 overflow-x-auto",children:JSON.stringify(N.research,null,2)})]}),r.jsx("div",{className:"text-xs text-gray-600 font-mono pt-4 border-t border-white/5",children:"Raw Data Preview (Debug)"})]}),r.jsx("div",{className:"p-4 border-t border-white/10 bg-[#111422] text-right",children:r.jsx("button",{onClick:()=>G(null),className:"px-4 py-2 rounded bg-gray-700 hover:bg-gray-600 text-white transition-colors",children:"Zamknij"})})]})})]})},yv=()=>{const[l,s]=F.useState(null),[n,o]=F.useState(!0),[d,h]=F.useState(null),[f,b]=F.useState(()=>localStorage.getItem("currentView")||"overview");if(F.useEffect(()=>{localStorage.setItem("currentView",f)},[f]),F.useEffect(()=>{ue.auth.getSession().then(({data:{session:v}})=>{s(v),o(!1)});const{data:{subscription:p}}=ue.auth.onAuthStateChange((v,x)=>{s(x),x||h(null)});return()=>p.unsubscribe()},[]),F.useEffect(()=>{(async()=>{if(!(l!=null&&l.user)){h(null);return}const{data:v,error:x}=await ue.from("profiles").select("galaxy_coords").eq("id",l.user.id).maybeSingle();v&&!x&&v.galaxy_coords?h(!0):h(!1)})()},[l]),n)return r.jsxs("div",{className:"loading-screen",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"adowanie..."})]});if(!l)return r.jsx(ev,{onLogin:s});if(d===null)return r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[#101322]",children:r.jsx("div",{className:"text-white text-xl",children:"Sprawdzanie pozycji..."})});if(d===!1)return r.jsx(tv,{session:l,onComplete:()=>h(!0)});const g=()=>{switch(f){case"overview":return r.jsx(op,{onNavigate:p=>b(p)});case"buildings":return r.jsx(av,{});case"research":return r.jsx(nv,{});case"shipyard":return r.jsx(sv,{});case"fleet":return r.jsx(dv,{});case"galaxy":return r.jsx(rv,{});case"shop":return r.jsx(fv,{});case"ranking":return r.jsx(mv,{});case"settings":return r.jsx(pv,{});case"defense":return r.jsx(gv,{});case"clans":return r.jsx(bv,{});case"admin":return r.jsx(xv,{});default:return r.jsx(op,{onNavigate:p=>b(p)})}};return r.jsx(By,{session:l,children:r.jsx(Fy,{activeView:f,onNavigate:p=>b(p),children:g()})})},Mp=document.getElementById("root");if(!Mp)throw new Error("Could not find root element to mount to");const vv=eb.createRoot(Mp);vv.render(r.jsx(_i.StrictMode,{children:r.jsx(yv,{})}));
